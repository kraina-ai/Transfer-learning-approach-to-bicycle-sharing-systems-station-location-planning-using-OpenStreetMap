(self.webpackChunkangular_kepler_test_app=self.webpackChunkangular_kepler_test_app||[]).push([[179],{255:wd=>{function $s(Ua){return Promise.resolve().then(()=>{var Hs=new Error("Cannot find module '"+Ua+"'");throw Hs.code="MODULE_NOT_FOUND",Hs})}$s.keys=()=>[],$s.resolve=$s,$s.id=255,wd.exports=$s},958:function(wd){wd.exports=function(){"use strict";var $s,Ua,Hs;function Cd(g,Do){if($s)if(Ua){var qo="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/api/#transpiling-v2'); }; var sharedChunk = {}; ("+$s+")(sharedChunk); ("+Ua+")(sharedChunk); self.onerror = null;",mo={};$s(mo),Hs=Do(mo),"undefined"!=typeof window&&(Hs.workerUrl=window.URL.createObjectURL(new Blob([qo],{type:"text/javascript"})))}else Ua=Do;else $s=Do}return Cd(0,function(g){var qo=mo;function mo(a,i,l,u){this.cx=3*a,this.bx=3*(l-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(u-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=u,this.p2x=l,this.p2y=u}mo.prototype.sampleCurveX=function(a){return((this.ax*a+this.bx)*a+this.cx)*a},mo.prototype.sampleCurveY=function(a){return((this.ay*a+this.by)*a+this.cy)*a},mo.prototype.sampleCurveDerivativeX=function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},mo.prototype.solveCurveX=function(a,i){var l,u,f,x,b;for(void 0===i&&(i=1e-6),f=a,b=0;b<8;b++){if(x=this.sampleCurveX(f)-a,Math.abs(x)<i)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=x/S}if((f=a)<(l=0))return l;if(f>(u=1))return u;for(;l<u;){if(x=this.sampleCurveX(f),Math.abs(x-a)<i)return f;a>x?l=f:u=f,f=.5*(u-l)+l}return f},mo.prototype.solve=function(a,i){return this.sampleCurveY(this.solveCurveX(a,i))};var dt=ct;function ct(a,i){this.x=a,this.y=i}ct.prototype={clone:function(){return new ct(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,i){return this.clone()._rotateAround(a,i)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var i=a.x-this.x,l=a.y-this.y;return i*i+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,i){return Math.atan2(this.x*i-this.y*a,this.x*a+this.y*i)},_matMult:function(a){var i=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=i,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var i=Math.cos(a),l=Math.sin(a),u=l*this.x+i*this.y;return this.x=i*this.x-l*this.y,this.y=u,this},_rotateAround:function(a,i){var l=Math.cos(a),u=Math.sin(a),f=i.y+u*(this.x-i.x)+l*(this.y-i.y);return this.x=i.x+l*(this.x-i.x)-u*(this.y-i.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ct.convert=function(a){return a instanceof ct?a:Array.isArray(a)?new ct(a[0],a[1]):a};var Et="undefined"!=typeof self?self:{};const ms=Math.pow(2,53)-1,ja=Math.PI/180,hu=180/Math.PI;function qn(a){return a*ja}const du=[[0,0],[1,0],[1,1],[0,1]];function Au(a){if(a<=0)return 0;if(a>=1)return 1;const i=a*a,l=i*a;return 4*(a<.5?l:3*(a-i)+l-.75)}function Ga(a,i,l,u){const f=new qo(a,i,l,u);return function(x){return f.solve(x)}}const gs=Ga(.25,.1,.25,1);function di(a,i,l){return Math.min(l,Math.max(i,a))}function $a(a,i,l){const u=l-i,f=((a-i)%u+u)%u+i;return f===i?l:f}function fu(a,i,l){if(!a.length)return l(null,[]);let u=a.length;const f=new Array(a.length);let x=null;a.forEach((b,S)=>{i(b,(P,F)=>{P&&(x=P),f[S]=F,0==--u&&l(x,f)})})}function Hn(a){const i=[];for(const l in a)i.push(a[l]);return i}function Ai(a,...i){for(const l of i)for(const u in l)a[u]=l[u];return a}let lf=1;function _s(){return lf++}function xl(){return function a(i){return i?(i^16*Math.random()>>i/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function bl(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function vi(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function lc(a,i){a.forEach(l=>{i[l]&&(i[l]=i[l].bind(i))})}function ys(a,i){return-1!==a.indexOf(i,a.length-i.length)}function pn(a,i,l){const u={};for(const f in a)u[f]=i.call(l||this,a[f],f,a);return u}function Zo(a,i,l){const u={};for(const f in a)i.call(l||this,a[f],f,a)&&(u[f]=a[f]);return u}function Br(a){return Array.isArray(a)?a.map(Br):"object"==typeof a&&a?pn(a,Br):a}const Ha={};function jr(a){Ha[a]||("undefined"!=typeof console&&console.warn(a),Ha[a]=!0)}function vs(a,i,l){return(l.y-a.y)*(i.x-a.x)>(i.y-a.y)*(l.x-a.x)}function qa(a){let i=0;for(let l,u,f=0,x=a.length,b=x-1;f<x;b=f++)l=a[f],u=a[b],i+=(u.x-l.x)*(l.y+u.y);return i}function wl(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Za(a){const i={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,u,f,x)=>{const b=f||x;return i[u]=!b||b.toLowerCase(),""}),i["max-age"]){const l=parseInt(i["max-age"],10);isNaN(l)?delete i["max-age"]:i["max-age"]=l}return i}let Wa,zn,Cl,El=null;function pu(a){if(null==El){const i=a.navigator?a.navigator.userAgent:null;El=!!a.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return El}function mu(a){try{const i=Et[a];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch(i){return!1}}const go={now:()=>void 0!==Cl?Cl:Et.performance.now(),setNow(a){Cl=a},restoreNow(){Cl=void 0},frame(a){const i=Et.requestAnimationFrame(a);return{cancel:()=>Et.cancelAnimationFrame(i)}},getImageData(a,i=0){const l=Et.document.createElement("canvas"),u=l.getContext("2d");if(!u)throw new Error("failed to create canvas 2d context");return l.width=a.width,l.height=a.height,u.drawImage(a,0,0,a.width,a.height),u.getImageData(-i,-i,a.width+2*i,a.height+2*i)},resolveURL:a=>(Wa||(Wa=Et.document.createElement("a")),Wa.href=a,Wa.href),get devicePixelRatio(){return Et.devicePixelRatio},get prefersReducedMotion(){return!!Et.matchMedia&&(null==zn&&(zn=Et.matchMedia("(prefers-reduced-motion: reduce)")),zn.matches)}};let _a;const Kn={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==_a){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{_a=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):a}catch(i){_a=a}}return _a},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},qs={supported:!1,testSupport:function(a){!ya&&Nr&&(Ed?Zs(a):Qa=a)}};let Qa,Nr,ya=!1,Ed=!1;function Zs(a){const i=a.createTexture();a.bindTexture(a.TEXTURE_2D,i);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,Nr),a.isContextLost())return;qs.supported=!0}catch(l){}a.deleteTexture(i),ya=!0}Et.document&&(Nr=Et.document.createElement("img"),Nr.onload=function(){Qa&&Zs(Qa),Qa=null,Ed=!0},Nr.onerror=function(){ya=!0,Qa=null},Nr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const gu="01",va="NO_ACCESS_TOKEN";function mr(a){return 0===a.indexOf("mapbox:")}function Xa(a){return Kn.API_URL_REGEX.test(a)}const _u=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function xs(a){const i=a.match(_u);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function Wo(a){const i=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${i}`}function Mo(a){if(!a)return null;const i=a.split(".");if(!i||3!==i.length)return null;try{return JSON.parse(decodeURIComponent(Et.atob(i[1]).split("").map(l=>"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(l){return null}}class yu{constructor(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(i){const l=Mo(Kn.ACCESS_TOKEN);let u="";return u=l&&l.u?Et.btoa(encodeURIComponent(l.u).replace(/%([0-9A-F]{2})/g,(f,x)=>String.fromCharCode(Number("0x"+x)))):Kn.ACCESS_TOKEN||"",i?`mapbox.eventData.${i}:${u}`:`mapbox.eventData:${u}`}fetchEventData(){const i=mu("localStorage"),l=this.getStorageKey(),u=this.getStorageKey("uuid");if(i)try{const f=Et.localStorage.getItem(l);f&&(this.eventData=JSON.parse(f));const x=Et.localStorage.getItem(u);x&&(this.anonId=x)}catch(f){jr("Unable to read from LocalStorage")}}saveEventData(){const i=mu("localStorage"),l=this.getStorageKey(),u=this.getStorageKey("uuid");if(i)try{Et.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&Et.localStorage.setItem(l,JSON.stringify(this.eventData))}catch(f){jr("Unable to write to LocalStorage")}}processRequests(i){}postEvent(i,l,u,f){if(!Kn.EVENTS_URL)return;const x=xs(Kn.EVENTS_URL);x.params.push(`access_token=${f||Kn.ACCESS_TOKEN||""}`);const b={event:this.type,created:new Date(i).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"2.5.1",skuId:gu,userId:this.anonId},S=l?Ai(b,l):b,P={url:Wo(x),headers:{"Content-Type":"text/plain"},body:JSON.stringify([S])};this.pendingRequest=Y(P,F=>{this.pendingRequest=null,u(F),this.saveEventData(),this.processRequests(f)})}queueRequest(i,l){this.queue.push(i),this.processRequests(l)}}const Dl=new class extends yu{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,i){Kn.EVENTS_URL&&Kn.ACCESS_TOKEN&&Array.isArray(a)&&a.some(l=>mr(l)||Xa(l))&&this.queueRequest(Date.now(),i)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const i=Mo(Kn.ACCESS_TOKEN),l=i?i.u:Kn.ACCESS_TOKEN;let u=l!==this.eventData.tokenU;vi(this.anonId)||(this.anonId=xl(),u=!0);const f=this.queue.shift();if(this.eventData.lastSuccess){const x=new Date(this.eventData.lastSuccess),b=new Date(f),S=(f-this.eventData.lastSuccess)/864e5;u=u||S>=1||S<-1||x.getDate()!==b.getDate()}else u=!0;if(!u)return this.processRequests();this.postEvent(f,{"enabled.telemetry":!1},x=>{x||(this.eventData.lastSuccess=f,this.eventData.tokenU=l)},a)}},xh=Dl.postTurnstileEvent.bind(Dl),cc=new class extends yu{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,i,l,u){this.skuToken=i,this.errorCb=u,Kn.EVENTS_URL&&(l||Kn.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},l):this.errorCb(new Error(va)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:i,timestamp:l}=this.queue.shift();i&&this.success[i]||(this.anonId||this.fetchEventData(),vi(this.anonId)||(this.anonId=xl()),this.postEvent(l,{skuToken:this.skuToken},u=>{u?this.errorCb(u):i&&(this.success[i]=!0)},a))}},uc=cc.postMapLoadEvent.bind(cc),bh=new class extends yu{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,i,l,u){if(!Kn.API_URL||!Kn.SESSION_PATH)return;const f=xs(Kn.API_URL+Kn.SESSION_PATH);f.params.push(`sku=${i||""}`),f.params.push(`access_token=${u||Kn.ACCESS_TOKEN||""}`);const x={url:Wo(f),headers:{"Content-Type":"text/plain"}};this.pendingRequest=ae(x,b=>{this.pendingRequest=null,l(b),this.saveEventData(),this.processRequests(u)})}getSessionAPI(a,i,l,u){this.skuToken=i,this.errorCb=u,Kn.SESSION_PATH&&Kn.API_URL&&(l||Kn.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},l):this.errorCb(new Error(va)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:i,timestamp:l}=this.queue.shift();i&&this.success[i]||this.getSession(l,this.skuToken,u=>{u?this.errorCb(u):i&&(this.success[i]=!0)},a)}},Dd=bh.getSessionAPI.bind(bh),hc=new Set,dc="mapbox-tiles";let Qo,Ya,wh=500,vu=50;function On(){Et.caches&&!Qo&&(Qo=Et.caches.open(dc))}function xa(a){const i=a.indexOf("?");return i<0?a:a.slice(0,i)}let un=1/0;const ba={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(ba);class Ac extends Error{constructor(i,l,u){401===l&&Xa(u)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(i),this.status=l,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Zn=wl()?()=>self.worker&&self.worker.referrer:()=>("blob:"===Et.location.protocol?Et.parent:Et).location.href,ne=function(a,i){if(!(/^file:/.test(l=a.url)||/^file:/.test(Zn())&&!/^\w+:/.test(l))){if(Et.fetch&&Et.Request&&Et.AbortController&&Et.Request.prototype.hasOwnProperty("signal"))return function(u,f){const x=new Et.AbortController,b=new Et.Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:Zn(),signal:x.signal});let S=!1,P=!1;const F=(N=b.url).indexOf("sku=")>0&&Xa(N);var N;"json"===u.type&&b.headers.set("Accept","application/json");const U=(q,re,oe)=>{if(P)return;if(q&&"SecurityError"!==q.message&&jr(q),re&&oe)return j(re);const Ae=Date.now();Et.fetch(b).then(xe=>{if(xe.ok){const Se=F?xe.clone():null;return j(xe,Se,Ae)}return f(new Ac(xe.statusText,xe.status,u.url))}).catch(xe=>{20!==xe.code&&f(new Error(xe.message))})},j=(q,re,oe)=>{("arrayBuffer"===u.type?q.arrayBuffer():"json"===u.type?q.json():q.text()).then(Ae=>{P||(re&&oe&&function(xe,Se,Le){if(On(),!Qo)return;const Be={status:Se.status,statusText:Se.statusText,headers:new Et.Headers};Se.headers.forEach((Ue,Ze)=>Be.headers.set(Ze,Ue));const Ne=Za(Se.headers.get("Cache-Control")||"");Ne["no-store"]||(Ne["max-age"]&&Be.headers.set("Expires",new Date(Le+1e3*Ne["max-age"]).toUTCString()),new Date(Be.headers.get("Expires")).getTime()-Le<42e4||function(Ue,Ze){if(void 0===Ya)try{new Response(new ReadableStream),Ya=!0}catch(at){Ya=!1}Ya?Ze(Ue.body):Ue.blob().then(Ze)}(Se,Ue=>{const Ze=new Et.Response(Ue,Be);On(),Qo&&Qo.then(at=>at.put(xa(xe.url),Ze)).catch(at=>jr(at.message))}))}(b,re,oe),S=!0,f(null,Ae,q.headers.get("Cache-Control"),q.headers.get("Expires")))}).catch(Ae=>{P||f(new Error(Ae.message))})};return F?function(q,re){if(On(),!Qo)return re(null);const oe=xa(q.url);Qo.then(Ae=>{Ae.match(oe).then(xe=>{const Se=function(Le){if(!Le)return!1;const Be=new Date(Le.headers.get("Expires")||0),Ne=Za(Le.headers.get("Cache-Control")||"");return Be>Date.now()&&!Ne["no-cache"]}(xe);Ae.delete(oe),Se&&Ae.put(oe,xe.clone()),re(null,xe,Se)}).catch(re)}).catch(re)}(b,U):U(null,null),{cancel:()=>{P=!0,S||x.abort()}}}(a,i);if(wl()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,i,void 0,!0)}var l;return function(u,f){const x=new Et.XMLHttpRequest;x.open(u.method||"GET",u.url,!0),"arrayBuffer"===u.type&&(x.responseType="arraybuffer");for(const b in u.headers)x.setRequestHeader(b,u.headers[b]);return"json"===u.type&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials="include"===u.credentials,x.onerror=()=>{f(new Error(x.statusText))},x.onload=()=>{if((x.status>=200&&x.status<300||0===x.status)&&null!==x.response){let b=x.response;if("json"===u.type)try{b=JSON.parse(x.response)}catch(S){return f(S)}f(null,b,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else f(new Ac(x.statusText,x.status,u.url))},x.send(u.body),{cancel:()=>x.abort()}}(a,i)},Z=function(a,i){return ne(Ai(a,{type:"arrayBuffer"}),i)},Y=function(a,i){return ne(Ai(a,{method:"POST"}),i)},ae=function(a,i){return ne(Ai(a,{method:"GET"}),i)};function he(a){const i=Et.document.createElement("a");return i.href=a,i.protocol===Et.document.location.protocol&&i.host===Et.document.location.host}const be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let we,ke;we=[],ke=0;const Ee=function(a,i){if(qs.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),ke>=Kn.MAX_PARALLEL_IMAGE_REQUESTS){const x={requestParameters:a,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return we.push(x),x}ke++;let l=!1;const u=()=>{if(!l)for(l=!0,ke--;we.length&&ke<Kn.MAX_PARALLEL_IMAGE_REQUESTS;){const x=we.shift(),{requestParameters:b,callback:S,cancelled:P}=x;P||(x.cancel=Ee(b,S).cancel)}},f=Z(a,(x,b,S,P)=>{u(),x?i(x):b&&(Et.createImageBitmap?function(F,N){const U=new Et.Blob([new Uint8Array(F)],{type:"image/png"});Et.createImageBitmap(U).then(j=>{N(null,j)}).catch(j=>{N(new Error(`Could not load image because of ${j.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(b,(F,N)=>i(F,N,S,P)):function(F,N){const U=new Et.Image,j=Et.URL;U.onload=()=>{N(null,U),j.revokeObjectURL(U.src),U.onload=null,Et.requestAnimationFrame(()=>{U.src=be})},U.onerror=()=>N(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new Et.Blob([new Uint8Array(F)],{type:"image/png"});U.src=F.byteLength?j.createObjectURL(q):be}(b,(F,N)=>i(F,N,S,P)))});return{cancel:()=>{f.cancel(),u()}}};function Oe(a,i,l){l[a]&&-1!==l[a].indexOf(i)||(l[a]=l[a]||[],l[a].push(i))}function Je(a,i,l){if(l&&l[a]){const u=l[a].indexOf(i);-1!==u&&l[a].splice(u,1)}}class mt{constructor(i,l={}){Ai(this,l),this.type=i}}class Ke extends mt{constructor(i,l={}){super("error",Ai({error:i},l))}}class $t{on(i,l){return this._listeners=this._listeners||{},Oe(i,l,this._listeners),this}off(i,l){return Je(i,l,this._listeners),Je(i,l,this._oneTimeListeners),this}once(i,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},Oe(i,l,this._oneTimeListeners),this):new Promise(u=>this.once(i,u))}fire(i,l){"string"==typeof i&&(i=new mt(i,l||{}));const u=i.type;if(this.listens(u)){i.target=this;const f=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const S of f)S.call(this,i);const x=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const S of x)Je(u,S,this._oneTimeListeners),S.call(this,i);const b=this._eventedParent;b&&(Ai(i,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),b.fire(i))}else i instanceof Ke&&console.error(i.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,l){return this._eventedParent=i,this._eventedParentData=l,this}}var Ce={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class $e{constructor(i,l,u,f){this.message=(i?`${i}: `:"")+u,f&&(this.identifier=f),null!=l&&l.__line__&&(this.line=l.__line__)}}function qt(a){const i=a.value;return i?[new $e(a.key,i,"constants have been deprecated as of v8")]:[]}function _n(a,...i){for(const l of i)for(const u in l)a[u]=l[u];return a}function an(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function er(a){if(Array.isArray(a))return a.map(er);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const i={};for(const l in a)i[l]=er(a[l]);return i}return an(a)}class Vn extends Error{constructor(i,l){super(l),this.message=l,this.key=i}}class xr{constructor(i,l=[]){this.parent=i,this.bindings={};for(const[u,f]of l)this.bindings[u]=f}concat(i){return new xr(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const Ka={kind:"null"},bt={kind:"number"},wn={kind:"string"},Xt={kind:"boolean"},Wn={kind:"color"},Ji={kind:"object"},Cn={kind:"value"},Md={kind:"collator"},Wt={kind:"formatted"},xu={kind:"resolvedImage"};function gr(a,i){return{kind:"array",itemType:a,N:i}}function tr(a){if("array"===a.kind){const i=tr(a.itemType);return"number"==typeof a.N?`array<${i}, ${a.N}>`:"value"===a.itemType.kind?"array":`array<${i}>`}return a.kind}const Sd=[Ka,bt,wn,Xt,Wn,Wt,Ji,gr(Cn),xu];function fc(a,i){if("error"===i.kind)return null;if("array"===a.kind){if("array"===i.kind&&(0===i.N&&"value"===i.itemType.kind||!fc(a.itemType,i.itemType))&&("number"!=typeof a.N||a.N===i.N))return null}else{if(a.kind===i.kind)return null;if("value"===a.kind)for(const l of Sd)if(!fc(l,i))return null}return`Expected ${tr(a)} but found ${tr(i)} instead.`}function pc(a,i){return i.some(l=>l.kind===a.kind)}function mc(a,i){return i.some(l=>"null"===l?null===a:"array"===l?Array.isArray(a):"object"===l?a&&!Array.isArray(a)&&"object"==typeof a:l===typeof a)}function Xo(a){var i={exports:{}};return a(i,i.exports),i.exports}var bu=Xo(function(a,i){var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(S){return(S=Math.round(S))<0?0:S>255?255:S}function f(S){return u("%"===S[S.length-1]?parseFloat(S)/100*255:parseInt(S))}function x(S){return(P="%"===S[S.length-1]?parseFloat(S)/100:parseFloat(S))<0?0:P>1?1:P;var P}function b(S,P,F){return F<0?F+=1:F>1&&(F-=1),6*F<1?S+(P-S)*F*6:2*F<1?P:3*F<2?S+(P-S)*(2/3-F)*6:S}try{i.parseCSSColor=function(S){var P,F=S.replace(/ /g,"").toLowerCase();if(F in l)return l[F].slice();if("#"===F[0])return 4===F.length?(P=parseInt(F.substr(1),16))>=0&&P<=4095?[(3840&P)>>4|(3840&P)>>8,240&P|(240&P)>>4,15&P|(15&P)<<4,1]:null:7===F.length&&(P=parseInt(F.substr(1),16))>=0&&P<=16777215?[(16711680&P)>>16,(65280&P)>>8,255&P,1]:null;var N=F.indexOf("("),U=F.indexOf(")");if(-1!==N&&U+1===F.length){var j=F.substr(0,N),q=F.substr(N+1,U-(N+1)).split(","),re=1;switch(j){case"rgba":if(4!==q.length)return null;re=x(q.pop());case"rgb":return 3!==q.length?null:[f(q[0]),f(q[1]),f(q[2]),re];case"hsla":if(4!==q.length)return null;re=x(q.pop());case"hsl":if(3!==q.length)return null;var oe=(parseFloat(q[0])%360+360)%360/360,Ae=x(q[1]),xe=x(q[2]),Se=xe<=.5?xe*(Ae+1):xe+Ae-xe*Ae,Le=2*xe-Se;return[u(255*b(Le,Se,oe+1/3)),u(255*b(Le,Se,oe)),u(255*b(Le,Se,oe-1/3)),re];default:return null}}return null}}catch(S){}});class dn{constructor(i,l,u,f=1){this.r=i,this.g=l,this.b=u,this.a=f}static parse(i){if(!i)return;if(i instanceof dn)return i;if("string"!=typeof i)return;const l=bu.parseCSSColor(i);return l?new dn(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toString(){const[i,l,u,f]=this.toArray();return`rgba(${Math.round(i)},${Math.round(l)},${Math.round(u)},${f})`}toArray(){const{r:i,g:l,b:u,a:f}=this;return 0===f?[0,0,0,0]:[255*i/f,255*l/f,255*u/f,f]}}dn.black=new dn(0,0,0,1),dn.white=new dn(1,1,1,1),dn.transparent=new dn(0,0,0,0),dn.red=new dn(1,0,0,1),dn.blue=new dn(0,0,1,1);class Td{constructor(i,l,u){this.sensitivity=i?l?"variant":"case":l?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,l){return this.collator.compare(i,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Yt{constructor(i,l,u,f,x){this.text=i,this.image=l,this.scale=u,this.fontStack=f,this.textColor=x}}class fi{constructor(i){this.sections=i}static fromString(i){return new fi([new Yt(i,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(i=>0!==i.text.length||i.image&&0!==i.image.name.length)}static factory(i){return i instanceof fi?i:fi.fromString(i)}toString(){return 0===this.sections.length?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const l of this.sections){if(l.image){i.push(["image",l.image.name]);continue}i.push(l.text);const u={};l.fontStack&&(u["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(u["font-scale"]=l.scale),l.textColor&&(u["text-color"]=["rgba"].concat(l.textColor.toArray())),i.push(u)}return i}}class Bo{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new Bo({name:i,available:!1}):null}serialize(){return["image",this.name]}}function wa(a,i,l,u){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof i&&i>=0&&i<=255&&"number"==typeof l&&l>=0&&l<=255?void 0===u||"number"==typeof u&&u>=0&&u<=1?null:`Invalid rgba value [${[a,i,l,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof u?[a,i,l,u]:[a,i,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function wu(a){if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||a instanceof dn||a instanceof Td||a instanceof fi||a instanceof Bo)return!0;if(Array.isArray(a)){for(const i of a)if(!wu(i))return!1;return!0}if("object"==typeof a){for(const i in a)if(!wu(a[i]))return!1;return!0}return!1}function xi(a){if(null===a)return Ka;if("string"==typeof a)return wn;if("boolean"==typeof a)return Xt;if("number"==typeof a)return bt;if(a instanceof dn)return Wn;if(a instanceof Td)return Md;if(a instanceof fi)return Wt;if(a instanceof Bo)return xu;if(Array.isArray(a)){const i=a.length;let l;for(const u of a){const f=xi(u);if(l){if(l===f)continue;l=Cn;break}l=f}return gr(l||Cn,i)}return Ji}function No(a){const i=typeof a;return null===a?"":"string"===i||"number"===i||"boolean"===i?String(a):a instanceof dn||a instanceof fi||a instanceof Bo?a.toString():JSON.stringify(a)}class pi{constructor(i,l){this.type=i,this.value=l}static parse(i,l){if(2!==i.length)return l.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!wu(i[1]))return l.error("invalid value");const u=i[1];let f=xi(u);const x=l.expectedType;return"array"!==f.kind||0!==f.N||!x||"array"!==x.kind||"number"==typeof x.N&&0!==x.N||(f=x),new pi(f,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof dn?["rgba"].concat(this.value.toArray()):this.value instanceof fi?this.value.serialize():this.value}}class eo{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const Cu={string:wn,number:bt,boolean:Xt,object:Ji};class _r{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");let u,f=1;const x=i[0];if("array"===x){let S,P;if(i.length>2){const F=i[1];if("string"!=typeof F||!(F in Cu)||"object"===F)return l.error('The item type argument of "array" must be one of string, number, boolean',1);S=Cu[F],f++}else S=Cn;if(i.length>3){if(null!==i[2]&&("number"!=typeof i[2]||i[2]<0||i[2]!==Math.floor(i[2])))return l.error('The length argument to "array" must be a positive integer literal',2);P=i[2],f++}u=gr(S,P)}else u=Cu[x];const b=[];for(;f<i.length;f++){const S=l.parse(i[f],f,Cn);if(!S)return null;b.push(S)}return new _r(u,b)}evaluate(i){for(let l=0;l<this.args.length;l++){const u=this.args[l].evaluate(i);if(!fc(this.type,xi(u)))return u;if(l===this.args.length-1)throw new eo(`Expected value to be of type ${tr(this.type)}, but found ${tr(xi(u))} instead.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,l=[i.kind];if("array"===i.kind){const u=i.itemType;if("string"===u.kind||"number"===u.kind||"boolean"===u.kind){l.push(u.kind);const f=i.N;("number"==typeof f||this.args.length>1)&&l.push(f)}}return l.concat(this.args.map(u=>u.serialize()))}}class Eu{constructor(i){this.type=Wt,this.sections=i}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const u=i[1];if(!Array.isArray(u)&&"object"==typeof u)return l.error("First argument must be an image or text section.");const f=[];let x=!1;for(let b=1;b<=i.length-1;++b){const S=i[b];if(x&&"object"==typeof S&&!Array.isArray(S)){x=!1;let P=null;if(S["font-scale"]&&(P=l.parse(S["font-scale"],1,bt),!P))return null;let F=null;if(S["text-font"]&&(F=l.parse(S["text-font"],1,gr(wn)),!F))return null;let N=null;if(S["text-color"]&&(N=l.parse(S["text-color"],1,Wn),!N))return null;const U=f[f.length-1];U.scale=P,U.font=F,U.textColor=N}else{const P=l.parse(i[b],1,Cn);if(!P)return null;const F=P.type.kind;if("string"!==F&&"value"!==F&&"null"!==F&&"resolvedImage"!==F)return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,f.push({content:P,scale:null,font:null,textColor:null})}}return new Eu(f)}evaluate(i){return new fi(this.sections.map(l=>{const u=l.content.evaluate(i);return xi(u)===xu?new Yt("",u,null,null,null):new Yt(No(u),null,l.scale?l.scale.evaluate(i):null,l.font?l.font.evaluate(i).join(","):null,l.textColor?l.textColor.evaluate(i):null)}))}eachChild(i){for(const l of this.sections)i(l.content),l.scale&&i(l.scale),l.font&&i(l.font),l.textColor&&i(l.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const l of this.sections){i.push(l.content.serialize());const u={};l.scale&&(u["font-scale"]=l.scale.serialize()),l.font&&(u["text-font"]=l.font.serialize()),l.textColor&&(u["text-color"]=l.textColor.serialize()),i.push(u)}return i}}class Ch{constructor(i){this.type=xu,this.input=i}static parse(i,l){if(2!==i.length)return l.error("Expected two arguments.");const u=l.parse(i[1],1,wn);return u?new Ch(u):l.error("No image name provided.")}evaluate(i){const l=this.input.evaluate(i),u=Bo.fromString(l);return u&&i.availableImages&&(u.available=i.availableImages.indexOf(l)>-1),u}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const om={"to-boolean":Xt,"to-color":Wn,"to-number":bt,"to-string":wn};class Ml{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const u=i[0];if(("to-boolean"===u||"to-string"===u)&&2!==i.length)return l.error("Expected one argument.");const f=om[u],x=[];for(let b=1;b<i.length;b++){const S=l.parse(i[b],b,Cn);if(!S)return null;x.push(S)}return new Ml(f,x)}evaluate(i){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(i));if("color"===this.type.kind){let l,u;for(const f of this.args){if(l=f.evaluate(i),u=null,l instanceof dn)return l;if("string"==typeof l){const x=i.parseColor(l);if(x)return x}else if(Array.isArray(l)&&(u=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:wa(l[0],l[1],l[2],l[3]),!u))return new dn(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new eo(u||`Could not parse color from value '${"string"==typeof l?l:String(JSON.stringify(l))}'`)}if("number"===this.type.kind){let l=null;for(const u of this.args){if(l=u.evaluate(i),null===l)return 0;const f=Number(l);if(!isNaN(f))return f}throw new eo(`Could not convert ${JSON.stringify(l)} to number.`)}return"formatted"===this.type.kind?fi.fromString(No(this.args[0].evaluate(i))):"resolvedImage"===this.type.kind?Bo.fromString(No(this.args[0].evaluate(i))):No(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Eu([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ch(this.args[0]).serialize();const i=[`to-${this.type.kind}`];return this.eachChild(l=>{i.push(l.serialize())}),i}}const cr=["Unknown","Point","LineString","Polygon"];class sm{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?cr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let l=this._parseColorCache[i];return l||(l=this._parseColorCache[i]=dn.parse(i)),l}}class Yo{constructor(i,l,u,f){this.name=i,this.type=l,this._evaluate=u,this.args=f}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,l){const u=i[0],f=Yo.definitions[u];if(!f)return l.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(f)?f[0]:f.type,b=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,S=b.filter(([F])=>!Array.isArray(F)||F.length===i.length-1);let P=null;for(const[F,N]of S){P=new Qs(l.registry,l.path,null,l.scope);const U=[];let j=!1;for(let q=1;q<i.length;q++){const re=i[q],oe=Array.isArray(F)?F[q-1]:F.type,Ae=P.parse(re,1+U.length,oe);if(!Ae){j=!0;break}U.push(Ae)}if(!j)if(Array.isArray(F)&&F.length!==U.length)P.error(`Expected ${F.length} arguments, but found ${U.length} instead.`);else{for(let q=0;q<U.length;q++){const re=Array.isArray(F)?F[q]:F.type,oe=U[q];P.concat(q+1).checkSubtype(re,oe.type)}if(0===P.errors.length)return new Yo(u,x,N,U)}}if(1===S.length)l.errors.push(...P.errors);else{const F=(S.length?S:b).map(([U])=>{return j=U,Array.isArray(j)?`(${j.map(tr).join(", ")})`:`(${tr(j.type)}...)`;var j}).join(" | "),N=[];for(let U=1;U<i.length;U++){const j=l.parse(i[U],1+N.length);if(!j)return null;N.push(tr(j.type))}l.error(`Expected arguments of type ${F}, but found (${N.join(", ")}) instead.`)}return null}static register(i,l){Yo.definitions=l;for(const u in l)i[u]=Yo}}class Ko{constructor(i,l,u){this.type=Md,this.locale=u,this.caseSensitive=i,this.diacriticSensitive=l}static parse(i,l){if(2!==i.length)return l.error("Expected one argument.");const u=i[1];if("object"!=typeof u||Array.isArray(u))return l.error("Collator options argument must be an object.");const f=l.parse(void 0!==u["case-sensitive"]&&u["case-sensitive"],1,Xt);if(!f)return null;const x=l.parse(void 0!==u["diacritic-sensitive"]&&u["diacritic-sensitive"],1,Xt);if(!x)return null;let b=null;return u.locale&&(b=l.parse(u.locale,1,wn),!b)?null:new Ko(f,x,b)}evaluate(i){return new Td(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}const Qn=8192;function gc(a,i){a[0]=Math.min(a[0],i[0]),a[1]=Math.min(a[1],i[1]),a[2]=Math.max(a[2],i[0]),a[3]=Math.max(a[3],i[1])}function _c(a,i){return!(a[0]<=i[0]||a[2]>=i[2]||a[1]<=i[1]||a[3]>=i[3])}function Id(a,i){const l=(180+a[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,f=Math.pow(2,i.z);return[Math.round(l*f*Qn),Math.round(u*f*Qn)]}function cf(a,i,l){const u=a[0]-i[0],f=a[1]-i[1],x=a[0]-l[0],b=a[1]-l[1];return u*b-x*f==0&&u*x<=0&&f*b<=0}function kd(a,i){let l=!1;for(let b=0,S=i.length;b<S;b++){const P=i[b];for(let F=0,N=P.length;F<N-1;F++){if(cf(a,P[F],P[F+1]))return!1;(f=P[F])[1]>(u=a)[1]!=(x=P[F+1])[1]>u[1]&&u[0]<(x[0]-f[0])*(u[1]-f[1])/(x[1]-f[1])+f[0]&&(l=!l)}}var u,f,x;return l}function Ws(a,i){for(let l=0;l<i.length;l++)if(kd(a,i[l]))return!0;return!1}function Ca(a,i,l,u){const f=u[0]-l[0],x=u[1]-l[1],b=(a[0]-l[0])*x-f*(a[1]-l[1]),S=(i[0]-l[0])*x-f*(i[1]-l[1]);return b>0&&S<0||b<0&&S>0}function am(a,i,l){for(const F of l)for(let N=0;N<F.length-1;++N)if((S=[(b=F[N+1])[0]-(x=F[N])[0],b[1]-x[1]])[0]*(P=[(f=i)[0]-(u=a)[0],f[1]-u[1]])[1]-S[1]*P[0]!=0&&Ca(u,f,x,b)&&Ca(x,b,u,f))return!0;var u,f,x,b,S,P;return!1}function zo(a,i){for(let l=0;l<a.length;++l)if(!kd(a[l],i))return!1;for(let l=0;l<a.length-1;++l)if(am(a[l],a[l+1],i))return!1;return!0}function lm(a,i){for(let l=0;l<i.length;l++)if(zo(a,i[l]))return!0;return!1}function Eh(a,i,l){const u=[];for(let f=0;f<a.length;f++){const x=[];for(let b=0;b<a[f].length;b++){const S=Id(a[f][b],l);gc(i,S),x.push(S)}u.push(x)}return u}function Jo(a,i,l){const u=[];for(let f=0;f<a.length;f++){const x=Eh(a[f],i,l);u.push(x)}return u}function Dh(a,i,l,u){if(a[0]<l[0]||a[0]>l[2]){const f=.5*u;let x=a[0]-l[0]>f?-u:l[0]-a[0]>f?u:0;0===x&&(x=a[0]-l[2]>f?-u:l[2]-a[0]>f?u:0),a[0]+=x}gc(i,a)}function Gi(a,i,l,u){const f=Math.pow(2,u.z)*Qn,x=[u.x*Qn,u.y*Qn],b=[];for(const S of a)for(const P of S){const F=[P.x+x[0],P.y+x[1]];Dh(F,i,l,f),b.push(F)}return b}function Du(a,i,l,u){const f=Math.pow(2,u.z)*Qn,x=[u.x*Qn,u.y*Qn],b=[];for(const P of a){const F=[];for(const N of P){const U=[N.x+x[0],N.y+x[1]];gc(i,U),F.push(U)}b.push(F)}if(i[2]-i[0]<=f/2){(S=i)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const P of b)for(const F of P)Dh(F,i,l,f)}var S;return b}class es{constructor(i,l){this.type=Xt,this.geojson=i,this.geometries=l}static parse(i,l){if(2!==i.length)return l.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(wu(i[1])){const u=i[1];if("FeatureCollection"===u.type)for(let f=0;f<u.features.length;++f){const x=u.features[f].geometry.type;if("Polygon"===x||"MultiPolygon"===x)return new es(u,u.features[f].geometry)}else if("Feature"===u.type){const f=u.geometry.type;if("Polygon"===f||"MultiPolygon"===f)return new es(u,u.geometry)}else if("Polygon"===u.type||"MultiPolygon"===u.type)return new es(u,u)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(null!=i.geometry()&&null!=i.canonicalID()){if("Point"===i.geometryType())return function(l,u){const f=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if("Polygon"===u.type){const S=Eh(u.coordinates,x,b),P=Gi(l.geometry(),f,x,b);if(!_c(f,x))return!1;for(const F of P)if(!kd(F,S))return!1}if("MultiPolygon"===u.type){const S=Jo(u.coordinates,x,b),P=Gi(l.geometry(),f,x,b);if(!_c(f,x))return!1;for(const F of P)if(!Ws(F,S))return!1}return!0}(i,this.geometries);if("LineString"===i.geometryType())return function(l,u){const f=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if("Polygon"===u.type){const S=Eh(u.coordinates,x,b),P=Du(l.geometry(),f,x,b);if(!_c(f,x))return!1;for(const F of P)if(!zo(F,S))return!1}if("MultiPolygon"===u.type){const S=Jo(u.coordinates,x,b),P=Du(l.geometry(),f,x,b);if(!_c(f,x))return!1;for(const F of P)if(!lm(F,S))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function Kt(a){if(a instanceof Yo&&("get"===a.name&&1===a.args.length||"feature-state"===a.name||"has"===a.name&&1===a.args.length||"properties"===a.name||"geometry-type"===a.name||"id"===a.name||/^filter-/.test(a.name))||a instanceof es)return!1;let i=!0;return a.eachChild(l=>{i&&!Kt(l)&&(i=!1)}),i}function bi(a){if(a instanceof Yo&&"feature-state"===a.name)return!1;let i=!0;return a.eachChild(l=>{i&&!bi(l)&&(i=!1)}),i}function Fi(a,i){if(a instanceof Yo&&i.indexOf(a.name)>=0)return!1;let l=!0;return a.eachChild(u=>{l&&!Fi(u,i)&&(l=!1)}),l}class mn{constructor(i,l){this.type=l.type,this.name=i,this.boundExpression=l}static parse(i,l){if(2!==i.length||"string"!=typeof i[1])return l.error("'var' expression requires exactly one string literal argument.");const u=i[1];return l.scope.has(u)?new mn(u,l.scope.get(u)):l.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Qs{constructor(i,l=[],u,f=new xr,x=[]){this.registry=i,this.path=l,this.key=l.map(b=>`[${b}]`).join(""),this.scope=f,this.errors=x,this.expectedType=u}parse(i,l,u,f,x={}){return l?this.concat(l,u,f)._parse(i,x):this._parse(i,x)}_parse(i,l){function u(f,x,b){return"assert"===b?new _r(x,[f]):"coerce"===b?new Ml(x,[f]):f}if(null!==i&&"string"!=typeof i&&"boolean"!=typeof i&&"number"!=typeof i||(i=["literal",i]),Array.isArray(i)){if(0===i.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=i[0];if("string"!=typeof f)return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[f];if(x){let b=x.parse(i,this);if(!b)return null;if(this.expectedType){const S=this.expectedType,P=b.type;if("string"!==S.kind&&"number"!==S.kind&&"boolean"!==S.kind&&"object"!==S.kind&&"array"!==S.kind||"value"!==P.kind)if("color"!==S.kind&&"formatted"!==S.kind&&"resolvedImage"!==S.kind||"value"!==P.kind&&"string"!==P.kind){if(this.checkSubtype(S,P))return null}else b=u(b,S,l.typeAnnotation||"coerce");else b=u(b,S,l.typeAnnotation||"assert")}if(!(b instanceof pi)&&"resolvedImage"!==b.type.kind&&So(b)){const S=new sm;try{b=new pi(b.type,b.evaluate(S))}catch(P){return this.error(P.message),null}}return b}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===i?"'undefined' value invalid. Use null instead.":"object"==typeof i?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,l,u){const f="number"==typeof i?this.path.concat(i):this.path,x=u?this.scope.concat(u):this.scope;return new Qs(this.registry,f,l||null,x,this.errors)}error(i,...l){const u=`${this.key}${l.map(f=>`[${f}]`).join("")}`;this.errors.push(new Vn(u,i))}checkSubtype(i,l){const u=fc(i,l);return u&&this.error(u),u}}function So(a){if(a instanceof mn)return So(a.boundExpression);if(a instanceof Yo&&"error"===a.name||a instanceof Ko||a instanceof es)return!1;const i=a instanceof Ml||a instanceof _r;let l=!0;return a.eachChild(u=>{l=i?l&&So(u):l&&u instanceof pi}),!!l&&Kt(a)&&Fi(a,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script"])}function Mh(a,i){const l=a.length-1;let u,f,x=0,b=l,S=0;for(;x<=b;)if(S=Math.floor((x+b)/2),u=a[S],f=a[S+1],u<=i){if(S===l||i<f)return S;x=S+1}else{if(!(u>i))throw new eo("Input is not a number.");b=S-1}return 0}class $i{constructor(i,l,u){this.type=i,this.input=l,this.labels=[],this.outputs=[];for(const[f,x]of u)this.labels.push(f),this.outputs.push(x)}static parse(i,l){if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");const u=l.parse(i[1],1,bt);if(!u)return null;const f=[];let x=null;l.expectedType&&"value"!==l.expectedType.kind&&(x=l.expectedType);for(let b=1;b<i.length;b+=2){const S=1===b?-1/0:i[b],P=i[b+1],F=b,N=b+1;if("number"!=typeof S)return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(f.length&&f[f.length-1][0]>=S)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);const U=l.parse(P,N,x);if(!U)return null;x=x||U.type,f.push([S,U])}return new $i(x,u,f)}evaluate(i){const l=this.labels,u=this.outputs;if(1===l.length)return u[0].evaluate(i);const f=this.input.evaluate(i);if(f<=l[0])return u[0].evaluate(i);const x=l.length;return f>=l[x-1]?u[x-1].evaluate(i):u[Mh(l,f)].evaluate(i)}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&i.push(this.labels[l]),i.push(this.outputs[l].serialize());return i}}function At(a,i,l){return a*(1-l)+i*l}var En=Object.freeze({__proto__:null,number:At,color:function(a,i,l){return new dn(At(a.r,i.r,l),At(a.g,i.g,l),At(a.b,i.b,l),At(a.a,i.a,l))},array:function(a,i,l){return a.map((u,f)=>At(u,i[f],l))}});const Ea=4/29,mi=6/29,Xs=3*mi*mi,Yr=Math.PI/180,Mu=180/Math.PI;function Da(a){return a>.008856451679035631?Math.pow(a,1/3):a/Xs+Ea}function yn(a){return a>mi?a*a*a:Xs*(a-Ea)}function Sl(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Ma(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Su(a){const i=Ma(a.r),l=Ma(a.g),u=Ma(a.b),f=Da((.4124564*i+.3575761*l+.1804375*u)/.95047),x=Da((.2126729*i+.7151522*l+.072175*u)/1);return{l:116*x-16,a:500*(f-x),b:200*(x-Da((.0193339*i+.119192*l+.9503041*u)/1.08883)),alpha:a.a}}function Ja(a){let i=(a.l+16)/116,l=isNaN(a.a)?i:i+a.a/500,u=isNaN(a.b)?i:i-a.b/200;return i=1*yn(i),l=.95047*yn(l),u=1.08883*yn(u),new dn(Sl(3.2404542*l-1.5371385*i-.4985314*u),Sl(-.969266*l+1.8760108*i+.041556*u),Sl(.0556434*l-.2040259*i+1.0572252*u),a.alpha)}function To(a,i,l){const u=i-a;return a+l*(u>180||u<-180?u-360*Math.round(u/360):u)}const Ys={forward:Su,reverse:Ja,interpolate:function(a,i,l){return{l:At(a.l,i.l,l),a:At(a.a,i.a,l),b:At(a.b,i.b,l),alpha:At(a.alpha,i.alpha,l)}}},bs={forward:function(a){const{l:i,a:l,b:u}=Su(a),f=Math.atan2(u,l)*Mu;return{h:f<0?f+360:f,c:Math.sqrt(l*l+u*u),l:i,alpha:a.a}},reverse:function(a){const i=a.h*Yr,l=a.c;return Ja({l:a.l,a:Math.cos(i)*l,b:Math.sin(i)*l,alpha:a.alpha})},interpolate:function(a,i,l){return{h:To(a.h,i.h,l),c:At(a.c,i.c,l),l:At(a.l,i.l,l),alpha:At(a.alpha,i.alpha,l)}}};var ts=Object.freeze({__proto__:null,lab:Ys,hcl:bs});class Ln{constructor(i,l,u,f,x){this.type=i,this.operator=l,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(const[b,S]of x)this.labels.push(b),this.outputs.push(S)}static interpolationFactor(i,l,u,f){let x=0;if("exponential"===i.name)x=Pd(l,i.base,u,f);else if("linear"===i.name)x=Pd(l,1,u,f);else if("cubic-bezier"===i.name){const b=i.controlPoints;x=new qo(b[0],b[1],b[2],b[3]).solve(Pd(l,1,u,f))}return x}static parse(i,l){let[u,f,x,...b]=i;if(!Array.isArray(f)||0===f.length)return l.error("Expected an interpolation type expression.",1);if("linear"===f[0])f={name:"linear"};else if("exponential"===f[0]){const F=f[1];if("number"!=typeof F)return l.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:F}}else{if("cubic-bezier"!==f[0])return l.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const F=f.slice(1);if(4!==F.length||F.some(N=>"number"!=typeof N||N<0||N>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:F}}}if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(x=l.parse(x,2,bt),!x)return null;const S=[];let P=null;"interpolate-hcl"===u||"interpolate-lab"===u?P=Wn:l.expectedType&&"value"!==l.expectedType.kind&&(P=l.expectedType);for(let F=0;F<b.length;F+=2){const N=b[F],U=b[F+1],j=F+3,q=F+4;if("number"!=typeof N)return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(S.length&&S[S.length-1][0]>=N)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const re=l.parse(U,q,P);if(!re)return null;P=P||re.type,S.push([N,re])}return"number"===P.kind||"color"===P.kind||"array"===P.kind&&"number"===P.itemType.kind&&"number"==typeof P.N?new Ln(P,u,f,x,S):l.error(`Type ${tr(P)} is not interpolatable.`)}evaluate(i){const l=this.labels,u=this.outputs;if(1===l.length)return u[0].evaluate(i);const f=this.input.evaluate(i);if(f<=l[0])return u[0].evaluate(i);const x=l.length;if(f>=l[x-1])return u[x-1].evaluate(i);const b=Mh(l,f),S=Ln.interpolationFactor(this.interpolation,f,l[b],l[b+1]),P=u[b].evaluate(i),F=u[b+1].evaluate(i);return"interpolate"===this.operator?En[this.type.kind.toLowerCase()](P,F,S):"interpolate-hcl"===this.operator?bs.reverse(bs.interpolate(bs.forward(P),bs.forward(F),S)):Ys.reverse(Ys.interpolate(Ys.forward(P),Ys.forward(F),S))}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const l=[this.operator,i,this.input.serialize()];for(let u=0;u<this.labels.length;u++)l.push(this.labels[u],this.outputs[u].serialize());return l}}function Pd(a,i,l,u){const f=u-l,x=a-l;return 0===f?0:1===i?x/f:(Math.pow(i,x)-1)/(Math.pow(i,f)-1)}class Sh{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expectected at least one argument.");let u=null;const f=l.expectedType;f&&"value"!==f.kind&&(u=f);const x=[];for(const S of i.slice(1)){const P=l.parse(S,1+x.length,u,void 0,{typeAnnotation:"omit"});if(!P)return null;u=u||P.type,x.push(P)}const b=f&&x.some(S=>fc(f,S.type));return new Sh(b?Cn:u,x)}evaluate(i){let l,u=null,f=0;for(const x of this.args)if(f++,u=x.evaluate(i),u&&u instanceof Bo&&!u.available&&(l||(l=u.name),u=null,f===this.args.length&&(u=l)),null!==u)break;return u}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(l=>{i.push(l.serialize())}),i}}class Tl{constructor(i,l){this.type=l.type,this.bindings=[].concat(i),this.result=l}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const l of this.bindings)i(l[1]);i(this.result)}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const u=[];for(let x=1;x<i.length-1;x+=2){const b=i[x];if("string"!=typeof b)return l.error(`Expected string, but found ${typeof b} instead.`,x);if(/[^a-zA-Z0-9_]/.test(b))return l.error("Variable names must contain only alphanumeric characters or '_'.",x);const S=l.parse(i[x+1],x+1);if(!S)return null;u.push([b,S])}const f=l.parse(i[i.length-1],i.length-1,l.expectedType,u);return f?new Tl(u,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[l,u]of this.bindings)i.push(l,u.serialize());return i.push(this.result.serialize()),i}}class yc{constructor(i,l,u){this.type=i,this.index=l,this.input=u}static parse(i,l){if(3!==i.length)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const u=l.parse(i[1],1,bt),f=l.parse(i[2],2,gr(l.expectedType||Cn));return u&&f?new yc(f.type.itemType,u,f):null}evaluate(i){const l=this.index.evaluate(i),u=this.input.evaluate(i);if(l<0)throw new eo(`Array index out of bounds: ${l} < 0.`);if(l>=u.length)throw new eo(`Array index out of bounds: ${l} > ${u.length-1}.`);if(l!==Math.floor(l))throw new eo(`Array index must be an integer, but found ${l} instead.`);return u[l]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Il{constructor(i,l){this.type=Xt,this.needle=i,this.haystack=l}static parse(i,l){if(3!==i.length)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const u=l.parse(i[1],1,Cn),f=l.parse(i[2],2,Cn);return u&&f?pc(u.type,[Xt,wn,bt,Ka,Cn])?new Il(u,f):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${tr(u.type)} instead`):null}evaluate(i){const l=this.needle.evaluate(i),u=this.haystack.evaluate(i);if(!u)return!1;if(!mc(l,["boolean","string","number","null"]))throw new eo(`Expected first argument to be of type boolean, string, number or null, but found ${tr(xi(l))} instead.`);if(!mc(u,["string","array"]))throw new eo(`Expected second argument to be of type array or string, but found ${tr(xi(u))} instead.`);return u.indexOf(l)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class kl{constructor(i,l,u){this.type=bt,this.needle=i,this.haystack=l,this.fromIndex=u}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const u=l.parse(i[1],1,Cn),f=l.parse(i[2],2,Cn);if(!u||!f)return null;if(!pc(u.type,[Xt,wn,bt,Ka,Cn]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${tr(u.type)} instead`);if(4===i.length){const x=l.parse(i[3],3,bt);return x?new kl(u,f,x):null}return new kl(u,f)}evaluate(i){const l=this.needle.evaluate(i),u=this.haystack.evaluate(i);if(!mc(l,["boolean","string","number","null"]))throw new eo(`Expected first argument to be of type boolean, string, number or null, but found ${tr(xi(l))} instead.`);if(!mc(u,["string","array"]))throw new eo(`Expected second argument to be of type array or string, but found ${tr(xi(u))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(i);return u.indexOf(l,f)}return u.indexOf(l)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Sa{constructor(i,l,u,f,x,b){this.inputType=i,this.type=l,this.input=u,this.cases=f,this.outputs=x,this.otherwise=b}static parse(i,l){if(i.length<5)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return l.error("Expected an even number of arguments.");let u,f;l.expectedType&&"value"!==l.expectedType.kind&&(f=l.expectedType);const x={},b=[];for(let F=2;F<i.length-1;F+=2){let N=i[F];const U=i[F+1];Array.isArray(N)||(N=[N]);const j=l.concat(F);if(0===N.length)return j.error("Expected at least one branch label.");for(const re of N){if("number"!=typeof re&&"string"!=typeof re)return j.error("Branch labels must be numbers or strings.");if("number"==typeof re&&Math.abs(re)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof re&&Math.floor(re)!==re)return j.error("Numeric branch labels must be integer values.");if(u){if(j.checkSubtype(u,xi(re)))return null}else u=xi(re);if(void 0!==x[String(re)])return j.error("Branch labels must be unique.");x[String(re)]=b.length}const q=l.parse(U,F,f);if(!q)return null;f=f||q.type,b.push(q)}const S=l.parse(i[1],1,Cn);if(!S)return null;const P=l.parse(i[i.length-1],i.length-1,f);return P?"value"!==S.type.kind&&l.concat(1).checkSubtype(u,S.type)?null:new Sa(u,f,S,x,b,P):null}evaluate(i){const l=this.input.evaluate(i);return(xi(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),u=[],f={};for(const b of l){const S=f[this.cases[b]];void 0===S?(f[this.cases[b]]=u.length,u.push([this.cases[b],[b]])):u[S][1].push(b)}const x=b=>"number"===this.inputType.kind?Number(b):b;for(const[b,S]of u)i.push(1===S.length?x(S[0]):S.map(x)),i.push(this.outputs[b].serialize());return i.push(this.otherwise.serialize()),i}}class wi{constructor(i,l,u){this.type=i,this.branches=l,this.otherwise=u}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return l.error("Expected an odd number of arguments.");let u;l.expectedType&&"value"!==l.expectedType.kind&&(u=l.expectedType);const f=[];for(let b=1;b<i.length-1;b+=2){const S=l.parse(i[b],b,Xt);if(!S)return null;const P=l.parse(i[b+1],b+1,u);if(!P)return null;f.push([S,P]),u=u||P.type}const x=l.parse(i[i.length-1],i.length-1,u);return x?new wi(u,f,x):null}evaluate(i){for(const[l,u]of this.branches)if(l.evaluate(i))return u.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[l,u]of this.branches)i(l),i(u);i(this.otherwise)}outputDefined(){return this.branches.every(([i,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(l=>{i.push(l.serialize())}),i}}class Tu{constructor(i,l,u,f){this.type=i,this.input=l,this.beginIndex=u,this.endIndex=f}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const u=l.parse(i[1],1,Cn),f=l.parse(i[2],2,bt);if(!u||!f)return null;if(!pc(u.type,[gr(Cn),wn,Cn]))return l.error(`Expected first argument to be of type array or string, but found ${tr(u.type)} instead`);if(4===i.length){const x=l.parse(i[3],3,bt);return x?new Tu(u.type,u,f,x):null}return new Tu(u.type,u,f)}evaluate(i){const l=this.input.evaluate(i),u=this.beginIndex.evaluate(i);if(!mc(l,["string","array"]))throw new eo(`Expected first argument to be of type array or string, but found ${tr(xi(l))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(i);return l.slice(u,f)}return l.slice(u)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function ws(a,i){return"=="===a||"!="===a?"boolean"===i.kind||"string"===i.kind||"number"===i.kind||"null"===i.kind||"value"===i.kind:"string"===i.kind||"number"===i.kind||"value"===i.kind}function Vo(a,i,l,u){return 0===u.compare(i,l)}function el(a,i,l){const u="=="!==a&&"!="!==a;return class tP{constructor(x,b,S){this.type=Xt,this.lhs=x,this.rhs=b,this.collator=S,this.hasUntypedArgument="value"===x.type.kind||"value"===b.type.kind}static parse(x,b){if(3!==x.length&&4!==x.length)return b.error("Expected two or three arguments.");const S=x[0];let P=b.parse(x[1],1,Cn);if(!P)return null;if(!ws(S,P.type))return b.concat(1).error(`"${S}" comparisons are not supported for type '${tr(P.type)}'.`);let F=b.parse(x[2],2,Cn);if(!F)return null;if(!ws(S,F.type))return b.concat(2).error(`"${S}" comparisons are not supported for type '${tr(F.type)}'.`);if(P.type.kind!==F.type.kind&&"value"!==P.type.kind&&"value"!==F.type.kind)return b.error(`Cannot compare types '${tr(P.type)}' and '${tr(F.type)}'.`);u&&("value"===P.type.kind&&"value"!==F.type.kind?P=new _r(F.type,[P]):"value"!==P.type.kind&&"value"===F.type.kind&&(F=new _r(P.type,[F])));let N=null;if(4===x.length){if("string"!==P.type.kind&&"string"!==F.type.kind&&"value"!==P.type.kind&&"value"!==F.type.kind)return b.error("Cannot use collator to compare non-string types.");if(N=b.parse(x[3],3,Md),!N)return null}return new tP(P,F,N)}evaluate(x){const b=this.lhs.evaluate(x),S=this.rhs.evaluate(x);if(u&&this.hasUntypedArgument){const P=xi(b),F=xi(S);if(P.kind!==F.kind||"string"!==P.kind&&"number"!==P.kind)throw new eo(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${P.kind}, ${F.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const P=xi(b),F=xi(S);if("string"!==P.kind||"string"!==F.kind)return i(x,b,S)}return this.collator?l(x,b,S,this.collator.evaluate(x)):i(x,b,S)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}serialize(){const x=[a];return this.eachChild(b=>{x.push(b.serialize())}),x}}}const Th=el("==",function(a,i,l){return i===l},Vo),Iu=el("!=",function(a,i,l){return i!==l},function(a,i,l,u){return!Vo(0,i,l,u)}),ns=el("<",function(a,i,l){return i<l},function(a,i,l,u){return u.compare(i,l)<0}),cm=el(">",function(a,i,l){return i>l},function(a,i,l,u){return u.compare(i,l)>0}),E0=el("<=",function(a,i,l){return i<=l},function(a,i,l,u){return u.compare(i,l)<=0}),um=el(">=",function(a,i,l){return i>=l},function(a,i,l,u){return u.compare(i,l)>=0});class Rd{constructor(i,l,u,f,x){this.type=wn,this.number=i,this.locale=l,this.currency=u,this.minFractionDigits=f,this.maxFractionDigits=x}static parse(i,l){if(3!==i.length)return l.error("Expected two arguments.");const u=l.parse(i[1],1,bt);if(!u)return null;const f=i[2];if("object"!=typeof f||Array.isArray(f))return l.error("NumberFormat options argument must be an object.");let x=null;if(f.locale&&(x=l.parse(f.locale,1,wn),!x))return null;let b=null;if(f.currency&&(b=l.parse(f.currency,1,wn),!b))return null;let S=null;if(f["min-fraction-digits"]&&(S=l.parse(f["min-fraction-digits"],1,bt),!S))return null;let P=null;return f["max-fraction-digits"]&&(P=l.parse(f["max-fraction-digits"],1,bt),!P)?null:new Rd(u,x,b,S,P)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class ku{constructor(i){this.type=bt,this.input=i}static parse(i,l){if(2!==i.length)return l.error(`Expected 1 argument, but found ${i.length-1} instead.`);const u=l.parse(i[1],1);return u?"array"!==u.type.kind&&"string"!==u.type.kind&&"value"!==u.type.kind?l.error(`Expected argument of type string or array, but found ${tr(u.type)} instead.`):new ku(u):null}evaluate(i){const l=this.input.evaluate(i);if("string"==typeof l||Array.isArray(l))return l.length;throw new eo(`Expected value to be of type string or array, but found ${tr(xi(l))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(l=>{i.push(l.serialize())}),i}}const vc={"==":Th,"!=":Iu,">":cm,"<":ns,">=":um,"<=":E0,array:_r,at:yc,boolean:_r,case:wi,coalesce:Sh,collator:Ko,format:Eu,image:Ch,in:Il,"index-of":kl,interpolate:Ln,"interpolate-hcl":Ln,"interpolate-lab":Ln,length:ku,let:Tl,literal:pi,match:Sa,number:_r,"number-format":Rd,object:_r,slice:Tu,step:$i,string:_r,"to-boolean":Ml,"to-color":Ml,"to-number":Ml,"to-string":Ml,var:mn,within:es};function uf(a,[i,l,u,f]){i=i.evaluate(a),l=l.evaluate(a),u=u.evaluate(a);const x=f?f.evaluate(a):1,b=wa(i,l,u,x);if(b)throw new eo(b);return new dn(i/255*x,l/255*x,u/255*x,x)}function hm(a,i){return a in i}function hf(a,i){const l=i[a];return void 0===l?null:l}function xc(a){return{type:a}}function df(a){return{result:"success",value:a}}function bc(a){return{result:"error",value:a}}function wc(a){return"data-driven"===a["property-type"]||"cross-faded-data-driven"===a["property-type"]}function Fd(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Af(a){return!!a.expression&&a.expression.interpolated}function or(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function Od(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function D0(a){return a}function Ld(a,i){const l="color"===i.type,u=a.stops&&"object"==typeof a.stops[0][0],f=u||!(u||void 0!==a.property),x=a.type||(Af(i)?"exponential":"interval");if(l&&((a=_n({},a)).stops&&(a.stops=a.stops.map(F=>[F[0],dn.parse(F[1])])),a.default=dn.parse(a.default?a.default:i.default)),a.colorSpace&&"rgb"!==a.colorSpace&&!ts[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let b,S,P;if("exponential"===x)b=Ih;else if("interval"===x)b=Am;else if("categorical"===x){b=dm,S=Object.create(null);for(const F of a.stops)S[F[0]]=F[1];P=typeof a.stops[0][0]}else{if("identity"!==x)throw new Error(`Unknown function type "${x}"`);b=Rl}if(u){const F={},N=[];for(let q=0;q<a.stops.length;q++){const re=a.stops[q],oe=re[0].zoom;void 0===F[oe]&&(F[oe]={zoom:oe,type:a.type,property:a.property,default:a.default,stops:[]},N.push(oe)),F[oe].stops.push([re[0].value,re[1]])}const U=[];for(const q of N)U.push([F[q].zoom,Ld(F[q],i)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:Ln.interpolationFactor.bind(void 0,j),zoomStops:U.map(q=>q[0]),evaluate:({zoom:q},re)=>Ih({stops:U,base:a.base},i,q).evaluate(q,re)}}if(f){const F="exponential"===x?{name:"exponential",base:void 0!==a.base?a.base:1}:null;return{kind:"camera",interpolationType:F,interpolationFactor:Ln.interpolationFactor.bind(void 0,F),zoomStops:a.stops.map(N=>N[0]),evaluate:({zoom:N})=>b(a,i,N,S,P)}}return{kind:"source",evaluate(F,N){const U=N&&N.properties?N.properties[a.property]:void 0;return void 0===U?Pl(a.default,i.default):b(a,i,U,S,P)}}}function Pl(a,i,l){return void 0!==a?a:void 0!==i?i:void 0!==l?l:void 0}function dm(a,i,l,u,f){return Pl(typeof l===f?u[l]:void 0,a.default,i.default)}function Am(a,i,l){if("number"!==or(l))return Pl(a.default,i.default);const u=a.stops.length;if(1===u||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[u-1][0])return a.stops[u-1][1];const f=Mh(a.stops.map(x=>x[0]),l);return a.stops[f][1]}function Ih(a,i,l){const u=void 0!==a.base?a.base:1;if("number"!==or(l))return Pl(a.default,i.default);const f=a.stops.length;if(1===f||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[f-1][0])return a.stops[f-1][1];const x=Mh(a.stops.map(N=>N[0]),l),b=function(N,U,j,q){const re=q-j,oe=N-j;return 0===re?0:1===U?oe/re:(Math.pow(U,oe)-1)/(Math.pow(U,re)-1)}(l,u,a.stops[x][0],a.stops[x+1][0]),S=a.stops[x][1],P=a.stops[x+1][1];let F=En[i.type]||D0;if(a.colorSpace&&"rgb"!==a.colorSpace){const N=ts[a.colorSpace];F=(U,j)=>N.reverse(N.interpolate(N.forward(U),N.forward(j),b))}return"function"==typeof S.evaluate?{evaluate(...N){const U=S.evaluate.apply(void 0,N),j=P.evaluate.apply(void 0,N);if(void 0!==U&&void 0!==j)return F(U,j,b)}}:F(S,P,b)}function Rl(a,i,l){return"color"===i.type?l=dn.parse(l):"formatted"===i.type?l=fi.fromString(l.toString()):"resolvedImage"===i.type?l=Bo.fromString(l.toString()):or(l)===i.type||"enum"===i.type&&i.values[l]||(l=void 0),Pl(l,a.default,i.default)}Yo.register(vc,{error:[{kind:"error"},[wn],(a,[i])=>{throw new eo(i.evaluate(a))}],typeof:[wn,[Cn],(a,[i])=>tr(xi(i.evaluate(a)))],"to-rgba":[gr(bt,4),[Wn],(a,[i])=>i.evaluate(a).toArray()],rgb:[Wn,[bt,bt,bt],uf],rgba:[Wn,[bt,bt,bt,bt],uf],has:{type:Xt,overloads:[[[wn],(a,[i])=>hm(i.evaluate(a),a.properties())],[[wn,Ji],(a,[i,l])=>hm(i.evaluate(a),l.evaluate(a))]]},get:{type:Cn,overloads:[[[wn],(a,[i])=>hf(i.evaluate(a),a.properties())],[[wn,Ji],(a,[i,l])=>hf(i.evaluate(a),l.evaluate(a))]]},"feature-state":[Cn,[wn],(a,[i])=>hf(i.evaluate(a),a.featureState||{})],properties:[Ji,[],a=>a.properties()],"geometry-type":[wn,[],a=>a.geometryType()],id:[Cn,[],a=>a.id()],zoom:[bt,[],a=>a.globals.zoom],"heatmap-density":[bt,[],a=>a.globals.heatmapDensity||0],"line-progress":[bt,[],a=>a.globals.lineProgress||0],"sky-radial-progress":[bt,[],a=>a.globals.skyRadialProgress||0],accumulated:[Cn,[],a=>void 0===a.globals.accumulated?null:a.globals.accumulated],"+":[bt,xc(bt),(a,i)=>{let l=0;for(const u of i)l+=u.evaluate(a);return l}],"*":[bt,xc(bt),(a,i)=>{let l=1;for(const u of i)l*=u.evaluate(a);return l}],"-":{type:bt,overloads:[[[bt,bt],(a,[i,l])=>i.evaluate(a)-l.evaluate(a)],[[bt],(a,[i])=>-i.evaluate(a)]]},"/":[bt,[bt,bt],(a,[i,l])=>i.evaluate(a)/l.evaluate(a)],"%":[bt,[bt,bt],(a,[i,l])=>i.evaluate(a)%l.evaluate(a)],ln2:[bt,[],()=>Math.LN2],pi:[bt,[],()=>Math.PI],e:[bt,[],()=>Math.E],"^":[bt,[bt,bt],(a,[i,l])=>Math.pow(i.evaluate(a),l.evaluate(a))],sqrt:[bt,[bt],(a,[i])=>Math.sqrt(i.evaluate(a))],log10:[bt,[bt],(a,[i])=>Math.log(i.evaluate(a))/Math.LN10],ln:[bt,[bt],(a,[i])=>Math.log(i.evaluate(a))],log2:[bt,[bt],(a,[i])=>Math.log(i.evaluate(a))/Math.LN2],sin:[bt,[bt],(a,[i])=>Math.sin(i.evaluate(a))],cos:[bt,[bt],(a,[i])=>Math.cos(i.evaluate(a))],tan:[bt,[bt],(a,[i])=>Math.tan(i.evaluate(a))],asin:[bt,[bt],(a,[i])=>Math.asin(i.evaluate(a))],acos:[bt,[bt],(a,[i])=>Math.acos(i.evaluate(a))],atan:[bt,[bt],(a,[i])=>Math.atan(i.evaluate(a))],min:[bt,xc(bt),(a,i)=>Math.min(...i.map(l=>l.evaluate(a)))],max:[bt,xc(bt),(a,i)=>Math.max(...i.map(l=>l.evaluate(a)))],abs:[bt,[bt],(a,[i])=>Math.abs(i.evaluate(a))],round:[bt,[bt],(a,[i])=>{const l=i.evaluate(a);return l<0?-Math.round(-l):Math.round(l)}],floor:[bt,[bt],(a,[i])=>Math.floor(i.evaluate(a))],ceil:[bt,[bt],(a,[i])=>Math.ceil(i.evaluate(a))],"filter-==":[Xt,[wn,Cn],(a,[i,l])=>a.properties()[i.value]===l.value],"filter-id-==":[Xt,[Cn],(a,[i])=>a.id()===i.value],"filter-type-==":[Xt,[wn],(a,[i])=>a.geometryType()===i.value],"filter-<":[Xt,[wn,Cn],(a,[i,l])=>{const u=a.properties()[i.value],f=l.value;return typeof u==typeof f&&u<f}],"filter-id-<":[Xt,[Cn],(a,[i])=>{const l=a.id(),u=i.value;return typeof l==typeof u&&l<u}],"filter->":[Xt,[wn,Cn],(a,[i,l])=>{const u=a.properties()[i.value],f=l.value;return typeof u==typeof f&&u>f}],"filter-id->":[Xt,[Cn],(a,[i])=>{const l=a.id(),u=i.value;return typeof l==typeof u&&l>u}],"filter-<=":[Xt,[wn,Cn],(a,[i,l])=>{const u=a.properties()[i.value],f=l.value;return typeof u==typeof f&&u<=f}],"filter-id-<=":[Xt,[Cn],(a,[i])=>{const l=a.id(),u=i.value;return typeof l==typeof u&&l<=u}],"filter->=":[Xt,[wn,Cn],(a,[i,l])=>{const u=a.properties()[i.value],f=l.value;return typeof u==typeof f&&u>=f}],"filter-id->=":[Xt,[Cn],(a,[i])=>{const l=a.id(),u=i.value;return typeof l==typeof u&&l>=u}],"filter-has":[Xt,[Cn],(a,[i])=>i.value in a.properties()],"filter-has-id":[Xt,[],a=>null!==a.id()&&void 0!==a.id()],"filter-type-in":[Xt,[gr(wn)],(a,[i])=>i.value.indexOf(a.geometryType())>=0],"filter-id-in":[Xt,[gr(Cn)],(a,[i])=>i.value.indexOf(a.id())>=0],"filter-in-small":[Xt,[wn,gr(Cn)],(a,[i,l])=>l.value.indexOf(a.properties()[i.value])>=0],"filter-in-large":[Xt,[wn,gr(Cn)],(a,[i,l])=>function(u,f,x,b){for(;x<=b;){const S=x+b>>1;if(f[S]===u)return!0;f[S]>u?b=S-1:x=S+1}return!1}(a.properties()[i.value],l.value,0,l.value.length-1)],all:{type:Xt,overloads:[[[Xt,Xt],(a,[i,l])=>i.evaluate(a)&&l.evaluate(a)],[xc(Xt),(a,i)=>{for(const l of i)if(!l.evaluate(a))return!1;return!0}]]},any:{type:Xt,overloads:[[[Xt,Xt],(a,[i,l])=>i.evaluate(a)||l.evaluate(a)],[xc(Xt),(a,i)=>{for(const l of i)if(l.evaluate(a))return!0;return!1}]]},"!":[Xt,[Xt],(a,[i])=>!i.evaluate(a)],"is-supported-script":[Xt,[wn],(a,[i])=>{const l=a.globals&&a.globals.isSupportedScript;return!l||l(i.evaluate(a))}],upcase:[wn,[wn],(a,[i])=>i.evaluate(a).toUpperCase()],downcase:[wn,[wn],(a,[i])=>i.evaluate(a).toLowerCase()],concat:[wn,xc(Cn),(a,i)=>i.map(l=>No(l.evaluate(a))).join("")],"resolved-locale":[wn,[Md],(a,[i])=>i.evaluate(a).resolvedLocale()]});class kh{constructor(i,l){var u;this.expression=i,this._warningHistory={},this._evaluator=new sm,this._defaultValue=l?"color"===(u=l).type&&Od(u.default)?new dn(0,0,0,0):"color"===u.type?dn.parse(u.default)||null:void 0===u.default?null:u.default:null,this._enumValues=l&&"enum"===l.type?l.values:null}evaluateWithoutErrorHandling(i,l,u,f,x,b){return this._evaluator.globals=i,this._evaluator.feature=l,this._evaluator.featureState=u,this._evaluator.canonical=f,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)}evaluate(i,l,u,f,x,b){this._evaluator.globals=i,this._evaluator.feature=l||null,this._evaluator.featureState=u||null,this._evaluator.canonical=f,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=b||null;try{const S=this.expression.evaluate(this._evaluator);if(null==S||"number"==typeof S&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new eo(`Expected value to be one of ${Object.keys(this._enumValues).map(P=>JSON.stringify(P)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,"undefined"!=typeof console&&console.warn(S.message)),this._defaultValue}}}function Sr(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in vc}function rs(a,i){const l=new Qs(vc,[],i?function(f){const x={color:Wn,string:wn,number:bt,enum:wn,boolean:Xt,formatted:Wt,resolvedImage:xu};return"array"===f.type?gr(x[f.value]||Cn,f.length):x[f.type]}(i):void 0),u=l.parse(a,void 0,void 0,void 0,i&&"string"===i.type?{typeAnnotation:"coerce"}:void 0);return u?df(new kh(u,i)):bc(l.errors)}class Ph{constructor(i,l){this.kind=i,this._styleExpression=l,this.isStateDependent="constant"!==i&&!bi(l.expression)}evaluateWithoutErrorHandling(i,l,u,f,x,b){return this._styleExpression.evaluateWithoutErrorHandling(i,l,u,f,x,b)}evaluate(i,l,u,f,x,b){return this._styleExpression.evaluate(i,l,u,f,x,b)}}class tl{constructor(i,l,u,f){this.kind=i,this.zoomStops=u,this._styleExpression=l,this.isStateDependent="camera"!==i&&!bi(l.expression),this.interpolationType=f}evaluateWithoutErrorHandling(i,l,u,f,x,b){return this._styleExpression.evaluateWithoutErrorHandling(i,l,u,f,x,b)}evaluate(i,l,u,f,x,b){return this._styleExpression.evaluate(i,l,u,f,x,b)}interpolationFactor(i,l,u){return this.interpolationType?Ln.interpolationFactor(this.interpolationType,i,l,u):0}}function Rh(a,i){if("error"===(a=rs(a,i)).result)return a;const l=a.value.expression,u=Kt(l);if(!u&&!wc(i))return bc([new Vn("","data expressions not supported")]);const f=Fi(l,["zoom"]);if(!f&&!Fd(i))return bc([new Vn("","zoom expressions not supported")]);const x=Cc(l);return x||f?x instanceof Vn?bc([x]):x instanceof Ln&&!Af(i)?bc([new Vn("",'"interpolate" expressions cannot be used with this property')]):df(x?new tl(u?"camera":"composite",a.value,x.labels,x instanceof Ln?x.interpolation:void 0):new Ph(u?"constant":"source",a.value)):bc([new Vn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Pu{constructor(i,l){this._parameters=i,this._specification=l,_n(this,Ld(this._parameters,this._specification))}static deserialize(i){return new Pu(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function Cc(a){let i=null;if(a instanceof Tl)i=Cc(a.result);else if(a instanceof Sh){for(const l of a.args)if(i=Cc(l),i)break}else(a instanceof $i||a instanceof Ln)&&a.input instanceof Yo&&"zoom"===a.input.name&&(i=a);return i instanceof Vn||a.eachChild(l=>{const u=Cc(l);u instanceof Vn?i=u:!i&&u?i=new Vn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&u&&i!==u&&(i=new Vn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function Hi(a){const i=a.key,l=a.value,u=a.valueSpec||{},f=a.objectElementValidators||{},x=a.style,b=a.styleSpec;let S=[];const P=or(l);if("object"!==P)return[new $e(i,l,`object expected, ${P} found`)];for(const F in l){const N=F.split(".")[0],U=u[N]||u["*"];let j;if(f[N])j=f[N];else if(u[N])j=ko;else if(f["*"])j=f["*"];else{if(!u["*"]){S.push(new $e(i,l[F],`unknown property "${F}"`));continue}j=ko}S=S.concat(j({key:(i&&`${i}.`)+F,value:l[F],valueSpec:U,style:x,styleSpec:b,object:l,objectKey:F},l))}for(const F in u)f[F]||u[F].required&&void 0===u[F].default&&void 0===l[F]&&S.push(new $e(i,l,`missing required property "${F}"`));return S}function Bd(a){const i=a.value,l=a.valueSpec,u=a.style,f=a.styleSpec,x=a.key,b=a.arrayElementValidator||ko;if("array"!==or(i))return[new $e(x,i,`array expected, ${or(i)} found`)];if(l.length&&i.length!==l.length)return[new $e(x,i,`array length ${l.length} expected, length ${i.length} found`)];if(l["min-length"]&&i.length<l["min-length"])return[new $e(x,i,`array length at least ${l["min-length"]} expected, length ${i.length} found`)];let S={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum};f.$version<7&&(S.function=l.function),"object"===or(l.value)&&(S=l.value);let P=[];for(let F=0;F<i.length;F++)P=P.concat(b({array:i,arrayIndex:F,value:i[F],valueSpec:S,style:u,styleSpec:f,key:`${x}[${F}]`}));return P}function _o(a){const i=a.key,l=a.value,u=a.valueSpec;let f=or(l);if("number"===f&&l!=l&&(f="NaN"),"number"!==f)return[new $e(i,l,`number expected, ${f} found`)];if("minimum"in u){let x=u.minimum;if("array"===or(u.minimum)&&(x=u.minimum[a.arrayIndex]),l<x)return[new $e(i,l,`${l} is less than the minimum value ${x}`)]}if("maximum"in u){let x=u.maximum;if("array"===or(u.maximum)&&(x=u.maximum[a.arrayIndex]),l>x)return[new $e(i,l,`${l} is greater than the maximum value ${x}`)]}return[]}function Fh(a){const i=a.valueSpec,l=an(a.value.type);let u,f,x,b={};const S="categorical"!==l&&void 0===a.value.property,P=!S,F="array"===or(a.value.stops)&&"array"===or(a.value.stops[0])&&"object"===or(a.value.stops[0][0]),N=Hi({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(q){if("identity"===l)return[new $e(q.key,q.value,'identity function may not have a "stops" property')];let re=[];const oe=q.value;return re=re.concat(Bd({key:q.key,value:oe,valueSpec:q.valueSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:U})),"array"===or(oe)&&0===oe.length&&re.push(new $e(q.key,oe,"array must have at least one stop")),re},default:function(q){return ko({key:q.key,value:q.value,valueSpec:i,style:q.style,styleSpec:q.styleSpec})}}});return"identity"===l&&S&&N.push(new $e(a.key,a.value,'missing required property "property"')),"identity"===l||a.value.stops||N.push(new $e(a.key,a.value,'missing required property "stops"')),"exponential"===l&&a.valueSpec.expression&&!Af(a.valueSpec)&&N.push(new $e(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(P&&!wc(a.valueSpec)?N.push(new $e(a.key,a.value,"property functions not supported")):S&&!Fd(a.valueSpec)&&N.push(new $e(a.key,a.value,"zoom functions not supported"))),"categorical"!==l&&!F||void 0!==a.value.property||N.push(new $e(a.key,a.value,'"property" property is required')),N;function U(q){let re=[];const oe=q.value,Ae=q.key;if("array"!==or(oe))return[new $e(Ae,oe,`array expected, ${or(oe)} found`)];if(2!==oe.length)return[new $e(Ae,oe,`array length 2 expected, length ${oe.length} found`)];if(F){if("object"!==or(oe[0]))return[new $e(Ae,oe,`object expected, ${or(oe[0])} found`)];if(void 0===oe[0].zoom)return[new $e(Ae,oe,"object stop key must have zoom")];if(void 0===oe[0].value)return[new $e(Ae,oe,"object stop key must have value")];if(x&&x>an(oe[0].zoom))return[new $e(Ae,oe[0].zoom,"stop zoom values must appear in ascending order")];an(oe[0].zoom)!==x&&(x=an(oe[0].zoom),f=void 0,b={}),re=re.concat(Hi({key:`${Ae}[0]`,value:oe[0],valueSpec:{zoom:{}},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:_o,value:j}}))}else re=re.concat(j({key:`${Ae}[0]`,value:oe[0],valueSpec:{},style:q.style,styleSpec:q.styleSpec},oe));return Sr(er(oe[1]))?re.concat([new $e(`${Ae}[1]`,oe[1],"expressions are not allowed in function stops.")]):re.concat(ko({key:`${Ae}[1]`,value:oe[1],valueSpec:i,style:q.style,styleSpec:q.styleSpec}))}function j(q,re){const oe=or(q.value),Ae=an(q.value),xe=null!==q.value?q.value:re;if(u){if(oe!==u)return[new $e(q.key,xe,`${oe} stop domain type must match previous stop domain type ${u}`)]}else u=oe;if("number"!==oe&&"string"!==oe&&"boolean"!==oe)return[new $e(q.key,xe,"stop domain value must be a number, string, or boolean")];if("number"!==oe&&"categorical"!==l){let Se=`number expected, ${oe} found`;return wc(i)&&void 0===l&&(Se+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $e(q.key,xe,Se)]}return"categorical"!==l||"number"!==oe||isFinite(Ae)&&Math.floor(Ae)===Ae?"categorical"!==l&&"number"===oe&&void 0!==f&&Ae<f?[new $e(q.key,xe,"stop domain values must appear in ascending order")]:(f=Ae,"categorical"===l&&Ae in b?[new $e(q.key,xe,"stop domain values must be unique")]:(b[Ae]=!0,[])):[new $e(q.key,xe,`integer expected, found ${Ae}`)]}}function Ta(a){const i=("property"===a.expressionContext?Rh:rs)(er(a.value),a.valueSpec);if("error"===i.result)return i.value.map(u=>new $e(`${a.key}${u.key}`,a.value,u.message));const l=i.value.expression||i.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&!l.outputDefined())return[new $e(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===a.expressionContext&&"layout"===a.propertyType&&!bi(l))return[new $e(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext&&!bi(l))return[new $e(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!Fi(l,["zoom","feature-state"]))return[new $e(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!Kt(l))return[new $e(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function nl(a){const i=a.key,l=a.value,u=a.valueSpec,f=[];return Array.isArray(u.values)?-1===u.values.indexOf(an(l))&&f.push(new $e(i,l,`expected one of [${u.values.join(", ")}], ${JSON.stringify(l)} found`)):-1===Object.keys(u.values).indexOf(an(l))&&f.push(new $e(i,l,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(l)} found`)),f}function Oh(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":return a.length>=3&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const i of a.slice(1))if(!Oh(i)&&"boolean"!=typeof i)return!1;return!0;default:return!0}}const Ru={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Fu(a){if(null==a)return{filter:()=>!0,needGeometry:!1};Oh(a)||(a=rl(a));const i=rs(a,Ru);if("error"===i.result)throw new Error(i.value.map(l=>`${l.key}: ${l.message}`).join(", "));return{filter:(l,u,f)=>i.value.evaluate(l,u,{},f),needGeometry:fm(a)}}function Qr(a,i){return a<i?-1:a>i?1:0}function fm(a){if(!Array.isArray(a))return!1;if("within"===a[0])return!0;for(let i=1;i<a.length;i++)if(fm(a[i]))return!0;return!1}function rl(a){if(!a)return!0;const i=a[0];return a.length<=1?"any"!==i:"=="===i?Nd(a[1],a[2],"=="):"!="===i?zd(Nd(a[1],a[2],"==")):"<"===i||">"===i||"<="===i||">="===i?Nd(a[1],a[2],i):"any"===i?(l=a.slice(1),["any"].concat(l.map(rl))):"all"===i?["all"].concat(a.slice(1).map(rl)):"none"===i?["all"].concat(a.slice(1).map(rl).map(zd)):"in"===i?ai(a[1],a.slice(2)):"!in"===i?zd(ai(a[1],a.slice(2))):"has"===i?ff(a[1]):"!has"===i?zd(ff(a[1])):"within"!==i||a;var l}function Nd(a,i,l){switch(a){case"$type":return[`filter-type-${l}`,i];case"$id":return[`filter-id-${l}`,i];default:return[`filter-${l}`,a,i]}}function ai(a,i){if(0===i.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(l=>typeof l!=typeof i[0])?["filter-in-large",a,["literal",i.sort(Qr)]]:["filter-in-small",a,["literal",i]]}}function ff(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function zd(a){return["!",a]}function Ec(a){return Oh(er(a.value))?Ta(_n({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):no(a)}function no(a){const i=a.value,l=a.key;if("array"!==or(i))return[new $e(l,i,`array expected, ${or(i)} found`)];const u=a.styleSpec;let f,x=[];if(i.length<1)return[new $e(l,i,"filter array must have at least 1 element")];switch(x=x.concat(nl({key:`${l}[0]`,value:i[0],valueSpec:u.filter_operator,style:a.style,styleSpec:a.styleSpec})),an(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&"$type"===an(i[1])&&x.push(new $e(l,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":3!==i.length&&x.push(new $e(l,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(f=or(i[1]),"string"!==f&&x.push(new $e(`${l}[1]`,i[1],`string expected, ${f} found`)));for(let b=2;b<i.length;b++)f=or(i[b]),"$type"===an(i[1])?x=x.concat(nl({key:`${l}[${b}]`,value:i[b],valueSpec:u.geometry_type,style:a.style,styleSpec:a.styleSpec})):"string"!==f&&"number"!==f&&"boolean"!==f&&x.push(new $e(`${l}[${b}]`,i[b],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let b=1;b<i.length;b++)x=x.concat(no({key:`${l}[${b}]`,value:i[b],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":f=or(i[1]),2!==i.length?x.push(new $e(l,i,`filter array for "${i[0]}" operator must have 2 elements`)):"string"!==f&&x.push(new $e(`${l}[1]`,i[1],`string expected, ${f} found`));break;case"within":f=or(i[1]),2!==i.length?x.push(new $e(l,i,`filter array for "${i[0]}" operator must have 2 elements`)):"object"!==f&&x.push(new $e(`${l}[1]`,i[1],`object expected, ${f} found`))}return x}function Ou(a,i){const l=a.key,u=a.style,f=a.styleSpec,x=a.value,b=a.objectKey,S=f[`${i}_${a.layerType}`];if(!S)return[];const P=b.match(/^(.*)-transition$/);if("paint"===i&&P&&S[P[1]]&&S[P[1]].transition)return ko({key:l,value:x,valueSpec:f.transition,style:u,styleSpec:f});const F=a.valueSpec||S[b];if(!F)return[new $e(l,x,`unknown property "${b}"`)];let N;if("string"===or(x)&&wc(F)&&!F.tokens&&(N=/^{([^}]+)}$/.exec(x)))return[new $e(l,x,`"${b}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(N[1])} }\`.`)];const U=[];return"symbol"===a.layerType&&("text-field"===b&&u&&!u.glyphs&&U.push(new $e(l,x,'use of "text-field" requires a style "glyphs" property')),"text-font"===b&&Od(er(x))&&"identity"===an(x.type)&&U.push(new $e(l,x,'"text-font" does not support identity functions'))),U.concat(ko({key:a.key,value:x,valueSpec:F,style:u,styleSpec:f,expressionContext:"property",propertyType:i,propertyKey:b}))}function ro(a){return Ou(a,"paint")}function Ks(a){return Ou(a,"layout")}function Io(a){let i=[];const l=a.value,u=a.key,f=a.style,x=a.styleSpec;l.type||l.ref||i.push(new $e(u,l,'either "type" or "ref" is required'));let b=an(l.type);const S=an(l.ref);if(l.id){const P=an(l.id);for(let F=0;F<a.arrayIndex;F++){const N=f.layers[F];an(N.id)===P&&i.push(new $e(u,l.id,`duplicate layer id "${l.id}", previously used at line ${N.id.__line__}`))}}if("ref"in l){let P;["type","source","source-layer","filter","layout"].forEach(F=>{F in l&&i.push(new $e(u,l[F],`"${F}" is prohibited for ref layers`))}),f.layers.forEach(F=>{an(F.id)===S&&(P=F)}),P?P.ref?i.push(new $e(u,l.ref,"ref cannot reference another ref layer")):b=an(P.type):i.push(new $e(u,l.ref,`ref layer "${S}" not found`))}else if("background"!==b&&"sky"!==b)if(l.source){const P=f.sources&&f.sources[l.source],F=P&&an(P.type);P?"vector"===F&&"raster"===b?i.push(new $e(u,l.source,`layer "${l.id}" requires a raster source`)):"raster"===F&&"raster"!==b?i.push(new $e(u,l.source,`layer "${l.id}" requires a vector source`)):"vector"!==F||l["source-layer"]?"raster-dem"===F&&"hillshade"!==b?i.push(new $e(u,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==b||!l.paint||!l.paint["line-gradient"]||"geojson"===F&&P.lineMetrics||i.push(new $e(u,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new $e(u,l,`layer "${l.id}" must specify a "source-layer"`)):i.push(new $e(u,l.source,`source "${l.source}" not found`))}else i.push(new $e(u,l,'missing required property "source"'));return i=i.concat(Hi({key:u,value:l,valueSpec:x.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ko({key:`${u}.type`,value:l.type,valueSpec:x.layer.type,style:a.style,styleSpec:a.styleSpec,object:l,objectKey:"type"}),filter:Ec,layout:P=>Hi({layer:l,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":F=>Ks(_n({layerType:b},F))}}),paint:P=>Hi({layer:l,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":F=>ro(_n({layerType:b},F))}})}})),i}function Fl(a){const i=a.value,l=a.key,u=or(i);return"string"!==u?[new $e(l,i,`string expected, ${u} found`)]:[]}const Lh={promoteId:function({key:a,value:i}){if("string"===or(i))return Fl({key:a,value:i});{const l=[];for(const u in i)l.push(...Fl({key:`${a}.${u}`,value:i[u]}));return l}}};function pf(a){const i=a.value,l=a.key,u=a.styleSpec,f=a.style;if(!i.type)return[new $e(l,i,'"type" is required')];const x=an(i.type);let b;switch(x){case"vector":case"raster":case"raster-dem":return b=Hi({key:l,value:i,valueSpec:u[`source_${x.replace("-","_")}`],style:a.style,styleSpec:u,objectElementValidators:Lh}),b;case"geojson":if(b=Hi({key:l,value:i,valueSpec:u.source_geojson,style:f,styleSpec:u,objectElementValidators:Lh}),i.cluster)for(const S in i.clusterProperties){const[P,F]=i.clusterProperties[S],N="string"==typeof P?[P,["accumulated"],["get",S]]:P;b.push(...Ta({key:`${l}.${S}.map`,value:F,expressionContext:"cluster-map"})),b.push(...Ta({key:`${l}.${S}.reduce`,value:N,expressionContext:"cluster-reduce"}))}return b;case"video":return Hi({key:l,value:i,valueSpec:u.source_video,style:f,styleSpec:u});case"image":return Hi({key:l,value:i,valueSpec:u.source_image,style:f,styleSpec:u});case"canvas":return[new $e(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return nl({key:`${l}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:u})}}function Cs(a){const i=a.value,l=a.styleSpec,u=l.light,f=a.style;let x=[];const b=or(i);if(void 0===i)return x;if("object"!==b)return x=x.concat([new $e("light",i,`object expected, ${b} found`)]),x;for(const S in i){const P=S.match(/^(.*)-transition$/);x=x.concat(P&&u[P[1]]&&u[P[1]].transition?ko({key:S,value:i[S],valueSpec:l.transition,style:f,styleSpec:l}):u[S]?ko({key:S,value:i[S],valueSpec:u[S],style:f,styleSpec:l}):[new $e(S,i[S],`unknown property "${S}"`)])}return x}function Vd(a){const i=a.value,l=a.key,u=a.style,f=a.styleSpec,x=f.terrain;let b=[];const S=or(i);if(void 0===i)return b;if("object"!==S)return b=b.concat([new $e("terrain",i,`object expected, ${S} found`)]),b;for(const P in i){const F=P.match(/^(.*)-transition$/);b=b.concat(F&&x[F[1]]&&x[F[1]].transition?ko({key:P,value:i[P],valueSpec:f.transition,style:u,styleSpec:f}):x[P]?ko({key:P,value:i[P],valueSpec:x[P],style:u,styleSpec:f}):[new $e(P,i[P],`unknown property "${P}"`)])}if(i.source){const P=u.sources&&u.sources[i.source],F=P&&an(P.type);P?"raster-dem"!==F&&b.push(new $e(l,i.source,`terrain cannot be used with a source of type ${F}, it only be used with a "raster-dem" source type`)):b.push(new $e(l,i.source,`source "${i.source}" not found`))}else b.push(new $e(l,i,'terrain is missing required property "source"'));return b}function Dc(a){const i=a.value,l=a.style,u=a.styleSpec,f=u.fog;let x=[];const b=or(i);if(void 0===i)return x;if("object"!==b)return x=x.concat([new $e("fog",i,`object expected, ${b} found`)]),x;for(const S in i){const P=S.match(/^(.*)-transition$/);x=x.concat(P&&f[P[1]]&&f[P[1]].transition?ko({key:S,value:i[S],valueSpec:u.transition,style:l,styleSpec:u}):f[S]?ko({key:S,value:i[S],valueSpec:f[S],style:l,styleSpec:u}):[new $e(S,i[S],`unknown property "${S}"`)])}return x}const ln={"*":()=>[],array:Bd,boolean:function(a){const i=a.value,l=a.key,u=or(i);return"boolean"!==u?[new $e(l,i,`boolean expected, ${u} found`)]:[]},number:_o,color:function(a){const i=a.key,l=a.value,u=or(l);return"string"!==u?[new $e(i,l,`color expected, ${u} found`)]:null===bu.parseCSSColor(l)?[new $e(i,l,`color expected, "${l}" found`)]:[]},constants:qt,enum:nl,filter:Ec,function:Fh,layer:Io,object:Hi,source:pf,light:Cs,terrain:Vd,fog:Dc,string:Fl,formatted:function(a){return 0===Fl(a).length?[]:Ta(a)},resolvedImage:function(a){return 0===Fl(a).length?[]:Ta(a)}};function ko(a){const i=a.value,l=a.valueSpec,u=a.styleSpec;return l.expression&&Od(an(i))?Fh(a):l.expression&&Sr(er(i))?Ta(a):l.type&&ln[l.type]?ln[l.type](a):Hi(_n({},a,{valueSpec:l.type?u[l.type]:l}))}function Ud(a){const i=a.value,l=a.key,u=Fl(a);return u.length||(-1===i.indexOf("{fontstack}")&&u.push(new $e(l,i,'"glyphs" url must include a "{fontstack}" token')),-1===i.indexOf("{range}")&&u.push(new $e(l,i,'"glyphs" url must include a "{range}" token'))),u}function Ia(a,i=Ce){let l=[];return l=l.concat(ko({key:"",value:a,valueSpec:i.$root,styleSpec:i,style:a,objectElementValidators:{glyphs:Ud,"*":()=>[]}})),a.constants&&(l=l.concat(qt({key:"constants",value:a.constants,style:a,styleSpec:i}))),jd(l)}function jd(a){return[].concat(a).sort((i,l)=>i.line-l.line)}function Js(a){return function(...i){return jd(a.apply(this,i))}}Ia.source=Js(pf),Ia.light=Js(Cs),Ia.terrain=Js(Vd),Ia.fog=Js(Dc),Ia.layer=Js(Io),Ia.filter=Js(Ec),Ia.paintProperty=Js(ro),Ia.layoutProperty=Js(Ks);const Mc=Ia,Gd=Mc.light,ht=Mc.fog,Xn=Mc.paintProperty,qi=Mc.layoutProperty;function li(a,i){let l=!1;if(i&&i.length)for(const u of i)a.fire(new Ke(new Error(u.message))),l=!0;return l}var Sc=io;function io(a,i,l){var u=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var f=new Int32Array(this.arrayBuffer);a=f[0],this.d=(i=f[1])+2*(l=f[2]);for(var x=0;x<this.d*this.d;x++){var b=f[3+x],S=f[3+x+1];u.push(b===S?null:f.subarray(b,S))}var P=f[3+u.length+1];this.keys=f.subarray(f[3+u.length],P),this.bboxes=f.subarray(P),this.insert=this._insertReadonly}else{this.d=i+2*l;for(var F=0;F<this.d*this.d;F++)u.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=a,this.padding=l,this.scale=i/a,this.uid=0;var N=l/i*a;this.min=-N,this.max=a+N}io.prototype.insert=function(a,i,l,u,f){this._forEachCell(i,l,u,f,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(f)},io.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},io.prototype._insertCell=function(a,i,l,u,f,x){this.cells[f].push(x)},io.prototype.query=function(a,i,l,u,f){var x=this.min,b=this.max;if(a<=x&&i<=x&&b<=l&&b<=u&&!f)return Array.prototype.slice.call(this.keys);var S=[];return this._forEachCell(a,i,l,u,this._queryCell,S,{},f),S},io.prototype._queryCell=function(a,i,l,u,f,x,b,S){var P=this.cells[f];if(null!==P)for(var F=this.keys,N=this.bboxes,U=0;U<P.length;U++){var j=P[U];if(void 0===b[j]){var q=4*j;(S?S(N[q+0],N[q+1],N[q+2],N[q+3]):a<=N[q+2]&&i<=N[q+3]&&l>=N[q+0]&&u>=N[q+1])?(b[j]=!0,x.push(F[j])):b[j]=!1}}},io.prototype._forEachCell=function(a,i,l,u,f,x,b,S){for(var P=this._convertToCellCoord(a),F=this._convertToCellCoord(i),N=this._convertToCellCoord(l),U=this._convertToCellCoord(u),j=P;j<=N;j++)for(var q=F;q<=U;q++){var re=this.d*q+j;if((!S||S(this._convertFromCellCoord(j),this._convertFromCellCoord(q),this._convertFromCellCoord(j+1),this._convertFromCellCoord(q+1)))&&f.call(this,a,i,l,u,re,x,b,S))return}},io.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},io.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},io.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,i=3+this.cells.length+1+1,l=0,u=0;u<this.cells.length;u++)l+=this.cells[u].length;var f=new Int32Array(i+l+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var x=i,b=0;b<a.length;b++){var S=a[b];f[3+b]=x,f.set(S,x),x+=S.length}return f[3+a.length]=x,f.set(this.keys,x),f[3+a.length+1]=x+=this.keys.length,f.set(this.bboxes,x),x+=this.bboxes.length,f.buffer};const{ImageData:Es,ImageBitmap:Bh}=Et,Ol={};function Ft(a,i,l={}){Object.defineProperty(i,"_classRegistryKey",{value:a,writeable:!1}),Ol[a]={klass:i,omit:l.omit||[],shallow:l.shallow||[]}}Ft("Object",Object),Sc.serialize=function(a,i){const l=a.toArrayBuffer();return i&&i.push(l),{buffer:l}},Sc.deserialize=function(a){return new Sc(a.buffer)},Ft("Grid",Sc),Ft("Color",dn),Ft("Error",Error),Ft("ResolvedImage",Bo),Ft("StylePropertyFunction",Pu),Ft("StyleExpression",kh,{omit:["_evaluator"]}),Ft("ZoomDependentExpression",tl),Ft("ZoomConstantExpression",Ph),Ft("CompoundExpression",Yo,{omit:["_evaluate"]});for(const a in vc)vc[a]._classRegistryKey||Ft(`Expression_${a}`,vc[a]);function $d(a){return a&&"undefined"!=typeof ArrayBuffer&&(a instanceof ArrayBuffer||a.constructor&&"ArrayBuffer"===a.constructor.name)}function Lu(a){return Bh&&a instanceof Bh}function il(a,i){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if($d(a)||Lu(a))return i&&i.push(a),a;if(ArrayBuffer.isView(a)){const l=a;return i&&i.push(l.buffer),l}if(a instanceof Es)return i&&i.push(a.data.buffer),a;if(Array.isArray(a)){const l=[];for(const u of a)l.push(il(u,i));return l}if("object"==typeof a){const l=a.constructor,u=l._classRegistryKey;if(!u)throw new Error("can't serialize object of unregistered class");const f=l.serialize?l.serialize(a,i):{};if(!l.serialize){for(const x in a){if(!a.hasOwnProperty(x)||Ol[u].omit.indexOf(x)>=0)continue;const b=a[x];f[x]=Ol[u].shallow.indexOf(x)>=0?b:il(b,i)}a instanceof Error&&(f.message=a.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==u&&(f.$name=u),f}throw new Error("can't serialize object of type "+typeof a)}function Ci(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||$d(a)||Lu(a)||ArrayBuffer.isView(a)||a instanceof Es)return a;if(Array.isArray(a))return a.map(Ci);if("object"==typeof a){const i=a.$name||"Object",{klass:l}=Ol[i];if(!l)throw new Error(`can't deserialize unregistered class ${i}`);if(l.deserialize)return l.deserialize(a);const u=Object.create(l.prototype);for(const f of Object.keys(a)){if("$name"===f)continue;const x=a[f];u[f]=Ol[i].shallow.indexOf(f)>=0?x:Ci(x)}return u}throw new Error("can't deserialize object of type "+typeof a)}class Ds{constructor(){this.first=!0}update(i,l){const u=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=l),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=u,!0))}}const Hd=a=>a>=1536&&a<=1791,Ll=a=>a>=1872&&a<=1919,ea=a=>a>=2208&&a<=2303,Bu=a=>a>=11904&&a<=12031,qd=a=>a>=12032&&a<=12255,mf=a=>a>=12272&&a<=12287,Bl=a=>a>=12288&&a<=12351,Nu=a=>a>=12352&&a<=12447,Tc=a=>a>=12448&&a<=12543,Nh=a=>a>=12544&&a<=12591,zu=a=>a>=12704&&a<=12735,Zd=a=>a>=12736&&a<=12783,zh=a=>a>=12784&&a<=12799,Nl=a=>a>=12800&&a<=13055,Vu=a=>a>=13056&&a<=13311,Wd=a=>a>=13312&&a<=19903,Vh=a=>a>=19968&&a<=40959,Ic=a=>a>=40960&&a<=42127,Uu=a=>a>=42128&&a<=42191,zl=a=>a>=44032&&a<=55215,gf=a=>a>=63744&&a<=64255,Ei=a=>a>=64336&&a<=65023,ka=a=>a>=65040&&a<=65055,Gr=a=>a>=65072&&a<=65103,_f=a=>a>=65104&&a<=65135,ol=a=>a>=65136&&a<=65279,kc=a=>a>=65280&&a<=65519;function Vl(a){for(const i of a)if(ta(i.charCodeAt(0)))return!0;return!1}function pm(a){for(const i of a)if(!yf(i.charCodeAt(0)))return!1;return!0}function yf(a){return!(Hd(a)||Ll(a)||ea(a)||Ei(a)||ol(a))}function ta(a){return!(746!==a&&747!==a&&(a<4352||!(zu(a)||Nh(a)||Gr(a)&&!(a>=65097&&a<=65103)||gf(a)||Vu(a)||Bu(a)||Zd(a)||!(!Bl(a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||Wd(a)||Vh(a)||Nl(a)||(i=a,i>=12592&&i<=12687)||(i=>i>=43360&&i<=43391)(a)||(i=>i>=55216&&i<=55295)(a)||(i=>i>=4352&&i<=4607)(a)||zl(a)||Nu(a)||mf(a)||(i=>i>=12688&&i<=12703)(a)||qd(a)||zh(a)||Tc(a)&&12540!==a||!(!kc(a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!_f(a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||(i=>i>=5120&&i<=5759)(a)||(i=>i>=6320&&i<=6399)(a)||ka(a)||(i=>i>=19904&&i<=19967)(a)||Ic(a)||Uu(a))));var i}function ju(a){return!(ta(a)||(i=a,(l=i)>=128&&l<=255&&(167===i||169===i||174===i||177===i||188===i||189===i||190===i||215===i||247===i)||(l=>l>=8192&&l<=8303)(i)&&(8214===i||8224===i||8225===i||8240===i||8241===i||8251===i||8252===i||8258===i||8263===i||8264===i||8265===i||8273===i)||(l=>l>=8448&&l<=8527)(i)||(l=>l>=8528&&l<=8591)(i)||(l=>l>=8960&&l<=9215)(i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||9003===i||i>=9085&&i<=9114||i>=9150&&i<=9165||9167===i||i>=9169&&i<=9179||i>=9186&&i<=9215)||(l=>l>=9216&&l<=9279)(i)&&9251!==i||(l=>l>=9280&&l<=9311)(i)||(l=>l>=9312&&l<=9471)(i)||(l=>l>=9632&&l<=9727)(i)||(l=>l>=9728&&l<=9983)(i)&&!(i>=9754&&i<=9759)||(l=>l>=11008&&l<=11263)(i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||Bl(i)||Tc(i)||(l=>l>=57344&&l<=63743)(i)||Gr(i)||_f(i)||kc(i)||8734===i||8756===i||8757===i||i>=9984&&i<=10087||i>=10102&&i<=10131||65532===i||65533===i));var i,l}function Gu(a){return a>=1424&&a<=2303||Ei(a)||ol(a)}function Pc(a,i){return!(!i&&Gu(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||(l=a,l>=6016&&l<=6143));var l}function _(a){for(const i of a)if(Gu(i.charCodeAt(0)))return!0;return!1}const s="deferred",h="loading",v="loaded";let E=null,D="unavailable",R=null;const B=function(a){a&&"string"==typeof a&&a.indexOf("NetworkError")>-1&&(D="error"),E&&E(a)};function z(){$.fire(new mt("pluginStateChange",{pluginStatus:D,pluginURL:R}))}const $=new $t,H=function(){return D},Q=function(){if(D!==s||!R)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");D=h,z(),R&&Z({url:R},a=>{a?B(a):(D=v,z())})},J={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>D===v||null!=J.applyArabicShaping,isLoading:()=>D===h,setState(a){D=a.pluginStatus,R=a.pluginURL},isParsed:()=>null!=J.applyArabicShaping&&null!=J.processBidirectionalText&&null!=J.processStyledBidirectionalText,getPluginURL:()=>R};class te{constructor(i,l){this.zoom=i,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ds,this.transition={})}isSupportedScript(i){return function(l,u){for(const f of l)if(!Pc(f.charCodeAt(0),u))return!1;return!0}(i,J.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,l=i-Math.floor(i),u=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*l}}}class le{constructor(i,l){this.property=i,this.value=l,this.expression=function(u,f){if(Od(u))return new Pu(u,f);if(Sr(u)){const x=Rh(u,f);if("error"===x.result)throw new Error(x.value.map(b=>`${b.key}: ${b.message}`).join(", "));return x.value}{let x=u;return"string"==typeof u&&"color"===f.type&&(x=dn.parse(u)),{kind:"constant",evaluate:()=>x}}}(void 0===l?i.specification.default:l,i.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(i,l,u){return this.property.possiblyEvaluate(this,i,l,u)}}class ce{constructor(i){this.property=i,this.value=new le(i,void 0)}transitioned(i,l){return new se(this.property,this.value,l,Ai({},i.transition,this.transition),i.now)}untransitioned(){return new se(this.property,this.value,null,{},0)}}class _e{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return Br(this._values[i].value.value)}setValue(i,l){this._values.hasOwnProperty(i)||(this._values[i]=new ce(this._values[i].property)),this._values[i].value=new le(this._values[i].property,null===l?void 0:Br(l))}getTransition(i){return Br(this._values[i].transition)}setTransition(i,l){this._values.hasOwnProperty(i)||(this._values[i]=new ce(this._values[i].property)),this._values[i].transition=Br(l)||void 0}serialize(){const i={};for(const l of Object.keys(this._values)){const u=this.getValue(l);void 0!==u&&(i[l]=u);const f=this.getTransition(l);void 0!==f&&(i[`${l}-transition`]=f)}return i}transitioned(i,l){const u=new ue(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].transitioned(i,l._values[f]);return u}untransitioned(){const i=new ue(this._properties);for(const l of Object.keys(this._values))i._values[l]=this._values[l].untransitioned();return i}}class se{constructor(i,l,u,f,x){const b=f.delay||0,S=f.duration||0;x=x||0,this.property=i,this.value=l,this.begin=x+b,this.end=this.begin+S,i.specification.transition&&(f.delay||f.duration)&&(this.prior=u)}possiblyEvaluate(i,l,u){const f=i.now||0,x=this.value.possiblyEvaluate(i,l,u),b=this.prior;if(b){if(f>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(f<this.begin)return b.possiblyEvaluate(i,l,u);{const S=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(i,l,u),x,Au(S))}}return x}}class ue{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,l,u){const f=new Me(this._properties);for(const x of Object.keys(this._values))f._values[x]=this._values[x].possiblyEvaluate(i,l,u);return f}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class ge{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}getValue(i){return Br(this._values[i].value)}setValue(i,l){this._values[i]=new le(this._values[i].property,null===l?void 0:Br(l))}serialize(){const i={};for(const l of Object.keys(this._values)){const u=this.getValue(l);void 0!==u&&(i[l]=u)}return i}possiblyEvaluate(i,l,u){const f=new Me(this._properties);for(const x of Object.keys(this._values))f._values[x]=this._values[x].possiblyEvaluate(i,l,u);return f}}class ve{constructor(i,l,u){this.property=i,this.value=l,this.parameters=u}isConstant(){return"constant"===this.value.kind}constantOr(i){return"constant"===this.value.kind?this.value.value:i}evaluate(i,l,u,f){return this.property.evaluate(this.value,this.parameters,i,l,u,f)}}class Me{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class de{constructor(i){this.specification=i}possiblyEvaluate(i,l){return i.expression.evaluate(l)}interpolate(i,l,u){const f=En[this.specification.type];return f?f(i,l,u):i}}class Fe{constructor(i,l){this.specification=i,this.overrides=l}possiblyEvaluate(i,l,u,f){return new ve(this,"constant"===i.expression.kind||"camera"===i.expression.kind?{kind:"constant",value:i.expression.evaluate(l,null,{},u,f)}:i.expression,l)}interpolate(i,l,u){if("constant"!==i.value.kind||"constant"!==l.value.kind)return i;if(void 0===i.value.value||void 0===l.value.value)return new ve(this,{kind:"constant",value:void 0},i.parameters);const f=En[this.specification.type];return f?new ve(this,{kind:"constant",value:f(i.value.value,l.value.value,u)},i.parameters):i}evaluate(i,l,u,f,x,b){return"constant"===i.kind?i.value:i.evaluate(l,u,f,x,b)}}class Xe extends Fe{possiblyEvaluate(i,l,u,f){if(void 0===i.value)return new ve(this,{kind:"constant",value:void 0},l);if("constant"===i.expression.kind){const x=i.expression.evaluate(l,null,{},u,f),b="resolvedImage"===i.property.specification.type&&"string"!=typeof x?x.name:x,S=this._calculate(b,b,b,l);return new ve(this,{kind:"constant",value:S},l)}if("camera"===i.expression.kind){const x=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new ve(this,{kind:"constant",value:x},l)}return new ve(this,i.expression,l)}evaluate(i,l,u,f,x,b){if("source"===i.kind){const S=i.evaluate(l,u,f,x,b);return this._calculate(S,S,S,l)}return"composite"===i.kind?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},u,f),i.evaluate({zoom:Math.floor(l.zoom)},u,f),i.evaluate({zoom:Math.floor(l.zoom)+1},u,f),l):i.value}_calculate(i,l,u,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:i,to:l,other:u}:{from:u,to:l,other:i}}interpolate(i){return i}}class it{constructor(i){this.specification=i}possiblyEvaluate(i,l,u,f){if(void 0!==i.value){if("constant"===i.expression.kind){const x=i.expression.evaluate(l,null,{},u,f);return this._calculate(x,x,x,l)}return this._calculate(i.expression.evaluate(new te(Math.floor(l.zoom-1),l)),i.expression.evaluate(new te(Math.floor(l.zoom),l)),i.expression.evaluate(new te(Math.floor(l.zoom+1),l)),l)}}_calculate(i,l,u,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:u,to:l}}interpolate(i){return i}}class Pe{constructor(i){this.specification=i}possiblyEvaluate(i,l,u,f){return!!i.expression.evaluate(l,null,{},u,f)}interpolate(){return!1}}class Ge{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in i){const u=i[l];u.specification.overridable&&this.overridableProperties.push(l);const f=this.defaultPropertyValues[l]=new le(u,void 0),x=this.defaultTransitionablePropertyValues[l]=new ce(u);this.defaultTransitioningPropertyValues[l]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=f.possiblyEvaluate({})}}}function wt(a,i){return 256*(a=di(Math.floor(a),0,255))+di(Math.floor(i),0,255)}Ft("DataDrivenProperty",Fe),Ft("DataConstantProperty",de),Ft("CrossFadedDataDrivenProperty",Xe),Ft("CrossFadedProperty",it),Ft("ColorRampProperty",Pe);const St={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Mt{constructor(i,l){this._structArray=i,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ft{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,l){return i._trim(),l&&(i.isTransferred=!0,l.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const l=Object.create(this.prototype);return l.arrayBuffer=i.arrayBuffer,l.length=i.length,l.capacity=i.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function It(a,i=1){let l=0,u=0;return{members:a.map(f=>{const x=St[f.type].BYTES_PER_ELEMENT,b=l=Dn(l,Math.max(i,x)),S=f.components||1;return u=Math.max(u,x),l+=x*S,{name:f.name,type:f.type,components:S,offset:b}}),size:Dn(l,Math.max(u,i)),alignment:i}}function Dn(a,i){return Math.ceil(a/i)*i}class tn extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l){const u=this.length;return this.resize(u+1),this.emplace(u,i,l)}emplace(i,l,u){const f=2*i;return this.int16[f+0]=l,this.int16[f+1]=u,i}}tn.prototype.bytesPerElement=4,Ft("StructArrayLayout2i4",tn);class $r extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,u,f){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,u,f)}emplace(i,l,u,f,x){const b=4*i;return this.int16[b+0]=l,this.int16[b+1]=u,this.int16[b+2]=f,this.int16[b+3]=x,i}}$r.prototype.bytesPerElement=8,Ft("StructArrayLayout4i8",$r);class Cr extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,u,f,x,b,S){const P=this.length;return this.resize(P+1),this.emplace(P,i,l,u,f,x,b,S)}emplace(i,l,u,f,x,b,S,P){const F=6*i,N=12*i,U=3*i;return this.int16[F+0]=l,this.int16[F+1]=u,this.uint8[N+4]=f,this.uint8[N+5]=x,this.uint8[N+6]=b,this.uint8[N+7]=S,this.float32[U+2]=P,i}}Cr.prototype.bytesPerElement=12,Ft("StructArrayLayout2i4ub1f12",Cr);class hn extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,u){const f=this.length;return this.resize(f+1),this.emplace(f,i,l,u)}emplace(i,l,u,f){const x=3*i;return this.float32[x+0]=l,this.float32[x+1]=u,this.float32[x+2]=f,i}}hn.prototype.bytesPerElement=12,Ft("StructArrayLayout3f12",hn);class Mn extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,u,f,x,b,S,P,F,N){const U=this.length;return this.resize(U+1),this.emplace(U,i,l,u,f,x,b,S,P,F,N)}emplace(i,l,u,f,x,b,S,P,F,N,U){const j=10*i;return this.uint16[j+0]=l,this.uint16[j+1]=u,this.uint16[j+2]=f,this.uint16[j+3]=x,this.uint16[j+4]=b,this.uint16[j+5]=S,this.uint16[j+6]=P,this.uint16[j+7]=F,this.uint16[j+8]=N,this.uint16[j+9]=U,i}}Mn.prototype.bytesPerElement=20,Ft("StructArrayLayout10ui20",Mn);class zr extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,u,f,x,b,S,P){const F=this.length;return this.resize(F+1),this.emplace(F,i,l,u,f,x,b,S,P)}emplace(i,l,u,f,x,b,S,P,F){const N=8*i;return this.uint16[N+0]=l,this.uint16[N+1]=u,this.uint16[N+2]=f,this.uint16[N+3]=x,this.uint16[N+4]=b,this.uint16[N+5]=S,this.uint16[N+6]=P,this.uint16[N+7]=F,i}}zr.prototype.bytesPerElement=16,Ft("StructArrayLayout8ui16",zr);class yo extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,u,f,x,b,S,P,F,N,U,j,q,re,oe,Ae){const xe=this.length;return this.resize(xe+1),this.emplace(xe,i,l,u,f,x,b,S,P,F,N,U,j,q,re,oe,Ae)}emplace(i,l,u,f,x,b,S,P,F,N,U,j,q,re,oe,Ae,xe){const Se=16*i;return this.int16[Se+0]=l,this.int16[Se+1]=u,this.int16[Se+2]=f,this.int16[Se+3]=x,this.uint16[Se+4]=b,this.uint16[Se+5]=S,this.uint16[Se+6]=P,this.uint16[Se+7]=F,this.int16[Se+8]=N,this.int16[Se+9]=U,this.int16[Se+10]=j,this.int16[Se+11]=q,this.int16[Se+12]=re,this.int16[Se+13]=oe,this.int16[Se+14]=Ae,this.int16[Se+15]=xe,i}}yo.prototype.bytesPerElement=32,Ft("StructArrayLayout4i4ui4i4i32",yo);class Po extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint32[1*i+0]=l,i}}Po.prototype.bytesPerElement=4,Ft("StructArrayLayout1ul4",Po);class oo extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,u,f,x,b,S,P,F,N,U,j,q){const re=this.length;return this.resize(re+1),this.emplace(re,i,l,u,f,x,b,S,P,F,N,U,j,q)}emplace(i,l,u,f,x,b,S,P,F,N,U,j,q,re){const oe=20*i,Ae=10*i;return this.int16[oe+0]=l,this.int16[oe+1]=u,this.int16[oe+2]=f,this.int16[oe+3]=x,this.int16[oe+4]=b,this.float32[Ae+3]=S,this.float32[Ae+4]=P,this.float32[Ae+5]=F,this.float32[Ae+6]=N,this.int16[oe+14]=U,this.uint32[Ae+8]=j,this.uint16[oe+18]=q,this.uint16[oe+19]=re,i}}oo.prototype.bytesPerElement=40,Ft("StructArrayLayout5i4f1i1ul2ui40",oo);class vo extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,u,f,x,b,S){const P=this.length;return this.resize(P+1),this.emplace(P,i,l,u,f,x,b,S)}emplace(i,l,u,f,x,b,S,P){const F=8*i;return this.int16[F+0]=l,this.int16[F+1]=u,this.int16[F+2]=f,this.int16[F+4]=x,this.int16[F+5]=b,this.int16[F+6]=S,this.int16[F+7]=P,i}}vo.prototype.bytesPerElement=16,Ft("StructArrayLayout3i2i2i16",vo);class Ms extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,u,f,x){const b=this.length;return this.resize(b+1),this.emplace(b,i,l,u,f,x)}emplace(i,l,u,f,x,b){const S=4*i,P=8*i;return this.float32[S+0]=l,this.float32[S+1]=u,this.float32[S+2]=f,this.int16[P+6]=x,this.int16[P+7]=b,i}}Ms.prototype.bytesPerElement=16,Ft("StructArrayLayout2f1f2i16",Ms);class Ro extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,u,f){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,u,f)}emplace(i,l,u,f,x){const b=12*i,S=3*i;return this.uint8[b+0]=l,this.uint8[b+1]=u,this.float32[S+1]=f,this.float32[S+2]=x,i}}Ro.prototype.bytesPerElement=12,Ft("StructArrayLayout2ub2f12",Ro);class Pn extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,u){const f=this.length;return this.resize(f+1),this.emplace(f,i,l,u)}emplace(i,l,u,f){const x=3*i;return this.uint16[x+0]=l,this.uint16[x+1]=u,this.uint16[x+2]=f,i}}Pn.prototype.bytesPerElement=6,Ft("StructArrayLayout3ui6",Pn);class Tr extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,l,u,f,x,b,S,P,F,N,U,j,q,re,oe,Ae,xe,Se,Le,Be,Ne){const Ue=this.length;return this.resize(Ue+1),this.emplace(Ue,i,l,u,f,x,b,S,P,F,N,U,j,q,re,oe,Ae,xe,Se,Le,Be,Ne)}emplace(i,l,u,f,x,b,S,P,F,N,U,j,q,re,oe,Ae,xe,Se,Le,Be,Ne,Ue){const Ze=30*i,at=15*i,pt=60*i;return this.int16[Ze+0]=l,this.int16[Ze+1]=u,this.int16[Ze+2]=f,this.float32[at+2]=x,this.float32[at+3]=b,this.uint16[Ze+8]=S,this.uint16[Ze+9]=P,this.uint32[at+5]=F,this.uint32[at+6]=N,this.uint32[at+7]=U,this.uint16[Ze+16]=j,this.uint16[Ze+17]=q,this.uint16[Ze+18]=re,this.float32[at+10]=oe,this.float32[at+11]=Ae,this.uint8[pt+48]=xe,this.uint8[pt+49]=Se,this.uint8[pt+50]=Le,this.uint32[at+13]=Be,this.int16[Ze+28]=Ne,this.uint8[pt+58]=Ue,i}}Tr.prototype.bytesPerElement=60,Ft("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60",Tr);class Un extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,l,u,f,x,b,S,P,F,N,U,j,q,re,oe,Ae,xe,Se,Le,Be,Ne,Ue,Ze,at,pt,gt,nt,st,xt,ot){const Jt=this.length;return this.resize(Jt+1),this.emplace(Jt,i,l,u,f,x,b,S,P,F,N,U,j,q,re,oe,Ae,xe,Se,Le,Be,Ne,Ue,Ze,at,pt,gt,nt,st,xt,ot)}emplace(i,l,u,f,x,b,S,P,F,N,U,j,q,re,oe,Ae,xe,Se,Le,Be,Ne,Ue,Ze,at,pt,gt,nt,st,xt,ot,Jt){const Tt=38*i,nr=19*i;return this.int16[Tt+0]=l,this.int16[Tt+1]=u,this.int16[Tt+2]=f,this.float32[nr+2]=x,this.float32[nr+3]=b,this.int16[Tt+8]=S,this.int16[Tt+9]=P,this.int16[Tt+10]=F,this.int16[Tt+11]=N,this.int16[Tt+12]=U,this.int16[Tt+13]=j,this.uint16[Tt+14]=q,this.uint16[Tt+15]=re,this.uint16[Tt+16]=oe,this.uint16[Tt+17]=Ae,this.uint16[Tt+18]=xe,this.uint16[Tt+19]=Se,this.uint16[Tt+20]=Le,this.uint16[Tt+21]=Be,this.uint16[Tt+22]=Ne,this.uint16[Tt+23]=Ue,this.uint16[Tt+24]=Ze,this.uint16[Tt+25]=at,this.uint16[Tt+26]=pt,this.uint16[Tt+27]=gt,this.uint16[Tt+28]=nt,this.uint32[nr+15]=st,this.float32[nr+16]=xt,this.float32[nr+17]=ot,this.float32[nr+18]=Jt,i}}Un.prototype.bytesPerElement=76,Ft("StructArrayLayout3i2f6i15ui1ul3f76",Un);class br extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.float32[1*i+0]=l,i}}br.prototype.bytesPerElement=4,Ft("StructArrayLayout1f4",br);class Di extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,u){const f=this.length;return this.resize(f+1),this.emplace(f,i,l,u)}emplace(i,l,u,f){const x=3*i;return this.int16[x+0]=l,this.int16[x+1]=u,this.int16[x+2]=f,i}}Di.prototype.bytesPerElement=6,Ft("StructArrayLayout3i6",Di);class sr extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,u,f){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,u,f)}emplace(i,l,u,f,x){const b=6*i;return this.uint32[3*i+0]=l,this.uint16[b+2]=u,this.uint16[b+3]=f,this.uint16[b+4]=x,i}}sr.prototype.bytesPerElement=12,Ft("StructArrayLayout1ul3ui12",sr);class ci extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l){const u=this.length;return this.resize(u+1),this.emplace(u,i,l)}emplace(i,l,u){const f=2*i;return this.uint16[f+0]=l,this.uint16[f+1]=u,i}}ci.prototype.bytesPerElement=4,Ft("StructArrayLayout2ui4",ci);class Fo extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint16[1*i+0]=l,i}}Fo.prototype.bytesPerElement=2,Ft("StructArrayLayout1ui2",Fo);class so extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,u,f,x){const b=this.length;return this.resize(b+1),this.emplace(b,i,l,u,f,x)}emplace(i,l,u,f,x,b){const S=5*i;return this.float32[S+0]=l,this.float32[S+1]=u,this.float32[S+2]=f,this.float32[S+3]=x,this.float32[S+4]=b,i}}so.prototype.bytesPerElement=20,Ft("StructArrayLayout5f20",so);class Qd extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l){const u=this.length;return this.resize(u+1),this.emplace(u,i,l)}emplace(i,l,u){const f=2*i;return this.float32[f+0]=l,this.float32[f+1]=u,i}}Qd.prototype.bytesPerElement=8,Ft("StructArrayLayout2f8",Qd);class vf extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,u,f){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,u,f)}emplace(i,l,u,f,x){const b=4*i;return this.float32[b+0]=l,this.float32[b+1]=u,this.float32[b+2]=f,this.float32[b+3]=x,i}}vf.prototype.bytesPerElement=16,Ft("StructArrayLayout4f16",vf);class Uh extends Mt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Uh.prototype.size=40;class Rc extends oo{get(i){return new Uh(this,i)}}Ft("CollisionBoxArray",Rc);class xf extends Mt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}xf.prototype.size=60;class on extends Tr{get(i){return new xf(this,i)}}Ft("PlacedSymbolArray",on);class jh extends Mt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(i){this._structArray.uint32[this._pos4+15]=i}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}jh.prototype.size=76;class mm extends Un{get(i){return new jh(this,i)}}Ft("SymbolInstanceArray",mm);class Mv extends br{getoffsetX(i){return this.float32[1*i+0]}}Ft("GlyphOffsetArray",Mv);class Sv extends Di{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}Ft("SymbolLineVertexArray",Sv);class Tv extends Mt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Tv.prototype.size=12;class Iv extends sr{get(i){return new Tv(this,i)}}Ft("FeatureIndexArray",Iv);class kv extends Mt{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}kv.prototype.size=4;class Pv extends ci{get(i){return new kv(this,i)}}Ft("FillExtrusionCentroidArray",Pv);const n2=It([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),r2=It([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var Rv=Xo(function(a){a.exports=function(i,l){var u,f,x,b,S,P,F,N;for(f=i.length-(u=3&i.length),x=l,S=3432918353,P=461845907,N=0;N<f;)F=255&i.charCodeAt(N)|(255&i.charCodeAt(++N))<<8|(255&i.charCodeAt(++N))<<16|(255&i.charCodeAt(++N))<<24,++N,x=27492+(65535&(b=5*(65535&(x=(x^=F=(65535&(F=(F=(65535&F)*S+(((F>>>16)*S&65535)<<16)&4294967295)<<15|F>>>17))*P+(((F>>>16)*P&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(F=0,u){case 3:F^=(255&i.charCodeAt(N+2))<<16;case 2:F^=(255&i.charCodeAt(N+1))<<8;case 1:x^=F=(65535&(F=(F=(65535&(F^=255&i.charCodeAt(N)))*S+(((F>>>16)*S&65535)<<16)&4294967295)<<15|F>>>17))*P+(((F>>>16)*P&65535)<<16)&4294967295}return x^=i.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}}),Xd=Xo(function(a){a.exports=function(i,l){for(var u,f=i.length,x=l^f,b=0;f>=4;)u=1540483477*(65535&(u=255&i.charCodeAt(b)|(255&i.charCodeAt(++b))<<8|(255&i.charCodeAt(++b))<<16|(255&i.charCodeAt(++b))<<24))+((1540483477*(u>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++b;switch(f){case 3:x^=(255&i.charCodeAt(b+2))<<16;case 2:x^=(255&i.charCodeAt(b+1))<<8;case 1:x=1540483477*(65535&(x^=255&i.charCodeAt(b)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}}),bf=Rv,Zi=Xd;bf.murmur3=Rv,bf.murmur2=Zi;class $u{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,l,u,f){this.ids.push(Yd(i)),this.positions.push(l,u,f)}getPositions(i){const l=Yd(i);let u=0,f=this.ids.length-1;for(;u<f;){const b=u+f>>1;this.ids[b]>=l?f=b:u=b+1}const x=[];for(;this.ids[u]===l;)x.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return x}static serialize(i,l){const u=new Float64Array(i.ids),f=new Uint32Array(i.positions);return M0(u,f,0,u.length-1),l&&l.push(u.buffer,f.buffer),{ids:u,positions:f}}static deserialize(i){const l=new $u;return l.ids=i.ids,l.positions=i.positions,l.indexed=!0,l}}function Yd(a){const i=+a;return!isNaN(i)&&i<=ms?i:bf(String(a))}function M0(a,i,l,u){for(;l<u;){const f=a[l+u>>1];let x=l-1,b=u+1;for(;;){do{x++}while(a[x]<f);do{b--}while(a[b]>f);if(x>=b)break;wf(a,x,b),wf(i,3*x,3*b),wf(i,3*x+1,3*b+1),wf(i,3*x+2,3*b+2)}b-l<u-b?(M0(a,i,l,b),l=b+1):(M0(a,i,b+1,u),u=b)}}function wf(a,i,l){const u=a[i];a[i]=a[l],a[l]=u}Ft("FeaturePositionMap",$u);class Wi{constructor(i,l){this.gl=i.gl,this.location=l}}class Ss extends Wi{constructor(i,l){super(i,l),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class Kd extends Wi{constructor(i,l){super(i,l),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class Fc extends Wi{constructor(i,l){super(i,l),this.current=dn.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const Oc=new Float32Array(16),S0=new Float32Array(9);function gm(a){return[wt(255*a.r,255*a.g),wt(255*a.b,255*a.a)]}class Jd{constructor(i,l,u){this.value=i,this.uniformNames=l.map(f=>`u_${f}`),this.type=u}setUniform(i,l,u){i.set(u.constantOr(this.value))}getBinding(i,l,u){return"color"===this.type?new Fc(i,l):new Ss(i,l)}}class eA{constructor(i,l){this.uniformNames=l.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=l.tl.concat(l.br),this.patternTo=i.tl.concat(i.br)}setUniform(i,l,u,f){const x="u_pattern_to"===f||"u_dash_to"===f?this.patternTo:"u_pattern_from"===f||"u_dash_from"===f?this.patternFrom:"u_pixel_ratio_to"===f?this.pixelRatioTo:"u_pixel_ratio_from"===f?this.pixelRatioFrom:null;x&&i.set(x)}getBinding(i,l,u){return"u_pattern_from"===u||"u_pattern_to"===u||"u_dash_from"===u||"u_dash_to"===u?new Kd(i,l):new Ss(i,l)}}class Lc{constructor(i,l,u,f){this.expression=i,this.type=u,this.maxValue=0,this.paintVertexAttributes=l.map(x=>({name:`a_${x}`,type:"Float32",components:"color"===u?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(i,l,u,f,x){const b=this.paintVertexArray.length,S=this.expression.evaluate(new te(0),l,{},f,[],x);this.paintVertexArray.resize(i),this._setPaintValue(b,i,S)}updatePaintArray(i,l,u,f){const x=this.expression.evaluate({zoom:0},u,f);this._setPaintValue(i,l,x)}_setPaintValue(i,l,u){if("color"===this.type){const f=gm(u);for(let x=i;x<l;x++)this.paintVertexArray.emplace(x,f[0],f[1])}else{for(let f=i;f<l;f++)this.paintVertexArray.emplace(f,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class na{constructor(i,l,u,f,x,b){this.expression=i,this.uniformNames=l.map(S=>`u_${S}_t`),this.type=u,this.useIntegerZoom=f,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=l.map(S=>({name:`a_${S}`,type:"Float32",components:"color"===u?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(i,l,u,f,x){const b=this.expression.evaluate(new te(this.zoom),l,{},f,[],x),S=this.expression.evaluate(new te(this.zoom+1),l,{},f,[],x),P=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(P,i,b,S)}updatePaintArray(i,l,u,f){const x=this.expression.evaluate({zoom:this.zoom},u,f),b=this.expression.evaluate({zoom:this.zoom+1},u,f);this._setPaintValue(i,l,x,b)}_setPaintValue(i,l,u,f){if("color"===this.type){const x=gm(u),b=gm(f);for(let S=i;S<l;S++)this.paintVertexArray.emplace(S,x[0],x[1],b[0],b[1])}else{for(let x=i;x<l;x++)this.paintVertexArray.emplace(x,u,f);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(f))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,l){const u=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,f=di(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);i.set(f)}getBinding(i,l,u){return new Ss(i,l)}}class Oi{constructor(i,l,u,f,x,b,S){this.expression=i,this.type=u,this.useIntegerZoom=f,this.zoom=x,this.layerId=S,this.paintVertexAttributes=("array"===u?r2:n2).members;for(let P=0;P<l.length;++P);this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(i,l,u){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(f,i,l.patterns&&l.patterns[this.layerId],u)}updatePaintArray(i,l,u,f,x){this._setPaintValues(i,l,u.patterns&&u.patterns[this.layerId],x)}_setPaintValues(i,l,u,f){if(!f||!u)return;const{min:x,mid:b,max:S}=u,P=f[x],F=f[b],N=f[S];if(P&&F&&N)for(let U=i;U<l;U++)this._setPaintValue(this.zoomInPaintVertexArray,U,F,P),this._setPaintValue(this.zoomOutPaintVertexArray,U,F,N)}_setPaintValue(i,l,u,f){i.emplace(l,u.tl[0],u.tl[1],u.br[0],u.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],u.pixelRatio,f.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Pa{constructor(i,l,u=(()=>!0)){this.binders={},this._buffers=[];const f=[];for(const x in i.paint._values){if(!u(x))continue;const b=i.paint.get(x);if(!(b instanceof ve&&wc(b.property.specification)))continue;const S=T0(x,i.type),P=b.value,F=b.property.specification.type,N=b.property.useIntegerZoom,U=b.property.specification["property-type"],j="cross-faded"===U||"cross-faded-data-driven"===U,q="line-dasharray"===String(x)&&"constant"!==i.layout.get("line-cap").value.kind;if("constant"!==P.kind||q)if("source"===P.kind||q||j){const re=I0(x,F,"source");this.binders[x]=j?new Oi(P,S,F,N,l,re,i.id):new Lc(P,S,F,re),f.push(`/a_${x}`)}else{const re=I0(x,F,"composite");this.binders[x]=new na(P,S,F,N,l,re),f.push(`/z_${x}`)}else this.binders[x]=j?new eA(P.value,S):new Jd(P.value,S,F),f.push(`/u_${x}`)}this.cacheKey=f.sort().join("")}getMaxValue(i){const l=this.binders[i];return l instanceof Lc||l instanceof na?l.maxValue:0}populatePaintArrays(i,l,u,f,x){for(const b in this.binders){const S=this.binders[b];(S instanceof Lc||S instanceof na||S instanceof Oi)&&S.populatePaintArray(i,l,u,f,x)}}setConstantPatternPositions(i,l){for(const u in this.binders){const f=this.binders[u];f instanceof eA&&f.setConstantPatternPositions(i,l)}}updatePaintArrays(i,l,u,f,x){let b=!1;for(const S in i){const P=l.getPositions(S);for(const F of P){const N=u.feature(F.index);for(const U in this.binders){const j=this.binders[U];if((j instanceof Lc||j instanceof na||j instanceof Oi)&&!0===j.expression.isStateDependent){const q=f.paint.get(U);j.expression=q.value,j.updatePaintArray(F.start,F.end,N,i[S],x),b=!0}}}}return b}defines(){const i=[];for(const l in this.binders){const u=this.binders[l];(u instanceof Jd||u instanceof eA)&&i.push(...u.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return i}getBinderAttributes(){const i=[];for(const l in this.binders){const u=this.binders[l];if(u instanceof Lc||u instanceof na||u instanceof Oi)for(let f=0;f<u.paintVertexAttributes.length;f++)i.push(u.paintVertexAttributes[f].name)}return i}getBinderUniforms(){const i=[];for(const l in this.binders){const u=this.binders[l];if(u instanceof Jd||u instanceof eA||u instanceof na)for(const f of u.uniformNames)i.push(f)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,l){const u=[];for(const f in this.binders){const x=this.binders[f];if(x instanceof Jd||x instanceof eA||x instanceof na)for(const b of x.uniformNames)if(l[b]){const S=x.getBinding(i,l[b],b);u.push({name:b,property:f,binding:S})}}return u}setUniforms(i,l,u,f){for(const{name:x,property:b,binding:S}of l)this.binders[b].setUniform(S,f,u.get(b),x)}updatePaintBuffers(i){this._buffers=[];for(const l in this.binders){const u=this.binders[l];if(i&&u instanceof Oi){const f=2===i.fromScale?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(u instanceof Lc||u instanceof na)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(i){for(const l in this.binders){const u=this.binders[l];(u instanceof Lc||u instanceof na||u instanceof Oi)&&u.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const l=this.binders[i];(l instanceof Lc||l instanceof na||l instanceof Oi)&&l.destroy()}}}class ra{constructor(i,l,u=(()=>!0)){this.programConfigurations={};for(const f of i)this.programConfigurations[f.id]=new Pa(f,l,u);this.needsUpload=!1,this._featureMap=new $u,this._bufferOffset=0}populatePaintArrays(i,l,u,f,x,b){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(i,l,f,x,b);void 0!==l.id&&this._featureMap.add(l.id,u,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,l,u,f){for(const x of u)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(i,this._featureMap,l,x,f)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const i2={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function T0(a,i){return i2[a]||[a.replace(`${i}-`,"").replace(/-/g,"_")]}const Fv={"line-pattern":{source:Mn,composite:Mn},"fill-pattern":{source:Mn,composite:Mn},"fill-extrusion-pattern":{source:Mn,composite:Mn},"line-dasharray":{source:zr,composite:zr}},Ov={color:{source:Qd,composite:vf},number:{source:br,composite:Qd}};function I0(a,i,l){const u=Fv[a];return u&&u[l]||Ov[i][l]}Ft("ConstantBinder",Jd),Ft("CrossFadedConstantBinder",eA),Ft("SourceExpressionBinder",Lc),Ft("CrossFadedCompositeBinder",Oi),Ft("CompositeExpressionBinder",na),Ft("ProgramConfiguration",Pa,{omit:["_buffers"]}),Ft("ProgramConfigurationSet",ra);const Cf="-transition";class Ra extends $t{constructor(i,l){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==i.type&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,"background"!==i.type&&"sky"!==i.type&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new ge(l.layout)),l.paint)){this._transitionablePaint=new _e(l.paint);for(const u in i.paint)this.setPaintProperty(u,i.paint[u],{validate:!1});for(const u in i.layout)this.setLayoutProperty(u,i.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Me(l.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return"visibility"===i?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,l,u={}){null!=l&&this._validate(qi,`layers.${this.id}.layout.${i}`,i,l,u)||("visibility"!==i?this._unevaluatedLayout.setValue(i,l):this.visibility=l)}getPaintProperty(i){return ys(i,Cf)?this._transitionablePaint.getTransition(i.slice(0,-Cf.length)):this._transitionablePaint.getValue(i)}setPaintProperty(i,l,u={}){if(null!=l&&this._validate(Xn,`layers.${this.id}.paint.${i}`,i,l,u))return!1;if(ys(i,Cf))return this._transitionablePaint.setTransition(i.slice(0,-Cf.length),l||void 0),!1;{const f=this._transitionablePaint._values[i],x="cross-faded-data-driven"===f.property.specification["property-type"],b=f.value.isDataDriven(),S=f.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);const P=this._transitionablePaint._values[i].value;return P.isDataDriven()||b||x||this._handleOverridablePaintPropertyUpdate(i,S,P)}}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getProgramConfiguration(i){return null}_handleOverridablePaintPropertyUpdate(i,l,u){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||"none"===this.visibility}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),Zo(i,(l,u)=>!(void 0===l||"layout"===u&&!Object.keys(l).length||"paint"===u&&!Object.keys(l).length))}_validate(i,l,u,f,x={}){return(!x||!1!==x.validate)&&li(this,i.call(Mc,{key:l,layerType:this.type,objectKey:u,value:f,styleSpec:Ce,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const l=this.paint.get(i);if(l instanceof ve&&wc(l.property.specification)&&("source"===l.value.kind||"composite"===l.value.kind)&&l.value.isStateDependent)return!0}return!1}}const tA=It([{name:"a_pos",components:2,type:"Int16"}],4),{members:_m}=tA;class Li{constructor(i=[]){this.segments=i}prepareSegment(i,l,u,f){let x=this.segments[this.segments.length-1];return i>Li.MAX_VERTEX_ARRAY_LENGTH&&jr(`Max vertices per segment is ${Li.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!x||x.vertexLength+i>Li.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==f)&&(x={vertexOffset:l.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},void 0!==f&&(x.sortKey=f),this.segments.push(x)),x}get(){return this.segments}destroy(){for(const i of this.segments)for(const l in i.vaos)i.vaos[l].destroy()}static simpleSegment(i,l,u,f){return new Li([{vertexOffset:i,primitiveOffset:l,vertexLength:u,primitiveLength:f,vaos:{},sortKey:0}])}}Li.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ft("SegmentVector",Li);var ur=8192;const Hu=Math.pow(2,14)-1,Ef=-Hu-1;function ia(a){const i=ur/a.extent,l=a.loadGeometry();for(let u=0;u<l.length;u++){const f=l[u];for(let x=0;x<f.length;x++){const b=f[x],S=Math.round(b.x*i),P=Math.round(b.y*i);b.x=di(S,Ef,Hu),b.y=di(P,Ef,Hu),(S<b.x||S>b.x+1||P<b.y||P>b.y+1)&&jr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function qu(a,i){return{type:a.type,id:a.id,properties:a.properties,geometry:i?ia(a):[]}}function Df(a,i,l,u,f){a.emplaceBack(2*i+(u+1)/2,2*l+(f+1)/2)}class ym{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new tn,this.indexArray=new Pn,this.segments=new Li,this.programConfigurations=new ra(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,u){const f=this.layers[0],x=[];let b=null;"circle"===f.type&&(b=f.layout.get("circle-sort-key"));for(const{feature:S,id:P,index:F,sourceLayerIndex:N}of i){const U=this.layers[0]._featureFilter.needGeometry,j=qu(S,U);if(!this.layers[0]._featureFilter.filter(new te(this.zoom),j,u))continue;const q=b?b.evaluate(j,{},u):void 0,re={id:P,properties:S.properties,type:S.type,sourceLayerIndex:N,index:F,geometry:U?j.geometry:ia(S),patterns:{},sortKey:q};x.push(re)}b&&x.sort((S,P)=>S.sortKey-P.sortKey);for(const S of x){const{geometry:P,index:F,sourceLayerIndex:N}=S,U=i[F].feature;this.addFeature(S,P,F,u),l.featureIndex.insert(U,P,F,N,this.index)}}update(i,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,_m),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,l,u,f){for(const x of l)for(const b of x){const S=b.x,P=b.y;if(S<0||S>=ur||P<0||P>=ur)continue;const F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),N=F.vertexLength;Df(this.layoutVertexArray,S,P,-1,-1),Df(this.layoutVertexArray,S,P,1,-1),Df(this.layoutVertexArray,S,P,1,1),Df(this.layoutVertexArray,S,P,-1,1),this.indexArray.emplaceBack(N,N+1,N+2),this.indexArray.emplaceBack(N,N+3,N+2),F.vertexLength+=4,F.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,{},f)}}function Mf(a,i){for(let l=0;l<a.length;l++)if(oa(i,a[l]))return!0;for(let l=0;l<i.length;l++)if(oa(a,i[l]))return!0;return!!Bc(a,i)}function o2(a,i,l){return!!oa(a,i)||!!vt(i,a,l)}function Sf(a,i){if(1===a.length)return k0(i,a[0]);for(let l=0;l<i.length;l++){const u=i[l];for(let f=0;f<u.length;f++)if(oa(a,u[f]))return!0}for(let l=0;l<a.length;l++)if(k0(i,a[l]))return!0;for(let l=0;l<i.length;l++)if(Bc(a,i[l]))return!0;return!1}function nA(a,i,l){if(a.length>1){if(Bc(a,i))return!0;for(let u=0;u<i.length;u++)if(vt(i[u],a,l))return!0}for(let u=0;u<a.length;u++)if(vt(a[u],i,l))return!0;return!1}function Bc(a,i){if(0===a.length||0===i.length)return!1;for(let l=0;l<a.length-1;l++){const u=a[l],f=a[l+1];for(let x=0;x<i.length-1;x++)if(Lv(u,f,i[x],i[x+1]))return!0}return!1}function Lv(a,i,l,u){return vs(a,l,u)!==vs(i,l,u)&&vs(a,i,l)!==vs(a,i,u)}function vt(a,i,l){const u=l*l;if(1===i.length)return a.distSqr(i[0])<u;for(let f=1;f<i.length;f++)if(vm(a,i[f-1],i[f])<u)return!0;return!1}function vm(a,i,l){const u=i.distSqr(l);if(0===u)return a.distSqr(i);const f=((a.x-i.x)*(l.x-i.x)+(a.y-i.y)*(l.y-i.y))/u;return a.distSqr(f<0?i:f>1?l:l.sub(i)._mult(f)._add(i))}function k0(a,i){let l,u,f,x=!1;for(let b=0;b<a.length;b++){l=a[b];for(let S=0,P=l.length-1;S<l.length;P=S++)u=l[S],f=l[P],u.y>i.y!=f.y>i.y&&i.x<(f.x-u.x)*(i.y-u.y)/(f.y-u.y)+u.x&&(x=!x)}return x}function oa(a,i){let l=!1;for(let u=0,f=a.length-1;u<a.length;f=u++){const x=a[u],b=a[f];x.y>i.y!=b.y>i.y&&i.x<(b.x-x.x)*(i.y-x.y)/(b.y-x.y)+x.x&&(l=!l)}return l}function Gh(a,i,l,u,f){for(const b of a)if(i<=b.x&&l<=b.y&&u>=b.x&&f>=b.y)return!0;const x=[new dt(i,l),new dt(i,f),new dt(u,f),new dt(u,l)];if(a.length>2)for(const b of x)if(oa(a,b))return!0;for(let b=0;b<a.length-1;b++)if(Bv(a[b],a[b+1],x))return!0;return!1}function Bv(a,i,l){const u=l[0],f=l[2];if(a.x<u.x&&i.x<u.x||a.x>f.x&&i.x>f.x||a.y<u.y&&i.y<u.y||a.y>f.y&&i.y>f.y)return!1;const x=vs(a,i,l[0]);return x!==vs(a,i,l[1])||x!==vs(a,i,l[2])||x!==vs(a,i,l[3])}function Zu(a,i,l){const u=i.paint.get(a).value;return"constant"===u.kind?u.value:l.programConfigurations.get(i.id).getMaxValue(a)}function rA(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Nv(a,i,l,u,f){if(!i[0]&&!i[1])return a;const x=dt.convert(i)._mult(f);"viewport"===l&&x._rotate(-u);const b=[];for(let S=0;S<a.length;S++)b.push(a[S].sub(x));return b}function Wu(a,i,l,u){const f=dt.convert(a)._mult(u);return"viewport"===i&&f._rotate(-l),f}Ft("CircleBucket",ym,{omit:["layers"]});const is=new Ge({"circle-sort-key":new Fe(Ce.layout_circle["circle-sort-key"])});var Tf={paint:new Ge({"circle-radius":new Fe(Ce.paint_circle["circle-radius"]),"circle-color":new Fe(Ce.paint_circle["circle-color"]),"circle-blur":new Fe(Ce.paint_circle["circle-blur"]),"circle-opacity":new Fe(Ce.paint_circle["circle-opacity"]),"circle-translate":new de(Ce.paint_circle["circle-translate"]),"circle-translate-anchor":new de(Ce.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new de(Ce.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new de(Ce.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Fe(Ce.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Fe(Ce.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Fe(Ce.paint_circle["circle-stroke-opacity"])}),layout:is},Mi="undefined"!=typeof Float32Array?Float32Array:Array;function P0(){var a=new Mi(9);return Mi!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function If(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function kf(a,i,l){var u=i[0],f=i[1],x=i[2],b=i[3],S=i[4],P=i[5],F=i[6],N=i[7],U=i[8],j=i[9],q=i[10],re=i[11],oe=i[12],Ae=i[13],xe=i[14],Se=i[15],Le=l[0],Be=l[1],Ne=l[2],Ue=l[3];return a[0]=Le*u+Be*S+Ne*U+Ue*oe,a[1]=Le*f+Be*P+Ne*j+Ue*Ae,a[2]=Le*x+Be*F+Ne*q+Ue*xe,a[3]=Le*b+Be*N+Ne*re+Ue*Se,a[4]=(Le=l[4])*u+(Be=l[5])*S+(Ne=l[6])*U+(Ue=l[7])*oe,a[5]=Le*f+Be*P+Ne*j+Ue*Ae,a[6]=Le*x+Be*F+Ne*q+Ue*xe,a[7]=Le*b+Be*N+Ne*re+Ue*Se,a[8]=(Le=l[8])*u+(Be=l[9])*S+(Ne=l[10])*U+(Ue=l[11])*oe,a[9]=Le*f+Be*P+Ne*j+Ue*Ae,a[10]=Le*x+Be*F+Ne*q+Ue*xe,a[11]=Le*b+Be*N+Ne*re+Ue*Se,a[12]=(Le=l[12])*u+(Be=l[13])*S+(Ne=l[14])*U+(Ue=l[15])*oe,a[13]=Le*f+Be*P+Ne*j+Ue*Ae,a[14]=Le*x+Be*F+Ne*q+Ue*xe,a[15]=Le*b+Be*N+Ne*re+Ue*Se,a}Math.hypot||(Math.hypot=function(){for(var a=0,i=arguments.length;i--;)a+=arguments[i]*arguments[i];return Math.sqrt(a)});var Pf=kf;function iA(){var a=new Mi(3);return Mi!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function R0(a){return Math.hypot(a[0],a[1],a[2])}function $h(a,i,l){var u=new Mi(3);return u[0]=a,u[1]=i,u[2]=l,u}function Qu(a,i,l){return a[0]=i[0]-l[0],a[1]=i[1]-l[1],a[2]=i[2]-l[2],a}function Hh(a,i,l){return a[0]=i[0]*l[0],a[1]=i[1]*l[1],a[2]=i[2]*l[2],a}function F0(a,i,l,u){return a[0]=i[0]+l[0]*u,a[1]=i[1]+l[1]*u,a[2]=i[2]+l[2]*u,a}function zv(a,i){var l=i[0],u=i[1],f=i[2],x=l*l+u*u+f*f;return x>0&&(x=1/Math.sqrt(x)),a[0]=i[0]*x,a[1]=i[1]*x,a[2]=i[2]*x,a}function xm(a,i,l){var u=l[0],f=l[1],x=l[2],b=i[0],S=i[1],P=i[2],F=f*P-x*S,N=x*b-u*P,U=u*S-f*b,j=f*U-x*N,q=x*F-u*U,re=u*N-f*F,oe=2*l[3];return N*=oe,U*=oe,q*=2,re*=2,a[0]=b+(F*=oe)+(j*=2),a[1]=S+N+q,a[2]=P+U+re,a}var oA,s2=Qu,Vv=Hh,Uv=R0;function sA(a,i,l){var u=i[0],f=i[1],x=i[2],b=i[3];return a[0]=l[0]*u+l[4]*f+l[8]*x+l[12]*b,a[1]=l[1]*u+l[5]*f+l[9]*x+l[13]*b,a[2]=l[2]*u+l[6]*f+l[10]*x+l[14]*b,a[3]=l[3]*u+l[7]*f+l[11]*x+l[15]*b,a}function qh(){var a=new Mi(4);return Mi!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function Rf(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function Xu(a,i,l){l*=.5;var u=i[0],f=i[1],x=i[2],b=i[3],S=Math.sin(l),P=Math.cos(l);return a[0]=u*P+b*S,a[1]=f*P+x*S,a[2]=x*P-f*S,a[3]=b*P-u*S,a}function O0(a,i,l,u,f,x,b,S,P){if(x&&a.queryGeometry.isAboveHorizon)return!1;x&&(P*=a.pixelToTileUnitsFactor);for(const F of i)for(const N of F){const U=N.add(S),j=f&&l.elevation?l.elevation.exaggeration()*f.getElevationAt(U.x,U.y,!0):0,q=x?U:jv(U,j,u),re=x?a.tilespaceRays.map(Ae=>bm(Ae,j)):a.queryGeometry.screenGeometry,oe=sA([],[N.x,N.y,j,1],u);if(!b&&x?P*=oe[3]/l.cameraToCenterDistance:b&&!x&&(P*=l.cameraToCenterDistance/oe[3]),o2(re,q,P))return!0}return!1}function jv(a,i,l){const u=sA([],[a.x,a.y,i,1],l);return new dt(u[0]/u[3],u[1]/u[3])}iA(),oA=new Mi(4),Mi!=Float32Array&&(oA[0]=0,oA[1]=0,oA[2]=0,oA[3]=0),iA(),$h(1,0,0),$h(0,1,0),qh(),qh(),P0();const Gv=$h(0,0,0),Ff=$h(0,0,1);function bm(a,i){const l=iA();return Gv[2]=i,a.intersectsPlane(Gv,Ff,l),new dt(l[0],l[1])}class wm extends ym{}function Of(a,{width:i,height:l},u,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==i*l*u)throw new RangeError("mismatched image size")}else f=new Uint8Array(i*l*u);return a.width=i,a.height=l,a.data=f,a}function Cm(a,{width:i,height:l},u){if(i===a.width&&l===a.height)return;const f=Of({},{width:i,height:l},u);Ul(a,f,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,i),height:Math.min(a.height,l)},u),a.width=i,a.height=l,a.data=f.data}function Ul(a,i,l,u,f,x){if(0===f.width||0===f.height)return i;if(f.width>a.width||f.height>a.height||l.x>a.width-f.width||l.y>a.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>i.width||f.height>i.height||u.x>i.width-f.width||u.y>i.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const b=a.data,S=i.data;for(let P=0;P<f.height;P++){const F=((l.y+P)*a.width+l.x)*x,N=((u.y+P)*i.width+u.x)*x;for(let U=0;U<f.width*x;U++)S[N+U]=b[F+U]}return i}Ft("HeatmapBucket",wm,{omit:["layers"]});class Nc{constructor(i,l){Of(this,i,1,l)}resize(i){Cm(this,i,1)}clone(){return new Nc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,u,f,x){Ul(i,l,u,f,x,1)}}class Ts{constructor(i,l){Of(this,i,4,l)}resize(i){Cm(this,i,4)}replace(i,l){l?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Ts({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,u,f,x){Ul(i,l,u,f,x,4)}}Ft("AlphaImage",Nc),Ft("RGBAImage",Ts);var $v={paint:new Ge({"heatmap-radius":new Fe(Ce.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Fe(Ce.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new de(Ce.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Pe(Ce.paint_heatmap["heatmap-color"]),"heatmap-opacity":new de(Ce.paint_heatmap["heatmap-opacity"])})};function Em(a){const i={},l=a.resolution||256,u=a.clips?a.clips.length:1,f=a.image||new Ts({width:l,height:u}),x=(b,S,P)=>{i[a.evaluationKey]=P;const F=a.expression.evaluate(i);f.data[b+S+0]=Math.floor(255*F.r/F.a),f.data[b+S+1]=Math.floor(255*F.g/F.a),f.data[b+S+2]=Math.floor(255*F.b/F.a),f.data[b+S+3]=Math.floor(255*F.a)};if(a.clips)for(let b=0,S=0;b<u;++b,S+=4*l)for(let P=0,F=0;P<l;P++,F+=4){const N=P/(l-1),{start:U,end:j}=a.clips[b];x(S,F,U*(1-N)+j*N)}else for(let b=0,S=0;b<l;b++,S+=4)x(0,S,b/(l-1));return f}var Hv={paint:new Ge({"hillshade-illumination-direction":new de(Ce.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new de(Ce.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new de(Ce.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new de(Ce.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new de(Ce.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new de(Ce.paint_hillshade["hillshade-accent-color"])})};const Is=It([{name:"a_pos",components:2,type:"Int16"}],4),{members:sl}=Is;var Lf=Bf,qv=Bf;function Bf(a,i,l){l=l||2;var u,f,x,b,S,P,F,N=i&&i.length,U=N?i[0]*l:a.length,j=L0(a,0,U,l,!0),q=[];if(!j||j.next===j.prev)return q;if(N&&(j=function(oe,Ae,xe,Se){var Le,Be,Ne,Ue=[];for(Le=0,Be=Ae.length;Le<Be;Le++)(Ne=L0(oe,Ae[Le]*Se,Le<Be-1?Ae[Le+1]*Se:oe.length,Se,!1))===Ne.next&&(Ne.steiner=!0),Ue.push(N0(Ne));for(Ue.sort(Xv),Le=0;Le<Ue.length;Le++)a2(Ue[Le],xe),xe=zc(xe,xe.next);return xe}(a,i,j,l)),a.length>80*l){u=x=a[0],f=b=a[1];for(var re=l;re<U;re+=l)(S=a[re])<u&&(u=S),(P=a[re+1])<f&&(f=P),S>x&&(x=S),P>b&&(b=P);F=0!==(F=Math.max(x-u,b-f))?1/F:0}return aA(j,q,l,u,f,F),q}function L0(a,i,l,u,f){var x,b;if(f===V0(a,i,l,u)>0)for(x=i;x<l;x+=u)b=Vf(x,a[x],a[x+1],b);else for(x=l-u;x>=i;x-=u)b=Vf(x,a[x],a[x+1],b);return b&&cA(b,b.next)&&(Ku(b),b=b.next),b}function zc(a,i){if(!a)return a;i||(i=a);var l,u=a;do{if(l=!1,u.steiner||!cA(u,u.next)&&0!==Kr(u.prev,u,u.next))u=u.next;else{if(Ku(u),(u=i=u.prev)===u.next)break;l=!0}}while(l||u!==i);return i}function aA(a,i,l,u,f,x,b){if(a){!b&&x&&function(N,U,j,q){var re=N;do{null===re.z&&(re.z=Yu(re.x,re.y,U,j,q)),re.prevZ=re.prev,re.nextZ=re.next,re=re.next}while(re!==N);re.prevZ.nextZ=null,re.prevZ=null,function(oe){var Ae,xe,Se,Le,Be,Ne,Ue,Ze,at=1;do{for(xe=oe,oe=null,Be=null,Ne=0;xe;){for(Ne++,Se=xe,Ue=0,Ae=0;Ae<at&&(Ue++,Se=Se.nextZ);Ae++);for(Ze=at;Ue>0||Ze>0&&Se;)0!==Ue&&(0===Ze||!Se||xe.z<=Se.z)?(Le=xe,xe=xe.nextZ,Ue--):(Le=Se,Se=Se.nextZ,Ze--),Be?Be.nextZ=Le:oe=Le,Le.prevZ=Be,Be=Le;xe=Se}Be.nextZ=null,at*=2}while(Ne>1)}(re)}(a,u,f,x);for(var S,P,F=a;a.prev!==a.next;)if(S=a.prev,P=a.next,x?Zv(a,u,f,x):B0(a))i.push(S.i/l),i.push(a.i/l),i.push(P.i/l),Ku(a),a=P.next,F=P.next;else if((a=P)===F){b?1===b?aA(a=Wv(zc(a),i,l),i,l,u,f,x,2):2===b&&Qv(a,i,l,u,f,x):aA(zc(a),i,l,u,f,x,1);break}}}function B0(a){var i=a.prev,l=a,u=a.next;if(Kr(i,l,u)>=0)return!1;for(var f=a.next.next;f!==a.prev;){if(Uo(i.x,i.y,l.x,l.y,u.x,u.y,f.x,f.y)&&Kr(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Zv(a,i,l,u){var f=a.prev,x=a,b=a.next;if(Kr(f,x,b)>=0)return!1;for(var S=f.x>x.x?f.x>b.x?f.x:b.x:x.x>b.x?x.x:b.x,P=f.y>x.y?f.y>b.y?f.y:b.y:x.y>b.y?x.y:b.y,F=Yu(f.x<x.x?f.x<b.x?f.x:b.x:x.x<b.x?x.x:b.x,f.y<x.y?f.y<b.y?f.y:b.y:x.y<b.y?x.y:b.y,i,l,u),N=Yu(S,P,i,l,u),U=a.prevZ,j=a.nextZ;U&&U.z>=F&&j&&j.z<=N;){if(U!==a.prev&&U!==a.next&&Uo(f.x,f.y,x.x,x.y,b.x,b.y,U.x,U.y)&&Kr(U.prev,U,U.next)>=0||(U=U.prevZ,j!==a.prev&&j!==a.next&&Uo(f.x,f.y,x.x,x.y,b.x,b.y,j.x,j.y)&&Kr(j.prev,j,j.next)>=0))return!1;j=j.nextZ}for(;U&&U.z>=F;){if(U!==a.prev&&U!==a.next&&Uo(f.x,f.y,x.x,x.y,b.x,b.y,U.x,U.y)&&Kr(U.prev,U,U.next)>=0)return!1;U=U.prevZ}for(;j&&j.z<=N;){if(j!==a.prev&&j!==a.next&&Uo(f.x,f.y,x.x,x.y,b.x,b.y,j.x,j.y)&&Kr(j.prev,j,j.next)>=0)return!1;j=j.nextZ}return!0}function Wv(a,i,l){var u=a;do{var f=u.prev,x=u.next.next;!cA(f,x)&&Dm(f,u,u.next,x)&&Nf(f,x)&&Nf(x,f)&&(i.push(f.i/l),i.push(u.i/l),i.push(x.i/l),Ku(u),Ku(u.next),u=a=x),u=u.next}while(u!==a);return zc(u)}function Qv(a,i,l,u,f,x){var b=a;do{for(var S=b.next.next;S!==b.prev;){if(b.i!==S.i&&lA(b,S)){var P=zf(b,S);return b=zc(b,b.next),P=zc(P,P.next),aA(b,i,l,u,f,x),void aA(P,i,l,u,f,x)}S=S.next}b=b.next}while(b!==a)}function Xv(a,i){return a.x-i.x}function a2(a,i){if(i=function(u,f){var x,b=f,S=u.x,P=u.y,F=-1/0;do{if(P<=b.y&&P>=b.next.y&&b.next.y!==b.y){var N=b.x+(P-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(N<=S&&N>F){if(F=N,N===S){if(P===b.y)return b;if(P===b.next.y)return b.next}x=b.x<b.next.x?b:b.next}}b=b.next}while(b!==f);if(!x)return null;if(S===F)return x;var U,j=x,q=x.x,re=x.y,oe=1/0;b=x;do{S>=b.x&&b.x>=q&&S!==b.x&&Uo(P<re?S:F,P,q,re,P<re?F:S,P,b.x,b.y)&&(U=Math.abs(P-b.y)/(S-b.x),Nf(b,u)&&(U<oe||U===oe&&(b.x>x.x||b.x===x.x&&Yv(x,b)))&&(x=b,oe=U)),b=b.next}while(b!==j);return x}(a,i)){var l=zf(i,a);zc(i,i.next),zc(l,l.next)}}function Yv(a,i){return Kr(a.prev,a,i.prev)<0&&Kr(i.next,a,a.next)<0}function Yu(a,i,l,u,f){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-l)*f)|a<<8))|a<<4))|a<<2))|a<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-u)*f)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function N0(a){var i=a,l=a;do{(i.x<l.x||i.x===l.x&&i.y<l.y)&&(l=i),i=i.next}while(i!==a);return l}function Uo(a,i,l,u,f,x,b,S){return(f-b)*(i-S)-(a-b)*(x-S)>=0&&(a-b)*(u-S)-(l-b)*(i-S)>=0&&(l-b)*(x-S)-(f-b)*(u-S)>=0}function lA(a,i){return a.next.i!==i.i&&a.prev.i!==i.i&&!function(l,u){var f=l;do{if(f.i!==l.i&&f.next.i!==l.i&&f.i!==u.i&&f.next.i!==u.i&&Dm(f,f.next,l,u))return!0;f=f.next}while(f!==l);return!1}(a,i)&&(Nf(a,i)&&Nf(i,a)&&function(l,u){var f=l,x=!1,b=(l.x+u.x)/2,S=(l.y+u.y)/2;do{f.y>S!=f.next.y>S&&f.next.y!==f.y&&b<(f.next.x-f.x)*(S-f.y)/(f.next.y-f.y)+f.x&&(x=!x),f=f.next}while(f!==l);return x}(a,i)&&(Kr(a.prev,a,i.prev)||Kr(a,i.prev,i))||cA(a,i)&&Kr(a.prev,a,a.next)>0&&Kr(i.prev,i,i.next)>0)}function Kr(a,i,l){return(i.y-a.y)*(l.x-i.x)-(i.x-a.x)*(l.y-i.y)}function cA(a,i){return a.x===i.x&&a.y===i.y}function Dm(a,i,l,u){var f=Sm(Kr(a,i,l)),x=Sm(Kr(a,i,u)),b=Sm(Kr(l,u,a)),S=Sm(Kr(l,u,i));return f!==x&&b!==S||!(0!==f||!Mm(a,l,i))||!(0!==x||!Mm(a,u,i))||!(0!==b||!Mm(l,a,u))||!(0!==S||!Mm(l,i,u))}function Mm(a,i,l){return i.x<=Math.max(a.x,l.x)&&i.x>=Math.min(a.x,l.x)&&i.y<=Math.max(a.y,l.y)&&i.y>=Math.min(a.y,l.y)}function Sm(a){return a>0?1:a<0?-1:0}function Nf(a,i){return Kr(a.prev,a,a.next)<0?Kr(a,i,a.next)>=0&&Kr(a,a.prev,i)>=0:Kr(a,i,a.prev)<0||Kr(a,a.next,i)<0}function zf(a,i){var l=new z0(a.i,a.x,a.y),u=new z0(i.i,i.x,i.y),f=a.next,x=i.prev;return a.next=i,i.prev=a,l.next=f,f.prev=l,u.next=l,l.prev=u,x.next=u,u.prev=x,u}function Vf(a,i,l,u){var f=new z0(a,i,l);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function Ku(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function z0(a,i,l){this.i=a,this.x=i,this.y=l,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function V0(a,i,l,u){for(var f=0,x=i,b=l-u;x<l;x+=u)f+=(a[b]-a[x])*(a[x+1]+a[b+1]),b=x;return f}function U0(a,i,l,u,f){j0(a,i,l||0,u||a.length-1,f||Kv)}function j0(a,i,l,u,f){for(;u>l;){if(u-l>600){var x=u-l+1,b=i-l+1,S=Math.log(x),P=.5*Math.exp(2*S/3),F=.5*Math.sqrt(S*P*(x-P)/x)*(b-x/2<0?-1:1);j0(a,i,Math.max(l,Math.floor(i-b*P/x+F)),Math.min(u,Math.floor(i+(x-b)*P/x+F)),f)}var N=a[i],U=l,j=u;for(uA(a,l,i),f(a[u],N)>0&&uA(a,l,u);U<j;){for(uA(a,U,j),U++,j--;f(a[U],N)<0;)U++;for(;f(a[j],N)>0;)j--}0===f(a[l],N)?uA(a,l,j):uA(a,++j,u),j<=i&&(l=j+1),i<=j&&(u=j-1)}}function uA(a,i,l){var u=a[i];a[i]=a[l],a[l]=u}function Kv(a,i){return a<i?-1:a>i?1:0}function Tm(a,i){const l=a.length;if(l<=1)return[a];const u=[];let f,x;for(let b=0;b<l;b++){const S=qa(a[b]);0!==S&&(a[b].area=Math.abs(S),void 0===x&&(x=S<0),x===S<0?(f&&u.push(f),f=[a[b]]):f.push(a[b]))}if(f&&u.push(f),i>1)for(let b=0;b<u.length;b++)u[b].length<=i||(U0(u[b],i,1,u[b].length-1,G0),u[b]=u[b].slice(0,i));return u}function G0(a,i){return i.area-a.area}function Zh(a,i,l){const u=l.patternDependencies;let f=!1;for(const x of i){const b=x.paint.get(`${a}-pattern`);b.isConstant()||(f=!0);const S=b.constantOr(null);S&&(f=!0,u[S.to]=!0,u[S.from]=!0)}return f}function Uf(a,i,l,u,f){const x=f.patternDependencies;for(const b of i){const S=b.paint.get(`${a}-pattern`).value;if("constant"!==S.kind){let P=S.evaluate({zoom:u-1},l,{},f.availableImages),F=S.evaluate({zoom:u},l,{},f.availableImages),N=S.evaluate({zoom:u+1},l,{},f.availableImages);P=P&&P.name?P.name:P,F=F&&F.name?F.name:F,N=N&&N.name?N.name:N,x[P]=!0,x[F]=!0,x[N]=!0,l.patterns[b.id]={min:P,mid:F,max:N}}}return l}Bf.deviation=function(a,i,l,u){var f=i&&i.length,x=Math.abs(V0(a,0,f?i[0]*l:a.length,l));if(f)for(var b=0,S=i.length;b<S;b++)x-=Math.abs(V0(a,i[b]*l,b<S-1?i[b+1]*l:a.length,l));var P=0;for(b=0;b<u.length;b+=3){var F=u[b]*l,N=u[b+1]*l,U=u[b+2]*l;P+=Math.abs((a[F]-a[U])*(a[N+1]-a[F+1])-(a[F]-a[N])*(a[U+1]-a[F+1]))}return 0===x&&0===P?0:Math.abs((P-x)/x)},Bf.flatten=function(a){for(var i=a[0][0].length,l={vertices:[],holes:[],dimensions:i},u=0,f=0;f<a.length;f++){for(var x=0;x<a[f].length;x++)for(var b=0;b<i;b++)l.vertices.push(a[f][x][b]);f>0&&l.holes.push(u+=a[f-1].length)}return l},Lf.default=qv;class hA{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new tn,this.indexArray=new Pn,this.indexArray2=new ci,this.programConfigurations=new ra(i.layers,i.zoom),this.segments=new Li,this.segments2=new Li,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,u){this.hasPattern=Zh("fill",this.layers,l);const f=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:b,id:S,index:P,sourceLayerIndex:F}of i){const N=this.layers[0]._featureFilter.needGeometry,U=qu(b,N);if(!this.layers[0]._featureFilter.filter(new te(this.zoom),U,u))continue;const j=f?f.evaluate(U,{},u,l.availableImages):void 0,q={id:S,properties:b.properties,type:b.type,sourceLayerIndex:F,index:P,geometry:N?U.geometry:ia(b),patterns:{},sortKey:j};x.push(q)}f&&x.sort((b,S)=>b.sortKey-S.sortKey);for(const b of x){const{geometry:S,index:P,sourceLayerIndex:F}=b;if(this.hasPattern){const N=Uf("fill",this.layers,b,this.zoom,l);this.patternFeatures.push(N)}else this.addFeature(b,S,P,u,{});l.featureIndex.insert(i[P].feature,S,P,F,this.index)}}update(i,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,u)}addFeatures(i,l,u){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,l,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,sl),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,l,u,f,x){for(const b of Tm(l,500)){let S=0;for(const q of b)S+=q.length;const P=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),F=P.vertexLength,N=[],U=[];for(const q of b){if(0===q.length)continue;q!==b[0]&&U.push(N.length/2);const re=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),oe=re.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(oe+q.length-1,oe),N.push(q[0].x),N.push(q[0].y);for(let Ae=1;Ae<q.length;Ae++)this.layoutVertexArray.emplaceBack(q[Ae].x,q[Ae].y),this.indexArray2.emplaceBack(oe+Ae-1,oe+Ae),N.push(q[Ae].x),N.push(q[Ae].y);re.vertexLength+=q.length,re.primitiveLength+=q.length}const j=Lf(N,U);for(let q=0;q<j.length;q+=3)this.indexArray.emplaceBack(F+j[q],F+j[q+1],F+j[q+2]);P.vertexLength+=S,P.primitiveLength+=j.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,x,f)}}Ft("FillBucket",hA,{omit:["layers","patternFeatures"]});const Jv=new Ge({"fill-sort-key":new Fe(Ce.layout_fill["fill-sort-key"])});var Vr={paint:new Ge({"fill-antialias":new de(Ce.paint_fill["fill-antialias"]),"fill-opacity":new Fe(Ce.paint_fill["fill-opacity"]),"fill-color":new Fe(Ce.paint_fill["fill-color"]),"fill-outline-color":new Fe(Ce.paint_fill["fill-outline-color"]),"fill-translate":new de(Ce.paint_fill["fill-translate"]),"fill-translate-anchor":new de(Ce.paint_fill["fill-translate-anchor"]),"fill-pattern":new Xe(Ce.paint_fill["fill-pattern"])}),layout:Jv};const e1=It([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),t1=It([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:Im}=e1;var km=Wh;function Wh(a,i,l,u,f){this.properties={},this.extent=l,this.type=0,this._pbf=a,this._geometry=-1,this._keys=u,this._values=f,a.readFields(n1,this,i)}function n1(a,i,l){1==a?i.id=l.readVarint():2==a?function(u,f){for(var x=u.readVarint()+u.pos;u.pos<x;){var b=f._keys[u.readVarint()],S=f._values[u.readVarint()];f.properties[b]=S}}(l,i):3==a?i.type=l.readVarint():4==a&&(i._geometry=l.pos)}function r1(a){for(var i,l,u=0,f=0,x=a.length,b=x-1;f<x;b=f++)u+=((l=a[b]).x-(i=a[f]).x)*(i.y+l.y);return u}Wh.types=["Unknown","Point","LineString","Polygon"],Wh.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var i,l=a.readVarint()+a.pos,u=1,f=0,x=0,b=0,S=[];a.pos<l;){if(f<=0){var P=a.readVarint();u=7&P,f=P>>3}if(f--,1===u||2===u)x+=a.readSVarint(),b+=a.readSVarint(),1===u&&(i&&S.push(i),i=[]),i.push(new dt(x,b));else{if(7!==u)throw new Error("unknown command "+u);i&&i.push(i[0].clone())}}return i&&S.push(i),S},Wh.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var i=a.readVarint()+a.pos,l=1,u=0,f=0,x=0,b=1/0,S=-1/0,P=1/0,F=-1/0;a.pos<i;){if(u<=0){var N=a.readVarint();l=7&N,u=N>>3}if(u--,1===l||2===l)(f+=a.readSVarint())<b&&(b=f),f>S&&(S=f),(x+=a.readSVarint())<P&&(P=x),x>F&&(F=x);else if(7!==l)throw new Error("unknown command "+l)}return[b,P,S,F]},Wh.prototype.toGeoJSON=function(a,i,l){var u,f,x=this.extent*Math.pow(2,l),b=this.extent*a,S=this.extent*i,P=this.loadGeometry(),F=Wh.types[this.type];function N(q){for(var re=0;re<q.length;re++){var oe=q[re];q[re]=[360*(oe.x+b)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(oe.y+S)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var U=[];for(u=0;u<P.length;u++)U[u]=P[u][0];N(P=U);break;case 2:for(u=0;u<P.length;u++)N(P[u]);break;case 3:for(P=function(q){var re=q.length;if(re<=1)return[q];for(var oe,Ae,xe=[],Se=0;Se<re;Se++){var Le=r1(q[Se]);0!==Le&&(void 0===Ae&&(Ae=Le<0),Ae===Le<0?(oe&&xe.push(oe),oe=[q[Se]]):oe.push(q[Se]))}return oe&&xe.push(oe),xe}(P),u=0;u<P.length;u++)for(f=0;f<P[u].length;f++)N(P[u][f])}1===P.length?P=P[0]:F="Multi"+F;var j={type:"Feature",geometry:{type:F,coordinates:P},properties:this.properties};return"id"in this&&(j.id=this.id),j};var $0=H0;function H0(a,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(l2,this,i),this.length=this._features.length}function l2(a,i,l){15===a?i.version=l.readVarint():1===a?i.name=l.readString():5===a?i.extent=l.readVarint():2===a?i._features.push(l.pos):3===a?i._keys.push(l.readString()):4===a&&i._values.push(function(u){for(var f=null,x=u.readVarint()+u.pos;u.pos<x;){var b=u.readVarint()>>3;f=1===b?u.readString():2===b?u.readFloat():3===b?u.readDouble():4===b?u.readVarint64():5===b?u.readVarint():6===b?u.readSVarint():7===b?u.readBoolean():null}return f}(l))}function c2(a,i,l){if(3===a){var u=new $0(l,l.readVarint()+l.pos);u.length&&(i[u.name]=u)}}H0.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var i=this._pbf.readVarint()+this._pbf.pos;return new km(this._pbf,i,this.extent,this._keys,this._values)};var Fa={VectorTile:function(a,i){this.layers=a.readFields(c2,{},i)},VectorTileFeature:km,VectorTileLayer:$0};const jo=Fa.VectorTileFeature.types,Pm=Math.pow(2,13);function Qh(a,i,l,u,f,x,b,S){a.emplaceBack((i<<1)+b,(l<<1)+x,(Math.floor(u*Pm)<<1)+f,Math.round(S))}class Rm{constructor(){this.acc=new dt(0,0),this.polyCount=[]}startRing(i){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new dt(i.x,i.y),this.max=new dt(i.x,i.y))}append(i,l){this.currentPolyCount.edges++,this.acc._add(i);let u=!!this.borders;const f=this.min,x=this.max;i.x<f.x?(f.x=i.x,u=!0):i.x>x.x&&(x.x=i.x,u=!0),i.y<f.y?(f.y=i.y,u=!0):i.y>x.y&&(x.y=i.y,u=!0),((0===i.x||i.x===ur)&&i.x===l.x)!=((0===i.y||i.y===ur)&&i.y===l.y)&&this.processBorderOverlap(i,l),u&&this.checkBorderIntersection(i,l)}checkBorderIntersection(i,l){l.x<0!=i.x<0&&this.addBorderIntersection(0,At(l.y,i.y,(0-l.x)/(i.x-l.x))),l.x>ur!=i.x>ur&&this.addBorderIntersection(1,At(l.y,i.y,(ur-l.x)/(i.x-l.x))),l.y<0!=i.y<0&&this.addBorderIntersection(2,At(l.x,i.x,(0-l.y)/(i.y-l.y))),l.y>ur!=i.y>ur&&this.addBorderIntersection(3,At(l.x,i.x,(ur-l.y)/(i.y-l.y)))}addBorderIntersection(i,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[i];l<u[0]&&(u[0]=l),l>u[1]&&(u[1]=l)}processBorderOverlap(i,l){if(i.x===l.x){if(i.y===l.y)return;const u=0===i.x?0:1;this.addBorderIntersection(u,l.y),this.addBorderIntersection(u,i.y)}else{const u=0===i.y?2:3;this.addBorderIntersection(u,l.x),this.addBorderIntersection(u,i.x)}}centroid(){const i=this.polyCount.reduce((l,u)=>l+u.edges,0);return 0!==i?this.acc.div(i)._round():new dt(0,0)}span(){return new dt(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((i,l)=>i+ +(l[0]!==Number.MAX_VALUE),0)}}class ao{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new $r,this.centroidVertexArray=new Pv,this.indexArray=new Pn,this.programConfigurations=new ra(i.layers,i.zoom),this.segments=new Li,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.enableTerrain=i.enableTerrain}populate(i,l,u){this.features=[],this.hasPattern=Zh("fill-extrusion",this.layers,l),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(f){const x=Math.exp(Math.PI*(1-f.y/(1<<f.z)*2));return 80150034*x/(x*x+1)/ur/(1<<f.z)}(u);for(const{feature:f,id:x,index:b,sourceLayerIndex:S}of i){const P=this.layers[0]._featureFilter.needGeometry,F=qu(f,P);if(!this.layers[0]._featureFilter.filter(new te(this.zoom),F,u))continue;const N={id:x,sourceLayerIndex:S,index:b,geometry:P?F.geometry:ia(f),properties:f.properties,type:f.type,patterns:{}},U=this.layoutVertexArray.length;this.hasPattern?this.features.push(Uf("fill-extrusion",this.layers,N,this.zoom,l)):this.addFeature(N,N.geometry,b,u,{}),l.featureIndex.insert(f,N.geometry,b,S,this.index,U)}this.sortBorders()}addFeatures(i,l,u){for(const f of this.features){const{geometry:x}=f;this.addFeature(f,x,f.index,l,u)}this.sortBorders()}update(i,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Im),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,t1.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,l,u,f,x){const b=this.enableTerrain?new Rm:null;for(const P of Tm(l,500)){let F=0,N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(0===P.length||(S=P[0]).every(oe=>oe.x<=0)||S.every(oe=>oe.x>=ur)||S.every(oe=>oe.y<=0)||S.every(oe=>oe.y>=ur))continue;for(let oe=0;oe<P.length;oe++){const Ae=P[oe];if(0===Ae.length)continue;F+=Ae.length;let xe=0;b&&b.startRing(Ae[0]);for(let Se=0;Se<Ae.length;Se++){const Le=Ae[Se];if(Se>=1){const Be=Ae[Se-1];if(!dA(Le,Be)){b&&b.append(Le,Be),N.vertexLength+4>Li.MAX_VERTEX_ARRAY_LENGTH&&(N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ne=Le.sub(Be)._perp(),Ue=Ne.x/(Math.abs(Ne.x)+Math.abs(Ne.y)),Ze=Ne.y>0?1:0,at=Be.dist(Le);xe+at>32768&&(xe=0),Qh(this.layoutVertexArray,Le.x,Le.y,Ue,Ze,0,0,xe),Qh(this.layoutVertexArray,Le.x,Le.y,Ue,Ze,0,1,xe),xe+=at,Qh(this.layoutVertexArray,Be.x,Be.y,Ue,Ze,0,0,xe),Qh(this.layoutVertexArray,Be.x,Be.y,Ue,Ze,0,1,xe);const pt=N.vertexLength;this.indexArray.emplaceBack(pt,pt+2,pt+1),this.indexArray.emplaceBack(pt+1,pt+2,pt+3),N.vertexLength+=4,N.primitiveLength+=2}}}}if(N.vertexLength+F>Li.MAX_VERTEX_ARRAY_LENGTH&&(N=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray)),"Polygon"!==jo[i.type])continue;const U=[],j=[],q=N.vertexLength;for(let oe=0;oe<P.length;oe++){const Ae=P[oe];if(0!==Ae.length){Ae!==P[0]&&j.push(U.length/2);for(let xe=0;xe<Ae.length;xe++){const Se=Ae[xe];Qh(this.layoutVertexArray,Se.x,Se.y,0,0,1,1,0),U.push(Se.x),U.push(Se.y),b&&b.currentPolyCount.top++}}}const re=Lf(U,j);for(let oe=0;oe<re.length;oe+=3)this.indexArray.emplaceBack(q+re[oe],q+re[oe+2],q+re[oe+1]);N.primitiveLength+=re.length/3,N.vertexLength+=F}var S;if(b&&b.polyCount.length>0){if(b.borders){b.vertexArrayOffset=this.centroidVertexArray.length;const P=b.borders,F=this.featuresOnBorder.push(b)-1;for(let N=0;N<4;N++)P[N][0]!==Number.MAX_VALUE&&this.borders[N].push(F)}this.encodeCentroid(b.borders?void 0:b.centroid(),b)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,x,f)}sortBorders(){for(let i=0;i<4;i++)this.borders[i].sort((l,u)=>this.featuresOnBorder[l].borders[i][0]-this.featuresOnBorder[u].borders[i][0])}encodeCentroid(i,l,u=!0){let f,x;if(i)if(0!==i.y){const S=l.span()._mult(this.tileToMeter);f=(Math.max(i.x,1)<<3)+Math.min(7,Math.round(S.x/10)),x=(Math.max(i.y,1)<<3)+Math.min(7,Math.round(S.y/10))}else f=Math.ceil(7*(i.x+450)),x=0;else f=0,x=+u;let b=u?this.centroidVertexArray.length:l.vertexArrayOffset;for(const S of l.polyCount){u&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*S.edges+S.top);for(let P=0;P<2*S.edges;P++)this.centroidVertexArray.emplace(b++,0,x),this.centroidVertexArray.emplace(b++,f,x);for(let P=0;P<S.top;P++)this.centroidVertexArray.emplace(b++,f,x)}}}function dA(a,i){return a.x===i.x&&(a.x<0||a.x>ur)||a.y===i.y&&(a.y<0||a.y>ur)}Ft("FillExtrusionBucket",ao,{omit:["layers","features"]}),Ft("PartMetadata",Rm);var Fm={paint:new Ge({"fill-extrusion-opacity":new de(Ce["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Fe(Ce["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new de(Ce["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new de(Ce["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Xe(Ce["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Fe(Ce["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Fe(Ce["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new de(Ce["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function AA(a,i){return a.x*i.x+a.y*i.y}function q0(a,i){if(1===a.length){let l=0;const u=i[l++];let f;for(;!f||u.equals(f);)if(f=i[l++],!f)return 1/0;for(;l<i.length;l++){const x=i[l],b=a[0],S=f.sub(u),P=x.sub(u),F=b.sub(u),N=AA(S,S),U=AA(S,P),j=AA(P,P),q=AA(F,S),re=AA(F,P),oe=N*j-U*U,Ae=(j*q-U*re)/oe,xe=(N*re-U*q)/oe,Se=u.z*(1-Ae-xe)+f.z*Ae+x.z*xe;if(isFinite(Se))return Se}return 1/0}{let l=1/0;for(const u of i)l=Math.min(l,u.z);return l}}function Om(a){const i=new dt(a[0],a[1]);return i.z=a[2],i}function i1(a,i,l,u,f,x,b,S){const P=b*f.getElevationAt(a,i,!0,!0),F=0!==x[0],N=F?0===x[1]?b*(x[0]/7-450):b*function(U,j,q){const re=Math.floor(j[0]/8),oe=Math.floor(j[1]/8),Ae=10*(j[0]-8*re),xe=10*(j[1]-8*oe),Se=U.getElevationAt(re,oe,!0,!0),Le=U.getMeterToDEM(q),Be=Math.floor(.5*(Ae*Le-1)),Ne=Math.floor(.5*(xe*Le-1)),Ue=U.tileCoordToPixel(re,oe),Ze=2*Be+1,at=2*Ne+1,pt=(en=Ze,Tn=at,[(Jt=U).getElevationAtPixel(Tt=Ue.x-Be,nr=Ue.y-Ne,!0),Jt.getElevationAtPixel(Tt+Tn,nr,!0),Jt.getElevationAtPixel(Tt,nr+Tn,!0),Jt.getElevationAtPixel(Tt+en,nr+Tn,!0)]),gt=Math.abs(pt[0]-pt[1]),nt=Math.abs(pt[2]-pt[3]),st=Math.abs(pt[0]-pt[2])+Math.abs(pt[1]-pt[3]),xt=Math.min(.25,.5*Le*(gt+nt)/Ze),ot=Math.min(.25,.5*Le*st/at);var Jt,Tt,nr,en,Tn;return Se+Math.max(xt*Ae,ot*xe)}(f,x,S):P;return{base:P+(0===l)?-1:l,top:F?Math.max(N+u,P+l+2):P+u}}const Z0=It([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:o1}=Z0,W0=It([{name:"a_packed",components:3,type:"Float32"}]),{members:s1}=W0,a1=Fa.VectorTileFeature.types,l1=Math.cos(Math.PI/180*37.5);class jf{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new Cr,this.layoutVertexArray2=new hn,this.indexArray=new Pn,this.programConfigurations=new ra(i.layers,i.zoom),this.segments=new Li,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(i,l,u){this.hasPattern=Zh("line",this.layers,l);const f=this.layers[0].layout.get("line-sort-key"),x=[];for(const{feature:F,id:N,index:U,sourceLayerIndex:j}of i){const q=this.layers[0]._featureFilter.needGeometry,re=qu(F,q);if(!this.layers[0]._featureFilter.filter(new te(this.zoom),re,u))continue;const oe=f?f.evaluate(re,{},u):void 0,Ae={id:N,properties:F.properties,type:F.type,sourceLayerIndex:j,index:U,geometry:q?re.geometry:ia(F),patterns:{},sortKey:oe};x.push(Ae)}f&&x.sort((F,N)=>F.sortKey-N.sortKey);const{lineAtlas:b,featureIndex:S}=l,P=this.addConstantDashes(b);for(const F of x){const{geometry:N,index:U,sourceLayerIndex:j}=F;if(P&&this.addFeatureDashes(F,b),this.hasPattern){const q=Uf("line",this.layers,F,this.zoom,l);this.patternFeatures.push(q)}else this.addFeature(F,N,U,u,b.positions);S.insert(i[U].feature,N,U,j,this.index)}}addConstantDashes(i){let l=!1;for(const u of this.layers){const f=u.paint.get("line-dasharray").value,x=u.layout.get("line-cap").value;if("constant"!==f.kind||"constant"!==x.kind)l=!0;else{const b=x.value,S=f.value;if(!S)continue;i.addDash(S.from,b),i.addDash(S.to,b),S.other&&i.addDash(S.other,b)}}return l}addFeatureDashes(i,l){const u=this.zoom;for(const f of this.layers){const x=f.paint.get("line-dasharray").value,b=f.layout.get("line-cap").value;if("constant"===x.kind&&"constant"===b.kind)continue;let S,P,F,N,U,j;if("constant"===x.kind){const Ae=x.value;if(!Ae)continue;S=Ae.other||Ae.to,P=Ae.to,F=Ae.from}else S=x.evaluate({zoom:u-1},i),P=x.evaluate({zoom:u},i),F=x.evaluate({zoom:u+1},i);"constant"===b.kind?N=U=j=b.value:(N=b.evaluate({zoom:u-1},i),U=b.evaluate({zoom:u},i),j=b.evaluate({zoom:u+1},i)),l.addDash(S,N),l.addDash(P,U),l.addDash(F,j);const q=l.getKey(S,N),re=l.getKey(P,U),oe=l.getKey(F,j);i.patterns[f.id]={min:q,mid:re,max:oe}}}update(i,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,l,this.stateDependentLayers,u)}addFeatures(i,l,u){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,l,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,s1)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,o1),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,l,u,f,x){const b=this.layers[0].layout,S=b.get("line-join").evaluate(i,{}),P=b.get("line-cap").evaluate(i,{}),F=b.get("line-miter-limit"),N=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const U of l)this.addLine(U,i,S,P,F,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,x,f)}addLine(i,l,u,f,x,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let xe=0;xe<i.length-1;xe++)this.totalDistance+=i[xe].dist(i[xe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const S="Polygon"===a1[l.type];let P=i.length;for(;P>=2&&i[P-1].equals(i[P-2]);)P--;let F=0;for(;F<P-1&&i[F].equals(i[F+1]);)F++;if(P<(S?3:2))return;"bevel"===u&&(x=1.05);const N=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let j,q,re,oe,Ae;this.e1=this.e2=-1,S&&(j=i[P-2],Ae=i[F].sub(j)._unit()._perp());for(let xe=F;xe<P;xe++){if(re=xe===P-1?S?i[F+1]:void 0:i[xe+1],re&&i[xe].equals(re))continue;Ae&&(oe=Ae),j&&(q=j),j=i[xe],Ae=re?re.sub(j)._unit()._perp():oe,oe=oe||Ae;let Se=oe.add(Ae);0===Se.x&&0===Se.y||Se._unit();const Le=oe.x*Ae.x+oe.y*Ae.y,Be=Se.x*Ae.x+Se.y*Ae.y,Ne=0!==Be?1/Be:1/0,Ue=2*Math.sqrt(2-2*Be),Ze=Be<l1&&q&&re,at=oe.x*Ae.y-oe.y*Ae.x>0;if(Ze&&xe>F){const nt=j.dist(q);if(nt>2*N){const st=j.sub(j.sub(q)._mult(N/nt)._round());this.updateDistance(q,st),this.addCurrentVertex(st,oe,0,0,U),q=st}}const pt=q&&re;let gt=pt?u:S?"butt":f;if(pt&&"round"===gt&&(Ne<b?gt="miter":Ne<=2&&(gt="fakeround")),"miter"===gt&&Ne>x&&(gt="bevel"),"bevel"===gt&&(Ne>2&&(gt="flipbevel"),Ne<x&&(gt="miter")),q&&this.updateDistance(q,j),"miter"===gt)Se._mult(Ne),this.addCurrentVertex(j,Se,0,0,U);else if("flipbevel"===gt){if(Ne>100)Se=Ae.mult(-1);else{const nt=Ne*oe.add(Ae).mag()/oe.sub(Ae).mag();Se._perp()._mult(nt*(at?-1:1))}this.addCurrentVertex(j,Se,0,0,U),this.addCurrentVertex(j,Se.mult(-1),0,0,U)}else if("bevel"===gt||"fakeround"===gt){const nt=-Math.sqrt(Ne*Ne-1),st=at?nt:0,xt=at?0:nt;if(q&&this.addCurrentVertex(j,oe,st,xt,U),"fakeround"===gt){const ot=Math.round(180*Ue/Math.PI/20);for(let Jt=1;Jt<ot;Jt++){let Tt=Jt/ot;if(.5!==Tt){const en=Tt-.5;Tt+=Tt*en*(Tt-1)*((1.0904+Le*(Le*(3.55645-1.43519*Le)-3.2452))*en*en+(.848013+Le*(.215638*Le-1.06021)))}const nr=Ae.sub(oe)._mult(Tt)._add(oe)._unit()._mult(at?-1:1);this.addHalfVertex(j,nr.x,nr.y,!1,at,0,U)}}re&&this.addCurrentVertex(j,Ae,-st,-xt,U)}else if("butt"===gt)this.addCurrentVertex(j,Se,0,0,U);else if("square"===gt){const nt=q?1:-1;q||this.addCurrentVertex(j,Se,nt,nt,U),this.addCurrentVertex(j,Se,0,0,U),q&&this.addCurrentVertex(j,Se,nt,nt,U)}else"round"===gt&&(q&&(this.addCurrentVertex(j,oe,0,0,U),this.addCurrentVertex(j,oe,1,1,U,!0)),re&&(this.addCurrentVertex(j,Ae,-1,-1,U,!0),this.addCurrentVertex(j,Ae,0,0,U)));if(Ze&&xe<P-1){const nt=j.dist(re);if(nt>2*N){const st=j.add(re.sub(j)._mult(N/nt)._round());this.updateDistance(j,st),this.addCurrentVertex(st,Ae,0,0,U),j=st}}}}addCurrentVertex(i,l,u,f,x,b=!1){const S=l.y*f-l.x,P=-l.y-l.x*f;this.addHalfVertex(i,l.x+l.y*u,l.y-l.x*u,b,!1,u,x),this.addHalfVertex(i,S,P,b,!0,-f,x)}addHalfVertex({x:i,y:l},u,f,x,b,S,P){this.layoutVertexArray.emplaceBack((i<<1)+(x?1:0),(l<<1)+(b?1:0),Math.round(63*u)+128,Math.round(63*f)+128,1+(0===S?0:S<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const F=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,F),P.primitiveLength++),b?this.e2=F:this.e1=F}updateScaledDistance(){if(this.lineClips){const i=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=i*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(i,l){this.distance+=i.dist(l),this.updateScaledDistance()}}Ft("LineBucket",jf,{omit:["layers","patternFeatures"]});const Lm=new Ge({"line-cap":new Fe(Ce.layout_line["line-cap"]),"line-join":new Fe(Ce.layout_line["line-join"]),"line-miter-limit":new de(Ce.layout_line["line-miter-limit"]),"line-round-limit":new de(Ce.layout_line["line-round-limit"]),"line-sort-key":new Fe(Ce.layout_line["line-sort-key"])});var Bm={paint:new Ge({"line-opacity":new Fe(Ce.paint_line["line-opacity"]),"line-color":new Fe(Ce.paint_line["line-color"]),"line-translate":new de(Ce.paint_line["line-translate"]),"line-translate-anchor":new de(Ce.paint_line["line-translate-anchor"]),"line-width":new Fe(Ce.paint_line["line-width"]),"line-gap-width":new Fe(Ce.paint_line["line-gap-width"]),"line-offset":new Fe(Ce.paint_line["line-offset"]),"line-blur":new Fe(Ce.paint_line["line-blur"]),"line-dasharray":new Xe(Ce.paint_line["line-dasharray"]),"line-pattern":new Xe(Ce.paint_line["line-pattern"]),"line-gradient":new Pe(Ce.paint_line["line-gradient"])}),layout:Lm};const Q0=new class extends Fe{possiblyEvaluate(a,i){return i=new te(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(a,i)}evaluate(a,i,l,u){return i=Ai({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(a,i,l,u)}}(Bm.paint.properties["line-width"].specification);function c1(a,i){return i>0?i+2*a:a}Q0.useIntegerZoom=!0;const X0=It([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),Gf=It([{name:"a_projected_pos",components:3,type:"Float32"}],4);It([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const u1=It([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),h1=It([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);It([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Vc=It([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),d1=It([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);It([{name:"triangle",components:3,type:"Uint16"}]),It([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),It([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),It([{type:"Float32",name:"offsetX"}]),It([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const al=128;function Nm(a,i){const{expression:l}=i;if("constant"===l.kind)return{kind:"constant",layoutSize:l.evaluate(new te(a+1))};if("source"===l.kind)return{kind:"source"};{const{zoomStops:u,interpolationType:f}=l;let x=0;for(;x<u.length&&u[x]<=a;)x++;x=Math.max(0,x-1);let b=x;for(;b<u.length&&u[b]<a+1;)b++;b=Math.min(u.length-1,b);const S=u[x],P=u[b];return"composite"===l.kind?{kind:"composite",minZoom:S,maxZoom:P,interpolationType:f}:{kind:"camera",minZoom:S,maxZoom:P,minSize:l.evaluate(new te(S)),maxSize:l.evaluate(new te(P)),interpolationType:f}}}function $f(a,{uSize:i,uSizeT:l},{lowerSize:u,upperSize:f}){return"source"===a.kind?u/al:"composite"===a.kind?At(u/al,f/al,l):i}function jl(a,i){let l=0,u=0;if("constant"===a.kind)u=a.layoutSize;else if("source"!==a.kind){const{interpolationType:f,minZoom:x,maxZoom:b}=a,S=f?di(Ln.interpolationFactor(f,i,x,b),0,1):0;"camera"===a.kind?u=At(a.minSize,a.maxSize,S):l=S}return{uSizeT:l,uSize:u}}var sa=Object.freeze({__proto__:null,getSizeData:Nm,evaluateSizeForFeature:$f,evaluateSizeForZoom:jl,SIZE_PACK_FACTOR:al});function Y0(a,i,l){return a.sections.forEach(u=>{u.text=function(f,x,b){const S=x.layout.get("text-transform").evaluate(b,{});return"uppercase"===S?f=f.toLocaleUpperCase():"lowercase"===S&&(f=f.toLocaleLowerCase()),J.applyArabicShaping&&(f=J.applyArabicShaping(f)),f}(u.text,i,l)}),a}const fA={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function A1(a){return"\ufe36"===a||"\ufe48"===a||"\ufe38"===a||"\ufe44"===a||"\ufe42"===a||"\ufe3e"===a||"\ufe3c"===a||"\ufe3a"===a||"\ufe18"===a||"\ufe40"===a||"\ufe10"===a||"\ufe13"===a||"\ufe14"===a||"\uff40"===a||"\uffe3"===a||"\ufe11"===a||"\ufe12"===a}function K0(a){return"\ufe35"===a||"\ufe47"===a||"\ufe37"===a||"\ufe43"===a||"\ufe41"===a||"\ufe3d"===a||"\ufe3b"===a||"\ufe39"===a||"\ufe17"===a||"\ufe3f"===a}var f1=function(a,i,l,u,f){var x,b,S=8*f-u-1,P=(1<<S)-1,F=P>>1,N=-7,U=l?f-1:0,j=l?-1:1,q=a[i+U];for(U+=j,x=q&(1<<-N)-1,q>>=-N,N+=S;N>0;x=256*x+a[i+U],U+=j,N-=8);for(b=x&(1<<-N)-1,x>>=-N,N+=u;N>0;b=256*b+a[i+U],U+=j,N-=8);if(0===x)x=1-F;else{if(x===P)return b?NaN:1/0*(q?-1:1);b+=Math.pow(2,u),x-=F}return(q?-1:1)*b*Math.pow(2,x-u)},zm=function(a,i,l,u,f,x){var b,S,P,F=8*x-f-1,N=(1<<F)-1,U=N>>1,j=23===f?Math.pow(2,-24)-Math.pow(2,-77):0,q=u?0:x-1,re=u?1:-1,oe=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(S=isNaN(i)?1:0,b=N):(b=Math.floor(Math.log(i)/Math.LN2),i*(P=Math.pow(2,-b))<1&&(b--,P*=2),(i+=b+U>=1?j/P:j*Math.pow(2,1-U))*P>=2&&(b++,P/=2),b+U>=N?(S=0,b=N):b+U>=1?(S=(i*P-1)*Math.pow(2,f),b+=U):(S=i*Math.pow(2,U-1)*Math.pow(2,f),b=0));f>=8;a[l+q]=255&S,q+=re,S/=256,f-=8);for(b=b<<f|S,F+=f;F>0;a[l+q]=255&b,q+=re,b/=256,F-=8);a[l+q-re]|=128*oe},pA=yr;function yr(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}yr.Varint=0,yr.Fixed64=1,yr.Bytes=2,yr.Fixed32=5;var Vm=4294967296,Ju=1/Vm,Oa="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Uc(a){return a.type===yr.Bytes?a.readVarint()+a.pos:a.pos+1}function Um(a,i,l){var u=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));l.realloc(u);for(var f=l.pos-1;f>=a;f--)l.buf[f+u]=l.buf[f]}function u2(a,i){for(var l=0;l<a.length;l++)i.writeVarint(a[l])}function ks(a,i){for(var l=0;l<a.length;l++)i.writeSVarint(a[l])}function jm(a,i){for(var l=0;l<a.length;l++)i.writeFloat(a[l])}function Gm(a,i){for(var l=0;l<a.length;l++)i.writeDouble(a[l])}function p1(a,i){for(var l=0;l<a.length;l++)i.writeBoolean(a[l])}function J0(a,i){for(var l=0;l<a.length;l++)i.writeFixed32(a[l])}function gA(a,i){for(var l=0;l<a.length;l++)i.writeSFixed32(a[l])}function e_(a,i){for(var l=0;l<a.length;l++)i.writeFixed64(a[l])}function t_(a,i){for(var l=0;l<a.length;l++)i.writeSFixed64(a[l])}function Xh(a,i){return(a[i]|a[i+1]<<8|a[i+2]<<16)+16777216*a[i+3]}function jc(a,i,l){a[l]=i,a[l+1]=i>>>8,a[l+2]=i>>>16,a[l+3]=i>>>24}function $m(a,i){return(a[i]|a[i+1]<<8|a[i+2]<<16)+(a[i+3]<<24)}function h2(a,i,l){i.glyphs=[],1===a&&l.readMessage(Yh,i)}function Yh(a,i,l){if(3===a){const{id:u,bitmap:f,width:x,height:b,left:S,top:P,advance:F}=l.readMessage(Hm,{});i.glyphs.push({id:u,bitmap:new Nc({width:x+6,height:b+6},f),metrics:{width:x,height:b,left:S,top:P,advance:F}})}else 4===a?i.ascender=l.readSVarint():5===a&&(i.descender=l.readSVarint())}function Hm(a,i,l){1===a?i.id=l.readVarint():2===a?i.bitmap=l.readBytes():3===a?i.width=l.readVarint():4===a?i.height=l.readVarint():5===a?i.left=l.readSVarint():6===a?i.top=l.readSVarint():7===a&&(i.advance=l.readVarint())}function Hf(a){let i=0,l=0;for(const b of a)i+=b.w*b.h,l=Math.max(l,b.w);a.sort((b,S)=>S.h-b.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),l),h:1/0}];let f=0,x=0;for(const b of a)for(let S=u.length-1;S>=0;S--){const P=u[S];if(!(b.w>P.w||b.h>P.h)){if(b.x=P.x,b.y=P.y,x=Math.max(x,b.y+b.h),f=Math.max(f,b.x+b.w),b.w===P.w&&b.h===P.h){const F=u.pop();S<u.length&&(u[S]=F)}else b.h===P.h?(P.x+=b.w,P.w-=b.w):b.w===P.w?(P.y+=b.h,P.h-=b.h):(u.push({x:P.x+b.w,y:P.y,w:P.w-b.w,h:b.h}),P.y+=b.h,P.h-=b.h);break}}return{w:f,h:x,fill:i/(f*x)||0}}yr.prototype={destroy:function(){this.buf=null},readFields:function(a,i,l){for(l=l||this.length;this.pos<l;){var u=this.readVarint(),f=u>>3,x=this.pos;this.type=7&u,a(f,i,this),this.pos===x&&this.skip(u)}return i},readMessage:function(a,i){return this.readFields(a,i,this.readVarint()+this.pos)},readFixed32:function(){var a=Xh(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=$m(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=Xh(this.buf,this.pos)+Xh(this.buf,this.pos+4)*Vm;return this.pos+=8,a},readSFixed64:function(){var a=Xh(this.buf,this.pos)+$m(this.buf,this.pos+4)*Vm;return this.pos+=8,a},readFloat:function(){var a=f1(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=f1(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var i,l,u=this.buf;return i=127&(l=u[this.pos++]),l<128?i:(i|=(127&(l=u[this.pos++]))<<7,l<128?i:(i|=(127&(l=u[this.pos++]))<<14,l<128?i:(i|=(127&(l=u[this.pos++]))<<21,l<128?i:function(f,x,b){var S,P,F=b.buf;if(S=(112&(P=F[b.pos++]))>>4,P<128||(S|=(127&(P=F[b.pos++]))<<3,P<128)||(S|=(127&(P=F[b.pos++]))<<10,P<128)||(S|=(127&(P=F[b.pos++]))<<17,P<128)||(S|=(127&(P=F[b.pos++]))<<24,P<128)||(S|=(1&(P=F[b.pos++]))<<31,P<128))return function(a,i,l){return l?4294967296*i+(a>>>0):4294967296*(i>>>0)+(a>>>0)}(f,S,x);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(l=u[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,i=this.pos;return this.pos=a,a-i>=12&&Oa?Oa.decode(this.buf.subarray(i,a)):function(l,u,f){for(var x="",b=u;b<f;){var S,P,F,N=l[b],U=null,j=N>239?4:N>223?3:N>191?2:1;if(b+j>f)break;1===j?N<128&&(U=N):2===j?128==(192&(S=l[b+1]))&&(U=(31&N)<<6|63&S)<=127&&(U=null):3===j?(P=l[b+2],128==(192&(S=l[b+1]))&&128==(192&P)&&((U=(15&N)<<12|(63&S)<<6|63&P)<=2047||U>=55296&&U<=57343)&&(U=null)):4===j&&(P=l[b+2],F=l[b+3],128==(192&(S=l[b+1]))&&128==(192&P)&&128==(192&F)&&((U=(15&N)<<18|(63&S)<<12|(63&P)<<6|63&F)<=65535||U>=1114112)&&(U=null)),null===U?(U=65533,j=1):U>65535&&(U-=65536,x+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),x+=String.fromCharCode(U),b+=j}return x}(this.buf,i,a)},readBytes:function(){var a=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,a);return this.pos=a,i},readPackedVarint:function(a,i){if(this.type!==yr.Bytes)return a.push(this.readVarint(i));var l=Uc(this);for(a=a||[];this.pos<l;)a.push(this.readVarint(i));return a},readPackedSVarint:function(a){if(this.type!==yr.Bytes)return a.push(this.readSVarint());var i=Uc(this);for(a=a||[];this.pos<i;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==yr.Bytes)return a.push(this.readBoolean());var i=Uc(this);for(a=a||[];this.pos<i;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==yr.Bytes)return a.push(this.readFloat());var i=Uc(this);for(a=a||[];this.pos<i;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==yr.Bytes)return a.push(this.readDouble());var i=Uc(this);for(a=a||[];this.pos<i;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==yr.Bytes)return a.push(this.readFixed32());var i=Uc(this);for(a=a||[];this.pos<i;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==yr.Bytes)return a.push(this.readSFixed32());var i=Uc(this);for(a=a||[];this.pos<i;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==yr.Bytes)return a.push(this.readFixed64());var i=Uc(this);for(a=a||[];this.pos<i;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==yr.Bytes)return a.push(this.readSFixed64());var i=Uc(this);for(a=a||[];this.pos<i;)a.push(this.readSFixed64());return a},skip:function(a){var i=7&a;if(i===yr.Varint)for(;this.buf[this.pos++]>127;);else if(i===yr.Bytes)this.pos=this.readVarint()+this.pos;else if(i===yr.Fixed32)this.pos+=4;else{if(i!==yr.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(a,i){this.writeVarint(a<<3|i)},realloc:function(a){for(var i=this.length||16;i<this.pos+a;)i*=2;if(i!==this.length){var l=new Uint8Array(i);l.set(this.buf),this.buf=l,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),jc(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),jc(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),jc(this.buf,-1&a,this.pos),jc(this.buf,Math.floor(a*Ju),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),jc(this.buf,-1&a,this.pos),jc(this.buf,Math.floor(a*Ju),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(i,l){var u,f,x,S;if(i>=0?(u=i%4294967296|0,f=i/4294967296|0):(f=~(-i/4294967296),4294967295^(u=~(-i%4294967296))?u=u+1|0:(u=0,f=f+1|0)),i>=0x10000000000000000||i<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),x=u,(S=l).buf[S.pos++]=127&x|128,x>>>=7,S.buf[S.pos++]=127&x|128,x>>>=7,S.buf[S.pos++]=127&x|128,x>>>=7,S.buf[S.pos++]=127&x|128,S.buf[S.pos]=127&(x>>>=7),function(x,b){var S=(7&x)<<4;b.buf[b.pos++]|=S|((x>>>=3)?128:0),x&&(b.buf[b.pos++]=127&x|((x>>>=7)?128:0),x&&(b.buf[b.pos++]=127&x|((x>>>=7)?128:0),x&&(b.buf[b.pos++]=127&x|((x>>>=7)?128:0),x&&(b.buf[b.pos++]=127&x|((x>>>=7)?128:0),x&&(b.buf[b.pos++]=127&x)))))}(f,l)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var i=this.pos;this.pos=function(u,f,x){for(var b,S,P=0;P<f.length;P++){if((b=f.charCodeAt(P))>55295&&b<57344){if(!S){b>56319||P+1===f.length?(u[x++]=239,u[x++]=191,u[x++]=189):S=b;continue}if(b<56320){u[x++]=239,u[x++]=191,u[x++]=189,S=b;continue}b=S-55296<<10|b-56320|65536,S=null}else S&&(u[x++]=239,u[x++]=191,u[x++]=189,S=null);b<128?u[x++]=b:(b<2048?u[x++]=b>>6|192:(b<65536?u[x++]=b>>12|224:(u[x++]=b>>18|240,u[x++]=b>>12&63|128),u[x++]=b>>6&63|128),u[x++]=63&b|128)}return x}(this.buf,a,this.pos);var l=this.pos-i;l>=128&&Um(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeFloat:function(a){this.realloc(4),zm(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),zm(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var i=a.length;this.writeVarint(i),this.realloc(i);for(var l=0;l<i;l++)this.buf[this.pos++]=a[l]},writeRawMessage:function(a,i){this.pos++;var l=this.pos;a(i,this);var u=this.pos-l;u>=128&&Um(l,u,this),this.pos=l-1,this.writeVarint(u),this.pos+=u},writeMessage:function(a,i,l){this.writeTag(a,yr.Bytes),this.writeRawMessage(i,l)},writePackedVarint:function(a,i){i.length&&this.writeMessage(a,u2,i)},writePackedSVarint:function(a,i){i.length&&this.writeMessage(a,ks,i)},writePackedBoolean:function(a,i){i.length&&this.writeMessage(a,p1,i)},writePackedFloat:function(a,i){i.length&&this.writeMessage(a,jm,i)},writePackedDouble:function(a,i){i.length&&this.writeMessage(a,Gm,i)},writePackedFixed32:function(a,i){i.length&&this.writeMessage(a,J0,i)},writePackedSFixed32:function(a,i){i.length&&this.writeMessage(a,gA,i)},writePackedFixed64:function(a,i){i.length&&this.writeMessage(a,e_,i)},writePackedSFixed64:function(a,i){i.length&&this.writeMessage(a,t_,i)},writeBytesField:function(a,i){this.writeTag(a,yr.Bytes),this.writeBytes(i)},writeFixed32Field:function(a,i){this.writeTag(a,yr.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(a,i){this.writeTag(a,yr.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(a,i){this.writeTag(a,yr.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(a,i){this.writeTag(a,yr.Fixed64),this.writeSFixed64(i)},writeVarintField:function(a,i){this.writeTag(a,yr.Varint),this.writeVarint(i)},writeSVarintField:function(a,i){this.writeTag(a,yr.Varint),this.writeSVarint(i)},writeStringField:function(a,i){this.writeTag(a,yr.Bytes),this.writeString(i)},writeFloatField:function(a,i){this.writeTag(a,yr.Fixed32),this.writeFloat(i)},writeDoubleField:function(a,i){this.writeTag(a,yr.Fixed64),this.writeDouble(i)},writeBooleanField:function(a,i){this.writeVarintField(a,Boolean(i))}};class qm{constructor(i,{pixelRatio:l,version:u,stretchX:f,stretchY:x,content:b}){this.paddedRect=i,this.pixelRatio=l,this.stretchX=f,this.stretchY=x,this.content=b,this.version=u}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class qf{constructor(i,l){const u={},f={};this.haveRenderCallbacks=[];const x=[];this.addImages(i,u,x),this.addImages(l,f,x);const{w:b,h:S}=Hf(x),P=new Ts({width:b||1,height:S||1});for(const F in i){const N=i[F],U=u[F].paddedRect;Ts.copy(N.data,P,{x:0,y:0},{x:U.x+1,y:U.y+1},N.data)}for(const F in l){const N=l[F],U=f[F].paddedRect,j=U.x+1,q=U.y+1,re=N.data.width,oe=N.data.height;Ts.copy(N.data,P,{x:0,y:0},{x:j,y:q},N.data),Ts.copy(N.data,P,{x:0,y:oe-1},{x:j,y:q-1},{width:re,height:1}),Ts.copy(N.data,P,{x:0,y:0},{x:j,y:q+oe},{width:re,height:1}),Ts.copy(N.data,P,{x:re-1,y:0},{x:j-1,y:q},{width:1,height:oe}),Ts.copy(N.data,P,{x:0,y:0},{x:j+re,y:q},{width:1,height:oe})}this.image=P,this.iconPositions=u,this.patternPositions=f}addImages(i,l,u){for(const f in i){const x=i[f],b={x:0,y:0,w:x.data.width+2,h:x.data.height+2};u.push(b),l[f]=new qm(b,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(i,l){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in i.updatedImages)this.patchUpdatedImage(this.iconPositions[u],i.getImage(u),l),this.patchUpdatedImage(this.patternPositions[u],i.getImage(u),l)}patchUpdatedImage(i,l,u){if(!i||!l||i.version===l.version)return;i.version=l.version;const[f,x]=i.tl;u.update(l.data,void 0,{x:f,y:x})}}Ft("ImagePosition",qm),Ft("ImageAtlas",qf);const Ps={horizontal:1,vertical:2,horizontalOnly:3};class _A{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,l){const u=new _A;return u.scale=i||1,u.fontStack=l,u}static forImage(i){const l=new _A;return l.imageName=i,l}}class Kh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,l){const u=new Kh;for(let f=0;f<i.sections.length;f++){const x=i.sections[f];x.image?u.addImageSection(x):u.addTextSection(x,l)}return u}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(i){this.text=function(l,u){let f="";for(let x=0;x<l.length;x++){const b=l.charCodeAt(x+1)||null,S=l.charCodeAt(x-1)||null;f+=!u&&(b&&ju(b)&&!fA[l[x+1]]||S&&ju(S)&&!fA[l[x-1]])||!fA[l[x]]?l[x]:fA[l[x]]}return f}(this.text,i)}trim(){let i=0;for(let u=0;u<this.text.length&&Zf[this.text.charCodeAt(u)];u++)i++;let l=this.text.length;for(let u=this.text.length-1;u>=0&&u>=i&&Zf[this.text.charCodeAt(u)];u--)l--;this.text=this.text.substring(i,l),this.sectionIndex=this.sectionIndex.slice(i,l)}substring(i,l){const u=new Kh;return u.text=this.text.substring(i,l),u.sectionIndex=this.sectionIndex.slice(i,l),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,l)=>Math.max(i,this.sections[l].scale),0)}addTextSection(i,l){this.text+=i.text,this.sections.push(_A.forText(i.scale,i.fontStack||l));const u=this.sections.length-1;for(let f=0;f<i.text.length;++f)this.sectionIndex.push(u)}addImageSection(i){const l=i.image?i.image.name:"";if(0===l.length)return void jr("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(_A.forImage(l)),this.sectionIndex.push(this.sections.length-1)):jr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Zm(a,i,l,u,f,x,b,S,P,F,N,U,j,q,re,oe){const Ae=Kh.fromFeature(a,f);let xe;U===Ps.vertical&&Ae.verticalizePunctuation(j);const{processBidirectionalText:Se,processStyledBidirectionalText:Le}=J;if(Se&&1===Ae.sections.length){xe=[];const Ue=Se(Ae.toString(),Qm(Ae,F,x,i,u,q,re));for(const Ze of Ue){const at=new Kh;at.text=Ze,at.sections=Ae.sections;for(let pt=0;pt<Ze.length;pt++)at.sectionIndex.push(0);xe.push(at)}}else if(Le){xe=[];const Ue=Le(Ae.text,Ae.sectionIndex,Qm(Ae,F,x,i,u,q,re));for(const Ze of Ue){const at=new Kh;at.text=Ze[0],at.sectionIndex=Ze[1],at.sections=Ae.sections,xe.push(at)}}else xe=function(Ue,Ze){const at=[],pt=Ue.text;let gt=0;for(const nt of Ze)at.push(Ue.substring(gt,nt)),gt=nt;return gt<pt.length&&at.push(Ue.substring(gt,pt.length)),at}(Ae,Qm(Ae,F,x,i,u,q,re));const Be=[],Ne={positionedLines:Be,text:Ae.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:U,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Ue,Ze,at,pt,gt,nt,st,xt,ot,Jt,Tt,nr){let en=0,Tn=0,Gt=0;const nn="right"===xt?1:"left"===xt?0:.5;let Bn=!1;for(const hr of gt){const dr=hr.getSections();for(const zi of dr){if(zi.imageName)continue;const Xr=Ze[zi.fontStack];if(Xr&&(Bn=void 0!==Xr.ascender&&void 0!==Xr.descender,!Bn))break}if(!Bn)break}let Si=0;for(const hr of gt){hr.trim();const dr=hr.getMaxScale(),zi=24*(dr-1),Xr={positionedGlyphs:[],lineOffset:0};Ue.positionedLines[Si]=Xr;const Vi=Xr.positionedGlyphs;let Ti=0;if(!hr.length()){Tn+=nt,++Si;continue}let Ar=0,ei=0;for(let kr=0;kr<hr.length();kr++){const ti=hr.getSection(kr),Go=hr.getSectionIndex(kr),ni=hr.getCharCode(kr);let ri=ti.scale,jn=null,Ui=null,ss=null,Fs=24,Os=0;const Ba=!(ot===Ps.horizontal||!Tt&&!ta(ni)||Tt&&(Zf[ni]||(Hr=ni,Hd(Hr)||Ll(Hr)||ea(Hr)||Ei(Hr)||ol(Hr))));if(ti.imageName){const Na=pt[ti.imageName];if(!Na)continue;ss=ti.imageName,Ue.iconsInText=Ue.iconsInText||!0,Ui=Na.paddedRect;const xo=Na.displaySize;ri=24*ri/nr,jn={width:xo[0],height:xo[1],left:1,top:-3,advance:Ba?xo[1]:xo[0],localGlyph:!1},Os=Bn?-jn.height*ri:24*dr-17-xo[1]*ri,Fs=jn.advance;const ca=(Ba?xo[0]:xo[1])*ri-24*dr;ca>0&&ca>Ti&&(Ti=ca)}else{const Na=at[ti.fontStack];if(!Na)continue;Na[ni]&&(Ui=Na[ni]);const xo=Ze[ti.fontStack];if(!xo)continue;const ca=xo.glyphs[ni];if(!ca)continue;if(jn=ca.metrics,Fs=8203!==ni?24:0,Bn){const ih=void 0!==xo.ascender?Math.abs(xo.ascender):0,Ls=void 0!==xo.descender?Math.abs(xo.descender):0,ed=(ih+Ls)*ri;Ar<ed&&(Ar=ed,ei=(ih-Ls)/2*ri),Os=-ih*ri}else Os=24*(dr-ri)-17}Ba?(Ue.verticalizable=!0,Vi.push({glyph:ni,imageName:ss,x:en,y:Tn+Os,vertical:Ba,scale:ri,localGlyph:jn.localGlyph,fontStack:ti.fontStack,sectionIndex:Go,metrics:jn,rect:Ui}),en+=Fs*ri+Jt):(Vi.push({glyph:ni,imageName:ss,x:en,y:Tn+Os,vertical:Ba,scale:ri,localGlyph:jn.localGlyph,fontStack:ti.fontStack,sectionIndex:Go,metrics:jn,rect:Ui}),en+=jn.advance*ri+Jt)}0!==Vi.length&&(Gt=Math.max(en-Jt,Gt),Bn?Xm(Vi,nn,Ti,ei,nt*dr/2):Xm(Vi,nn,Ti,0,nt/2)),en=0;const Ir=nt*dr+Ti;Xr.lineOffset=Math.max(Ti,zi),Tn+=Ir,++Si}var Hr;const Bi=Tn,{horizontalAlign:Ni,verticalAlign:qr}=Xf(st);(function(hr,dr,zi,Xr,Vi,Ti){const Ar=(dr-zi)*Vi,ei=-Ti*Xr;for(const Ir of hr)for(const kr of Ir.positionedGlyphs)kr.x+=Ar,kr.y+=ei})(Ue.positionedLines,nn,Ni,qr,Gt,Bi),Ue.top+=-qr*Bi,Ue.bottom=Ue.top+Bi,Ue.left+=-Ni*Gt,Ue.right=Ue.left+Gt,Ue.hasBaseline=Bn}(Ne,i,l,u,xe,b,S,P,U,F,j,oe),!function(Ue){for(const Ze of Ue)if(0!==Ze.positionedGlyphs.length)return!1;return!0}(Be)&&Ne}const Zf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},m1={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Wm(a,i,l,u,f,x){if(i.imageName){const b=u[i.imageName];return b?b.displaySize[0]*i.scale*24/x+f:0}{const b=l[i.fontStack],S=b&&b.glyphs[a];return S?S.metrics.advance*i.scale+f:0}}function Wf(a,i,l,u){const f=Math.pow(a-i,2);return u?a<i?f/2:2*f:f+Math.abs(l)*l}function n_(a,i,l){let u=0;return 10===a&&(u-=1e4),l&&(u+=150),40!==a&&65288!==a||(u+=50),41!==i&&65289!==i||(u+=50),u}function Qf(a,i,l,u,f,x){let b=null,S=Wf(i,l,f,x);for(const P of u){const F=Wf(i-P.x,l,f,x)+P.badness;F<=S&&(b=P,S=F)}return{index:a,x:i,priorBreak:b,badness:S}}function r_(a){return a?r_(a.priorBreak).concat(a.index):[]}function Qm(a,i,l,u,f,x,b){if("point"!==x)return[];if(!a)return[];const S=[],P=function(j,q,re,oe,Ae,xe){let Se=0;for(let Le=0;Le<j.length();Le++){const Be=j.getSection(Le);Se+=Wm(j.getCharCode(Le),Be,oe,Ae,q,xe)}return Se/Math.max(1,Math.ceil(Se/re))}(a,i,l,u,f,b),F=a.text.indexOf("\u200b")>=0;let N=0;for(let j=0;j<a.length();j++){const q=a.getSection(j),re=a.getCharCode(j);if(Zf[re]||(N+=Wm(re,q,u,f,i,b)),j<a.length()-1){const oe=!((U=re)<11904||!(zu(U)||Nh(U)||Gr(U)||gf(U)||Vu(U)||Bu(U)||Zd(U)||Bl(U)||Wd(U)||Vh(U)||Nl(U)||kc(U)||Nu(U)||mf(U)||qd(U)||zh(U)||Tc(U)||ka(U)||Uu(U)||Ic(U)));(m1[re]||oe||q.imageName)&&S.push(Qf(j+1,N,P,S,n_(re,a.getCharCode(j+1),oe&&F),!1))}}var U;return r_(Qf(a.length(),N,P,S,0,!0))}function Xf(a){let i=.5,l=.5;switch(a){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:i,verticalAlign:l}}function Xm(a,i,l,u,f){if(!(i||l||u||f))return;const x=a.length-1,b=a[x],S=(b.x+b.metrics.advance*b.scale)*i;for(let P=0;P<=x;P++)a[P].x-=S,a[P].y+=l+u+f}function eh(a,i,l){const{horizontalAlign:u,verticalAlign:f}=Xf(l),x=i[0]-a.displaySize[0]*u,b=i[1]-a.displaySize[1]*f;return{image:a,top:b,bottom:b+a.displaySize[1],left:x,right:x+a.displaySize[0]}}function Ym(a,i,l,u,f,x){const b=a.image;let S;if(b.content){const Ae=b.content,xe=b.pixelRatio||1;S=[Ae[0]/xe,Ae[1]/xe,b.displaySize[0]-Ae[2]/xe,b.displaySize[1]-Ae[3]/xe]}const P=i.left*x,F=i.right*x;let N,U,j,q;"width"===l||"both"===l?(q=f[0]+P-u[3],U=f[0]+F+u[1]):(q=f[0]+(P+F-b.displaySize[0])/2,U=q+b.displaySize[0]);const re=i.top*x,oe=i.bottom*x;return"height"===l||"both"===l?(N=f[1]+re-u[0],j=f[1]+oe+u[2]):(N=f[1]+(re+oe-b.displaySize[1])/2,j=N+b.displaySize[1]),{image:b,top:N,right:U,bottom:j,left:q,collisionPadding:S}}class Gl extends dt{constructor(i,l,u,f,x){super(i,l),this.angle=f,this.z=u,void 0!==x&&(this.segment=x)}clone(){return new Gl(this.x,this.y,this.z,this.angle,this.segment)}}function i_(a,i,l,u,f){if(void 0===i.segment)return!0;let x=i,b=i.segment+1,S=0;for(;S>-l/2;){if(b--,b<0)return!1;S-=a[b].dist(x),x=a[b]}S+=a[b].dist(a[b+1]),b++;const P=[];let F=0;for(;S<l/2;){const N=a[b],U=a[b+1];if(!U)return!1;let j=a[b-1].angleTo(N)-N.angleTo(U);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:S,angleDelta:j}),F+=j;S-P[0].distance>u;)F-=P.shift().angleDelta;if(F>f)return!1;b++,S+=N.dist(U)}return!0}function yA(a){let i=0;for(let l=0;l<a.length-1;l++)i+=a[l].dist(a[l+1]);return i}function o_(a,i,l){return a?.6*i*l:0}function Km(a,i){return Math.max(a?a.right-a.left:0,i?i.right-i.left:0)}function s_(a,i,l,u,f,x){const b=o_(l,f,x),S=Km(l,u)*x;let P=0;const F=yA(a)/2;for(let N=0;N<a.length-1;N++){const U=a[N],j=a[N+1],q=U.dist(j);if(P+q>F){const re=(F-P)/q,oe=At(U.x,j.x,re),Ae=At(U.y,j.y,re),xe=new Gl(oe,Ae,0,j.angleTo(U),N);return!b||i_(a,xe,S,b,i)?xe:void 0}P+=q}}function a_(a,i,l,u,f,x,b,S,P){const F=o_(u,x,b),N=Km(u,f),U=N*b,j=0===a[0].x||a[0].x===P||0===a[0].y||a[0].y===P;return i-U<i/4&&(i=U+i/4),Yf(a,j?i/2*S%i:(N/2+2*x)*b*S%i,i,F,l,U,j,!1,P)}function Yf(a,i,l,u,f,x,b,S,P){const F=x/2,N=yA(a);let U=0,j=i-l,q=[];for(let re=0;re<a.length-1;re++){const oe=a[re],Ae=a[re+1],xe=oe.dist(Ae),Se=Ae.angleTo(oe);for(;j+l<U+xe;){j+=l;const Le=(j-U)/xe,Be=At(oe.x,Ae.x,Le),Ne=At(oe.y,Ae.y,Le);if(Be>=0&&Be<P&&Ne>=0&&Ne<P&&j-F>=0&&j+F<=N){const Ue=new Gl(Be,Ne,0,Se,re);Ue._round(),u&&!i_(a,Ue,x,u,f)||q.push(Ue)}}U+=xe}return S||q.length||b||(q=Yf(a,U/2,l,u,f,x,b,!0,P)),q}function Jm(a,i,l,u,f){const x=[];for(let b=0;b<a.length;b++){const S=a[b];let P;for(let F=0;F<S.length-1;F++){let N=S[F],U=S[F+1];N.x<i&&U.x<i||(N.x<i?N=new dt(i,N.y+(i-N.x)/(U.x-N.x)*(U.y-N.y))._round():U.x<i&&(U=new dt(i,N.y+(i-N.x)/(U.x-N.x)*(U.y-N.y))._round()),N.y<l&&U.y<l||(N.y<l?N=new dt(N.x+(l-N.y)/(U.y-N.y)*(U.x-N.x),l)._round():U.y<l&&(U=new dt(N.x+(l-N.y)/(U.y-N.y)*(U.x-N.x),l)._round()),N.x>=u&&U.x>=u||(N.x>=u?N=new dt(u,N.y+(u-N.x)/(U.x-N.x)*(U.y-N.y))._round():U.x>=u&&(U=new dt(u,N.y+(u-N.x)/(U.x-N.x)*(U.y-N.y))._round()),N.y>=f&&U.y>=f||(N.y>=f?N=new dt(N.x+(f-N.y)/(U.y-N.y)*(U.x-N.x),f)._round():U.y>=f&&(U=new dt(N.x+(f-N.y)/(U.y-N.y)*(U.x-N.x),f)._round()),P&&N.equals(P[P.length-1])||(P=[N],x.push(P)),P.push(U)))))}}return x}Ft("Anchor",Gl);const Gc=1e20;function vA(a,i,l,u,f,x,b,S,P){for(let F=i;F<i+u;F++)eg(a,l*x+F,x,f,b,S,P);for(let F=l;F<l+f;F++)eg(a,F*x+i,1,u,b,S,P)}function eg(a,i,l,u,f,x,b){x[0]=0,b[0]=-Gc,b[1]=Gc,f[0]=a[i];for(let S=1,P=0,F=0;S<u;S++){f[S]=a[i+S*l];const N=S*S;do{const U=x[P];F=(f[S]-f[U]+N-U*U)/(S-U)/2}while(F<=b[P]&&--P>-1);P++,x[P]=S,b[P]=F,b[P+1]=Gc}for(let S=0,P=0;S<u;S++){for(;b[P+1]<S;)P++;const F=x[P],N=S-F;a[i+S*l]=f[F]+N*N}}const xA={none:0,ideographs:1,all:2};class th{constructor(i,l,u){this.requestManager=i,this.localGlyphMode=l,this.localFontFamily=u,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i){this.url=i}getGlyphs(i,l){const u=[];for(const f in i)for(const x of i[f])u.push({stack:f,id:x});fu(u,({stack:f,id:x},b)=>{let S=this.entries[f];S||(S=this.entries[f]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let P=S.glyphs[x];if(void 0!==P)return void b(null,{stack:f,id:x,glyph:P});if(P=this._tinySDF(S,f,x),P)return S.glyphs[x]=P,void b(null,{stack:f,id:x,glyph:P});const F=Math.floor(x/256);if(256*F>65535)return void b(new Error("glyphs > 65535 not supported"));if(S.ranges[F])return void b(null,{stack:f,id:x,glyph:P});let N=S.requests[F];N||(N=S.requests[F]=[],th.loadGlyphRange(f,F,this.url,this.requestManager,(U,j)=>{if(j){S.ascender=j.ascender,S.descender=j.descender;for(const q in j.glyphs)this._doesCharSupportLocalGlyph(+q)||(S.glyphs[+q]=j.glyphs[+q]);S.ranges[F]=!0}for(const q of N)q(U,j);delete S.requests[F]})),N.push((U,j)=>{U?b(U):j&&b(null,{stack:f,id:x,glyph:j.glyphs[x]||null})})},(f,x)=>{if(f)l(f);else if(x){const b={};for(const{stack:S,id:P,glyph:F}of x)void 0===b[S]&&(b[S]={}),void 0===b[S].glyphs&&(b[S].glyphs={}),b[S].glyphs[P]=F&&{id:F.id,bitmap:F.bitmap.clone(),metrics:F.metrics},b[S].ascender=this.entries[S].ascender,b[S].descender=this.entries[S].descender;l(null,b)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==xA.none&&(this.localGlyphMode===xA.all?!!this.localFontFamily:!!this.localFontFamily&&(Vh(i)||zl(i)||Nu(i)||Tc(i))||Bl(i))}_tinySDF(i,l,u){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(u))return;let x=i.tinySDF;if(!x){let oe="400";/bold/i.test(l)?oe="900":/medium/i.test(l)?oe="500":/light/i.test(l)&&(oe="200"),x=i.tinySDF=new th.TinySDF({fontFamily:f,fontWeight:oe,fontSize:48,buffer:6,radius:16}),x.fontWeight=oe}if(this.localGlyphs[x.fontWeight][u])return this.localGlyphs[x.fontWeight][u];const b=String.fromCharCode(u),{data:S,width:P,height:F,glyphWidth:N,glyphHeight:U,glyphLeft:j,glyphTop:q,glyphAdvance:re}=x.draw(b);return this.localGlyphs[x.fontWeight][u]={id:u,bitmap:new Nc({width:P,height:F},S),metrics:{width:N/2,height:U/2,left:j/2,top:q/2-27,advance:re/2,localGlyph:!0}}}}function Kf(a,i,l,u){const f=[],x=a.image,b=x.pixelRatio,S=x.paddedRect.w-2,P=x.paddedRect.h-2,F=a.right-a.left,N=a.bottom-a.top,U=x.stretchX||[[0,S]],j=x.stretchY||[[0,P]],q=(nt,st)=>nt+st[1]-st[0],re=U.reduce(q,0),oe=j.reduce(q,0),Ae=S-re,xe=P-oe;let Se=0,Le=re,Be=0,Ne=oe,Ue=0,Ze=Ae,at=0,pt=xe;if(x.content&&u){const nt=x.content;Se=$c(U,0,nt[0]),Be=$c(j,0,nt[1]),Le=$c(U,nt[0],nt[2]),Ne=$c(j,nt[1],nt[3]),Ue=nt[0]-Se,at=nt[1]-Be,Ze=nt[2]-nt[0]-Le,pt=nt[3]-nt[1]-Ne}const gt=(nt,st,xt,ot)=>{const Jt=bA(nt.stretch-Se,Le,F,a.left),Tt=Jf(nt.fixed-Ue,Ze,nt.stretch,re),nr=bA(st.stretch-Be,Ne,N,a.top),en=Jf(st.fixed-at,pt,st.stretch,oe),Tn=bA(xt.stretch-Se,Le,F,a.left),Gt=Jf(xt.fixed-Ue,Ze,xt.stretch,re),nn=bA(ot.stretch-Be,Ne,N,a.top),Bn=Jf(ot.fixed-at,pt,ot.stretch,oe),Si=new dt(Jt,nr),Hr=new dt(Tn,nr),Bi=new dt(Tn,nn),Ni=new dt(Jt,nn),qr=new dt(Tt/b,en/b),hr=new dt(Gt/b,Bn/b),dr=i*Math.PI/180;if(dr){const Vi=Math.sin(dr),Ti=Math.cos(dr),Ar=[Ti,-Vi,Vi,Ti];Si._matMult(Ar),Hr._matMult(Ar),Ni._matMult(Ar),Bi._matMult(Ar)}const zi=nt.stretch+nt.fixed,Xr=st.stretch+st.fixed;return{tl:Si,tr:Hr,bl:Ni,br:Bi,tex:{x:x.paddedRect.x+1+zi,y:x.paddedRect.y+1+Xr,w:xt.stretch+xt.fixed-zi,h:ot.stretch+ot.fixed-Xr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:qr,pixelOffsetBR:hr,minFontScaleX:Ze/b/F,minFontScaleY:pt/b/N,isSDF:l}};if(u&&(x.stretchX||x.stretchY)){const nt=l_(U,Ae,re),st=l_(j,xe,oe);for(let xt=0;xt<nt.length-1;xt++){const ot=nt[xt],Jt=nt[xt+1];for(let Tt=0;Tt<st.length-1;Tt++)f.push(gt(ot,st[Tt],Jt,st[Tt+1]))}}else f.push(gt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:P+1}));return f}function $c(a,i,l){let u=0;for(const f of a)u+=Math.max(i,Math.min(l,f[1]))-Math.max(i,Math.min(l,f[0]));return u}function l_(a,i,l){const u=[{fixed:-1,stretch:0}];for(const[f,x]of a){const b=u[u.length-1];u.push({fixed:f-b.stretch,stretch:b.stretch}),u.push({fixed:f-b.stretch,stretch:b.stretch+(x-f)})}return u.push({fixed:i+1,stretch:l}),u}function bA(a,i,l,u){return a/i*l+u}function Jf(a,i,l,u){return a-i*l/u}function g1(a,i,l,u){const f=i+a.positionedLines[u].lineOffset;return 0===u?l+f/2:l+(f+(i+a.positionedLines[u-1].lineOffset))/2}th.loadGlyphRange=function(a,i,l,u,f){const x=256*i,b=x+255,S=u.transformRequest(u.normalizeGlyphsURL(l).replace("{fontstack}",a).replace("{range}",`${x}-${b}`),ba.Glyphs);Z(S,(P,F)=>{if(P)f(P);else if(F){const N={},U=new pA(F).readFields(h2,{});for(const j of U.glyphs)N[j.id]=j;f(null,{glyphs:N,ascender:U.ascender,descender:U.descender})}})},th.TinySDF=class{constructor({fontSize:a=24,buffer:i=3,radius:l=8,cutoff:u=.25,fontFamily:f="sans-serif",fontWeight:x="normal",fontStyle:b="normal"}){this.buffer=i,this.cutoff=u,this.radius=l;const S=this.size=a+4*i,P=this._createCanvas(S),F=this.ctx=P.getContext("2d",{willReadFrequently:!0});F.font=`${b} ${x} ${a}px ${f}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(a){const i=document.createElement("canvas");return i.width=i.height=a,i}draw(a){const{width:i,actualBoundingBoxAscent:l,actualBoundingBoxDescent:u,actualBoundingBoxLeft:f,actualBoundingBoxRight:x}=this.ctx.measureText(a),b=Math.floor(l),S=Math.min(this.size-this.buffer,Math.ceil(x-f)),P=Math.min(this.size-this.buffer,Math.ceil(l)+Math.ceil(u)),F=S+2*this.buffer,N=P+2*this.buffer,U=F*N,j=new Uint8ClampedArray(U),q={data:j,width:F,height:N,glyphWidth:S,glyphHeight:P,glyphTop:b,glyphLeft:0,glyphAdvance:i};if(0===S||0===P)return q;const{ctx:re,buffer:oe,gridInner:Ae,gridOuter:xe}=this;re.clearRect(oe,oe,S,P),re.fillText(a,oe,oe+b+1);const Se=re.getImageData(oe,oe,S,P);xe.fill(Gc,0,U),Ae.fill(0,0,U);for(let Le=0;Le<P;Le++)for(let Be=0;Be<S;Be++){const Ne=Se.data[4*(Le*S+Be)+3]/255;if(0===Ne)continue;const Ue=(Le+oe)*F+Be+oe;if(1===Ne)xe[Ue]=0,Ae[Ue]=Gc;else{const Ze=.5-Ne;xe[Ue]=Ze>0?Ze*Ze:0,Ae[Ue]=Ze<0?Ze*Ze:0}}vA(xe,0,0,F,N,F,this.f,this.v,this.z),vA(Ae,oe,oe,S,P,F,this.f,this.v,this.z);for(let Le=0;Le<U;Le++){const Be=Math.sqrt(xe[Le])-Math.sqrt(Ae[Le]);j[Le]=Math.round(255-255*(Be/this.radius+this.cutoff))}return q}};class c_{constructor(i=[],l=tg){if(this.data=i,this.length=this.data.length,this.compare=l,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const i=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:l,compare:u}=this,f=l[i];for(;i>0;){const x=i-1>>1,b=l[x];if(u(f,b)>=0)break;l[i]=b,i=x}l[i]=f}_down(i){const{data:l,compare:u}=this,f=this.length>>1,x=l[i];for(;i<f;){let b=1+(i<<1),S=l[b];const P=b+1;if(P<this.length&&u(l[P],S)<0&&(b=P,S=l[P]),u(S,x)>=0)break;l[i]=S,i=b}l[i]=x}}function tg(a,i){return a<i?-1:a>i?1:0}function u_(a,i=1,l=!1){let u=1/0,f=1/0,x=-1/0,b=-1/0;const S=a[0];for(let q=0;q<S.length;q++){const re=S[q];(!q||re.x<u)&&(u=re.x),(!q||re.y<f)&&(f=re.y),(!q||re.x>x)&&(x=re.x),(!q||re.y>b)&&(b=re.y)}const P=Math.min(x-u,b-f);let F=P/2;const N=new c_([],d2);if(0===P)return new dt(u,f);for(let q=u;q<x;q+=P)for(let re=f;re<b;re+=P)N.push(new nh(q+F,re+F,F,a));let U=function(q){let re=0,oe=0,Ae=0;const xe=q[0];for(let Se=0,Le=xe.length,Be=Le-1;Se<Le;Be=Se++){const Ne=xe[Se],Ue=xe[Be],Ze=Ne.x*Ue.y-Ue.x*Ne.y;oe+=(Ne.x+Ue.x)*Ze,Ae+=(Ne.y+Ue.y)*Ze,re+=3*Ze}return new nh(oe/re,Ae/re,0,q)}(a),j=N.length;for(;N.length;){const q=N.pop();(q.d>U.d||!U.d)&&(U=q,l&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,j)),q.max-U.d<=i||(F=q.h/2,N.push(new nh(q.p.x-F,q.p.y-F,F,a)),N.push(new nh(q.p.x+F,q.p.y-F,F,a)),N.push(new nh(q.p.x-F,q.p.y+F,F,a)),N.push(new nh(q.p.x+F,q.p.y+F,F,a)),j+=4)}return l&&(console.log(`num probes: ${j}`),console.log(`best distance: ${U.d}`)),U.p}function d2(a,i){return i.max-a.max}function nh(a,i,l,u){this.p=new dt(a,i),this.h=l,this.d=function(f,x){let b=!1,S=1/0;for(let P=0;P<x.length;P++){const F=x[P];for(let N=0,U=F.length,j=U-1;N<U;j=N++){const q=F[N],re=F[j];q.y>f.y!=re.y>f.y&&f.x<(re.x-q.x)*(f.y-q.y)/(re.y-q.y)+q.x&&(b=!b),S=Math.min(S,vm(f,q,re))}}return(b?1:-1)*Math.sqrt(S)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}const ng=Number.POSITIVE_INFINITY,h_=Math.sqrt(2);function d_(a,i){return i[1]!==ng?function(l,u,f){let x=0,b=0;switch(u=Math.abs(u),f=Math.abs(f),l){case"top-right":case"top-left":case"top":b=f-7;break;case"bottom-right":case"bottom-left":case"bottom":b=7-f}switch(l){case"top-right":case"bottom-right":case"right":x=-u;break;case"top-left":case"bottom-left":case"left":x=u}return[x,b]}(a,i[0],i[1]):function(l,u){let f=0,x=0;u<0&&(u=0);const b=u/h_;switch(l){case"top-right":case"top-left":x=b-7;break;case"bottom-right":case"bottom-left":x=7-b;break;case"bottom":x=7-u;break;case"top":x=u-7}switch(l){case"top-right":case"bottom-right":f=-b;break;case"top-left":case"bottom-left":f=b;break;case"left":f=u;break;case"right":f=-u}return[f,x]}(a,i[0])}function _1(a,i,l,u,f,x,b,S){a.createArrays(),a.tilePixelRatio=ur/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const P=a.layers[0].layout,F=a.layers[0]._unevaluatedLayout._values,N={};if("composite"===a.textSizeData.kind){const{minZoom:q,maxZoom:re}=a.textSizeData;N.compositeTextSizes=[F["text-size"].possiblyEvaluate(new te(q),b),F["text-size"].possiblyEvaluate(new te(re),b)]}if("composite"===a.iconSizeData.kind){const{minZoom:q,maxZoom:re}=a.iconSizeData;N.compositeIconSizes=[F["icon-size"].possiblyEvaluate(new te(q),b),F["icon-size"].possiblyEvaluate(new te(re),b)]}N.layoutTextSize=F["text-size"].possiblyEvaluate(new te(S+1),b),N.layoutIconSize=F["icon-size"].possiblyEvaluate(new te(S+1),b),N.textMaxSize=F["text-size"].possiblyEvaluate(new te(18),b);const U="map"===P.get("text-rotation-alignment")&&"point"!==P.get("symbol-placement"),j=P.get("text-size");for(const q of a.features){const re=P.get("text-font").evaluate(q,{},b).join(","),oe=j.evaluate(q,{},b),Ae=N.layoutTextSize.evaluate(q,{},b),xe=(N.layoutIconSize.evaluate(q,{},b),{horizontal:{},vertical:void 0}),Se=q.text;let Le,Be=[0,0];if(Se){const Ze=Se.toString(),at=24*P.get("text-letter-spacing").evaluate(q,{},b),pt=24*P.get("text-line-height").evaluate(q,{},b),gt=pm(Ze)?at:0,nt=P.get("text-anchor").evaluate(q,{},b),st=P.get("text-variable-anchor");if(!st){const en=P.get("text-radial-offset").evaluate(q,{},b);Be=en?d_(nt,[24*en,ng]):P.get("text-offset").evaluate(q,{},b).map(Tn=>24*Tn)}let xt=U?"center":P.get("text-justify").evaluate(q,{},b);const ot=P.get("symbol-placement"),Jt="point"===ot,Tt="point"===ot?24*P.get("text-max-width").evaluate(q,{},b):0,nr=en=>{a.allowVerticalPlacement&&Vl(Ze)&&(xe.vertical=Zm(Se,i,l,f,re,Tt,pt,nt,en,gt,Be,Ps.vertical,!0,ot,Ae,oe))};if(!U&&st){const en="auto"===xt?st.map(Gt=>Rs(Gt)):[xt];let Tn=!1;for(let Gt=0;Gt<en.length;Gt++){const nn=en[Gt];if(!xe.horizontal[nn])if(Tn)xe.horizontal[nn]=xe.horizontal[0];else{const Bn=Zm(Se,i,l,f,re,Tt,pt,"center",nn,gt,Be,Ps.horizontal,!1,ot,Ae,oe);Bn&&(xe.horizontal[nn]=Bn,Tn=1===Bn.positionedLines.length)}}nr("left")}else{if("auto"===xt&&(xt=Rs(nt)),Jt||P.get("text-writing-mode").indexOf("horizontal")>=0||!Vl(Ze)){const en=Zm(Se,i,l,f,re,Tt,pt,nt,xt,gt,Be,Ps.horizontal,!1,ot,Ae,oe);en&&(xe.horizontal[xt]=en)}nr("point"===ot?"left":xt)}}let Ne=!1;if(q.icon&&q.icon.name){const Ze=u[q.icon.name];Ze&&(Le=eh(f[q.icon.name],P.get("icon-offset").evaluate(q,{},b),P.get("icon-anchor").evaluate(q,{},b)),Ne=Ze.sdf,void 0===a.sdfIcons?a.sdfIcons=Ze.sdf:a.sdfIcons!==Ze.sdf&&jr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ze.pixelRatio!==a.pixelRatio||0!==P.get("icon-rotate").constantOr(1))&&(a.iconsNeedLinear=!0))}const Ue=f_(xe.horizontal)||xe.vertical;a.iconsInText||(a.iconsInText=!!Ue&&Ue.iconsInText),(Ue||Le)&&y1(a,q,xe,Le,u,N,Ae,0,Be,Ne,b)}x&&a.generateCollisionDebugBuffers(S,a.collisionBoxArray)}function Rs(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function y1(a,i,l,u,f,x,b,S,P,F,N){let U=x.textMaxSize.evaluate(i,{},N);void 0===U&&(U=b);const j=a.layers[0].layout,q=j.get("icon-offset").evaluate(i,{},N),re=f_(l.horizontal)||l.vertical,oe=b/24,Ae=a.tilePixelRatio*U/24,xe=a.tilePixelRatio*j.get("symbol-spacing"),Se=j.get("text-padding")*a.tilePixelRatio,Le=j.get("icon-padding")*a.tilePixelRatio,Be=qn(j.get("text-max-angle")),Ne="map"===j.get("text-rotation-alignment")&&"point"!==j.get("symbol-placement"),Ue="map"===j.get("icon-rotation-alignment")&&"point"!==j.get("symbol-placement"),Ze=j.get("symbol-placement"),at=xe/2,pt=j.get("icon-text-fit");let gt;u&&"none"!==pt&&(a.allowVerticalPlacement&&l.vertical&&(gt=Ym(u,l.vertical,pt,j.get("icon-text-fit-padding"),q,oe)),re&&(u=Ym(u,re,pt,j.get("icon-text-fit-padding"),q,oe)));const nt=(st,xt)=>{xt.x<0||xt.x>=ur||xt.y<0||xt.y>=ur||function(ot,Jt,Tt,nr,en,Tn,Gt,nn,Bn,Si,Hr,Bi,Ni,qr,hr,dr,zi,Xr,Vi,Ti,Ar,ei,Ir,kr){const ti=ot.addToLineVertexArray(Jt,nr);let Go,ni,ri,jn,Ui,ss,Fs,Os=0,Ba=0,Na=0,xo=0,ca=-1,ih=-1;const Ls={};let ed=bf(""),Qc=0,dp=0;if(void 0===Bn._unevaluatedLayout.getValue("text-radial-offset")?[Qc,dp]=Bn.layout.get("text-offset").evaluate(Ar,{},kr).map(as=>24*as):(Qc=24*Bn.layout.get("text-radial-offset").evaluate(Ar,{},kr),dp=ng),ot.allowVerticalPlacement&&en.vertical){const as=en.vertical;if(hr)ss=rg(as),nn&&(Fs=rg(nn));else{const ls=Bn.layout.get("text-rotate").evaluate(Ar,{},kr)+90;ri=ep(Si,Tt,Jt,Hr,Bi,Ni,as,qr,ls,dr),nn&&(jn=ep(Si,Tt,Jt,Hr,Bi,Ni,nn,Xr,ls))}}if(Tn){const as=Bn.layout.get("icon-rotate").evaluate(Ar,{},kr),ls="none"!==Bn.layout.get("icon-text-fit"),kA=Kf(Tn,as,Ir,ls),yg=nn?Kf(nn,as,Ir,ls):void 0;ni=ep(Si,Tt,Jt,Hr,Bi,Ni,Tn,Xr,as),Os=4*kA.length;const T1=ot.iconSizeData;let oh=null;"source"===T1.kind?(oh=[al*Bn.layout.get("icon-size").evaluate(Ar,{},kr)],oh[0]>$l&&jr(`${ot.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===T1.kind&&(oh=[al*ei.compositeIconSizes[0].evaluate(Ar,{},kr),al*ei.compositeIconSizes[1].evaluate(Ar,{},kr)],(oh[0]>$l||oh[1]>$l)&&jr(`${ot.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),ot.addSymbols(ot.icon,kA,oh,Ti,Vi,Ar,!1,Tt,Jt,ti.lineStartIndex,ti.lineLength,-1,kr),ca=ot.icon.placedSymbolArray.length-1,yg&&(Ba=4*yg.length,ot.addSymbols(ot.icon,yg,oh,Ti,Vi,Ar,Ps.vertical,Tt,Jt,ti.lineStartIndex,ti.lineLength,-1,kr),ih=ot.icon.placedSymbolArray.length-1)}for(const as in en.horizontal){const ls=en.horizontal[as];Go||(ed=bf(ls.text),hr?Ui=rg(ls):Go=ep(Si,Tt,Jt,Hr,Bi,Ni,ls,qr,Bn.layout.get("text-rotate").evaluate(Ar,{},kr),dr));const kA=1===ls.positionedLines.length;if(Na+=A_(ot,Tt,Jt,ls,Gt,Bn,hr,Ar,dr,ti,en.vertical?Ps.horizontal:Ps.horizontalOnly,kA?Object.keys(en.horizontal):[as],Ls,ca,ei,kr),kA)break}en.vertical&&(xo+=A_(ot,Tt,Jt,en.vertical,Gt,Bn,hr,Ar,dr,ti,Ps.vertical,["vertical"],Ls,ih,ei,kr));let Xc=-1;const _g=(as,ls)=>as?Math.max(as,ls):ls;Xc=_g(Ui,Xc),Xc=_g(ss,Xc),Xc=_g(Fs,Xc);const td=Xc>-1?1:0;ot.glyphOffsetArray.length>=co.MAX_GLYPHS&&jr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Ar.sortKey&&ot.addToSortKeyRanges(ot.symbolInstances.length,Ar.sortKey),ot.symbolInstances.emplaceBack(Tt.x,Tt.y,Tt.z,Jt.x,Jt.y,Ls.right>=0?Ls.right:-1,Ls.center>=0?Ls.center:-1,Ls.left>=0?Ls.left:-1,Ls.vertical>=0?Ls.vertical:-1,ca,ih,ed,void 0!==Go?Go:ot.collisionBoxArray.length,void 0!==Go?Go+1:ot.collisionBoxArray.length,void 0!==ri?ri:ot.collisionBoxArray.length,void 0!==ri?ri+1:ot.collisionBoxArray.length,void 0!==ni?ni:ot.collisionBoxArray.length,void 0!==ni?ni+1:ot.collisionBoxArray.length,jn||ot.collisionBoxArray.length,jn?jn+1:ot.collisionBoxArray.length,Hr,Na,xo,Os,Ba,td,0,Qc,dp,Xc)}(a,xt,xt,st,l,u,f,gt,a.layers[0],a.collisionBoxArray,i.index,i.sourceLayerIndex,a.index,Se,Ne,P,0,Le,Ue,q,i,x,F,N)};if("line"===Ze)for(const st of Jm(i.geometry,0,0,ur,ur)){const xt=a_(st,xe,Be,l.vertical||re,u,24,Ae,a.overscaling,ur);for(const ot of xt){const Jt=re;Jt&&p_(a,Jt.text,at,ot)||nt(st,ot)}}else if("line-center"===Ze){for(const st of i.geometry)if(st.length>1){const xt=s_(st,Be,l.vertical||re,u,24,Ae);xt&&nt(st,xt)}}else if("Polygon"===i.type)for(const st of Tm(i.geometry,0)){const xt=u_(st,16);nt(st[0],new Gl(xt.x,xt.y,0,0,void 0))}else if("LineString"===i.type)for(const st of i.geometry)nt(st,new Gl(st[0].x,st[0].y,0,0,void 0));else if("Point"===i.type)for(const st of i.geometry)for(const xt of st)nt([xt],new Gl(xt.x,xt.y,0,0,void 0))}const $l=32640;function A_(a,i,l,u,f,x,b,S,P,F,N,U,j,q,re,oe){const Ae=function(Le,Be,Ne,Ue,Ze,at,pt,gt){const nt=[];if(0===Be.positionedLines.length)return nt;const st=Ue.layout.get("text-rotate").evaluate(at,{})*Math.PI/180,xt=function(en){const Tn=en[0],Gt=en[1],nn=Tn*Gt;return nn>0?[Tn,-Gt]:nn<0?[-Tn,Gt]:0===Tn?[Gt,Tn]:[Gt,-Tn]}(Ne);let ot=Math.abs(Be.top-Be.bottom);for(const en of Be.positionedLines)ot-=en.lineOffset;const Jt=Be.positionedLines.length,Tt=ot/Jt;let nr=Be.top-Ne[1];for(let en=0;en<Jt;++en){const Tn=Be.positionedLines[en];nr=g1(Be,Tt,nr,en);for(const Gt of Tn.positionedGlyphs){if(!Gt.rect)continue;const nn=Gt.rect||{};let Bn=4,Si=!0,Hr=1,Bi=0;if(Gt.imageName){const jn=pt[Gt.imageName];if(!jn)continue;if(jn.sdf){jr("SDF images are not supported in formatted text and will be ignored.");continue}Si=!1,Hr=jn.pixelRatio,Bn=1/Hr}const Ni=(Ze||gt)&&Gt.vertical,qr=Gt.metrics.advance*Gt.scale/2,hr=Gt.metrics,dr=Gt.rect;if(null===dr)continue;gt&&Be.verticalizable&&(Bi=Gt.imageName?qr-Gt.metrics.width*Gt.scale/2:0);const zi=Ze?[Gt.x+qr,Gt.y]:[0,0];let Xr=[0,0],Vi=[0,0],Ti=!1;Ze||(Ni?(Vi=[Gt.x+qr+xt[0],Gt.y+xt[1]-Bi],Ti=!0):Xr=[Gt.x+qr+Ne[0],Gt.y+Ne[1]-Bi]);const Ar=dr.w*Gt.scale/(Hr*(Gt.localGlyph?2:1)),ei=dr.h*Gt.scale/(Hr*(Gt.localGlyph?2:1));let Ir,kr,ti,Go;if(Ni){const jn=Gt.y-nr,Ui=new dt(-qr,qr-jn),ss=-Math.PI/2,Fs=new dt(...Vi);Ir=new dt(-qr+Xr[0],Xr[1]),Ir._rotateAround(ss,Ui)._add(Fs),Ir.x+=-jn+qr,Ir.y-=(hr.left-Bn)*Gt.scale;const Os=Gt.imageName?hr.advance*Gt.scale:24*Gt.scale,Ba=String.fromCharCode(Gt.glyph);A1(Ba)?Ir.x+=(1-Bn)*Gt.scale:K0(Ba)?Ir.x+=Os-hr.height*Gt.scale+(-Bn-1)*Gt.scale:Ir.x+=Gt.imageName||hr.width+2*Bn===dr.w&&hr.height+2*Bn===dr.h?(Os-ei)/2:(Os-(hr.height+2*Bn)*Gt.scale)/2,kr=new dt(Ir.x,Ir.y-Ar),ti=new dt(Ir.x+ei,Ir.y),Go=new dt(Ir.x+ei,Ir.y-Ar)}else{const jn=(hr.left-Bn)*Gt.scale-qr+Xr[0],Ui=(-hr.top-Bn)*Gt.scale+Xr[1],ss=jn+Ar,Fs=Ui+ei;Ir=new dt(jn,Ui),kr=new dt(ss,Ui),ti=new dt(jn,Fs),Go=new dt(ss,Fs)}if(st){let jn;jn=Ze?new dt(0,0):Ti?new dt(xt[0],xt[1]):new dt(Ne[0],Ne[1]),Ir._rotateAround(st,jn),kr._rotateAround(st,jn),ti._rotateAround(st,jn),Go._rotateAround(st,jn)}const ni=new dt(0,0),ri=new dt(0,0);nt.push({tl:Ir,tr:kr,bl:ti,br:Go,tex:nn,writingMode:Be.writingMode,glyphOffset:zi,sectionIndex:Gt.sectionIndex,isSDF:Si,pixelOffsetTL:ni,pixelOffsetBR:ri,minFontScaleX:0,minFontScaleY:0})}}return nt}(0,u,P,x,b,S,f,a.allowVerticalPlacement),xe=a.textSizeData;let Se=null;"source"===xe.kind?(Se=[al*x.layout.get("text-size").evaluate(S,{},oe)],Se[0]>$l&&jr(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===xe.kind&&(Se=[al*re.compositeTextSizes[0].evaluate(S,{},oe),al*re.compositeTextSizes[1].evaluate(S,{},oe)],(Se[0]>$l||Se[1]>$l)&&jr(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,Ae,Se,P,b,S,N,i,l,F.lineStartIndex,F.lineLength,q,oe);for(const Le of U)j[Le]=a.text.placedSymbolArray.length-1;return 4*Ae.length}function f_(a){for(const i in a)return a[i];return null}function ep(a,i,l,u,f,x,b,S,P,F){let N=b.top,U=b.bottom,j=b.left,q=b.right;const re=b.collisionPadding;if(re&&(j-=re[0],N-=re[1],q+=re[2],U+=re[3]),P){const oe=new dt(j,N),Ae=new dt(q,N),xe=new dt(j,U),Se=new dt(q,U),Le=qn(P);let Be=new dt(0,0);F&&(Be=new dt(F[0],F[1])),oe._rotateAround(Le,Be),Ae._rotateAround(Le,Be),xe._rotateAround(Le,Be),Se._rotateAround(Le,Be),j=Math.min(oe.x,Ae.x,xe.x,Se.x),q=Math.max(oe.x,Ae.x,xe.x,Se.x),N=Math.min(oe.y,Ae.y,xe.y,Se.y),U=Math.max(oe.y,Ae.y,xe.y,Se.y)}return a.emplaceBack(i.x,i.y,i.z,l.x,l.y,j,N,q,U,S,u,f,x),a.length-1}function rg(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const i=a.bottom-a.top;return i>0?Math.max(10,i):null}function p_(a,i,l,u){const f=a.compareText;if(i in f){const x=f[i];for(let b=x.length-1;b>=0;b--)if(u.dist(x[b])<l)return!0}else f[i]=[];return f[i].push(u),!1}const v1=Fa.VectorTileFeature.types,x1=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function tp(a,i,l,u,f,x,b,S,P,F,N,U,j,q,re,oe){const Ae=N?Math.min($l,Math.round(N[0])):0,xe=N?Math.min($l,Math.round(N[1])):0;a.emplaceBack(i,l,Math.round(32*b),Math.round(32*S),P,F,(Ae<<1)+(U?1:0),xe,16*j,16*q,256*re,256*oe,u,f,x,0)}function An(a,i,l){a.emplaceBack(i.x,i.y,l),a.emplaceBack(i.x,i.y,l),a.emplaceBack(i.x,i.y,l),a.emplaceBack(i.x,i.y,l)}function Ht(a){for(const i of a.sections)if(_(i.text))return!0;return!1}class np{constructor(i){this.layoutVertexArray=new yo,this.indexArray=new Pn,this.programConfigurations=i,this.segments=new Li,this.dynamicLayoutVertexArray=new hn,this.opacityVertexArray=new Po,this.placedSymbolArray=new on}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(i,l,u,f){this.isEmpty()||(u&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,X0.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,Gf.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,x1,!0),this.opacityVertexBuffer.itemSize=1),(u||f)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ft("SymbolBuffers",np);class Jh{constructor(i,l,u){this.layoutVertexArray=new i,this.layoutAttributes=l,this.indexArray=new u,this.segments=new Li,this.collisionVertexArray=new Ro,this.collisionVertexArrayExt=new hn}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,u1.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,h1.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Ft("CollisionBuffers",Jh);class co{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(b=>b.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=If([]),this.placementViewportMatrix=If([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Nm(this.zoom,l["text-size"]),this.iconSizeData=Nm(this.zoom,l["icon-size"]);const u=this.layers[0].layout,f=u.get("symbol-sort-key"),x=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==x&&void 0!==f.constantOr(1),this.sortFeaturesByY=("viewport-y"===x||"auto"===x&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(b=>Ps[b]),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=i.sourceID}createArrays(){this.text=new np(new ra(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new np(new ra(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new Mv,this.lineVertexArray=new Sv,this.symbolInstances=new mm}calculateGlyphDependencies(i,l,u,f,x){for(let b=0;b<i.length;b++)if(l[i.charCodeAt(b)]=!0,f&&x){const S=fA[i.charAt(b)];S&&(l[S.charCodeAt(0)]=!0)}}populate(i,l,u){const f=this.layers[0],x=f.layout,b=x.get("text-font"),S=x.get("text-field"),P=x.get("icon-image"),F=("constant"!==S.value.kind||S.value.value instanceof fi&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&("constant"!==b.value.kind||b.value.value.length>0),N="constant"!==P.value.kind||!!P.value.value||Object.keys(P.parameters).length>0,U=x.get("symbol-sort-key");if(this.features=[],!F&&!N)return;const j=l.iconDependencies,q=l.glyphDependencies,re=l.availableImages,oe=new te(this.zoom);for(const{feature:Ae,id:xe,index:Se,sourceLayerIndex:Le}of i){const Be=f._featureFilter.needGeometry,Ne=qu(Ae,Be);if(!f._featureFilter.filter(oe,Ne,u))continue;let Ue,Ze;if(Be||(Ne.geometry=ia(Ae)),F){const pt=f.getValueAndResolveTokens("text-field",Ne,u,re),gt=fi.factory(pt);Ht(gt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===H()||this.hasRTLText&&J.isParsed())&&(Ue=Y0(gt,f,Ne))}if(N){const pt=f.getValueAndResolveTokens("icon-image",Ne,u,re);Ze=pt instanceof Bo?pt:Bo.fromString(pt)}if(!Ue&&!Ze)continue;const at=this.sortFeaturesByKey?U.evaluate(Ne,{},u):void 0;if(this.features.push({id:xe,text:Ue,icon:Ze,index:Se,sourceLayerIndex:Le,geometry:Ne.geometry,properties:Ae.properties,type:v1[Ae.type],sortKey:at}),Ze&&(j[Ze.name]=!0),Ue){const pt=b.evaluate(Ne,{},u).join(","),gt="map"===x.get("text-rotation-alignment")&&"point"!==x.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ps.vertical)>=0;for(const nt of Ue.sections)if(nt.image)j[nt.image.name]=!0;else{const st=Vl(Ue.toString()),xt=nt.fontStack||pt,ot=q[xt]=q[xt]||{};this.calculateGlyphDependencies(nt.text,ot,gt,this.allowVerticalPlacement,st)}}}"line"===x.get("symbol-placement")&&(this.features=function(Ae){const xe={},Se={},Le=[];let Be=0;function Ne(pt){Le.push(Ae[pt]),Be++}function Ue(pt,gt,nt){const st=Se[pt];return delete Se[pt],Se[gt]=st,Le[st].geometry[0].pop(),Le[st].geometry[0]=Le[st].geometry[0].concat(nt[0]),st}function Ze(pt,gt,nt){const st=xe[gt];return delete xe[gt],xe[pt]=st,Le[st].geometry[0].shift(),Le[st].geometry[0]=nt[0].concat(Le[st].geometry[0]),st}function at(pt,gt,nt){const st=nt?gt[0][gt[0].length-1]:gt[0][0];return`${pt}:${st.x}:${st.y}`}for(let pt=0;pt<Ae.length;pt++){const gt=Ae[pt],nt=gt.geometry,st=gt.text?gt.text.toString():null;if(!st){Ne(pt);continue}const xt=at(st,nt),ot=at(st,nt,!0);if(xt in Se&&ot in xe&&Se[xt]!==xe[ot]){const Jt=Ze(xt,ot,nt),Tt=Ue(xt,ot,Le[Jt].geometry);delete xe[xt],delete Se[ot],Se[at(st,Le[Tt].geometry,!0)]=Tt,Le[Jt].geometry=null}else xt in Se?Ue(xt,ot,nt):ot in xe?Ze(xt,ot,nt):(Ne(pt),xe[xt]=Be-1,Se[ot]=Be-1)}return Le.filter(pt=>pt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ae,xe)=>Ae.sortKey-xe.sortKey)}update(i,l,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,l,this.layers,u),this.icon.programConfigurations.updatePaintArrays(i,l,this.layers,u))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,l){const u=this.lineVertexArray.length;if(void 0!==i.segment){let f=i.dist(l[i.segment+1]),x=i.dist(l[i.segment]);const b={};for(let S=i.segment+1;S<l.length;S++)b[S]={x:l[S].x,y:l[S].y,tileUnitDistanceFromAnchor:f},S<l.length-1&&(f+=l[S+1].dist(l[S]));for(let S=i.segment||0;S>=0;S--)b[S]={x:l[S].x,y:l[S].y,tileUnitDistanceFromAnchor:x},S>0&&(x+=l[S-1].dist(l[S]));for(let S=0;S<l.length;S++){const P=b[S];this.lineVertexArray.emplaceBack(P.x,P.y,P.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(i,l,u,f,x,b,S,P,F,N,U,j,q){const re=i.indexArray,oe=i.layoutVertexArray,Ae=i.segments.prepareSegment(4*l.length,oe,re,this.canOverlap?b.sortKey:void 0),xe=this.glyphOffsetArray.length,Se=Ae.vertexLength,Le=this.allowVerticalPlacement&&S===Ps.vertical?Math.PI/2:0,Be=b.text&&b.text.sections;for(let Ne=0;Ne<l.length;Ne++){const{tl:Ue,tr:Ze,bl:at,br:pt,tex:gt,pixelOffsetTL:nt,pixelOffsetBR:st,minFontScaleX:xt,minFontScaleY:ot,glyphOffset:Jt,isSDF:Tt,sectionIndex:nr}=l[Ne],en=Ae.vertexLength,Tn=Jt[1];tp(oe,P.x,P.y,P.z,F.x,F.y,Ue.x,Tn+Ue.y,gt.x,gt.y,u,Tt,nt.x,nt.y,xt,ot),tp(oe,P.x,P.y,P.z,F.x,F.y,Ze.x,Tn+Ze.y,gt.x+gt.w,gt.y,u,Tt,st.x,nt.y,xt,ot),tp(oe,P.x,P.y,P.z,F.x,F.y,at.x,Tn+at.y,gt.x,gt.y+gt.h,u,Tt,nt.x,st.y,xt,ot),tp(oe,P.x,P.y,P.z,F.x,F.y,pt.x,Tn+pt.y,gt.x+gt.w,gt.y+gt.h,u,Tt,st.x,st.y,xt,ot),An(i.dynamicLayoutVertexArray,P,Le),re.emplaceBack(en,en+1,en+2),re.emplaceBack(en+1,en+2,en+3),Ae.vertexLength+=4,Ae.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Jt[0]),Ne!==l.length-1&&nr===l[Ne+1].sectionIndex||i.programConfigurations.populatePaintArrays(oe.length,b,b.index,{},q,Be&&Be[nr])}i.placedSymbolArray.emplaceBack(P.x,P.y,P.z,F.x,F.y,xe,this.glyphOffsetArray.length-xe,Se,N,U,F.segment,u?u[0]:0,u?u[1]:0,f[0],f[1],S,0,!1,0,j,0)}_commitLayoutVertex(i,l,u,f,x,b,S){i.emplaceBack(l,u,f,x,b,Math.round(S.x),Math.round(S.y))}_addCollisionDebugVertices(i,l,u,f,x,b,S){const P=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),F=P.vertexLength,N=S.tileAnchorX,U=S.tileAnchorY;for(let q=0;q<4;q++)u.collisionVertexArray.emplaceBack(0,0,0,0);u.collisionVertexArrayExt.emplaceBack(l,-i.padding,-i.padding),u.collisionVertexArrayExt.emplaceBack(l,i.padding,-i.padding),u.collisionVertexArrayExt.emplaceBack(l,i.padding,i.padding),u.collisionVertexArrayExt.emplaceBack(l,-i.padding,i.padding),this._commitLayoutVertex(u.layoutVertexArray,f,x,b,N,U,new dt(i.x1,i.y1)),this._commitLayoutVertex(u.layoutVertexArray,f,x,b,N,U,new dt(i.x2,i.y1)),this._commitLayoutVertex(u.layoutVertexArray,f,x,b,N,U,new dt(i.x2,i.y2)),this._commitLayoutVertex(u.layoutVertexArray,f,x,b,N,U,new dt(i.x1,i.y2)),P.vertexLength+=4;const j=u.indexArray;j.emplaceBack(F,F+1),j.emplaceBack(F+1,F+2),j.emplaceBack(F+2,F+3),j.emplaceBack(F+3,F),P.primitiveLength+=4}_addTextDebugCollisionBoxes(i,l,u,f,x,b){for(let S=f;S<x;S++){const P=u.get(S),F=this.getSymbolInstanceTextSize(i,b,l,S);this._addCollisionDebugVertices(P,F,this.textCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,b)}}_addIconDebugCollisionBoxes(i,l,u,f,x,b){for(let S=f;S<x;S++){const P=u.get(S),F=this.getSymbolInstanceIconSize(i,l,S);this._addCollisionDebugVertices(P,F,this.iconCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,b)}}generateCollisionDebugBuffers(i,l){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Jh(vo,Vc.members,ci),this.iconCollisionBox=new Jh(vo,Vc.members,ci);const u=jl(this.iconSizeData,i),f=jl(this.textSizeData,i);for(let x=0;x<this.symbolInstances.length;x++){const b=this.symbolInstances.get(x);this._addTextDebugCollisionBoxes(f,i,l,b.textBoxStartIndex,b.textBoxEndIndex,b),this._addTextDebugCollisionBoxes(f,i,l,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._addIconDebugCollisionBoxes(u,i,l,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._addIconDebugCollisionBoxes(u,i,l,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}}getSymbolInstanceTextSize(i,l,u,f){const x=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:f),b=$f(this.textSizeData,i,x)/24;return this.tilePixelRatio*b}getSymbolInstanceIconSize(i,l,u){const f=this.icon.placedSymbolArray.get(u),x=$f(this.iconSizeData,i,f);return this.tilePixelRatio*x}_commitDebugCollisionVertexUpdate(i,l,u){i.emplaceBack(l,-u,-u),i.emplaceBack(l,u,-u),i.emplaceBack(l,u,u),i.emplaceBack(l,-u,u)}_updateTextDebugCollisionBoxes(i,l,u,f,x,b){for(let S=f;S<x;S++){const P=u.get(S),F=this.getSymbolInstanceTextSize(i,b,l,S);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,F,P.padding)}}_updateIconDebugCollisionBoxes(i,l,u,f,x){for(let b=f;b<x;b++){const S=u.get(b),P=this.getSymbolInstanceIconSize(i,l,b);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,P,S.padding)}}updateCollisionDebugBuffers(i,l){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const u=jl(this.iconSizeData,i),f=jl(this.textSizeData,i);for(let x=0;x<this.symbolInstances.length;x++){const b=this.symbolInstances.get(x);this._updateTextDebugCollisionBoxes(f,i,l,b.textBoxStartIndex,b.textBoxEndIndex,b),this._updateTextDebugCollisionBoxes(f,i,l,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._updateIconDebugCollisionBoxes(u,i,l,b.iconBoxStartIndex,b.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(u,i,l,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,l,u,f,x,b,S,P,F){const N={};for(let U=l;U<u;U++){const j=i.get(U);N.textBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,padding:j.padding,projectedAnchorX:j.projectedAnchorX,projectedAnchorY:j.projectedAnchorY,projectedAnchorZ:j.projectedAnchorZ,tileAnchorX:j.tileAnchorX,tileAnchorY:j.tileAnchorY},N.textFeatureIndex=j.featureIndex;break}for(let U=f;U<x;U++){const j=i.get(U);N.verticalTextBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,padding:j.padding,projectedAnchorX:j.projectedAnchorX,projectedAnchorY:j.projectedAnchorY,projectedAnchorZ:j.projectedAnchorZ,tileAnchorX:j.tileAnchorX,tileAnchorY:j.tileAnchorY},N.verticalTextFeatureIndex=j.featureIndex;break}for(let U=b;U<S;U++){const j=i.get(U);N.iconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,padding:j.padding,projectedAnchorX:j.projectedAnchorX,projectedAnchorY:j.projectedAnchorY,projectedAnchorZ:j.projectedAnchorZ,tileAnchorX:j.tileAnchorX,tileAnchorY:j.tileAnchorY},N.iconFeatureIndex=j.featureIndex;break}for(let U=P;U<F;U++){const j=i.get(U);N.verticalIconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,padding:j.padding,projectedAnchorX:j.projectedAnchorX,projectedAnchorY:j.projectedAnchorY,projectedAnchorZ:j.projectedAnchorZ,tileAnchorX:j.tileAnchorX,tileAnchorY:j.tileAnchorY},N.verticalIconFeatureIndex=j.featureIndex;break}return N}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const u=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,l){const u=i.placedSymbolArray.get(l),f=u.vertexStartIndex+4*u.numGlyphs;for(let x=u.vertexStartIndex;x<f;x+=4)i.indexArray.emplaceBack(x,x+1,x+2),i.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const l=Math.sin(i),u=Math.cos(i),f=[],x=[],b=[];for(let S=0;S<this.symbolInstances.length;++S){b.push(S);const P=this.symbolInstances.get(S);f.push(0|Math.round(l*P.tileAnchorX+u*P.tileAnchorY)),x.push(P.featureIndex)}return b.sort((S,P)=>f[S]-f[P]||x[P]-x[S]),b}addToSortKeyRanges(i,l){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===l?u.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const u=this.symbolInstances.get(l);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((f,x,b)=>{f>=0&&b.indexOf(f)===x&&this.addIndicesForPlacedSymbol(this.text,f)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ft("SymbolBucket",co,{omit:["layers","collisionBoxArray","features","compareText"]}),co.MAX_GLYPHS=65535,co.addDynamicAttributes=An;const m_=new Ge({"symbol-placement":new de(Ce.layout_symbol["symbol-placement"]),"symbol-spacing":new de(Ce.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new de(Ce.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Fe(Ce.layout_symbol["symbol-sort-key"]),"symbol-z-order":new de(Ce.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new de(Ce.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new de(Ce.layout_symbol["icon-ignore-placement"]),"icon-optional":new de(Ce.layout_symbol["icon-optional"]),"icon-rotation-alignment":new de(Ce.layout_symbol["icon-rotation-alignment"]),"icon-size":new Fe(Ce.layout_symbol["icon-size"]),"icon-text-fit":new de(Ce.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new de(Ce.layout_symbol["icon-text-fit-padding"]),"icon-image":new Fe(Ce.layout_symbol["icon-image"]),"icon-rotate":new Fe(Ce.layout_symbol["icon-rotate"]),"icon-padding":new de(Ce.layout_symbol["icon-padding"]),"icon-keep-upright":new de(Ce.layout_symbol["icon-keep-upright"]),"icon-offset":new Fe(Ce.layout_symbol["icon-offset"]),"icon-anchor":new Fe(Ce.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new de(Ce.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new de(Ce.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new de(Ce.layout_symbol["text-rotation-alignment"]),"text-field":new Fe(Ce.layout_symbol["text-field"]),"text-font":new Fe(Ce.layout_symbol["text-font"]),"text-size":new Fe(Ce.layout_symbol["text-size"]),"text-max-width":new Fe(Ce.layout_symbol["text-max-width"]),"text-line-height":new Fe(Ce.layout_symbol["text-line-height"]),"text-letter-spacing":new Fe(Ce.layout_symbol["text-letter-spacing"]),"text-justify":new Fe(Ce.layout_symbol["text-justify"]),"text-radial-offset":new Fe(Ce.layout_symbol["text-radial-offset"]),"text-variable-anchor":new de(Ce.layout_symbol["text-variable-anchor"]),"text-anchor":new Fe(Ce.layout_symbol["text-anchor"]),"text-max-angle":new de(Ce.layout_symbol["text-max-angle"]),"text-writing-mode":new de(Ce.layout_symbol["text-writing-mode"]),"text-rotate":new Fe(Ce.layout_symbol["text-rotate"]),"text-padding":new de(Ce.layout_symbol["text-padding"]),"text-keep-upright":new de(Ce.layout_symbol["text-keep-upright"]),"text-transform":new Fe(Ce.layout_symbol["text-transform"]),"text-offset":new Fe(Ce.layout_symbol["text-offset"]),"text-allow-overlap":new de(Ce.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new de(Ce.layout_symbol["text-ignore-placement"]),"text-optional":new de(Ce.layout_symbol["text-optional"])});var ig={paint:new Ge({"icon-opacity":new Fe(Ce.paint_symbol["icon-opacity"]),"icon-color":new Fe(Ce.paint_symbol["icon-color"]),"icon-halo-color":new Fe(Ce.paint_symbol["icon-halo-color"]),"icon-halo-width":new Fe(Ce.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Fe(Ce.paint_symbol["icon-halo-blur"]),"icon-translate":new de(Ce.paint_symbol["icon-translate"]),"icon-translate-anchor":new de(Ce.paint_symbol["icon-translate-anchor"]),"text-opacity":new Fe(Ce.paint_symbol["text-opacity"]),"text-color":new Fe(Ce.paint_symbol["text-color"],{runtimeType:Wn,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Fe(Ce.paint_symbol["text-halo-color"]),"text-halo-width":new Fe(Ce.paint_symbol["text-halo-width"]),"text-halo-blur":new Fe(Ce.paint_symbol["text-halo-blur"]),"text-translate":new de(Ce.paint_symbol["text-translate"]),"text-translate-anchor":new de(Ce.paint_symbol["text-translate-anchor"])}),layout:m_};class rp{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:Ka,this.defaultValue=i}evaluate(i){if(i.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(i.formattedSection))return l.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ft("FormatSectionOverride",rp,{omit:["defaultValue"]});class aa extends Ra{constructor(i){super(i,ig)}recalculate(i,l){super.recalculate(i,l),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const f=[];for(const x of u)f.indexOf(x)<0&&f.push(x);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(i,l,u,f){const x=this.layout.get(i).evaluate(l,{},u,f),b=this._unevaluatedLayout._values[i];return b.isDataDriven()||Sr(b.value)||!x?x:(S=l.properties,x.replace(/{([^{}]+)}/g,(F,N)=>N in S?String(S[N]):""));var S}createBucket(i){return new co(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of ig.paint.overridableProperties){if(!aa.hasPaintOverride(this.layout,i))continue;const l=this.paint.get(i),u=new rp(l),f=new kh(u,l.property.specification);let x=null;x="constant"===l.value.kind||"source"===l.value.kind?new Ph("source",f):new tl("composite",f,l.value.zoomStops,l.value._interpolationType),this.paint._values[i]=new ve(l.property,x,l.parameters)}}_handleOverridablePaintPropertyUpdate(i,l,u){return!(!this.layout||l.isDataDriven()||u.isDataDriven())&&aa.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,l){const u=i.get("text-field"),f=ig.paint.properties[l];let x=!1;const b=S=>{for(const P of S)if(f.overrides&&f.overrides.hasOverride(P))return void(x=!0)};if("constant"===u.value.kind&&u.value.value instanceof fi)b(u.value.value.sections);else if("source"===u.value.kind){const S=F=>{x||(F instanceof pi&&xi(F.value)===Wt?b(F.value.sections):F instanceof Eu?b(F.sections):F.eachChild(S))},P=u.value;P._styleExpression&&S(P._styleExpression.expression)}return x}getProgramConfiguration(i){return new Pa(this,i)}}var og={paint:new Ge({"background-color":new de(Ce.paint_background["background-color"]),"background-pattern":new it(Ce.paint_background["background-pattern"]),"background-opacity":new de(Ce.paint_background["background-opacity"])})},g_={paint:new Ge({"raster-opacity":new de(Ce.paint_raster["raster-opacity"]),"raster-hue-rotate":new de(Ce.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new de(Ce.paint_raster["raster-brightness-min"]),"raster-brightness-max":new de(Ce.paint_raster["raster-brightness-max"]),"raster-saturation":new de(Ce.paint_raster["raster-saturation"]),"raster-contrast":new de(Ce.paint_raster["raster-contrast"]),"raster-resampling":new de(Ce.paint_raster["raster-resampling"]),"raster-fade-duration":new de(Ce.paint_raster["raster-fade-duration"])})};class sg extends Ra{constructor(i){super(i,{}),this.implementation=i}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}var A2={paint:new Ge({"sky-type":new de(Ce.paint_sky["sky-type"]),"sky-atmosphere-sun":new de(Ce.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new de(Ce.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new de(Ce.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new de(Ce.paint_sky["sky-gradient-radius"]),"sky-gradient":new Pe(Ce.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new de(Ce.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new de(Ce.paint_sky["sky-atmosphere-color"]),"sky-opacity":new de(Ce.paint_sky["sky-opacity"])})};function ip(a,i,l){const u=$h(0,0,1),f=Rf(qh());return function(x,b,S){S*=.5;var P=b[0],F=b[1],N=b[2],U=b[3],j=Math.sin(S),q=Math.cos(S);x[0]=P*q-N*j,x[1]=F*q+U*j,x[2]=N*q+P*j,x[3]=U*q-F*j}(f,f,l?-qn(a)+Math.PI:qn(a)),Xu(f,f,-qn(i)),xm(u,u,f),zv(u,u)}const f2={circle:class extends Ra{constructor(a){super(a,Tf)}createBucket(a){return new ym(a)}queryRadius(a){const i=a;return Zu("circle-radius",this,i)+Zu("circle-stroke-width",this,i)+rA(this.paint.get("circle-translate"))}queryIntersectsFeature(a,i,l,u,f,x,b,S){const P=Wu(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,a.pixelToTileUnitsFactor),F=this.paint.get("circle-radius").evaluate(i,l)+this.paint.get("circle-stroke-width").evaluate(i,l);return O0(a,u,x,b,S,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),P,F)}getProgramIds(){return["circle"]}getProgramConfiguration(a){return new Pa(this,a)}},heatmap:class extends Ra{createBucket(a){return new wm(a)}constructor(a){super(a,$v),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"heatmap-color"===a&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Em({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return Zu("heatmap-radius",this,a)}queryIntersectsFeature(a,i,l,u,f,x,b,S){const P=this.paint.get("heatmap-radius").evaluate(i,l);return O0(a,u,x,b,S,!0,!0,new dt(0,0),P)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(a){return new Pa(this,a)}},hillshade:class extends Ra{constructor(a){super(a,Hv)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(a){return new Pa(this,a)}},fill:class extends Ra{constructor(a){super(a,Vr)}getProgramIds(){const a=this.paint.get("fill-pattern"),i=a&&a.constantOr(1),l=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getProgramConfiguration(a){return new Pa(this,a)}recalculate(a,i){super.recalculate(a,i);const l=this.paint._values["fill-outline-color"];"constant"===l.value.kind&&void 0===l.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new hA(a)}queryRadius(){return rA(this.paint.get("fill-translate"))}queryIntersectsFeature(a,i,l,u,f,x){return!a.queryGeometry.isAboveHorizon&&Sf(Nv(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,a.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}},"fill-extrusion":class extends Ra{constructor(a){super(a,Fm)}createBucket(a){return new ao(a)}queryRadius(){return rA(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(a){return new Pa(this,a)}queryIntersectsFeature(a,i,l,u,f,x,b,S,P){const F=Wu(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,a.pixelToTileUnitsFactor),N=this.paint.get("fill-extrusion-height").evaluate(i,l),U=this.paint.get("fill-extrusion-base").evaluate(i,l),j=[0,0],q=S&&x.elevation,re=x.elevation?x.elevation.exaggeration():1;if(q){const xe=a.tile.getBucket(this).centroidVertexArray,Se=P+1;if(Se<xe.length){const Le=xe.get(Se);j[0]=Le.a_centroid_pos0,j[1]=Le.a_centroid_pos1}}if(0===j[0]&&1===j[1])return!1;const oe=(xe=u,Se=U,Le=N,Be=F,Ne=b,(Ue=q?S:null)?function(gt,nt,st,xt,ot,Jt,Tt,nr,en){const Tn=[],Gt=[],nn=[0,0,0,1];for(const Bn of gt){const Si=[],Hr=[];for(const Bi of Bn){const Ni=Bi.x+xt.x,qr=Bi.y+xt.y,hr=i1(Ni,qr,nt,st,Jt,Tt,nr,en);nn[0]=Ni,nn[1]=qr,nn[2]=hr.base,nn[3]=1,sA(nn,nn,ot),nn[3]=Math.max(nn[3],1e-5);const dr=Om([nn[0]/nn[3],nn[1]/nn[3],nn[2]/nn[3]]);nn[0]=Ni,nn[1]=qr,nn[2]=hr.top,nn[3]=1,sA(nn,nn,ot),nn[3]=Math.max(nn[3],1e-5);const zi=Om([nn[0]/nn[3],nn[1]/nn[3],nn[2]/nn[3]]);Si.push(dr),Hr.push(zi)}Tn.push(Si),Gt.push(Hr)}return[Tn,Gt]}(xe,Se,Le,Be,Ne,Ue,j,re,x.center.lat):function(gt,nt,st,xt,ot){const Jt=[],Tt=[],nr=ot[8]*nt,en=ot[9]*nt,Tn=ot[10]*nt,Gt=ot[11]*nt,nn=ot[8]*st,Bn=ot[9]*st,Si=ot[10]*st,Hr=ot[11]*st;for(const Bi of gt){const Ni=[],qr=[];for(const hr of Bi){const dr=hr.x+xt.x,zi=hr.y+xt.y,Xr=ot[0]*dr+ot[4]*zi+ot[12],Vi=ot[1]*dr+ot[5]*zi+ot[13],Ti=ot[2]*dr+ot[6]*zi+ot[14],Ar=ot[3]*dr+ot[7]*zi+ot[15],ei=Xr+nr,Ir=Vi+en,kr=Ti+Tn,ti=Math.max(Ar+Gt,1e-5),Go=Xr+nn,ni=Vi+Bn,ri=Ti+Si,jn=Math.max(Ar+Hr,1e-5),Ui=new dt(ei/ti,Ir/ti);Ui.z=kr/ti,Ni.push(Ui);const ss=new dt(Go/jn,ni/jn);ss.z=ri/jn,qr.push(ss)}Jt.push(Ni),Tt.push(qr)}return[Jt,Tt]}(xe,Se,Le,Be,Ne)),Ae=a.queryGeometry;var xe,Se,Le,Be,Ne,Ue;return function(xe,Se,Le){let Be=1/0;Sf(Le,Se)&&(Be=q0(Le,Se[0]));for(let Ne=0;Ne<Se.length;Ne++){const Ue=Se[Ne],Ze=xe[Ne];for(let at=0;at<Ue.length-1;at++){const pt=Ue[at],gt=[pt,Ue[at+1],Ze[at+1],Ze[at],pt];Mf(Le,gt)&&(Be=Math.min(Be,q0(Le,gt)))}}return Be!==1/0&&Be}(oe[0],oe[1],Ae.isPointQuery()?Ae.screenBounds:Ae.screenGeometry)}},line:class extends Ra{constructor(a){super(a,Bm),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if("line-gradient"===a){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof $i,this.gradientVersion=(this.gradientVersion+1)%ms}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,i){super.recalculate(a,i),this.paint._values["line-floorwidth"]=Q0.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new jf(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(a){return new Pa(this,a)}queryRadius(a){const i=a,l=c1(Zu("line-width",this,i),Zu("line-gap-width",this,i)),u=Zu("line-offset",this,i);return l/2+Math.abs(u)+rA(this.paint.get("line-translate"))}queryIntersectsFeature(a,i,l,u,f,x){if(a.queryGeometry.isAboveHorizon)return!1;const b=Nv(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,a.pixelToTileUnitsFactor),S=a.pixelToTileUnitsFactor/2*c1(this.paint.get("line-width").evaluate(i,l),this.paint.get("line-gap-width").evaluate(i,l)),P=this.paint.get("line-offset").evaluate(i,l);return P&&(u=function(F,N){const U=[],j=new dt(0,0);for(let q=0;q<F.length;q++){const re=F[q],oe=[];for(let Ae=0;Ae<re.length;Ae++){const xe=re[Ae-1],Se=re[Ae],Le=re[Ae+1],Be=0===Ae?j:Se.sub(xe)._unit()._perp(),Ne=Ae===re.length-1?j:Le.sub(Se)._unit()._perp(),Ue=Be._add(Ne)._unit();Ue._mult(1/(Ue.x*Ne.x+Ue.y*Ne.y)),oe.push(Ue._mult(N)._add(Se))}U.push(oe)}return U}(u,P*a.pixelToTileUnitsFactor)),function(F,N,U){for(let j=0;j<N.length;j++){const q=N[j];if(F.length>=3)for(let re=0;re<q.length;re++)if(oa(F,q[re]))return!0;if(nA(F,q,U))return!0}return!1}(b,u,S)}isTileClipped(){return!0}},symbol:aa,background:class extends Ra{constructor(a){super(a,og)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Ra{constructor(a){super(a,g_)}getProgramIds(){return["raster"]}},sky:class extends Ra{constructor(a){super(a,A2),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"sky-gradient"===a?this._updateColorRamp():"sky-atmosphere-sun"!==a&&"sky-atmosphere-halo-color"!==a&&"sky-atmosphere-color"!==a&&"sky-atmosphere-sun-intensity"!==a||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Em({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}}getCenter(a,i){const l=this.paint.get("sky-type");if("atmosphere"===l){const u=this.paint.get("sky-atmosphere-sun"),f=!u,x=a.style.light,b=x.properties.get("position");return f&&"viewport"===x.properties.get("anchor")&&jr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?ip(b.azimuthal,90-b.polar,i):ip(u[0],90-u[1],i)}if("gradient"===l){const u=this.paint.get("sky-gradient-center");return ip(u[0],90-u[1],i)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return"atmosphere"===a?["skyboxCapture","skybox"]:"gradient"===a?["skyboxGradient"]:null}}},{HTMLImageElement:ll,HTMLCanvasElement:wA,HTMLVideoElement:CA,ImageData:op,ImageBitmap:ag}=Et;class sp{constructor(i,l,u,f){this.context=i,this.format=u,this.texture=i.gl.createTexture(),this.update(l,f)}update(i,l,u){const{width:f,height:x}=i,b=!(this.size&&this.size[0]===f&&this.size[1]===x||u),{context:S}=this,{gl:P}=S;if(this.useMipmap=Boolean(l&&l.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!l||!1!==l.premultiply)),b)this.size=[f,x],i instanceof ll||i instanceof wA||i instanceof CA||i instanceof op||ag&&i instanceof ag?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,i):P.texImage2D(P.TEXTURE_2D,0,this.format,f,x,0,this.format,P.UNSIGNED_BYTE,i.data);else{const{x:F,y:N}=u||{x:0,y:0};i instanceof ll||i instanceof wA||i instanceof CA||i instanceof op||ag&&i instanceof ag?P.texSubImage2D(P.TEXTURE_2D,0,F,N,P.RGBA,P.UNSIGNED_BYTE,i):P.texSubImage2D(P.TEXTURE_2D,0,F,N,f,x,P.RGBA,P.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)}bind(i,l,u){const{context:f}=this,{gl:x}=f;x.bindTexture(x.TEXTURE_2D,this.texture),u!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=x.LINEAR),i!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,i),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,u||i),this.filter=i),l!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,l),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class Hc{constructor(i,l){i&&(l?this.setSouthWest(i).setNorthEast(l):4===i.length?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof Jr?new Jr(i.lng,i.lat):Jr.convert(i),this}setSouthWest(i){return this._sw=i instanceof Jr?new Jr(i.lng,i.lat):Jr.convert(i),this}extend(i){const l=this._sw,u=this._ne;let f,x;if(i instanceof Jr)f=i,x=i;else{if(!(i instanceof Hc))return Array.isArray(i)?4===i.length||i.every(Array.isArray)?this.extend(Hc.convert(i)):this.extend(Jr.convert(i)):this;if(f=i._sw,x=i._ne,!f||!x)return this}return l||u?(l.lng=Math.min(f.lng,l.lng),l.lat=Math.min(f.lat,l.lat),u.lng=Math.max(x.lng,u.lng),u.lat=Math.max(x.lat,u.lat)):(this._sw=new Jr(f.lng,f.lat),this._ne=new Jr(x.lng,x.lat)),this}getCenter(){return new Jr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Jr(this.getWest(),this.getNorth())}getSouthEast(){return new Jr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:l,lat:u}=Jr.convert(i);let f=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f}static convert(i){return!i||i instanceof Hc?i:new Hc(i)}}const b1=6371008.8;class Jr{constructor(i,l){if(isNaN(i)||isNaN(l))throw new Error(`Invalid LngLat object: (${i}, ${l})`);if(this.lng=+i,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Jr($a(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const l=Math.PI/180,u=this.lat*l,f=i.lat*l,x=Math.sin(u)*Math.sin(f)+Math.cos(u)*Math.cos(f)*Math.cos((i.lng-this.lng)*l);return b1*Math.acos(Math.min(x,1))}toBounds(i=0){const l=360*i/40075017,u=l/Math.cos(Math.PI/180*this.lat);return new Hc(new Jr(this.lng-u,this.lat-l),new Jr(this.lng+u,this.lat+l))}static convert(i){if(i instanceof Jr)return i;if(Array.isArray(i)&&(2===i.length||3===i.length))return new Jr(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&"object"==typeof i&&null!==i)return new Jr(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const w1=2*Math.PI*b1;function lg(a){return w1*Math.cos(a*Math.PI/180)}function cg(a){return(180+a)/360}function __(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function EA(a,i){return a/lg(i)}function ug(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function y_(a,i){return a*lg(ug(i))}class DA{constructor(i,l,u=0){this.x=+i,this.y=+l,this.z=+u}static fromLngLat(i,l=0){const u=Jr.convert(i);return new DA(cg(u.lng),__(u.lat),EA(l,u.lat))}toLngLat(){return new Jr(360*this.x-180,ug(this.y))}toAltitude(){return y_(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/w1*(i=ug(this.y),1/Math.cos(i*Math.PI/180));var i}}class v_{constructor(i,l){this.width=i,this.height=l,this.nextRow=0,this.image=new Nc({width:i,height:l}),this.positions={},this.uploaded=!1}getDash(i,l){const u=this.getKey(i,l);return this.positions[u]}trim(){const i=this.width,l=this.height=bl(this.nextRow);this.image.resize({width:i,height:l})}getKey(i,l){return i.join(",")+l}getDashRanges(i,l,u){const f=[];let x=i.length%2==1?-i[i.length-1]*u:0,b=i[0]*u,S=!0;f.push({left:x,right:b,isDash:S,zeroLength:0===i[0]});let P=i[0];for(let F=1;F<i.length;F++){S=!S;const N=i[F];x=P*u,P+=N,b=P*u,f.push({left:x,right:b,isDash:S,zeroLength:0===N})}return f}addRoundDash(i,l,u){const f=l/2;for(let x=-u;x<=u;x++){const b=this.width*(this.nextRow+u+x);let S=0,P=i[S];for(let F=0;F<this.width;F++){F/P.right>1&&(P=i[++S]);const N=Math.abs(F-P.left),U=Math.abs(F-P.right),j=Math.min(N,U);let q;const re=x/u*(f+1);if(P.isDash){const oe=f-Math.abs(re);q=Math.sqrt(j*j+oe*oe)}else q=f-Math.sqrt(j*j+re*re);this.image.data[b+F]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(i,l){for(let P=i.length-1;P>=0;--P){const F=i[P],N=i[P+1];F.zeroLength?i.splice(P,1):N&&N.isDash===F.isDash&&(N.left=F.left,i.splice(P,1))}const u=i[0],f=i[i.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);const x=this.width*this.nextRow;let b=0,S=i[b];for(let P=0;P<this.width;P++){P/S.right>1&&(S=i[++b]);const F=Math.abs(P-S.left),N=Math.abs(P-S.right),U=Math.min(F,N);this.image.data[x+P]=Math.max(0,Math.min(255,(S.isDash?U:-U)+l+128))}}addDash(i,l){const u=this.getKey(i,l);if(this.positions[u])return this.positions[u];const f="round"===l,x=f?7:0,b=2*x+1;if(this.nextRow+b>this.height)return jr("LineAtlas out of space"),null;0===i.length&&i.push(1);let S=0;for(let N=0;N<i.length;N++)i[N]<0&&(jr("Negative value is found in line dasharray, replacing values with 0"),i[N]=0),S+=i[N];if(0!==S){const N=this.width/S,U=this.getDashRanges(i,this.width,N);f?this.addRoundDash(U,N,x):this.addRegularDash(U,"square"===l?.5*N:0)}const P=this.nextRow+x;this.nextRow+=b;const F={tl:[P,x],br:[S,0]};return this.positions[u]=F,F}}Ft("LineAtlas",v_);class p2{constructor(i){this._callback=i,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const m2=Et.performance;function C1(a){const i=a?a.url.toString():void 0;return m2.getEntriesByName(i)}class g2{constructor(){this.tasks={},this.taskQueue=[],lc(["process"],this),this.invoker=new p2(this.process),this.nextId=0}add(i,l){const u=this.nextId++,f=function({type:x,isSymbolTile:b,zoom:S}){return S=S||0,"message"===x?0:"maybePrepare"!==x||b?"parseTile"!==x||b?"parseTile"===x&&b?300-S:"maybePrepare"===x&&b?400-S:500:200-S:100-S}(l);if(0===f){wl();try{i()}finally{}return{cancel:()=>{}}}return this.tasks[u]={fn:i,metadata:l,priority:f,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){wl();try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const i=this.pick();if(null===i)return;const l=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let i=null,l=1/0;for(let f=0;f<this.taskQueue.length;f++){const x=this.tasks[this.taskQueue[f]];x.priority<l&&(l=x.priority,i=f)}if(null===i)return null;const u=this.taskQueue[i];return this.taskQueue.splice(i,1),u}remove(){this.invoker.remove()}}function E1(a,i,l){var u=2*Math.PI*6378137/256/Math.pow(2,l);return[a*u-2*Math.PI*6378137/2,i*u-2*Math.PI*6378137/2]}class x_{constructor(i,l,u){this.z=i,this.x=l,this.y=u,this.key=rh(0,i,i,l,u)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,l){const u=(x=this.y,b=this.z,S=E1(256*(f=this.x),256*(x=Math.pow(2,b)-x-1),b),P=E1(256*(f+1),256*(x+1),b),S[0]+","+S[1]+","+P[0]+","+P[1]);var f,x,b,S,P;const F=function(N,U,j){let q,re="";for(let oe=N;oe>0;oe--)q=1<<oe-1,re+=(U&q?1:0)+(j&q?2:0);return re}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===l?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",F).replace("{bbox-epsg-3857}",u)}getTilePoint(i){const l=Math.pow(2,this.z);return new dt((i.x*l-this.x)*ur,(i.y*l-this.y)*ur)}getTileVec3(i){const l=Math.pow(2,this.z);return $h((i.x*l-this.x)*ur,(i.y*l-this.y)*ur,y_(i.z,i.y))}toString(){return`${this.z}/${this.x}/${this.y}`}}class D1{constructor(i,l){this.wrap=i,this.canonical=l,this.key=rh(i,l.z,l.z,l.x,l.y)}}class gi{constructor(i,l,u,f,x){this.overscaledZ=i,this.wrap=l,this.canonical=new x_(u,+f,+x),this.key=0===l&&i===u?this.canonical.key:rh(l,i,u,f,x)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const l=this.canonical.z-i;return i>this.canonical.z?new gi(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new gi(i,this.wrap,i,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(i,l=!0){if(this.overscaledZ===i&&l)return this.key;if(i>this.canonical.z)return rh(this.wrap*+l,i,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-i;return rh(this.wrap*+l,i,i,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const l=this.canonical.z-i.canonical.z;return 0===i.overscaledZ||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>l&&i.canonical.y===this.canonical.y>>l}children(i){if(this.overscaledZ>=i)return[new gi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,u=2*this.canonical.x,f=2*this.canonical.y;return[new gi(l,this.wrap,l,u,f),new gi(l,this.wrap,l,u+1,f),new gi(l,this.wrap,l,u,f+1),new gi(l,this.wrap,l,u+1,f+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new gi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new gi(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new D1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new DA(i.x-this.wrap,i.y))}getTileVec3(i){return this.canonical.getTileVec3(new DA(i.x-this.wrap,i.y,i.z))}}function rh(a,i,l,u,f){const x=1<<Math.min(l,22);let b=x*(f%x)+u%x;return a&&l<22&&(b+=x*x*((a<0?-2*a-1:2*a)%(1<<2*(22-l)))),16*(32*b+l)+(i-l)}Ft("CanonicalTileID",x_),Ft("OverscaledTileID",gi,{omit:["projMatrix"]});class b_{constructor(i){this._stringToNumber={},this._numberToString=[];for(let l=0;l<i.length;l++){const u=i[l];this._stringToNumber[u]=l,this._numberToString[l]=u}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}class hg{constructor(i,l,u,f,x){this.type="Feature",this._vectorTileFeature=i,i._z=l,i._x=u,i._y=f,this.properties=i.properties,this.id=x}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const l in this)"_geometry"!==l&&"_vectorTileFeature"!==l&&(i[l]=this[l]);return i}}var dg=It([{name:"a_pos",type:"Int16",components:2}]);class Ag{constructor(i,l,u){this.tileID=i,this.uid=_s(),this.uses=0,this.tileSize=l,this.tileZoom=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){const l=i+this.timeAdded;l<go.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}loadVectorData(i,l,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(f,x){const b={};if(!x)return b;for(const S of f){const P=S.layerIds.map(F=>x.getLayer(F)).filter(Boolean);if(0!==P.length){S.layers=P,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(F=>P.filter(N=>N.id===F)[0]));for(const F of P)b[F.id]=S}}return b}(i.buckets,l.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const x=this.buckets[f];if(x instanceof co){if(this.hasSymbolBuckets=!0,!u)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const x=this.buckets[f];if(x instanceof co&&x.hasRTLText){this.hasRTLText=!0,J.isLoading()||J.isLoaded()||"deferred"!==H()||Q();break}}this.queryPadding=0;for(const f in this.buckets){const x=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(f).queryRadius(x))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage),i.lineAtlas&&(this.lineAtlas=i.lineAtlas)}else this.collisionBoxArray=new Rc}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const u in this.buckets){const f=this.buckets[u];f.uploadPending()&&f.upload(i)}const l=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new sp(i,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new sp(i,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new sp(i,this.lineAtlas.image,l.ALPHA),this.lineAtlas.uploaded=!0)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,l,u,f,x,b,S,P){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:f,pixelPosMatrix:S,transform:b,params:x},i,l,u):{}}querySourceFeatures(i,l){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const f=u.loadVTLayers(),x=l?l.sourceLayer:"",b=f._geojsonTileLayer||f[x];if(!b)return;const S=Fu(l&&l.filter),{z:P,x:F,y:N}=this.tileID.canonical,U={z:P,x:F,y:N};for(let j=0;j<b.length;j++){const q=b.feature(j);if(S.needGeometry){const Ae=qu(q,!0);if(!S.filter(new te(this.tileID.overscaledZ),Ae,this.tileID.canonical))continue}else if(!S.filter(new te(this.tileID.overscaledZ),q))continue;const re=u.getId(q,x),oe=new hg(q,P,F,N,re);oe.tile=U,i.push(oe)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const l=this.expirationTime;if(i.cacheControl){const u=Za(i.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const u=Date.now();let f=!1;if(this.expirationTime>u)f=!1;else if(l)if(this.expirationTime<l)f=!0;else{const x=this.expirationTime-l;x?this.expirationTime=u+Math.max(x,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(i,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(i).length)return;const u=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!l.style.hasLayer(f))continue;const x=this.buckets[f],b=x.layers[0].sourceLayer||"_geojsonTileLayer",S=u[b],P=i[b];if(!S||!P||0===Object.keys(P).length)continue;x.update(P,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const F=l&&l.style&&l.style.getLayer(f);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(x)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<go.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=go.now()+i}setDependencies(i,l){const u={};for(const f of l)u[f]=!0;this.dependencies[i]=u}hasDependency(i,l){for(const u of i){const f=this.dependencies[u];if(f)for(const x of l)if(f[x])return!0}return!1}clearQueryDebugViz(){}}class fg{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,l,u){const f=String(l);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][f]=this.stateChanges[i][f]||{},Ai(this.stateChanges[i][f],u),null===this.deletedStates[i]){this.deletedStates[i]={};for(const x in this.state[i])x!==f&&(this.deletedStates[i][x]=null)}else if(this.deletedStates[i]&&null===this.deletedStates[i][f]){this.deletedStates[i][f]={};for(const x in this.state[i][f])u[x]||(this.deletedStates[i][f][x]=null)}else for(const x in u)this.deletedStates[i]&&this.deletedStates[i][f]&&null===this.deletedStates[i][f][x]&&delete this.deletedStates[i][f][x]}removeFeatureState(i,l,u){if(null===this.deletedStates[i])return;const f=String(l);if(this.deletedStates[i]=this.deletedStates[i]||{},u&&void 0!==l)null!==this.deletedStates[i][f]&&(this.deletedStates[i][f]=this.deletedStates[i][f]||{},this.deletedStates[i][f][u]=null);else if(void 0!==l)if(this.stateChanges[i]&&this.stateChanges[i][f])for(u in this.deletedStates[i][f]={},this.stateChanges[i][f])this.deletedStates[i][f][u]=null;else this.deletedStates[i][f]=null;else this.deletedStates[i]=null}getState(i,l){const u=String(l),f=Ai({},(this.state[i]||{})[u],(this.stateChanges[i]||{})[u]);if(null===this.deletedStates[i])return{};if(this.deletedStates[i]){const x=this.deletedStates[i][l];if(null===x)return{};for(const b in x)delete f[b]}return f}initializeTileState(i,l){i.setFeatureState(this.state,l)}coalesceChanges(i,l){const u={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const x={};for(const b in this.stateChanges[f])this.state[f][b]||(this.state[f][b]={}),Ai(this.state[f][b],this.stateChanges[f][b]),x[b]=this.state[f][b];u[f]=x}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const x={};if(null===this.deletedStates[f])for(const b in this.state[f])x[b]={},this.state[f][b]={};else for(const b in this.deletedStates[f]){if(null===this.deletedStates[f][b])this.state[f][b]={};else for(const S of Object.keys(this.deletedStates[f][b]))delete this.state[f][b][S];x[b]=this.state[f][b]}u[f]=u[f]||{},Ai(u[f],x)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(u).length)for(const f in i)i[f].setFeatureState(u,l)}}class w_{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,l){const u=this.toIdx(i,l);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(i,l){return this.leaves[this.toIdx(i,l)]}toIdx(i,l){return l*this.size+i}}function Hl(a,i,l,u){let f=0,x=Number.MAX_VALUE;for(let b=0;b<3;b++)if(Math.abs(u[b])<1e-15){if(l[b]<a[b]||l[b]>i[b])return null}else{const S=1/u[b];let P=(a[b]-l[b])*S,F=(i[b]-l[b])*S;if(P>F){const N=P;P=F,F=N}if(P>f&&(f=P),F<x&&(x=F),f>x)return null}return f}function pg(a,i,l,u,f,x,b,S,P,F,N){const U=u-a,j=f-i,q=x-l,re=b-a,oe=S-i,Ae=P-l,xe=N[1]*Ae-N[2]*oe,Se=N[2]*re-N[0]*Ae,Le=N[0]*oe-N[1]*re,Be=U*xe+j*Se+q*Le;if(Math.abs(Be)<1e-15)return null;const Ne=1/Be,Ue=F[0]-a,Ze=F[1]-i,at=F[2]-l,pt=(Ue*xe+Ze*Se+at*Le)*Ne;if(pt<0||pt>1)return null;const gt=Ze*q-at*j,nt=at*U-Ue*q,st=Ue*j-Ze*U,xt=(N[0]*gt+N[1]*nt+N[2]*st)*Ne;return xt<0||pt+xt>1?null:(re*gt+oe*nt+Ae*st)*Ne}function C_(a,i,l){return(a-i)/(l-i)}function M1(a,i,l,u,f,x,b,S,P){const F=1<<l,N=x-u,U=b-f,j=(a+1)/F*N+u,q=(i+0)/F*U+f,re=(i+1)/F*U+f;S[0]=(a+0)/F*N+u,S[1]=q,P[0]=j,P[1]=re}class ap{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(x){const b=Math.ceil(Math.log2(x.dim/8)),S=[];let P=Math.ceil(Math.pow(2,b));const F=1/P,N=(q,re,oe,Ae,xe)=>{const Se=Ae?1:0,Le=(q+1)*oe-Se,Be=re*oe,Ne=(re+1)*oe-Se;xe[0]=q*oe,xe[1]=Be,xe[2]=Le,xe[3]=Ne};let U=new w_(P);const j=[];for(let q=0;q<P*P;q++){N(q%P,Math.floor(q/P),F,!1,j);const re=ql(j[0],j[1],x),oe=ql(j[2],j[1],x),Ae=ql(j[2],j[3],x),xe=ql(j[0],j[3],x);U.minimums.push(Math.min(re,oe,Ae,xe)),U.maximums.push(Math.max(re,oe,Ae,xe)),U.leaves.push(1)}for(S.push(U),P/=2;P>=1;P/=2){const q=S[S.length-1];U=new w_(P);for(let re=0;re<P*P;re++){N(re%P,Math.floor(re/P),2,!0,j);const oe=q.getElevation(j[0],j[1]),Ae=q.getElevation(j[2],j[1]),xe=q.getElevation(j[2],j[3]),Se=q.getElevation(j[0],j[3]),Le=q.isLeaf(j[0],j[1]),Be=q.isLeaf(j[2],j[1]),Ne=q.isLeaf(j[2],j[3]),Ue=q.isLeaf(j[0],j[3]),Ze=Math.min(oe.min,Ae.min,xe.min,Se.min),at=Math.max(oe.max,Ae.max,xe.max,Se.max),pt=Le&&Be&&Ne&&Ue;U.maximums.push(at),U.minimums.push(Ze),U.leaves.push(at-Ze<=5&&pt?1:0)}S.push(U)}return S}(this.dem),u=l.length-1,f=l[u];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(l,0,0,u,0)}raycastRoot(i,l,u,f,x,b,S=1){return Hl([i,l,-100],[u,f,this.maximums[0]*S],x,b)}raycast(i,l,u,f,x,b,S=1){if(!this.nodeCount)return null;const P=this.raycastRoot(i,l,u,f,x,b,S);if(null==P)return null;const F=[],N=[],U=[],j=[],q=[{idx:0,t:P,nodex:0,nodey:0,depth:0}];for(;q.length>0;){const{idx:re,t:oe,nodex:Ae,nodey:xe,depth:Se}=q.pop();if(this.leaves[re]){M1(Ae,xe,Se,i,l,u,f,U,j);const Be=1<<Se,Ne=(Ae+0)/Be,Ue=(Ae+1)/Be,Ze=(xe+0)/Be,at=(xe+1)/Be,pt=ql(Ne,Ze,this.dem)*S,gt=ql(Ue,Ze,this.dem)*S,nt=ql(Ue,at,this.dem)*S,st=ql(Ne,at,this.dem)*S,xt=pg(U[0],U[1],pt,j[0],U[1],gt,j[0],j[1],nt,x,b),ot=pg(j[0],j[1],nt,U[0],j[1],st,U[0],U[1],pt,x,b),Jt=Math.min(null!==xt?xt:Number.MAX_VALUE,null!==ot?ot:Number.MAX_VALUE);if(Jt!==Number.MAX_VALUE)return Jt;{const Tt=F0([],x,b,oe);if(E_(pt,gt,st,nt,C_(Tt[0],U[0],j[0]),C_(Tt[1],U[1],j[1]))>=Tt[2])return oe}continue}let Le=0;for(let Be=0;Be<this._siblingOffset.length;Be++){M1((Ae<<1)+this._siblingOffset[Be][0],(xe<<1)+this._siblingOffset[Be][1],Se+1,i,l,u,f,U,j),U[2]=-100,j[2]=this.maximums[this.childOffsets[re]+Be]*S;const Ne=Hl(U,j,x,b);if(null!=Ne){const Ue=Ne;F[Be]=Ue;let Ze=!1;for(let at=0;at<Le&&!Ze;at++)Ue>=F[N[at]]&&(N.splice(at,0,Be),Ze=!0);Ze||(N[Le]=Be),Le++}}for(let Be=0;Be<Le;Be++){const Ne=N[Be];q.push({idx:this.childOffsets[re]+Ne,t:F[Ne],nodex:(Ae<<1)+this._siblingOffset[Ne][0],nodey:(xe<<1)+this._siblingOffset[Ne][1],depth:Se+1})}}return null}_addNode(i,l,u){return this.minimums.push(i),this.maximums.push(l),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(i,l,u,f,x){if(1===i[f].isLeaf(l,u))return;this.childOffsets[x]||(this.childOffsets[x]=this.nodeCount);const b=f-1,S=i[b];let P,F=0;for(let N=0;N<this._siblingOffset.length;N++){const U=2*l+this._siblingOffset[N][0],j=2*u+this._siblingOffset[N][1],q=S.getElevation(U,j),re=S.isLeaf(U,j),oe=this._addNode(q.min,q.max,re);re&&(F|=1<<N),P||(P=oe)}for(let N=0;N<this._siblingOffset.length;N++)F&1<<N||this._construct(i,2*l+this._siblingOffset[N][0],2*u+this._siblingOffset[N][1],b,P+N)}}function E_(a,i,l,u,f,x){return At(At(a,l,x),At(i,u,x),f)}function ql(a,i,l){const u=l.dim,f=di(a*u-.5,0,u-1),x=di(i*u-.5,0,u-1),b=Math.floor(f),S=Math.floor(x),P=Math.min(b+1,u-1),F=Math.min(S+1,u-1);return E_(l.get(b,S),l.get(P,S),l.get(b,F),l.get(P,F),f-b,x-S)}const D_={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class lp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,l,u,f=!1,x=!1){if(this.uid=i,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(u&&"mapbox"!==u&&"terrarium"!==u)return jr(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const b=this.dim=l.height-2;if(this.data=new Uint32Array(l.data.buffer),this.encoding=u||"mapbox",this.borderReady=f,!f){for(let S=0;S<b;S++)this.data[this._idx(-1,S)]=this.data[this._idx(0,S)],this.data[this._idx(b,S)]=this.data[this._idx(b-1,S)],this.data[this._idx(S,-1)]=this.data[this._idx(S,0)],this.data[this._idx(S,b)]=this.data[this._idx(S,b-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(b,-1)]=this.data[this._idx(b-1,0)],this.data[this._idx(-1,b)]=this.data[this._idx(0,b-1)],this.data[this._idx(b,b)]=this.data[this._idx(b-1,b-1)],x&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new ap(this)}get(i,l,u=!1){const f=new Uint8Array(this.data.buffer);u&&(i=di(i,-1,this.dim),l=di(l,-1,this.dim));const x=4*this._idx(i,l);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(f[x],f[x+1],f[x+2])}static getUnpackVector(i){return D_[i]}get unpackVector(){return D_[this.encoding]}_idx(i,l){if(i<-1||i>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(i+1)}_unpackMapbox(i,l,u){return(256*i*256+256*l+u)/10-1e4}_unpackTerrarium(i,l,u){return 256*i+l+u/256-32768}static pack(i,l){const u=[0,0,0,0],f=lp.getUnpackVector(l);let x=Math.floor((i+f[3])/f[2]);return u[2]=x%256,x=Math.floor(x/256),u[1]=x%256,x=Math.floor(x/256),u[0]=x,u}getPixels(){return new Ts({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,l,u){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let f=l*this.dim,x=l*this.dim+this.dim,b=u*this.dim,S=u*this.dim+this.dim;switch(l){case-1:f=x-1;break;case 1:x=f+1}switch(u){case-1:b=S-1;break;case 1:S=b+1}const P=-l*this.dim,F=-u*this.dim;for(let N=b;N<S;N++)for(let U=f;U<x;U++)this.data[this._idx(U,N)]=i.data[this._idx(U+P,N+F)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}Ft("DEMData",lp),Ft("DemMinMaxQuadTree",ap,{omit:["dem"]});class MA{constructor(i,l){this.max=i,this.onRemove=l,this.reset()}reset(){for(const i in this.data)for(const l of this.data[i])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(i,l,u){const f=i.wrapped().key;void 0===this.data[f]&&(this.data[f]=[]);const x={value:l,timeout:void 0};if(void 0!==u&&(x.timeout=setTimeout(()=>{this.remove(i,x)},u)),this.data[f].push(x),this.order.push(f),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const l=this.data[i].shift();return l.timeout&&clearTimeout(l.timeout),0===this.data[i].length&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),l.value}getByKey(i){const l=this.data[i];return l?l[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,l){if(!this.has(i))return this;const u=i.wrapped().key,f=void 0===l?0:this.data[u].indexOf(l),x=this.data[u][f];return this.data[u].splice(f,1),x.timeout&&clearTimeout(x.timeout),0===this.data[u].length&&delete this.data[u],this.onRemove(x.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(i){const l=[];for(const u in this.data)for(const f of this.data[u])i(f.value)||l.push(f);for(const u of l)this.remove(u.value.tileID,u)}}class La{constructor(i,l,u){this.func=i,this.mask=l,this.range=u}}La.ReadOnly=!1,La.ReadWrite=!0,La.disabled=new La(519,La.ReadOnly,[0,1]);class qc{constructor(i,l,u,f,x,b){this.test=i,this.ref=l,this.mask=u,this.fail=f,this.depthFail=x,this.pass=b}}qc.disabled=new qc({func:519,mask:0},0,0,7680,7680,7680);class os{constructor(i,l,u){this.blendFunction=i,this.blendColor=l,this.mask=u}}os.Replace=[1,0],os.disabled=new os(os.Replace,dn.transparent,[!1,!1,!1,!1]),os.unblended=new os(os.Replace,dn.transparent,[!0,!0,!0,!0]),os.alphaBlended=new os([1,771],dn.transparent,[!0,!0,!0,!0]);class la{constructor(i,l,u){this.enable=i,this.mode=l,this.frontFace=u}}la.disabled=new la(!1,1029,2305),la.backCCW=new la(!0,1029,2305),la.backCW=new la(!0,1029,2304),la.frontCW=new la(!0,1028,2304),la.frontCCW=new la(!0,1028,2305);class Wc extends $t{constructor(i,l,u){super(),this.id=i,this._onlySymbols=u,l.on("data",f=>{"source"===f.dataType&&"metadata"===f.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===f.dataType&&"content"===f.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new MA(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new fg}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles){const l=this._tiles[i];if("loaded"!==l.state&&"errored"!==l.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(i,l){return i.isSymbolTile=this._onlySymbols,this._source.loadTile(i,l)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(i){if(this._source.abortTile)return this._source.abortTile(i,()=>{})}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const u=this._tiles[l];u.upload(i),u.prepare(this.map.style.imageManager)}}getIds(){return Hn(this._tiles).map(i=>i.tileID).sort(cp).map(i=>i.key)}getRenderableIds(i){const l=[];for(const u in this._tiles)this._isIdRenderable(+u,i)&&l.push(this._tiles[u]);return i?l.sort((u,f)=>{const x=u.tileID,b=f.tileID,S=new dt(x.canonical.x,x.canonical.y)._rotate(this.transform.angle),P=new dt(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return x.overscaledZ-b.overscaledZ||P.y-S.y||P.x-S.x}).map(u=>u.tileID.key):l.map(u=>u.tileID).sort(cp).map(u=>u.key)}hasRenderableParent(i){const l=this.findLoadedParent(i,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(i,l){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(l||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)"errored"!==this._tiles[i].state&&this._reloadTile(+i,"reloading")}}_reloadTile(i,l){const u=this._tiles[i];u&&("loading"!==u.state&&(u.state=l),this._loadTile(u,this._tileLoaded.bind(this,u,i,l)))}_tileLoaded(i,l,u,f){if(f)return i.state="errored",void(404!==f.status?this._source.fire(new Ke(f,{tile:i})):this.update(this.transform));i.timeAdded=go.now(),"expired"===u&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(l,i),"raster-dem"===this.getSource().type&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new mt("data",{dataType:"source",tile:i,coord:i.tileID,sourceCacheId:this.id}))}_backfillDEM(i){const l=this.getRenderableIds();for(let f=0;f<l.length;f++){const x=l[f];if(i.neighboringTiles&&i.neighboringTiles[x]){const b=this.getTileByID(x);u(i,b),u(b,i)}}function u(f,x){if(!f.dem||f.dem.borderReady)return;f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0;let b=x.tileID.canonical.x-f.tileID.canonical.x;const S=x.tileID.canonical.y-f.tileID.canonical.y,P=Math.pow(2,f.tileID.canonical.z),F=x.tileID.key;0===b&&0===S||Math.abs(S)>1||(Math.abs(b)>1&&(1===Math.abs(b+P)?b+=P:1===Math.abs(b-P)&&(b-=P)),x.dem&&f.dem&&(f.dem.backfillBorder(x.dem,b,S),f.neighboringTiles&&f.neighboringTiles[F]&&(f.neighboringTiles[F].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,l,u,f){for(const x in this._tiles){let b=this._tiles[x];if(f[x]||!b.hasData()||b.tileID.overscaledZ<=l||b.tileID.overscaledZ>u)continue;let S=b.tileID;for(;b&&b.tileID.overscaledZ>l+1;){const F=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[F.key],b&&b.hasData()&&(S=F)}let P=S;for(;P.overscaledZ>l;)if(P=P.scaledTo(P.overscaledZ-1),i[P.key]){f[S.key]=S;break}}}findLoadedParent(i,l){if(i.key in this._loadedParentTiles){const u=this._loadedParentTiles[i.key];return u&&u.tileID.overscaledZ>=l?u:null}for(let u=i.overscaledZ-1;u>=l;u--){const f=i.scaledTo(u),x=this._getLoadedTile(f);if(x)return x}}_getLoadedTile(i){const l=this._tiles[i.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?i.wrapped().key:i.canonical.key)}updateCacheSize(i,l){l=l||this._source.tileSize;const u=Math.ceil(i.width/l)+1,f=Math.ceil(i.height/l)+1,x=Math.floor(u*f*5),b="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(b)}handleWrapJump(i){const l=Math.round((i-(void 0===this._prevLng?i:this._prevLng))/360);if(this._prevLng=i,l){const u={};for(const f in this._tiles){const x=this._tiles[f];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+l),u[x.tileID.key]=x}this._tiles=u;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(+f,this._tiles[f])}}update(i,l,u){if(this.transform=i,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!u)return;let f;this.updateCacheSize(i,l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(S=>new gi(S.canonical.z,S.wrap,S.canonical.z,S.canonical.x,S.canonical.y)):(f=i.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!u,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(f=f.filter(S=>this._source.hasTile(S)))):f=[];const x=this._updateRetainedTiles(f);if(up(this._source.type)&&0!==f.length){const S={},P={},F=Object.keys(x);for(const U of F){const j=x[U],q=this._tiles[U];if(!q||q.fadeEndTime&&q.fadeEndTime<=go.now())continue;const re=this.findLoadedParent(j,Math.max(j.overscaledZ-Wc.maxOverzooming,this._source.minzoom));re&&(this._addTile(re.tileID),S[re.tileID.key]=re.tileID),P[U]=j}const N=f[f.length-1].overscaledZ;for(const U in this._tiles){const j=this._tiles[U];if(x[U]||!j.hasData())continue;let q=j.tileID;for(;q.overscaledZ>N;){q=q.scaledTo(q.overscaledZ-1);const re=this._tiles[q.key];if(re&&re.hasData()&&P[q.key]){x[U]=j.tileID;break}}}for(const U in S)x[U]||(this._coveredTiles[U]=!0,x[U]=S[U])}for(const S in x)this._tiles[S].clearFadeHold();const b=function(S,P){const F=[];for(const N in S)N in P||F.push(N);return F}(this._tiles,x);for(const S of b){const P=this._tiles[S];P.hasSymbolBuckets&&!P.holdingForFade()?P.setHoldDuration(this.map._fadeDuration):P.hasSymbolBuckets&&!P.symbolFadeFinished()||this._removeTile(+S)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(+i)}_updateRetainedTiles(i){const l={};if(0===i.length)return l;const u={},f=i[i.length-1].overscaledZ,x=i[0].overscaledZ,b=Math.max(x-Wc.maxOverzooming,this._source.minzoom),S=Math.max(x+Wc.maxUnderzooming,this._source.minzoom),P={};for(const F of i){const N=this._addTile(F);l[F.key]=F,N.hasData()||f<this._source.maxzoom&&(P[F.key]=F)}this._retainLoadedChildren(P,f,S,l);for(const F of i){let N=this._tiles[F.key];if(N.hasData())continue;if(F.canonical.z>=this._source.maxzoom){const j=F.children(this._source.maxzoom)[0],q=this.getTile(j);if(q&&q.hasData()){l[j.key]=j;continue}}else{const j=F.children(this._source.maxzoom);if(l[j[0].key]&&l[j[1].key]&&l[j[2].key]&&l[j[3].key])continue}let U=N.wasRequested();for(let j=F.overscaledZ-1;j>=b;--j){const q=F.scaledTo(j);if(u[q.key]||(u[q.key]=!0,N=this.getTile(q),!N&&U&&(N=this._addTile(q)),N&&(l[q.key]=q,U=N.wasRequested(),N.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const l=[];let u,f=this._tiles[i].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){u=this._loadedParentTiles[f.key];break}l.push(f.key);const x=f.scaledTo(f.overscaledZ-1);if(u=this._getLoadedTile(x),u)break;f=x}for(const x of l)this._loadedParentTiles[x]=u}}_addTile(i){let l=this._tiles[i.key];if(l)return l;l=this._cache.getAndRemove(i),l&&(this._setTileReloadTimer(i.key,l),l.tileID=i,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,l)));const u=Boolean(l);return u||(l=new Ag(i,this._source.tileSize*i.overscaleFactor(),this.transform.tileZoom),this._loadTile(l,this._tileLoaded.bind(this,l,i.key,l.state))),l?(l.uses++,this._tiles[i.key]=l,u||this._source.fire(new mt("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(i,l){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const u=l.getExpiryTimeout();u&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},u))}_removeTile(i){const l=this._tiles[i];l&&(l.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),l.uses>0||(l.hasData()&&"reloading"!==l.state?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(+i);this._cache.reset()}tilesIn(i,l,u){const f=[],x=this.transform;if(!x)return f;for(const b in this._tiles){const S=this._tiles[b];if(u&&S.clearQueryDebugViz(),S.holdingForFade())continue;const P=i.containsTile(S,x,l);P&&f.push(P)}return f}getVisibleCoordinates(i){const l=this.getRenderableIds(i).map(u=>this._tiles[u].tileID);for(const u of l)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(up(this._source.type))for(const i in this._tiles){const l=this._tiles[i];if(void 0!==l.fadeEndTime&&l.fadeEndTime>=go.now())return!0}return!1}setFeatureState(i,l,u){this._state.updateState(i=i||"_geojsonTileLayer",l,u)}removeFeatureState(i,l,u){this._state.removeFeatureState(i=i||"_geojsonTileLayer",l,u)}getFeatureState(i,l){return this._state.getState(i=i||"_geojsonTileLayer",l)}setDependencies(i,l,u){const f=this._tiles[i];f&&f.setDependencies(l,u)}reloadTilesForDependencies(i,l){for(const u in this._tiles)this._tiles[u].hasDependency(i,l)&&this._reloadTile(+u,"reloading");this._cache.filter(u=>!u.hasDependency(i,l))}}function cp(a,i){const l=Math.abs(2*a.wrap)-+(a.wrap<0),u=Math.abs(2*i.wrap)-+(i.wrap<0);return a.overscaledZ-i.overscaledZ||u-l||i.canonical.y-a.canonical.y||i.canonical.x-a.canonical.x}function up(a){return"raster"===a||"image"===a||"video"===a}Wc.maxOverzooming=10,Wc.maxUnderzooming=3;class TA{constructor(i,l,u){this._demTile=i,this._dem=this._demTile.dem,this._scale=l,this._offset=u}static create(i,l,u){const f=u||i.findDEMTileFor(l);if(!f||!f.dem)return;const x=f.dem,b=f.tileID,S=1<<l.canonical.z-b.canonical.z;return new TA(f,f.tileSize/ur/S,[(l.canonical.x/S-b.canonical.x)*x.dim,(l.canonical.y/S-b.canonical.y)*x.dim])}tileCoordToPixel(i,l){const u=l*this._scale+this._offset[1],f=Math.floor(i*this._scale+this._offset[0]),x=Math.floor(u);return new dt(f,x)}getElevationAt(i,l,u,f){const x=i*this._scale+this._offset[0],b=l*this._scale+this._offset[1],S=Math.floor(x),P=Math.floor(b),F=this._dem;return f=!!f,u?At(At(F.get(S,P,f),F.get(S,P+1,f),b-P),At(F.get(S+1,P,f),F.get(S+1,P+1,f),b-P),x-S):F.get(S,P,f)}getElevationAtPixel(i,l,u){return this._dem.get(i,l,!!u)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*EA(1,i)*this._dem.stride}}class IA{constructor(i,l){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Sc(ur,16,0),this.featureIndexArray=new Iv,this.promoteId=l}insert(i,l,u,f,x,b=0){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,f,x,b);const P=this.grid;for(let F=0;F<l.length;F++){const N=l[F],U=[1/0,1/0,-1/0,-1/0];for(let j=0;j<N.length;j++){const q=N[j];U[0]=Math.min(U[0],q.x),U[1]=Math.min(U[1],q.y),U[2]=Math.max(U[2],q.x),U[3]=Math.max(U[3],q.y)}U[0]<ur&&U[1]<ur&&U[2]>=0&&U[3]>=0&&P.insert(S,U[0],U[1],U[2],U[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Fa.VectorTile(new pA(this.rawTileData)).layers,this.sourceLayerCoder=new b_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,l,u,f){this.loadVTLayers();const x=i.params||{},b=Fu(x.filter),S=i.tileResult,P=i.transform,F=S.bufferedTilespaceBounds,N=this.grid.query(F.min.x,F.min.y,F.max.x,F.max.y,(re,oe,Ae,xe)=>Gh(S.bufferedTilespaceGeometry,re,oe,Ae,xe));N.sort(S_);let U=null;P.elevation&&N.length>0&&(U=TA.create(P.elevation,this.tileID));const j={};let q;for(let re=0;re<N.length;re++){const oe=N[re];if(oe===q)continue;q=oe;const Ae=this.featureIndexArray.get(oe);let xe=null;this.loadMatchingFeature(j,Ae,b,x.layers,x.availableImages,l,u,f,(Se,Le,Be,Ne=0)=>(xe||(xe=ia(Se)),Le.queryIntersectsFeature(S,Se,Be,xe,this.z,i.transform,i.pixelPosMatrix,U,Ne)))}return j}loadMatchingFeature(i,l,u,f,x,b,S,P,F){const{featureIndex:N,bucketIndex:U,sourceLayerIndex:j,layoutVertexArrayOffset:q}=l,re=this.bucketLayerIDs[U];if(f&&!function(Se,Le){for(let Be=0;Be<Se.length;Be++)if(Le.indexOf(Se[Be])>=0)return!0;return!1}(f,re))return;const oe=this.sourceLayerCoder.decode(j),Ae=this.vtLayers[oe].feature(N);if(u.needGeometry){const Se=qu(Ae,!0);if(!u.filter(new te(this.tileID.overscaledZ),Se,this.tileID.canonical))return}else if(!u.filter(new te(this.tileID.overscaledZ),Ae))return;const xe=this.getId(Ae,oe);for(let Se=0;Se<re.length;Se++){const Le=re[Se];if(f&&f.indexOf(Le)<0)continue;const Be=b[Le];if(!Be)continue;let Ne={};void 0!==xe&&P&&(Ne=P.getState(Be.sourceLayer||"_geojsonTileLayer",xe));const Ue=Ai({},S[Le]);Ue.paint=M_(Ue.paint,Be.paint,Ae,Ne,x),Ue.layout=M_(Ue.layout,Be.layout,Ae,Ne,x);const Ze=!F||F(Ae,Be,Ne,q);if(!Ze)continue;const at=new hg(Ae,this.z,this.x,this.y,xe);at.layer=Ue;let pt=i[Le];void 0===pt&&(pt=i[Le]=[]),pt.push({featureIndex:N,feature:at,intersectionZ:Ze})}}lookupSymbolFeatures(i,l,u,f,x,b,S,P){const F={};this.loadVTLayers();const N=Fu(x);for(const U of i)this.loadMatchingFeature(F,{bucketIndex:u,sourceLayerIndex:f,featureIndex:U,layoutVertexArrayOffset:0},N,b,S,P,l);return F}hasLayer(i){for(const l of this.bucketLayerIDs)for(const u of l)if(i===u)return!0;return!1}getId(i,l){let u=i.id;return this.promoteId&&(u=i.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[l]],"boolean"==typeof u&&(u=Number(u))),u}}function M_(a,i,l,u,f){return pn(a,(x,b)=>{const S=i instanceof Me?i.get(b):null;return S&&S.evaluate?S.evaluate(l,u,f):S})}function S_(a,i){return i-a}Ft("FeatureIndex",IA,{omit:["rawTileData","sourceLayerCoder"]});class S1{constructor(i){const l={},u=[];for(const S in i){const P=i[S],F=l[S]={};for(const N in P.glyphs){const U=P.glyphs[+N];if(!U||0===U.bitmap.width||0===U.bitmap.height)continue;const j=U.metrics.localGlyph?2:1,q={x:0,y:0,w:U.bitmap.width+2*j,h:U.bitmap.height+2*j};u.push(q),F[N]=q}}const{w:f,h:x}=Hf(u),b=new Nc({width:f||1,height:x||1});for(const S in i){const P=i[S];for(const F in P.glyphs){const N=P.glyphs[+F];if(!N||0===N.bitmap.width||0===N.bitmap.height)continue;const U=l[S][F],j=N.metrics.localGlyph?2:1;Nc.copy(N.bitmap,b,{x:0,y:0},{x:U.x+j,y:U.y+j},N.bitmap)}}this.image=b,this.positions=l}}Ft("GlyphAtlas",S1);class T_{constructor(i){this.tileID=new gi(i.tileID.overscaledZ,i.tileID.wrap,i.tileID.canonical.z,i.tileID.canonical.x,i.tileID.canonical.y),this.tileZoom=i.tileZoom,this.uid=i.uid,this.zoom=i.zoom,this.pixelRatio=i.pixelRatio,this.tileSize=i.tileSize,this.source=i.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=i.showCollisionBoxes,this.collectResourceTiming=!!i.collectResourceTiming,this.returnDependencies=!!i.returnDependencies,this.promoteId=i.promoteId,this.enableTerrain=!!i.enableTerrain,this.isSymbolTile=i.isSymbolTile}parse(i,l,u,f,x){this.status="parsing",this.data=i,this.collisionBoxArray=new Rc;const b=new b_(Object.keys(i.layers).sort()),S=new IA(this.tileID,this.promoteId);S.bucketLayerIDs=[];const P={},F=new v_(256,256),N={featureIndex:S,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:F,availableImages:u},U=l.familiesBySource[this.source];for(const Ne in U){const Ue=i.layers[Ne];if(!Ue)continue;let Ze=!1,at=!1;for(const nt of U[Ne])"symbol"===nt[0].type?Ze=!0:at=!0;if(!0===this.isSymbolTile&&!Ze||!1===this.isSymbolTile&&!at)continue;1===Ue.version&&jr(`Vector tile source "${this.source}" layer "${Ne}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const pt=b.encode(Ne),gt=[];for(let nt=0;nt<Ue.length;nt++){const st=Ue.feature(nt),xt=S.getId(st,Ne);gt.push({feature:st,id:xt,index:nt,sourceLayerIndex:pt})}for(const nt of U[Ne]){const st=nt[0];void 0!==this.isSymbolTile&&"symbol"===st.type!==this.isSymbolTile||st.minzoom&&this.zoom<Math.floor(st.minzoom)||st.maxzoom&&this.zoom>=st.maxzoom||"none"!==st.visibility&&(hp(nt,this.zoom,u),(P[st.id]=st.createBucket({index:S.bucketLayerIDs.length,layers:nt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:pt,sourceID:this.source,enableTerrain:this.enableTerrain})).populate(gt,N,this.tileID.canonical),S.bucketLayerIDs.push(nt.map(xt=>xt.id)))}}let j,q,re,oe;F.trim();const Ae={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},xe=pn(N.glyphDependencies,Ne=>Object.keys(Ne).map(Number));Object.keys(xe).length?f.send("getGlyphs",{uid:this.uid,stacks:xe},(Ne,Ue)=>{j||(j=Ne,q=Ue,Be.call(this))},void 0,!1,Ae):q={};const Se=Object.keys(N.iconDependencies);Se.length?f.send("getImages",{icons:Se,source:this.source,tileID:this.tileID,type:"icons"},(Ne,Ue)=>{j||(j=Ne,re=Ue,Be.call(this))},void 0,!1,Ae):re={};const Le=Object.keys(N.patternDependencies);function Be(){if(j)return x(j);if(q&&re&&oe){const Ne=new S1(q),Ue=new qf(re,oe);for(const Ze in P){const at=P[Ze];at instanceof co?(hp(at.layers,this.zoom,u),_1(at,q,Ne.positions,re,Ue.iconPositions,this.showCollisionBoxes,this.tileID.canonical,this.tileZoom)):at.hasPattern&&(at instanceof jf||at instanceof hA||at instanceof ao)&&(hp(at.layers,this.zoom,u),at.addFeatures(N,this.tileID.canonical,Ue.patternPositions))}this.status="done",x(null,{buckets:Hn(P).filter(Ze=>!Ze.isEmpty()),featureIndex:S,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ne.image,lineAtlas:F,imageAtlas:Ue,glyphMap:this.returnDependencies?q:null,iconMap:this.returnDependencies?re:null,glyphPositions:this.returnDependencies?Ne.positions:null})}}Le.length?f.send("getImages",{icons:Le,source:this.source,tileID:this.tileID,type:"patterns"},(Ne,Ue)=>{j||(j=Ne,oe=Ue,Be.call(this))},void 0,!1,Ae):oe={},Be.call(this)}}function hp(a,i,l){const u=new te(i);for(const f of a)f.recalculate(u,l)}class I_{constructor(i){this.entries={},this.scheduler=i}request(i,l,u,f){const x=this.entries[i]=this.entries[i]||{callbacks:[]};if(x.result){const[b,S]=x.result;return this.scheduler?this.scheduler.add(()=>{f(b,S)},l):f(b,S),()=>{}}return x.callbacks.push(f),x.cancel||(x.cancel=u((b,S)=>{x.result=[b,S];for(const P of x.callbacks)this.scheduler?this.scheduler.add(()=>{P(b,S)},l):P(b,S);setTimeout(()=>delete this.entries[i],3e3)})),()=>{x.result||(x.callbacks=x.callbacks.filter(b=>b!==f),x.callbacks.length||(x.cancel(),delete this.entries[i]))}}}function gg(a,i,l){const u=JSON.stringify(a.request);return a.data&&(this.deduped.entries[u]={result:[null,a.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},f=>{const x=Z(a.request,(b,S,P,F)=>{b?f(b):S&&f(null,{vectorTile:l?void 0:new Fa.VectorTile(new pA(S)),rawData:S,cacheControl:P,expires:F})});return()=>{x.cancel(),f()}},i)}g.ARRAY_TYPE=Mi,g.AUTH_ERR_MSG=va,g.Actor=class{constructor(a,i,l){this.target=a,this.parent=i,this.mapId=l,this.callbacks={},this.cancelCallbacks={},lc(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=wl()?a:Et,this.scheduler=new g2}send(a,i,l,u,f=!1,x){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=x,this.callbacks[b]=l);const S=pu(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:a,hasCallback:!!l,targetMapId:u,mustQueue:f,sourceMapId:this.mapId,data:il(i,S)},S),{cancel:()=>{l&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(a){const i=a.data,l=i.id;if(l&&(!i.targetMapId||this.mapId===i.targetMapId))if("<cancel>"===i.type){const u=this.cancelCallbacks[l];delete this.cancelCallbacks[l],u&&u.cancel()}else if(i.mustQueue||wl()){const u=this.callbacks[l];this.cancelCallbacks[l]=this.scheduler.add(()=>this.processTask(l,i),u&&u.metadata||{type:"message"})}else this.processTask(l,i)}processTask(a,i){if("<response>"===i.type){const l=this.callbacks[a];delete this.callbacks[a],l&&(i.error?l(Ci(i.error)):l(null,Ci(i.data)))}else{const l=pu(this.globalScope)?void 0:[],u=i.hasCallback?(x,b)=>{delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:x?il(x):null,data:il(b,l)},l)}:x=>{},f=Ci(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,f,u);else if(this.parent.getWorkerSource){const x=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,x[0],f.source)[x[1]](f,u)}else u(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},g.CanonicalTileID=x_,g.Color=dn,g.ColorMode=os,g.CullFaceMode=la,g.DEMData=lp,g.DataConstantProperty=de,g.DedupedRequest=I_,g.DepthMode=La,g.EXTENT=ur,g.Elevation=class{getAtPointOrZero(a,i=0){return this.getAtPoint(a,i)||0}getAtPoint(a,i,l=!0){null==i&&(i=null);const u=this._source();if(!u||a.y<0||a.y>1)return i;const f=u.getSource().maxzoom,x=1<<f,b=Math.floor(a.x),S=a.x-b,P=new gi(f,b,f,Math.floor(S*x),Math.floor(a.y*x)),F=this.findDEMTileFor(P);if(!F||!F.dem)return i;const N=F.dem,U=1<<F.tileID.canonical.z,j=(S*U-F.tileID.canonical.x)*N.dim,q=(a.y*U-F.tileID.canonical.y)*N.dim,re=Math.floor(j),oe=Math.floor(q);return(l?this.exaggeration():1)*At(At(N.get(re,oe),N.get(re,oe+1),q-oe),At(N.get(re+1,oe),N.get(re+1,oe+1),q-oe),j-re)}getAtTileOffset(a,i,l){const u=1<<a.canonical.z;return this.getAtPointOrZero(new DA(a.wrap+(a.canonical.x+i/ur)/u,(a.canonical.y+l/ur)/u))}getForTilePoints(a,i,l,u){const f=TA.create(this,a,u);return!!f&&(i.forEach(x=>{x[2]=this.exaggeration()*f.getElevationAt(x[0],x[1],l)}),!0)}getMinMaxForTile(a){const i=this.findDEMTileFor(a);if(!i||!i.dem)return null;const l=i.dem.tree,u=i.tileID,f=1<<a.canonical.z-u.canonical.z;let x=a.canonical.x/f-u.canonical.x,b=a.canonical.y/f-u.canonical.y,S=0;for(let P=0;P<a.canonical.z-u.canonical.z&&!l.leaves[S];P++){x*=2,b*=2;const F=2*Math.floor(b)+Math.floor(x);S=l.childOffsets[S]+F,x%=1,b%=1}return{min:this.exaggeration()*l.minimums[S],max:this.exaggeration()*l.maximums[S]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,i,l){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},g.ErrorEvent=Ke,g.EvaluationParameters=te,g.Event=mt,g.Evented=$t,g.GlyphManager=th,g.ImagePosition=qm,g.LineAtlas=v_,g.LngLat=Jr,g.LngLatBounds=Hc,g.LocalGlyphMode=xA,g.MAX_SAFE_INTEGER=ms,g.MercatorCoordinate=DA,g.ONE_EM=24,g.OverscaledTileID=gi,g.Properties=Ge,g.RGBAImage=Ts,g.RequestManager=class{constructor(a,i,l){this._transformRequestFn=a,this._customAccessToken=i,this._silenceAuthErrors=!!l,this._createSkuToken()}_createSkuToken(){const a=function(){let i="";for(let l=0;l<10;l++)i+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",gu,i].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,i){return this._transformRequestFn&&this._transformRequestFn(a,i)||{url:a}}normalizeStyleURL(a,i){if(!mr(a))return a;const l=xs(a);return l.path=`/styles/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||i)}normalizeGlyphsURL(a,i){if(!mr(a))return a;const l=xs(a);return l.path=`/fonts/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||i)}normalizeSourceURL(a,i){if(!mr(a))return a;const l=xs(a);return l.path=`/v4/${l.authority}.json`,l.params.push("secure"),this._makeAPIURL(l,this._customAccessToken||i)}normalizeSpriteURL(a,i,l,u){const f=xs(a);return mr(a)?(f.path=`/styles/v1${f.path}/sprite${i}${l}`,this._makeAPIURL(f,this._customAccessToken||u)):(f.path+=`${i}${l}`,Wo(f))}normalizeTileURL(a,i,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!mr(a))return a;const u=xs(a);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${i||l&&"raster"!==u.authority&&512===l?"@2x":""}${qs.supported?".webp":"$1"}`),"raster"===u.authority?u.path=`/${Kn.RASTER_URL_PREFIX}${u.path}`:(u.path=u.path.replace(/^.+\/v4\//,"/"),u.path=`/${Kn.TILE_URL_VERSION}${u.path}`);const f=this._customAccessToken||function(x){for(const b of x){const S=b.match(/^access_token=(.*)$/);if(S)return S[1]}return null}(u.params)||Kn.ACCESS_TOKEN;return Kn.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&u.params.push(`sku=${this._skuToken}`),this._makeAPIURL(u,f)}canonicalizeTileURL(a,i){const l=xs(a);if(!l.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!l.path.match(/\.[\w]+$/))return a;let u="mapbox://";l.path.match(/^\/raster\/v1\//)?u+=`raster/${l.path.replace(`/${Kn.RASTER_URL_PREFIX}/`,"")}`:u+=`tiles/${l.path.replace(`/${Kn.TILE_URL_VERSION}/`,"")}`;let f=l.params;return i&&(f=f.filter(x=>!x.match(/^access_token=/))),f.length&&(u+=`?${f.join("&")}`),u}canonicalizeTileset(a,i){const l=!!i&&mr(i),u=[];for(const f of a.tiles||[])Xa(f)?u.push(this.canonicalizeTileURL(f,l)):u.push(f);return u}_makeAPIURL(a,i){const l="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",u=xs(Kn.API_URL);if(a.protocol=u.protocol,a.authority=u.authority,"http"===a.protocol){const f=a.params.indexOf("secure");f>=0&&a.params.splice(f,1)}if("/"!==u.path&&(a.path=`${u.path}${a.path}`),!Kn.REQUIRE_ACCESS_TOKEN)return Wo(a);if(i=i||Kn.ACCESS_TOKEN,!this._silenceAuthErrors){if(!i)throw new Error(`An API access token is required to use Mapbox GL. ${l}`);if("s"===i[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${l}`)}return a.params=a.params.filter(f=>-1===f.indexOf("access_token")),a.params.push(`access_token=${i||""}`),Wo(a)}},g.ResourceType=ba,g.SegmentVector=Li,g.SourceCache=Wc,g.StencilMode=qc,g.StructArrayLayout1ui2=Fo,g.StructArrayLayout2f1f2i16=Ms,g.StructArrayLayout2i4=tn,g.StructArrayLayout2ui4=ci,g.StructArrayLayout3f12=hn,g.StructArrayLayout3ui6=Pn,g.StructArrayLayout4i8=$r,g.Texture=sp,g.Tile=Ag,g.Transitionable=_e,g.Uniform1f=Ss,g.Uniform1i=class extends Wi{constructor(a,i){super(a,i),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},g.Uniform2f=class extends Wi{constructor(a,i){super(a,i),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},g.Uniform3f=class extends Wi{constructor(a,i){super(a,i),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},g.Uniform4f=Kd,g.UniformColor=Fc,g.UniformMatrix3f=class extends Wi{constructor(a,i){super(a,i),this.current=S0}set(a){for(let i=0;i<9;i++)if(a[i]!==this.current[i]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}},g.UniformMatrix4f=class extends Wi{constructor(a,i){super(a,i),this.current=Oc}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let i=1;i<16;i++)if(a[i]!==this.current[i]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},g.UnwrappedTileID=D1,g.ValidationError=$e,g.VectorTileWorkerSource=class extends $t{constructor(a,i,l,u,f){super(),this.actor=a,this.layerIndex=i,this.availableImages=l,this.loadVectorData=f||gg,this.loading={},this.loaded={},this.deduped=new I_(a.scheduler),this.isSpriteLoaded=u,this.scheduler=a.scheduler}loadTile(a,i){const l=a.uid,u=a&&a.request,f=u&&u.collectResourceTiming,x=this.loading[l]=new T_(a);x.abort=this.loadVectorData(a,(b,S)=>{const P=!this.loading[l];if(delete this.loading[l],P||b||!S)return x.status="done",P||(this.loaded[l]=x),i(b);const F=S.rawData,N={};S.expires&&(N.expires=S.expires),S.cacheControl&&(N.cacheControl=S.cacheControl),x.vectorTile=S.vectorTile||new Fa.VectorTile(new pA(F));const U=()=>{x.parse(x.vectorTile,this.layerIndex,this.availableImages,this.actor,(j,q)=>{if(j||!q)return i(j);const re={};if(f){const oe=C1(u);oe.length>0&&(re.resourceTiming=JSON.parse(JSON.stringify(oe)))}i(null,Ai({rawTileData:F.slice(0)},q,N,re))})};this.isSpriteLoaded?U():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(U,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):U()}),this.loaded=this.loaded||{},this.loaded[l]=x})}reloadTile(a,i){const l=this.loaded,u=a.uid,f=this;if(l&&l[u]){const x=l[u];x.showCollisionBoxes=a.showCollisionBoxes,x.enableTerrain=!!a.enableTerrain;const b=(S,P)=>{const F=x.reloadCallback;F&&(delete x.reloadCallback,x.parse(x.vectorTile,f.layerIndex,this.availableImages,f.actor,F)),i(S,P)};"parsing"===x.status?x.reloadCallback=b:"done"===x.status&&(x.vectorTile?x.parse(x.vectorTile,this.layerIndex,this.availableImages,this.actor,b):b())}}abortTile(a,i){const l=a.uid,u=this.loading[l];u&&(u.abort&&u.abort(),delete this.loading[l]),i()}removeTile(a,i){const l=this.loaded,u=a.uid;l&&l[u]&&delete l[u],i()}},g.WritingMode=Ps,g.ZoomHistory=Ds,g.add=function(a,i,l){return a[0]=i[0]+l[0],a[1]=i[1]+l[1],a[2]=i[2]+l[2],a},g.addDynamicAttributes=An,g.altitudeFromMercatorZ=y_,g.asyncAll=fu,g.bezier=Ga,g.bindAll=lc,g.bufferConvexPolygon=function(a,i){const l=[];for(let u=0;u<a.length;u++){const f=$a(u-1,-1,a.length-1),x=$a(u+1,-1,a.length-1),b=a[u],S=a[x],P=a[f].sub(b).unit(),F=S.sub(b).unit(),N=F.angleWithSep(P.x,P.y),U=P.add(F).unit().mult(-1*i/Math.sin(N/2));l.push(b.add(U))}return l},g.cacheEntryPossiblyAdded=function(a){un++,un>vu&&(a.getActor().send("enforceCacheSizeLimit",wh),un=0)},g.clamp=di,g.clearTileCache=function(a){const i=Et.caches.delete(dc);a&&i.catch(a).then(()=>a())},g.clipLine=Jm,g.clone=function(a){var i=new Mi(3);return i[0]=a[0],i[1]=a[1],i[2]=a[2],i},g.clone$1=function(a){var i=new Mi(16);return i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[3],i[4]=a[4],i[5]=a[5],i[6]=a[6],i[7]=a[7],i[8]=a[8],i[9]=a[9],i[10]=a[10],i[11]=a[11],i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15],i},g.clone$2=Br,g.collisionCircleLayout=d1,g.config=Kn,g.conjugate=function(a,i){return a[0]=-i[0],a[1]=-i[1],a[2]=-i[2],a[3]=i[3],a},g.copy=function(a,i){return a[0]=i[0],a[1]=i[1],a[2]=i[2],a},g.create=iA,g.create$1=function(){var a=new Mi(16);return Mi!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},g.create$2=P0,g.createExpression=rs,g.createFilter=Fu,g.createLayout=It,g.createStyleLayer=function(a){return"custom"===a.type?new sg(a):new f2[a.type](a)},g.cross=function(a,i,l){var u=i[0],f=i[1],x=i[2],b=l[0],S=l[1],P=l[2];return a[0]=f*P-x*S,a[1]=x*b-u*P,a[2]=u*S-f*b,a},g.degToRad=qn,g.div=function(a,i,l){return a[0]=i[0]/l[0],a[1]=i[1]/l[1],a[2]=i[2]/l[2],a},g.dot=function(a,i){return a[0]*i[0]+a[1]*i[1]+a[2]*i[2]},g.dot$1=function(a,i){return a[0]*i[0]+a[1]*i[1]+a[2]*i[2]+a[3]*i[3]},g.ease=gs,g.easeCubicInOut=Au,g.emitValidationErrors=li,g.endsWith=ys,g.enforceCacheSizeLimit=function(a){On(),Qo&&Qo.then(i=>{i.keys().then(l=>{for(let u=0;u<l.length-a;u++)i.delete(l[u])})})},g.evaluateSizeForFeature=$f,g.evaluateSizeForZoom=jl,g.evaluateVariableOffset=d_,g.evented=$,g.exactEquals=function(a,i){return a[0]===i[0]&&a[1]===i[1]&&a[2]===i[2]&&a[3]===i[3]},g.exactEquals$1=function(a,i){return a[0]===i[0]&&a[1]===i[1]&&a[2]===i[2]},g.exported=go,g.exported$1=qs,g.extend=Ai,g.filterObject=Zo,g.fromMat4=function(a,i){return a[0]=i[0],a[1]=i[1],a[2]=i[2],a[3]=i[4],a[4]=i[5],a[5]=i[6],a[6]=i[8],a[7]=i[9],a[8]=i[10],a},g.fromQuat=function(a,i){var l=i[0],u=i[1],f=i[2],x=i[3],b=l+l,S=u+u,P=f+f,F=l*b,N=u*b,U=u*S,j=f*b,q=f*S,re=f*P,oe=x*b,Ae=x*S,xe=x*P;return a[0]=1-U-re,a[1]=N+xe,a[2]=j-Ae,a[3]=0,a[4]=N-xe,a[5]=1-F-re,a[6]=q+oe,a[7]=0,a[8]=j+Ae,a[9]=q-oe,a[10]=1-F-U,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},g.fromRotation=function(a,i){var l=Math.sin(i),u=Math.cos(i);return a[0]=u,a[1]=l,a[2]=0,a[3]=-l,a[4]=u,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},g.fromScaling=function(a,i){return a[0]=i[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=i[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=i[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},g.furthestTileCorner=function(a){const i=Math.round((a+45+360)%360/90)%4;return du[i]},g.getAABBPointSquareDist=function(a,i,l){let u=0;for(let f=0;f<2;++f){const x=l?l[f]:0;a[f]>x&&(u+=(a[f]-x)*(a[f]-x)),i[f]<x&&(u+=(x-i[f])*(x-i[f]))}return u},g.getAnchorAlignment=Xf,g.getAnchorJustification=Rs,g.getBounds=function(a){let i=1/0,l=1/0,u=-1/0,f=-1/0;for(const x of a)i=Math.min(i,x.x),l=Math.min(l,x.y),u=Math.max(u,x.x),f=Math.max(f,x.y);return{min:new dt(i,l),max:new dt(u,f)}},g.getImage=Ee,g.getJSON=function(a,i){return ne(Ai(a,{type:"json"}),i)},g.getMapSessionAPI=Dd,g.getPerformanceMeasurement=C1,g.getRTLTextPluginStatus=H,g.getReferrer=Zn,g.getVideo=function(a,i){const l=Et.document.createElement("video");l.muted=!0,l.onloadstart=function(){i(null,l)};for(let u=0;u<a.length;u++){const f=Et.document.createElement("source");he(a[u])||(l.crossOrigin="Anonymous"),f.src=a[u],l.appendChild(f)}return{cancel:()=>{}}},g.identity=If,g.identity$1=Rf,g.invert=function(a,i){var l=i[0],u=i[1],f=i[2],x=i[3],b=i[4],S=i[5],P=i[6],F=i[7],N=i[8],U=i[9],j=i[10],q=i[11],re=i[12],oe=i[13],Ae=i[14],xe=i[15],Se=l*S-u*b,Le=l*P-f*b,Be=l*F-x*b,Ne=u*P-f*S,Ue=u*F-x*S,Ze=f*F-x*P,at=N*oe-U*re,pt=N*Ae-j*re,gt=N*xe-q*re,nt=U*Ae-j*oe,st=U*xe-q*oe,xt=j*xe-q*Ae,ot=Se*xt-Le*st+Be*nt+Ne*gt-Ue*pt+Ze*at;return ot?(a[0]=(S*xt-P*st+F*nt)*(ot=1/ot),a[1]=(f*st-u*xt-x*nt)*ot,a[2]=(oe*Ze-Ae*Ue+xe*Ne)*ot,a[3]=(j*Ue-U*Ze-q*Ne)*ot,a[4]=(P*gt-b*xt-F*pt)*ot,a[5]=(l*xt-f*gt+x*pt)*ot,a[6]=(Ae*Be-re*Ze-xe*Le)*ot,a[7]=(N*Ze-j*Be+q*Le)*ot,a[8]=(b*st-S*gt+F*at)*ot,a[9]=(u*gt-l*st-x*at)*ot,a[10]=(re*Ue-oe*Be+xe*Se)*ot,a[11]=(U*Be-N*Ue-q*Se)*ot,a[12]=(S*pt-b*nt-P*at)*ot,a[13]=(l*nt-u*pt+f*at)*ot,a[14]=(oe*Le-re*Ne-Ae*Se)*ot,a[15]=(N*Ne-U*Le+j*Se)*ot,a):null},g.isMapAuthenticated=function(a){return hc.has(a)},g.isMapboxURL=mr,g.latFromMercatorY=ug,g.len=Uv,g.length=R0,g.length$1=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},g.loadVectorTile=gg,g.makeRequest=ne,g.mercatorXfromLng=cg,g.mercatorYfromLat=__,g.mercatorZfromAltitude=EA,g.mul=function(a,i,l){return a[0]=i[0]*l[0],a[1]=i[1]*l[1],a[2]=i[2]*l[2],a[3]=i[3]*l[3],a},g.mul$1=Pf,g.mul$2=Vv,g.multiply=kf,g.multiply$1=Hh,g.nextPowerOfTwo=bl,g.normalize=zv,g.normalize$1=function(a,i){var l=i[0],u=i[1],f=i[2],x=i[3],b=l*l+u*u+f*f+x*x;return b>0&&(b=1/Math.sqrt(b)),a[0]=l*b,a[1]=u*b,a[2]=f*b,a[3]=x*b,a},g.number=At,g.ortho=function(a,i,l,u,f,x,b){var S=1/(i-l),P=1/(u-f),F=1/(x-b);return a[0]=-2*S,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*P,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*F,a[11]=0,a[12]=(i+l)*S,a[13]=(f+u)*P,a[14]=(b+x)*F,a[15]=1,a},g.pbf=pA,g.perspective=function(a,i,l,u,f){var x,b=1/Math.tan(i/2);return a[0]=b/l,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=f&&f!==1/0?(a[10]=(f+u)*(x=1/(u-f)),a[14]=2*f*u*x):(a[10]=-1,a[14]=-2*u),a},g.pick=function(a,i){const l={};for(let u=0;u<i.length;u++){const f=i[u];f in a&&(l[f]=a[f])}return l},g.plugin=J,g.pointGeometry=dt,g.polygonIntersectsBox=Gh,g.polygonIntersectsPolygon=Mf,g.polygonizeBounds=function(a,i,l=0,u=!0){const f=new dt(l,l),x=a.sub(f),b=i.add(f),S=[x,new dt(b.x,x.y),b,new dt(x.x,b.y)];return u&&S.push(x),S},g.posAttributes=dg,g.postMapLoadEvent=uc,g.postTurnstileEvent=xh,g.potpack=Hf,g.prevPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},g.radToDeg=function(a){return a*hu},g.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],g.registerForPluginStateChange=function(a){return a({pluginStatus:D,pluginURL:R}),$.on("pluginStateChange",a),a},g.removeAuthState=function(a){hc.delete(a)},g.renderColorRamp=Em,g.rotateX=function(a,i,l){var u=Math.sin(l),f=Math.cos(l),x=i[4],b=i[5],S=i[6],P=i[7],F=i[8],N=i[9],U=i[10],j=i[11];return i!==a&&(a[0]=i[0],a[1]=i[1],a[2]=i[2],a[3]=i[3],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15]),a[4]=x*f+F*u,a[5]=b*f+N*u,a[6]=S*f+U*u,a[7]=P*f+j*u,a[8]=F*f-x*u,a[9]=N*f-b*u,a[10]=U*f-S*u,a[11]=j*f-P*u,a},g.rotateX$1=Xu,g.rotateY=function(a,i,l){var u=Math.sin(l),f=Math.cos(l),x=i[0],b=i[1],S=i[2],P=i[3],F=i[8],N=i[9],U=i[10],j=i[11];return i!==a&&(a[4]=i[4],a[5]=i[5],a[6]=i[6],a[7]=i[7],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15]),a[0]=x*f-F*u,a[1]=b*f-N*u,a[2]=S*f-U*u,a[3]=P*f-j*u,a[8]=x*u+F*f,a[9]=b*u+N*f,a[10]=S*u+U*f,a[11]=P*u+j*f,a},g.rotateZ=function(a,i,l){var u=Math.sin(l),f=Math.cos(l),x=i[0],b=i[1],S=i[2],P=i[3],F=i[4],N=i[5],U=i[6],j=i[7];return i!==a&&(a[8]=i[8],a[9]=i[9],a[10]=i[10],a[11]=i[11],a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15]),a[0]=x*f+F*u,a[1]=b*f+N*u,a[2]=S*f+U*u,a[3]=P*f+j*u,a[4]=F*f-x*u,a[5]=N*f-b*u,a[6]=U*f-S*u,a[7]=j*f-P*u,a},g.rotateZ$1=function(a,i,l){l*=.5;var u=i[0],f=i[1],x=i[2],b=i[3],S=Math.sin(l),P=Math.cos(l);return a[0]=u*P+f*S,a[1]=f*P-u*S,a[2]=x*P+b*S,a[3]=b*P-x*S,a},g.scale=function(a,i,l){return a[0]=i[0]*l,a[1]=i[1]*l,a[2]=i[2]*l,a},g.scale$1=function(a,i,l){var u=l[0],f=l[1],x=l[2];return a[0]=i[0]*u,a[1]=i[1]*u,a[2]=i[2]*u,a[3]=i[3]*u,a[4]=i[4]*f,a[5]=i[5]*f,a[6]=i[6]*f,a[7]=i[7]*f,a[8]=i[8]*x,a[9]=i[9]*x,a[10]=i[10]*x,a[11]=i[11]*x,a[12]=i[12],a[13]=i[13],a[14]=i[14],a[15]=i[15],a},g.scale$2=function(a,i,l){return a[0]=i[0]*l,a[1]=i[1]*l,a[2]=i[2]*l,a[3]=i[3]*l,a},g.scaleAndAdd=F0,g.setCacheLimits=function(a,i){wh=a,vu=i},g.setRTLTextPlugin=function(a,i,l=!1){if(D===s||D===h||D===v)throw new Error("setRTLTextPlugin cannot be called multiple times.");R=go.resolveURL(a),D=s,E=i,z(),l||Q()},g.smoothstep=function(a,i,l){return(l=di((l-a)/(i-a),0,1))*l*(3-2*l)},g.spec=Ce,g.storeAuthState=function(a,i){i?hc.add(a):hc.delete(a)},g.sub=s2,g.subtract=Qu,g.symbolSize=sa,g.transformMat3=function(a,i,l){var u=i[0],f=i[1],x=i[2];return a[0]=u*l[0]+f*l[3]+x*l[6],a[1]=u*l[1]+f*l[4]+x*l[7],a[2]=u*l[2]+f*l[5]+x*l[8],a},g.transformMat4=sA,g.transformMat4$1=function(a,i,l){var u=i[0],f=i[1],x=i[2],b=l[3]*u+l[7]*f+l[11]*x+l[15];return a[0]=(l[0]*u+l[4]*f+l[8]*x+l[12])/(b=b||1),a[1]=(l[1]*u+l[5]*f+l[9]*x+l[13])/b,a[2]=(l[2]*u+l[6]*f+l[10]*x+l[14])/b,a},g.transformQuat=xm,g.translate=function(a,i,l){var u,f,x,b,S,P,F,N,U,j,q,re,oe=l[0],Ae=l[1],xe=l[2];return i===a?(a[12]=i[0]*oe+i[4]*Ae+i[8]*xe+i[12],a[13]=i[1]*oe+i[5]*Ae+i[9]*xe+i[13],a[14]=i[2]*oe+i[6]*Ae+i[10]*xe+i[14],a[15]=i[3]*oe+i[7]*Ae+i[11]*xe+i[15]):(f=i[1],x=i[2],b=i[3],S=i[4],P=i[5],F=i[6],N=i[7],U=i[8],j=i[9],q=i[10],re=i[11],a[0]=u=i[0],a[1]=f,a[2]=x,a[3]=b,a[4]=S,a[5]=P,a[6]=F,a[7]=N,a[8]=U,a[9]=j,a[10]=q,a[11]=re,a[12]=u*oe+S*Ae+U*xe+i[12],a[13]=f*oe+P*Ae+j*xe+i[13],a[14]=x*oe+F*Ae+q*xe+i[14],a[15]=b*oe+N*Ae+re*xe+i[15]),a},g.triggerPluginCompletionEvent=B,g.uniqueId=_s,g.validateCustomStyleLayer=function(a){const i=[],l=a.id;return void 0===l&&i.push({message:`layers.${l}: missing required property "id"`}),void 0===a.render&&i.push({message:`layers.${l}: missing required method "render"`}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&i.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),i},g.validateFog=ht,g.validateLight=Gd,g.validateStyle=Mc,g.values=Hn,g.vectorTile=Fa,g.version="2.5.1",g.warnOnce=jr,g.window=Et,g.wrap=$a}),Cd(0,function(g){function Do(ne){const Z=typeof ne;if("number"===Z||"boolean"===Z||"string"===Z||null==ne)return JSON.stringify(ne);if(Array.isArray(ne)){let he="[";for(const be of ne)he+=`${Do(be)},`;return`${he}]`}const Y=Object.keys(ne).sort();let ae="{";for(let he=0;he<Y.length;he++)ae+=`${JSON.stringify(Y[he])}:${Do(ne[Y[he]])},`;return`${ae}}`}function qo(ne){let Z="";for(const Y of g.refProperties)Z+=`/${Do(ne[Y])}`;return Z}class mo{constructor(Z){this.keyCache={},Z&&this.replace(Z)}replace(Z){this._layerConfigs={},this._layers={},this.update(Z,[])}update(Z,Y){for(const he of Z){this._layerConfigs[he.id]=he;const be=this._layers[he.id]=g.createStyleLayer(he);be._featureFilter=g.createFilter(be.filter),this.keyCache[he.id]&&delete this.keyCache[he.id]}for(const he of Y)delete this.keyCache[he],delete this._layerConfigs[he],delete this._layers[he];this.familiesBySource={};const ae=function(he,be){const we={};for(let Ee=0;Ee<he.length;Ee++){const Oe=be&&be[he[Ee].id]||qo(he[Ee]);be&&(be[he[Ee].id]=Oe);let Je=we[Oe];Je||(Je=we[Oe]=[]),Je.push(he[Ee])}const ke=[];for(const Ee in we)ke.push(we[Ee]);return ke}(g.values(this._layerConfigs),this.keyCache);for(const he of ae){const be=he.map(mt=>this._layers[mt.id]),we=be[0];if("none"===we.visibility)continue;const ke=we.source||"";let Ee=this.familiesBySource[ke];Ee||(Ee=this.familiesBySource[ke]={});const Oe=we.sourceLayer||"_geojsonTileLayer";let Je=Ee[Oe];Je||(Je=Ee[Oe]=[]),Je.push(be)}}}const{ImageBitmap:dt}=g.window;class ct{loadTile(Z,Y){const{uid:ae,encoding:he,rawImageData:be,padding:we,buildQuadTree:ke}=Z,Ee=dt&&be instanceof dt?this.getImageData(be,we):be;Y(null,new g.DEMData(ae,Ee,he,we<1,ke))}getImageData(Z,Y){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Z.width,Z.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Z.width,this.offscreenCanvas.height=Z.height,this.offscreenCanvasContext.drawImage(Z,0,0,Z.width,Z.height);const ae=this.offscreenCanvasContext.getImageData(-Y,-Y,Z.width+2*Y,Z.height+2*Y);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new g.RGBAImage({width:ae.width,height:ae.height},ae.data)}}var Et=function ne(Z,Y){var ae,he=Z&&Z.type;if("FeatureCollection"===he)for(ae=0;ae<Z.features.length;ae++)ne(Z.features[ae],Y);else if("GeometryCollection"===he)for(ae=0;ae<Z.geometries.length;ae++)ne(Z.geometries[ae],Y);else if("Feature"===he)ne(Z.geometry,Y);else if("Polygon"===he)ms(Z.coordinates,Y);else if("MultiPolygon"===he)for(ae=0;ae<Z.coordinates.length;ae++)ms(Z.coordinates[ae],Y);return Z};function ms(ne,Z){if(0!==ne.length){ja(ne[0],Z);for(var Y=1;Y<ne.length;Y++)ja(ne[Y],!Z)}}function ja(ne,Z){for(var Y=0,ae=0,he=ne.length,be=he-1;ae<he;be=ae++)Y+=(ne[ae][0]-ne[be][0])*(ne[be][1]+ne[ae][1]);Y>=0!=!!Z&&ne.reverse()}const hu=g.vectorTile.VectorTileFeature.prototype.toGeoJSON;class qn{constructor(Z){this._feature=Z,this.extent=g.EXTENT,this.type=Z.type,this.properties=Z.tags,"id"in Z&&!isNaN(Z.id)&&(this.id=parseInt(Z.id,10))}loadGeometry(){if(1===this._feature.type){const Z=[];for(const Y of this._feature.geometry)Z.push([new g.pointGeometry(Y[0],Y[1])]);return Z}{const Z=[];for(const Y of this._feature.geometry){const ae=[];for(const he of Y)ae.push(new g.pointGeometry(he[0],he[1]));Z.push(ae)}return Z}}toGeoJSON(Z,Y,ae){return hu.call(this,Z,Y,ae)}}class du{constructor(Z){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=g.EXTENT,this.length=Z.length,this._features=Z}feature(Z){return new qn(this._features[Z])}}var Au=g.vectorTile.VectorTileFeature,Ga=gs;function gs(ne,Z){this.options=Z||{},this.features=ne,this.length=ne.length}function di(ne,Z){this.id="number"==typeof ne.id?ne.id:void 0,this.type=ne.type,this.rawGeometry=1===ne.type?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=Z||4096}gs.prototype.feature=function(ne){return new di(this.features[ne],this.options.extent)},di.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var Z=0;Z<ne.length;Z++){for(var Y=ne[Z],ae=[],he=0;he<Y.length;he++)ae.push(new g.pointGeometry(Y[he][0],Y[he][1]));this.geometry.push(ae)}return this.geometry},di.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,Z=1/0,Y=-1/0,ae=1/0,he=-1/0,be=0;be<ne.length;be++)for(var we=ne[be],ke=0;ke<we.length;ke++){var Ee=we[ke];Z=Math.min(Z,Ee.x),Y=Math.max(Y,Ee.x),ae=Math.min(ae,Ee.y),he=Math.max(he,Ee.y)}return[Z,ae,Y,he]},di.prototype.toGeoJSON=Au.prototype.toGeoJSON;var $a=Hn,fu=Ga;function Hn(ne){var Z=new g.pbf;return function(Y,ae){for(var he in Y.layers)ae.writeMessage(3,Ai,Y.layers[he])}(ne,Z),Z.finish()}function Ai(ne,Z){var Y;Z.writeVarintField(15,ne.version||1),Z.writeStringField(1,ne.name||""),Z.writeVarintField(5,ne.extent||4096);var ae={keys:[],values:[],keycache:{},valuecache:{}};for(Y=0;Y<ne.length;Y++)ae.feature=ne.feature(Y),Z.writeMessage(2,lf,ae);var he=ae.keys;for(Y=0;Y<he.length;Y++)Z.writeStringField(3,he[Y]);var be=ae.values;for(Y=0;Y<be.length;Y++)Z.writeMessage(4,lc,be[Y])}function lf(ne,Z){var Y=ne.feature;void 0!==Y.id&&Z.writeVarintField(1,Y.id),Z.writeMessage(2,_s,ne),Z.writeVarintField(3,Y.type),Z.writeMessage(4,vi,Y)}function _s(ne,Z){var Y=ne.feature,ae=ne.keys,he=ne.values,be=ne.keycache,we=ne.valuecache;for(var ke in Y.properties){var Ee=be[ke];void 0===Ee&&(ae.push(ke),be[ke]=Ee=ae.length-1),Z.writeVarint(Ee);var Oe=Y.properties[ke],Je=typeof Oe;"string"!==Je&&"boolean"!==Je&&"number"!==Je&&(Oe=JSON.stringify(Oe));var mt=Je+":"+Oe,Ke=we[mt];void 0===Ke&&(he.push(Oe),we[mt]=Ke=he.length-1),Z.writeVarint(Ke)}}function xl(ne,Z){return(Z<<3)+(7&ne)}function bl(ne){return ne<<1^ne>>31}function vi(ne,Z){for(var Y=ne.loadGeometry(),ae=ne.type,he=0,be=0,we=Y.length,ke=0;ke<we;ke++){var Ee=Y[ke],Oe=1;1===ae&&(Oe=Ee.length),Z.writeVarint(xl(1,Oe));for(var Je=3===ae?Ee.length-1:Ee.length,mt=0;mt<Je;mt++){1===mt&&1!==ae&&Z.writeVarint(xl(2,Je-1));var Ke=Ee[mt].x-he,$t=Ee[mt].y-be;Z.writeVarint(bl(Ke)),Z.writeVarint(bl($t)),he+=Ke,be+=$t}3===ae&&Z.writeVarint(xl(7,1))}}function lc(ne,Z){var Y=typeof ne;"string"===Y?Z.writeStringField(1,ne):"boolean"===Y?Z.writeBooleanField(7,ne):"number"===Y&&(ne%1!=0?Z.writeDoubleField(3,ne):ne<0?Z.writeSVarintField(6,ne):Z.writeVarintField(5,ne))}function ys(ne,Z,Y,ae,he,be){if(he-ae<=Y)return;const we=ae+he>>1;pn(ne,Z,we,ae,he,be%2),ys(ne,Z,Y,ae,we-1,be+1),ys(ne,Z,Y,we+1,he,be+1)}function pn(ne,Z,Y,ae,he,be){for(;he>ae;){if(he-ae>600){const Oe=he-ae+1,Je=Y-ae+1,mt=Math.log(Oe),Ke=.5*Math.exp(2*mt/3),$t=.5*Math.sqrt(mt*Ke*(Oe-Ke)/Oe)*(Je-Oe/2<0?-1:1);pn(ne,Z,Y,Math.max(ae,Math.floor(Y-Je*Ke/Oe+$t)),Math.min(he,Math.floor(Y+(Oe-Je)*Ke/Oe+$t)),be)}const we=Z[2*Y+be];let ke=ae,Ee=he;for(Zo(ne,Z,ae,Y),Z[2*he+be]>we&&Zo(ne,Z,ae,he);ke<Ee;){for(Zo(ne,Z,ke,Ee),ke++,Ee--;Z[2*ke+be]<we;)ke++;for(;Z[2*Ee+be]>we;)Ee--}Z[2*ae+be]===we?Zo(ne,Z,ae,Ee):(Ee++,Zo(ne,Z,Ee,he)),Ee<=Y&&(ae=Ee+1),Y<=Ee&&(he=Ee-1)}}function Zo(ne,Z,Y,ae){Br(ne,Y,ae),Br(Z,2*Y,2*ae),Br(Z,2*Y+1,2*ae+1)}function Br(ne,Z,Y){const ae=ne[Z];ne[Z]=ne[Y],ne[Y]=ae}function Ha(ne,Z,Y,ae){const he=ne-Y,be=Z-ae;return he*he+be*be}$a.fromVectorTileJs=Hn,$a.fromGeojsonVt=function(ne,Z){Z=Z||{};var Y={};for(var ae in ne)Y[ae]=new Ga(ne[ae].features,Z),Y[ae].name=ae,Y[ae].version=Z.version,Y[ae].extent=Z.extent;return Hn({layers:Y})},$a.GeoJSONWrapper=fu;const jr=ne=>ne[0],vs=ne=>ne[1];class qa{constructor(Z,Y=jr,ae=vs,he=64,be=Float64Array){this.nodeSize=he,this.points=Z;const we=Z.length<65536?Uint16Array:Uint32Array,ke=this.ids=new we(Z.length),Ee=this.coords=new be(2*Z.length);for(let Oe=0;Oe<Z.length;Oe++)ke[Oe]=Oe,Ee[2*Oe]=Y(Z[Oe]),Ee[2*Oe+1]=ae(Z[Oe]);ys(ke,Ee,he,0,ke.length-1,0)}range(Z,Y,ae,he){return function(be,we,ke,Ee,Oe,Je,mt){const Ke=[0,be.length-1,0],$t=[];let Ce,$e;for(;Ke.length;){const qt=Ke.pop(),_n=Ke.pop(),an=Ke.pop();if(_n-an<=mt){for(let xr=an;xr<=_n;xr++)Ce=we[2*xr],$e=we[2*xr+1],Ce>=ke&&Ce<=Oe&&$e>=Ee&&$e<=Je&&$t.push(be[xr]);continue}const er=Math.floor((an+_n)/2);Ce=we[2*er],$e=we[2*er+1],Ce>=ke&&Ce<=Oe&&$e>=Ee&&$e<=Je&&$t.push(be[er]);const Vn=(qt+1)%2;(0===qt?ke<=Ce:Ee<=$e)&&(Ke.push(an),Ke.push(er-1),Ke.push(Vn)),(0===qt?Oe>=Ce:Je>=$e)&&(Ke.push(er+1),Ke.push(_n),Ke.push(Vn))}return $t}(this.ids,this.coords,Z,Y,ae,he,this.nodeSize)}within(Z,Y,ae){return function(he,be,we,ke,Ee,Oe){const Je=[0,he.length-1,0],mt=[],Ke=Ee*Ee;for(;Je.length;){const $t=Je.pop(),Ce=Je.pop(),$e=Je.pop();if(Ce-$e<=Oe){for(let Vn=$e;Vn<=Ce;Vn++)Ha(be[2*Vn],be[2*Vn+1],we,ke)<=Ke&&mt.push(he[Vn]);continue}const qt=Math.floor(($e+Ce)/2),_n=be[2*qt],an=be[2*qt+1];Ha(_n,an,we,ke)<=Ke&&mt.push(he[qt]);const er=($t+1)%2;(0===$t?we-Ee<=_n:ke-Ee<=an)&&(Je.push($e),Je.push(qt-1),Je.push(er)),(0===$t?we+Ee>=_n:ke+Ee>=an)&&(Je.push(qt+1),Je.push(Ce),Je.push(er))}return mt}(this.ids,this.coords,Z,Y,ae,this.nodeSize)}}const wl={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ne=>ne},Za=Math.fround||(Wa=new Float32Array(1),ne=>(Wa[0]=+ne,Wa[0]));var Wa;class zn{constructor(Z){this.options=qs(Object.create(wl),Z),this.trees=new Array(this.options.maxZoom+1)}load(Z){const{log:Y,minZoom:ae,maxZoom:he,nodeSize:be}=this.options;Y&&console.time("total time");const we=`prepare ${Z.length} points`;Y&&console.time(we),this.points=Z;let ke=[];for(let Ee=0;Ee<Z.length;Ee++)Z[Ee].geometry&&ke.push(El(Z[Ee],Ee));this.trees[he+1]=new qa(ke,Qa,Nr,be,Float32Array),Y&&console.timeEnd(we);for(let Ee=he;Ee>=ae;Ee--){const Oe=+Date.now();ke=this._cluster(ke,Ee),this.trees[Ee]=new qa(ke,Qa,Nr,be,Float32Array),Y&&console.log("z%d: %d clusters in %dms",Ee,ke.length,+Date.now()-Oe)}return Y&&console.timeEnd("total time"),this}getClusters(Z,Y){let ae=((Z[0]+180)%360+360)%360-180;const he=Math.max(-90,Math.min(90,Z[1]));let be=180===Z[2]?180:((Z[2]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,Z[3]));if(Z[2]-Z[0]>=360)ae=-180,be=180;else if(ae>be){const Je=this.getClusters([ae,he,180,we],Y),mt=this.getClusters([-180,he,be,we],Y);return Je.concat(mt)}const ke=this.trees[this._limitZoom(Y)],Ee=ke.range(go(ae),_a(we),go(be),_a(he)),Oe=[];for(const Je of Ee){const mt=ke.points[Je];Oe.push(mt.numPoints?pu(mt):this.points[mt.index])}return Oe}getChildren(Z){const Y=this._getOriginId(Z),ae=this._getOriginZoom(Z),he="No cluster with the specified id.",be=this.trees[ae];if(!be)throw new Error(he);const we=be.points[Y];if(!we)throw new Error(he);const ke=this.options.radius/(this.options.extent*Math.pow(2,ae-1)),Ee=be.within(we.x,we.y,ke),Oe=[];for(const Je of Ee){const mt=be.points[Je];mt.parentId===Z&&Oe.push(mt.numPoints?pu(mt):this.points[mt.index])}if(0===Oe.length)throw new Error(he);return Oe}getLeaves(Z,Y,ae){const he=[];return this._appendLeaves(he,Z,Y=Y||10,ae=ae||0,0),he}getTile(Z,Y,ae){const he=this.trees[this._limitZoom(Z)],be=Math.pow(2,Z),{extent:we,radius:ke}=this.options,Ee=ke/we,Oe=(ae-Ee)/be,Je=(ae+1+Ee)/be,mt={features:[]};return this._addTileFeatures(he.range((Y-Ee)/be,Oe,(Y+1+Ee)/be,Je),he.points,Y,ae,be,mt),0===Y&&this._addTileFeatures(he.range(1-Ee/be,Oe,1,Je),he.points,be,ae,be,mt),Y===be-1&&this._addTileFeatures(he.range(0,Oe,Ee/be,Je),he.points,-1,ae,be,mt),mt.features.length?mt:null}getClusterExpansionZoom(Z){let Y=this._getOriginZoom(Z)-1;for(;Y<=this.options.maxZoom;){const ae=this.getChildren(Z);if(Y++,1!==ae.length)break;Z=ae[0].properties.cluster_id}return Y}_appendLeaves(Z,Y,ae,he,be){const we=this.getChildren(Y);for(const ke of we){const Ee=ke.properties;if(Ee&&Ee.cluster?be+Ee.point_count<=he?be+=Ee.point_count:be=this._appendLeaves(Z,Ee.cluster_id,ae,he,be):be<he?be++:Z.push(ke),Z.length===ae)break}return be}_addTileFeatures(Z,Y,ae,he,be,we){for(const ke of Z){const Ee=Y[ke],Oe=Ee.numPoints;let Je,mt,Ke;if(Oe)Je=mu(Ee),mt=Ee.x,Ke=Ee.y;else{const $e=this.points[Ee.index];Je=$e.properties,mt=go($e.geometry.coordinates[0]),Ke=_a($e.geometry.coordinates[1])}const $t={type:1,geometry:[[Math.round(this.options.extent*(mt*be-ae)),Math.round(this.options.extent*(Ke*be-he))]],tags:Je};let Ce;Oe?Ce=Ee.id:this.options.generateId?Ce=Ee.index:this.points[Ee.index].id&&(Ce=this.points[Ee.index].id),void 0!==Ce&&($t.id=Ce),we.features.push($t)}}_limitZoom(Z){return Math.max(this.options.minZoom,Math.min(+Z,this.options.maxZoom+1))}_cluster(Z,Y){const ae=[],{radius:he,extent:be,reduce:we,minPoints:ke}=this.options,Ee=he/(be*Math.pow(2,Y));for(let Oe=0;Oe<Z.length;Oe++){const Je=Z[Oe];if(Je.zoom<=Y)continue;Je.zoom=Y;const mt=this.trees[Y+1],Ke=mt.within(Je.x,Je.y,Ee),$t=Je.numPoints||1;let Ce=$t;for(const $e of Ke){const qt=mt.points[$e];qt.zoom>Y&&(Ce+=qt.numPoints||1)}if(Ce>=ke){let $e=Je.x*$t,qt=Je.y*$t,_n=we&&$t>1?this._map(Je,!0):null;const an=(Oe<<5)+(Y+1)+this.points.length;for(const er of Ke){const Vn=mt.points[er];if(Vn.zoom<=Y)continue;Vn.zoom=Y;const xr=Vn.numPoints||1;$e+=Vn.x*xr,qt+=Vn.y*xr,Vn.parentId=an,we&&(_n||(_n=this._map(Je,!0)),we(_n,this._map(Vn)))}Je.parentId=an,ae.push(Cl($e/Ce,qt/Ce,an,Ce,_n))}else if(ae.push(Je),Ce>1)for(const $e of Ke){const qt=mt.points[$e];qt.zoom<=Y||(qt.zoom=Y,ae.push(qt))}}return ae}_getOriginId(Z){return Z-this.points.length>>5}_getOriginZoom(Z){return(Z-this.points.length)%32}_map(Z,Y){if(Z.numPoints)return Y?qs({},Z.properties):Z.properties;const ae=this.points[Z.index].properties,he=this.options.map(ae);return Y&&he===ae?qs({},he):he}}function Cl(ne,Z,Y,ae,he){return{x:Za(ne),y:Za(Z),zoom:1/0,id:Y,parentId:-1,numPoints:ae,properties:he}}function El(ne,Z){const[Y,ae]=ne.geometry.coordinates;return{x:Za(go(Y)),y:Za(_a(ae)),zoom:1/0,index:Z,parentId:-1}}function pu(ne){return{type:"Feature",id:ne.id,properties:mu(ne),geometry:{type:"Point",coordinates:[(Z=ne.x,360*(Z-.5)),Kn(ne.y)]}};var Z}function mu(ne){const Z=ne.numPoints,Y=Z>=1e4?`${Math.round(Z/1e3)}k`:Z>=1e3?Math.round(Z/100)/10+"k":Z;return qs(qs({},ne.properties),{cluster:!0,cluster_id:ne.id,point_count:Z,point_count_abbreviated:Y})}function go(ne){return ne/360+.5}function _a(ne){const Z=Math.sin(ne*Math.PI/180),Y=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return Y<0?0:Y>1?1:Y}function Kn(ne){const Z=(180-360*ne)*Math.PI/180;return 360*Math.atan(Math.exp(Z))/Math.PI-90}function qs(ne,Z){for(const Y in Z)ne[Y]=Z[Y];return ne}function Qa(ne){return ne.x}function Nr(ne){return ne.y}function ya(ne,Z,Y,ae){for(var he,be=ae,we=Y-Z>>1,ke=Y-Z,Ee=ne[Z],Oe=ne[Z+1],Je=ne[Y],mt=ne[Y+1],Ke=Z+3;Ke<Y;Ke+=3){var $t=Ed(ne[Ke],ne[Ke+1],Ee,Oe,Je,mt);if($t>be)he=Ke,be=$t;else if($t===be){var Ce=Math.abs(Ke-we);Ce<ke&&(he=Ke,ke=Ce)}}be>ae&&(he-Z>3&&ya(ne,Z,he,ae),ne[he+2]=be,Y-he>3&&ya(ne,he,Y,ae))}function Ed(ne,Z,Y,ae,he,be){var we=he-Y,ke=be-ae;if(0!==we||0!==ke){var Ee=((ne-Y)*we+(Z-ae)*ke)/(we*we+ke*ke);Ee>1?(Y=he,ae=be):Ee>0&&(Y+=we*Ee,ae+=ke*Ee)}return(we=ne-Y)*we+(ke=Z-ae)*ke}function Zs(ne,Z,Y,ae){var he={id:void 0===ne?null:ne,type:Z,geometry:Y,tags:ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(be){var we=be.geometry,ke=be.type;if("Point"===ke||"MultiPoint"===ke||"LineString"===ke)gu(be,we);else if("Polygon"===ke||"MultiLineString"===ke)for(var Ee=0;Ee<we.length;Ee++)gu(be,we[Ee]);else if("MultiPolygon"===ke)for(Ee=0;Ee<we.length;Ee++)for(var Oe=0;Oe<we[Ee].length;Oe++)gu(be,we[Ee][Oe])}(he),he}function gu(ne,Z){for(var Y=0;Y<Z.length;Y+=3)ne.minX=Math.min(ne.minX,Z[Y]),ne.minY=Math.min(ne.minY,Z[Y+1]),ne.maxX=Math.max(ne.maxX,Z[Y]),ne.maxY=Math.max(ne.maxY,Z[Y+1])}function va(ne,Z,Y,ae){if(Z.geometry){var he=Z.geometry.coordinates,be=Z.geometry.type,we=Math.pow(Y.tolerance/((1<<Y.maxZoom)*Y.extent),2),ke=[],Ee=Z.id;if(Y.promoteId?Ee=Z.properties[Y.promoteId]:Y.generateId&&(Ee=ae||0),"Point"===be)mr(he,ke);else if("MultiPoint"===be)for(var Oe=0;Oe<he.length;Oe++)mr(he[Oe],ke);else if("LineString"===be)Xa(he,ke,we,!1);else if("MultiLineString"===be){if(Y.lineMetrics){for(Oe=0;Oe<he.length;Oe++)Xa(he[Oe],ke=[],we,!1),ne.push(Zs(Ee,"LineString",ke,Z.properties));return}_u(he,ke,we,!1)}else if("Polygon"===be)_u(he,ke,we,!0);else{if("MultiPolygon"!==be){if("GeometryCollection"===be){for(Oe=0;Oe<Z.geometry.geometries.length;Oe++)va(ne,{id:Ee,geometry:Z.geometry.geometries[Oe],properties:Z.properties},Y,ae);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Oe=0;Oe<he.length;Oe++){var Je=[];_u(he[Oe],Je,we,!0),ke.push(Je)}}ne.push(Zs(Ee,be,ke,Z.properties))}}function mr(ne,Z){Z.push(xs(ne[0])),Z.push(Wo(ne[1])),Z.push(0)}function Xa(ne,Z,Y,ae){for(var he,be,we=0,ke=0;ke<ne.length;ke++){var Ee=xs(ne[ke][0]),Oe=Wo(ne[ke][1]);Z.push(Ee),Z.push(Oe),Z.push(0),ke>0&&(we+=ae?(he*Oe-Ee*be)/2:Math.sqrt(Math.pow(Ee-he,2)+Math.pow(Oe-be,2))),he=Ee,be=Oe}var Je=Z.length-3;Z[2]=1,ya(Z,0,Je,Y),Z[Je+2]=1,Z.size=Math.abs(we),Z.start=0,Z.end=Z.size}function _u(ne,Z,Y,ae){for(var he=0;he<ne.length;he++){var be=[];Xa(ne[he],be,Y,ae),Z.push(be)}}function xs(ne){return ne/360+.5}function Wo(ne){var Z=Math.sin(ne*Math.PI/180),Y=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return Y<0?0:Y>1?1:Y}function Mo(ne,Z,Y,ae,he,be,we,ke){if(ae/=Z,be>=(Y/=Z)&&we<ae)return ne;if(we<Y||be>=ae)return null;for(var Ee=[],Oe=0;Oe<ne.length;Oe++){var Je=ne[Oe],mt=Je.geometry,Ke=Je.type,$t=0===he?Je.minX:Je.minY,Ce=0===he?Je.maxX:Je.maxY;if($t>=Y&&Ce<ae)Ee.push(Je);else if(!(Ce<Y||$t>=ae)){var $e=[];if("Point"===Ke||"MultiPoint"===Ke)yu(mt,$e,Y,ae,he);else if("LineString"===Ke)Dl(mt,$e,Y,ae,he,!1,ke.lineMetrics);else if("MultiLineString"===Ke)cc(mt,$e,Y,ae,he,!1);else if("Polygon"===Ke)cc(mt,$e,Y,ae,he,!0);else if("MultiPolygon"===Ke)for(var qt=0;qt<mt.length;qt++){var _n=[];cc(mt[qt],_n,Y,ae,he,!0),_n.length&&$e.push(_n)}if($e.length){if(ke.lineMetrics&&"LineString"===Ke){for(qt=0;qt<$e.length;qt++)Ee.push(Zs(Je.id,Ke,$e[qt],Je.tags));continue}"LineString"!==Ke&&"MultiLineString"!==Ke||(1===$e.length?(Ke="LineString",$e=$e[0]):Ke="MultiLineString"),"Point"!==Ke&&"MultiPoint"!==Ke||(Ke=3===$e.length?"Point":"MultiPoint"),Ee.push(Zs(Je.id,Ke,$e,Je.tags))}}}return Ee.length?Ee:null}function yu(ne,Z,Y,ae,he){for(var be=0;be<ne.length;be+=3){var we=ne[be+he];we>=Y&&we<=ae&&(Z.push(ne[be]),Z.push(ne[be+1]),Z.push(ne[be+2]))}}function Dl(ne,Z,Y,ae,he,be,we){for(var ke,Ee,Oe=xh(ne),Je=0===he?bh:Dd,mt=ne.start,Ke=0;Ke<ne.length-3;Ke+=3){var $t=ne[Ke],Ce=ne[Ke+1],$e=ne[Ke+2],qt=ne[Ke+3],_n=ne[Ke+4],an=0===he?$t:Ce,er=0===he?qt:_n,Vn=!1;we&&(ke=Math.sqrt(Math.pow($t-qt,2)+Math.pow(Ce-_n,2))),an<Y?er>Y&&(Ee=Je(Oe,$t,Ce,qt,_n,Y),we&&(Oe.start=mt+ke*Ee)):an>ae?er<ae&&(Ee=Je(Oe,$t,Ce,qt,_n,ae),we&&(Oe.start=mt+ke*Ee)):uc(Oe,$t,Ce,$e),er<Y&&an>=Y&&(Ee=Je(Oe,$t,Ce,qt,_n,Y),Vn=!0),er>ae&&an<=ae&&(Ee=Je(Oe,$t,Ce,qt,_n,ae),Vn=!0),!be&&Vn&&(we&&(Oe.end=mt+ke*Ee),Z.push(Oe),Oe=xh(ne)),we&&(mt+=ke)}var xr=ne.length-3;$t=ne[xr],Ce=ne[xr+1],$e=ne[xr+2],(an=0===he?$t:Ce)>=Y&&an<=ae&&uc(Oe,$t,Ce,$e),xr=Oe.length-3,be&&xr>=3&&(Oe[xr]!==Oe[0]||Oe[xr+1]!==Oe[1])&&uc(Oe,Oe[0],Oe[1],Oe[2]),Oe.length&&Z.push(Oe)}function xh(ne){var Z=[];return Z.size=ne.size,Z.start=ne.start,Z.end=ne.end,Z}function cc(ne,Z,Y,ae,he,be){for(var we=0;we<ne.length;we++)Dl(ne[we],Z,Y,ae,he,be,!1)}function uc(ne,Z,Y,ae){ne.push(Z),ne.push(Y),ne.push(ae)}function bh(ne,Z,Y,ae,he,be){var we=(be-Z)/(ae-Z);return ne.push(be),ne.push(Y+(he-Y)*we),ne.push(1),we}function Dd(ne,Z,Y,ae,he,be){var we=(be-Y)/(he-Y);return ne.push(Z+(ae-Z)*we),ne.push(be),ne.push(1),we}function hc(ne,Z){for(var Y=[],ae=0;ae<ne.length;ae++){var he,be=ne[ae],we=be.type;if("Point"===we||"MultiPoint"===we||"LineString"===we)he=dc(be.geometry,Z);else if("MultiLineString"===we||"Polygon"===we){he=[];for(var ke=0;ke<be.geometry.length;ke++)he.push(dc(be.geometry[ke],Z))}else if("MultiPolygon"===we)for(he=[],ke=0;ke<be.geometry.length;ke++){for(var Ee=[],Oe=0;Oe<be.geometry[ke].length;Oe++)Ee.push(dc(be.geometry[ke][Oe],Z));he.push(Ee)}Y.push(Zs(be.id,we,he,be.tags))}return Y}function dc(ne,Z){var Y=[];Y.size=ne.size,void 0!==ne.start&&(Y.start=ne.start,Y.end=ne.end);for(var ae=0;ae<ne.length;ae+=3)Y.push(ne[ae]+Z,ne[ae+1],ne[ae+2]);return Y}function Qo(ne,Z){if(ne.transformed)return ne;var Y,ae,he,be=1<<ne.z,we=ne.x,ke=ne.y;for(Y=0;Y<ne.features.length;Y++){var Ee=ne.features[Y],Oe=Ee.geometry,Je=Ee.type;if(Ee.geometry=[],1===Je)for(ae=0;ae<Oe.length;ae+=2)Ee.geometry.push(Ya(Oe[ae],Oe[ae+1],Z,be,we,ke));else for(ae=0;ae<Oe.length;ae++){var mt=[];for(he=0;he<Oe[ae].length;he+=2)mt.push(Ya(Oe[ae][he],Oe[ae][he+1],Z,be,we,ke));Ee.geometry.push(mt)}}return ne.transformed=!0,ne}function Ya(ne,Z,Y,ae,he,be){return[Math.round(Y*(ne*ae-he)),Math.round(Y*(Z*ae-be))]}function wh(ne,Z,Y,ae,he){for(var be=Z===he.maxZoom?0:he.tolerance/((1<<Z)*he.extent),we={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Y,y:ae,z:Z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ke=0;ke<ne.length;ke++){we.numFeatures++,vu(we,ne[ke],be,he);var Ee=ne[ke].minX,Oe=ne[ke].minY,Je=ne[ke].maxX,mt=ne[ke].maxY;Ee<we.minX&&(we.minX=Ee),Oe<we.minY&&(we.minY=Oe),Je>we.maxX&&(we.maxX=Je),mt>we.maxY&&(we.maxY=mt)}return we}function vu(ne,Z,Y,ae){var he=Z.geometry,be=Z.type,we=[];if("Point"===be||"MultiPoint"===be)for(var ke=0;ke<he.length;ke+=3)we.push(he[ke]),we.push(he[ke+1]),ne.numPoints++,ne.numSimplified++;else if("LineString"===be)On(we,he,ne,Y,!1,!1);else if("MultiLineString"===be||"Polygon"===be)for(ke=0;ke<he.length;ke++)On(we,he[ke],ne,Y,"Polygon"===be,0===ke);else if("MultiPolygon"===be)for(var Ee=0;Ee<he.length;Ee++){var Oe=he[Ee];for(ke=0;ke<Oe.length;ke++)On(we,Oe[ke],ne,Y,!0,0===ke)}if(we.length){var Je=Z.tags||null;if("LineString"===be&&ae.lineMetrics){for(var mt in Je={},Z.tags)Je[mt]=Z.tags[mt];Je.mapbox_clip_start=he.start/he.size,Je.mapbox_clip_end=he.end/he.size}var Ke={geometry:we,type:"Polygon"===be||"MultiPolygon"===be?3:"LineString"===be||"MultiLineString"===be?2:1,tags:Je};null!==Z.id&&(Ke.id=Z.id),ne.features.push(Ke)}}function On(ne,Z,Y,ae,he,be){var we=ae*ae;if(ae>0&&Z.size<(he?we:ae))Y.numPoints+=Z.length/3;else{for(var ke=[],Ee=0;Ee<Z.length;Ee+=3)(0===ae||Z[Ee+2]>we)&&(Y.numSimplified++,ke.push(Z[Ee]),ke.push(Z[Ee+1])),Y.numPoints++;he&&function(Oe,Je){for(var mt=0,Ke=0,$t=Oe.length,Ce=$t-2;Ke<$t;Ce=Ke,Ke+=2)mt+=(Oe[Ke]-Oe[Ce])*(Oe[Ke+1]+Oe[Ce+1]);if(mt>0===Je)for(Ke=0,$t=Oe.length;Ke<$t/2;Ke+=2){var $e=Oe[Ke],qt=Oe[Ke+1];Oe[Ke]=Oe[$t-2-Ke],Oe[Ke+1]=Oe[$t-1-Ke],Oe[$t-2-Ke]=$e,Oe[$t-1-Ke]=qt}}(ke,be),ne.push(ke)}}function xa(ne,Z){var Y=(Z=this.options=function(he,be){for(var we in be)he[we]=be[we];return he}(Object.create(this.options),Z)).debug;if(Y&&console.time("preprocess data"),Z.maxZoom<0||Z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Z.promoteId&&Z.generateId)throw new Error("promoteId and generateId cannot be used together.");var he,be,we,ke,Ee,Oe,ae=function(he,be){var we=[];if("FeatureCollection"===he.type)for(var ke=0;ke<he.features.length;ke++)va(we,he.features[ke],be,ke);else va(we,"Feature"===he.type?he:{geometry:he},be);return we}(ne,Z);this.tiles={},this.tileCoords=[],Y&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Z.indexMaxZoom,Z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(he=ae,be=Z,we=be.buffer/be.extent,ke=he,Ee=Mo(he,1,-1-we,we,0,-1,2,be),Oe=Mo(he,1,1-we,2+we,0,-1,2,be),(Ee||Oe)&&(ke=Mo(he,1,-we,1+we,0,-1,2,be)||[],Ee&&(ke=hc(Ee,1).concat(ke)),Oe&&(ke=ke.concat(hc(Oe,-1)))),ae=ke).length&&this.splitTile(ae,0,0,0),Y&&(ae.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function un(ne,Z,Y){return 32*((1<<ne)*Y+Z)+ne}function ba(ne,Z){const Y=ne.tileID.canonical;if(!this._geoJSONIndex)return Z(null,null);const ae=this._geoJSONIndex.getTile(Y.z,Y.x,Y.y);if(!ae)return Z(null,null);const he=new du(ae.features);let be=$a(he);0===be.byteOffset&&be.byteLength===be.buffer.byteLength||(be=new Uint8Array(be)),Z(null,{vectorTile:he,rawData:be.buffer})}xa.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},xa.prototype.splitTile=function(ne,Z,Y,ae,he,be,we){for(var ke=[ne,Z,Y,ae],Ee=this.options,Oe=Ee.debug;ke.length;){ae=ke.pop(),Y=ke.pop(),Z=ke.pop(),ne=ke.pop();var Je=1<<Z,mt=un(Z,Y,ae),Ke=this.tiles[mt];if(!Ke&&(Oe>1&&console.time("creation"),Ke=this.tiles[mt]=wh(ne,Z,Y,ae,Ee),this.tileCoords.push({z:Z,x:Y,y:ae}),Oe)){Oe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Z,Y,ae,Ke.numFeatures,Ke.numPoints,Ke.numSimplified),console.timeEnd("creation"));var $t="z"+Z;this.stats[$t]=(this.stats[$t]||0)+1,this.total++}if(Ke.source=ne,he){if(Z===Ee.maxZoom||Z===he)continue;var Ce=1<<he-Z;if(Y!==Math.floor(be/Ce)||ae!==Math.floor(we/Ce))continue}else if(Z===Ee.indexMaxZoom||Ke.numPoints<=Ee.indexMaxPoints)continue;if(Ke.source=null,0!==ne.length){Oe>1&&console.time("clipping");var $e,qt,_n,an,er,Vn,xr=.5*Ee.buffer/Ee.extent,Ka=.5-xr,bt=.5+xr,wn=1+xr;$e=qt=_n=an=null,er=Mo(ne,Je,Y-xr,Y+bt,0,Ke.minX,Ke.maxX,Ee),Vn=Mo(ne,Je,Y+Ka,Y+wn,0,Ke.minX,Ke.maxX,Ee),ne=null,er&&($e=Mo(er,Je,ae-xr,ae+bt,1,Ke.minY,Ke.maxY,Ee),qt=Mo(er,Je,ae+Ka,ae+wn,1,Ke.minY,Ke.maxY,Ee),er=null),Vn&&(_n=Mo(Vn,Je,ae-xr,ae+bt,1,Ke.minY,Ke.maxY,Ee),an=Mo(Vn,Je,ae+Ka,ae+wn,1,Ke.minY,Ke.maxY,Ee),Vn=null),Oe>1&&console.timeEnd("clipping"),ke.push($e||[],Z+1,2*Y,2*ae),ke.push(qt||[],Z+1,2*Y,2*ae+1),ke.push(_n||[],Z+1,2*Y+1,2*ae),ke.push(an||[],Z+1,2*Y+1,2*ae+1)}}},xa.prototype.getTile=function(ne,Z,Y){var ae=this.options,he=ae.extent,be=ae.debug;if(ne<0||ne>24)return null;var we=1<<ne,ke=un(ne,Z=(Z%we+we)%we,Y);if(this.tiles[ke])return Qo(this.tiles[ke],he);be>1&&console.log("drilling down to z%d-%d-%d",ne,Z,Y);for(var Ee,Oe=ne,Je=Z,mt=Y;!Ee&&Oe>0;)Oe--,Je=Math.floor(Je/2),mt=Math.floor(mt/2),Ee=this.tiles[un(Oe,Je,mt)];return Ee&&Ee.source?(be>1&&console.log("found parent tile z%d-%d-%d",Oe,Je,mt),be>1&&console.time("drilling down"),this.splitTile(Ee.source,Oe,Je,mt,ne,Z,Y),be>1&&console.timeEnd("drilling down"),this.tiles[ke]?Qo(this.tiles[ke],he):null):null};class Ac extends g.VectorTileWorkerSource{constructor(Z,Y,ae,he,be){super(Z,Y,ae,he,ba),be&&(this.loadGeoJSON=be)}loadData(Z,Y){const ae=Z&&Z.request,he=ae&&ae.collectResourceTiming;this.loadGeoJSON(Z,(be,we)=>{if(be||!we)return Y(be);if("object"!=typeof we)return Y(new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`));{Et(we,!0);try{if(Z.filter){const Ee=g.createExpression(Z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Ee.result)throw new Error(Ee.value.map(Je=>`${Je.key}: ${Je.message}`).join(", "));const Oe=we.features.filter(Je=>Ee.value.evaluate({zoom:0},Je));we={type:"FeatureCollection",features:Oe}}this._geoJSONIndex=Z.cluster?new zn(function({superclusterOptions:Ee,clusterProperties:Oe}){if(!Oe||!Ee)return Ee;const Je={},mt={},Ke={accumulated:null,zoom:0},$t={properties:null},Ce=Object.keys(Oe);for(const $e of Ce){const[qt,_n]=Oe[$e],an=g.createExpression(_n),er=g.createExpression("string"==typeof qt?[qt,["accumulated"],["get",$e]]:qt);Je[$e]=an.value,mt[$e]=er.value}return Ee.map=$e=>{$t.properties=$e;const qt={};for(const _n of Ce)qt[_n]=Je[_n].evaluate(Ke,$t);return qt},Ee.reduce=($e,qt)=>{$t.properties=qt;for(const _n of Ce)Ke.accumulated=$e[_n],$e[_n]=mt[_n].evaluate(Ke,$t)},Ee}(Z)).load(we.features):new xa(Ee=we,Z.geojsonVtOptions)}catch(Ee){return Y(Ee)}this.loaded={};const ke={};if(he){const Ee=g.getPerformanceMeasurement(ae);Ee&&(ke.resourceTiming={},ke.resourceTiming[Z.source]=JSON.parse(JSON.stringify(Ee)))}Y(null,ke)}var Ee})}reloadTile(Z,Y){const ae=this.loaded;return ae&&ae[Z.uid]?super.reloadTile(Z,Y):this.loadTile(Z,Y)}loadGeoJSON(Z,Y){if(Z.request)g.getJSON(Z.request,Y);else{if("string"!=typeof Z.data)return Y(new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`));try{return Y(null,JSON.parse(Z.data))}catch(ae){return Y(new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Z,Y){try{Y(null,this._geoJSONIndex.getClusterExpansionZoom(Z.clusterId))}catch(ae){Y(ae)}}getClusterChildren(Z,Y){try{Y(null,this._geoJSONIndex.getChildren(Z.clusterId))}catch(ae){Y(ae)}}getClusterLeaves(Z,Y){try{Y(null,this._geoJSONIndex.getLeaves(Z.clusterId,Z.limit,Z.offset))}catch(ae){Y(ae)}}}class Zn{constructor(Z){this.self=Z,this.actor=new g.Actor(Z,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded=!1,this.workerSourceTypes={vector:g.VectorTileWorkerSource,geojson:Ac},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Y,ae)=>{if(this.workerSourceTypes[Y])throw new Error(`Worker source with name "${Y}" already registered.`);this.workerSourceTypes[Y]=ae},this.self.registerRTLTextPlugin=Y=>{if(g.plugin.isParsed())throw new Error("RTL text plugin already registered.");g.plugin.applyArabicShaping=Y.applyArabicShaping,g.plugin.processBidirectionalText=Y.processBidirectionalText,g.plugin.processStyledBidirectionalText=Y.processStyledBidirectionalText}}checkIfReady(Z,Y,ae){ae()}setReferrer(Z,Y){this.referrer=Y}spriteLoaded(Z,Y){this.isSpriteLoaded=Y;for(const ae in this.workerSources[Z]){const he=this.workerSources[Z][ae];for(const be in he)he[be]instanceof g.VectorTileWorkerSource&&(he[be].isSpriteLoaded=Y,he[be].fire(new g.Event("isSpriteLoaded")))}}setImages(Z,Y,ae){this.availableImages[Z]=Y;for(const he in this.workerSources[Z]){const be=this.workerSources[Z][he];for(const we in be)be[we].availableImages=Y}ae()}enableTerrain(Z,Y,ae){this.terrain=Y,ae()}setLayers(Z,Y,ae){this.getLayerIndex(Z).replace(Y),ae()}updateLayers(Z,Y,ae){this.getLayerIndex(Z).update(Y.layers,Y.removedIds),ae()}loadTile(Z,Y,ae){const he=this.enableTerrain?g.extend({enableTerrain:this.terrain},Y):Y;this.getWorkerSource(Z,Y.type,Y.source).loadTile(he,ae)}loadDEMTile(Z,Y,ae){const he=this.enableTerrain?g.extend({buildQuadTree:this.terrain},Y):Y;this.getDEMWorkerSource(Z,Y.source).loadTile(he,ae)}reloadTile(Z,Y,ae){const he=this.enableTerrain?g.extend({enableTerrain:this.terrain},Y):Y;this.getWorkerSource(Z,Y.type,Y.source).reloadTile(he,ae)}abortTile(Z,Y,ae){this.getWorkerSource(Z,Y.type,Y.source).abortTile(Y,ae)}removeTile(Z,Y,ae){this.getWorkerSource(Z,Y.type,Y.source).removeTile(Y,ae)}removeSource(Z,Y,ae){if(!this.workerSources[Z]||!this.workerSources[Z][Y.type]||!this.workerSources[Z][Y.type][Y.source])return;const he=this.workerSources[Z][Y.type][Y.source];delete this.workerSources[Z][Y.type][Y.source],void 0!==he.removeSource?he.removeSource(Y,ae):ae()}loadWorkerSource(Z,Y,ae){try{this.self.importScripts(Y.url),ae()}catch(he){ae(he.toString())}}syncRTLPluginState(Z,Y,ae){try{g.plugin.setState(Y);const he=g.plugin.getPluginURL();if(g.plugin.isLoaded()&&!g.plugin.isParsed()&&null!=he){this.self.importScripts(he);const be=g.plugin.isParsed();ae(be?void 0:new Error(`RTL Text Plugin failed to import scripts from ${he}`),be)}}catch(he){ae(he.toString())}}getAvailableImages(Z){let Y=this.availableImages[Z];return Y||(Y=[]),Y}getLayerIndex(Z){let Y=this.layerIndexes[Z];return Y||(Y=this.layerIndexes[Z]=new mo),Y}getWorkerSource(Z,Y,ae){return this.workerSources[Z]||(this.workerSources[Z]={}),this.workerSources[Z][Y]||(this.workerSources[Z][Y]={}),this.workerSources[Z][Y][ae]||(this.workerSources[Z][Y][ae]=new this.workerSourceTypes[Y]({send:(he,be,we,ke,Ee,Oe)=>{this.actor.send(he,be,we,Z,Ee,Oe)},scheduler:this.actor.scheduler},this.getLayerIndex(Z),this.getAvailableImages(Z),this.isSpriteLoaded)),this.workerSources[Z][Y][ae]}getDEMWorkerSource(Z,Y){return this.demWorkerSources[Z]||(this.demWorkerSources[Z]={}),this.demWorkerSources[Z][Y]||(this.demWorkerSources[Z][Y]=new ct),this.demWorkerSources[Z][Y]}enforceCacheSizeLimit(Z,Y){g.enforceCacheSizeLimit(Y)}getWorkerPerformanceMetrics(Z,Y,ae){ae(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Zn(self)),Zn}),Cd(0,function(g){var Do=qo;function qo(_){return s=_,!("undefined"==typeof window||"undefined"==typeof document||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,E,D=new Blob([""],{type:"text/javascript"}),R=URL.createObjectURL(D);try{E=new Worker(R),v=!0}catch(B){v=!1}return E&&E.terminate(),URL.revokeObjectURL(R),v}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var v=document.createElement("canvas");v.width=v.height=1;var E=v.getContext("2d");if(!E)return!1;var D=E.getImageData(0,0,1,1);return D&&D.width===v.width}()||(void 0===mo[h=s&&s.failIfMajorPerformanceCaveat]&&(mo[h]=function(v){var E,R,B,z,D=(R=v,B=document.createElement("canvas"),(z=Object.create(qo.webGLContextAttributes)).failIfMajorPerformanceCaveat=R,B.getContext("webgl",z)||B.getContext("experimental-webgl",z));if(!D)return!1;try{E=D.createShader(D.VERTEX_SHADER)}catch(R){return!1}return!(!E||D.isContextLost())&&(D.shaderSource(E,"void main() {}"),D.compileShader(E),!0===D.getShaderParameter(E,D.COMPILE_STATUS))}(h)),!mo[h]||document.documentMode));var s,h}var mo={};function dt(_,s){if(Array.isArray(_)){if(!Array.isArray(s)||_.length!==s.length)return!1;for(let h=0;h<_.length;h++)if(!dt(_[h],s[h]))return!1;return!0}if("object"==typeof _&&null!==_&&null!==s){if("object"!=typeof s||Object.keys(_).length!==Object.keys(s).length)return!1;for(const h in _)if(!dt(_[h],s[h]))return!1;return!0}return _===s}qo.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const ct={create:function(_,s,h){const v=g.window.document.createElement(_);return void 0!==s&&(v.className=s),h&&h.appendChild(v),v},createNS:function(_,s){return g.window.document.createElementNS(_,s)}},Et=g.window.document&&g.window.document.documentElement.style,ms=Et&&void 0!==Et.userSelect?"userSelect":"WebkitUserSelect";let ja;ct.disableDrag=function(){Et&&ms&&(ja=Et[ms],Et[ms]="none")},ct.enableDrag=function(){Et&&ms&&(Et[ms]=ja)},ct.setTransform=function(_,s){_.style.transform=s};let hu=!1;try{const _=Object.defineProperty({},"passive",{get(){hu=!0}});g.window.addEventListener("test",_,_),g.window.removeEventListener("test",_,_)}catch(_){hu=!1}ct.addEventListener=function(_,s,h,v={}){_.addEventListener(s,h,"passive"in v&&hu?v:v.capture)},ct.removeEventListener=function(_,s,h,v={}){_.removeEventListener(s,h,"passive"in v&&hu?v:v.capture)};const qn=function(_){_.preventDefault(),_.stopPropagation(),g.window.removeEventListener("click",qn,!0)};function du(_,s,h){const v=_.offsetWidth===s.width?1:_.offsetWidth/s.width;return new g.pointGeometry((h.clientX-s.left)*v,(h.clientY-s.top)*v)}ct.suppressClick=function(){g.window.addEventListener("click",qn,!0),g.window.setTimeout(()=>{g.window.removeEventListener("click",qn,!0)},0)},ct.mousePos=function(_,s){const h=_.getBoundingClientRect();return du(_,h,s)},ct.touchPos=function(_,s){const h=_.getBoundingClientRect(),v=[];for(let E=0;E<s.length;E++)v.push(du(_,h,s[E]));return v},ct.mouseButton=function(_){return void 0!==g.window.InstallTrigger&&2===_.button&&_.ctrlKey&&g.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button},ct.remove=function(_){_.parentNode&&_.parentNode.removeChild(_)};class Au{constructor(s,h){this.pos=s,this.dir=h}intersectsPlane(s,h,v){const E=g.dot(h,this.dir);if(Math.abs(E)<1e-6)return!1;const D=g.dot(g.sub(g.create(),s,this.pos),h)/E,R=g.scaleAndAdd(g.create(),this.pos,this.dir,D);return g.copy(v,R),!0}}class Ga{constructor(s,h){this.points=s,this.planes=h}static fromInvProjectionMatrix(s,h,v){const E=Math.pow(2,v),D=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(B=>{const z=g.transformMat4([],B,s),$=1/z[3]/h*E;return g.mul(z,z,[$,$,1/z[3],$])}),R=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(B=>{const z=g.sub([],D[B[0]],D[B[1]]),$=g.sub([],D[B[2]],D[B[1]]),H=g.normalize([],g.cross([],z,$)),Q=-g.dot(H,D[B[1]]);return H.concat(Q)});return new Ga(D,R)}}class gs{constructor(s,h){this.min=s,this.max=h,this.center=g.scale([],g.add([],this.min,this.max),.5)}quadrant(s){const h=[s%2==0,s<2],v=g.clone(this.min),E=g.clone(this.max);for(let D=0;D<h.length;D++)v[D]=h[D]?this.min[D]:this.center[D],E[D]=h[D]?this.center[D]:this.max[D];return E[2]=this.max[2],new gs(v,E)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}intersects(s){const h=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let v=!0;for(let E=0;E<s.planes.length;E++){const D=s.planes[E];let R=0;for(let B=0;B<h.length;B++)R+=g.dot$1(D,h[B])>=0;if(0===R)return 0;R!==h.length&&(v=!1)}if(v)return 2;for(let E=0;E<3;E++){let D=Number.MAX_VALUE,R=-Number.MAX_VALUE;for(let B=0;B<s.points.length;B++){const z=s.points[B][E]-this.min[E];D=Math.min(D,z),R=Math.max(R,z)}if(R<0||D>this.max[E]-this.min[E])return 0}return 1}}function di(_){const{userImage:s}=_;return!!(s&&s.render&&s.render())&&(_.data.replace(new Uint8Array(s.data.buffer)),!0)}class $a extends g.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new g.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(const{ids:h,callback:v}of this.requestors)this._notify(h,v);this.requestors=[]}}getImage(s){return this.images[s]}addImage(s,h){this._validate(s,h)&&(this.images[s]=h)}_validate(s,h){let v=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new g.ErrorEvent(new Error(`Image "${s}" has invalid "stretchX" value`))),v=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new g.ErrorEvent(new Error(`Image "${s}" has invalid "stretchY" value`))),v=!1),this._validateContent(h.content,h)||(this.fire(new g.ErrorEvent(new Error(`Image "${s}" has invalid "content" value`))),v=!1),v}_validateStretch(s,h){if(!s)return!0;let v=0;for(const E of s){if(E[0]<v||E[1]<E[0]||h<E[1])return!1;v=E[1]}return!0}_validateContent(s,h){return!(s&&(4!==s.length||s[0]<0||h.data.width<s[0]||s[1]<0||h.data.height<s[1]||s[2]<0||h.data.width<s[2]||s[3]<0||h.data.height<s[3]||s[2]<s[0]||s[3]<s[1]))}updateImage(s,h){h.version=this.images[s].version+1,this.images[s]=h,this.updatedImages[s]=!0}removeImage(s){const h=this.images[s];delete this.images[s],delete this.patterns[s],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s,h){let v=!0;if(!this.isLoaded())for(const E of s)this.images[E]||(v=!1);this.isLoaded()||v?this._notify(s,h):this.requestors.push({ids:s,callback:h})}_notify(s,h){const v={};for(const E of s){this.images[E]||this.fire(new g.Event("styleimagemissing",{id:E}));const D=this.images[E];D?v[E]={data:D.data.clone(),pixelRatio:D.pixelRatio,sdf:D.sdf,version:D.version,stretchX:D.stretchX,stretchY:D.stretchY,content:D.content,hasRenderCallback:Boolean(D.userImage&&D.userImage.render)}:g.warnOnce(`Image "${E}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,v)}getPixelSize(){const{width:s,height:h}=this.atlasImage;return{width:s,height:h}}getPattern(s){const h=this.patterns[s],v=this.getImage(s);if(!v)return null;if(h&&h.position.version===v.version)return h.position;if(h)h.position.version=v.version;else{const E={w:v.data.width+2,h:v.data.height+2,x:0,y:0},D=new g.ImagePosition(E,v);this.patterns[s]={bin:E,position:D}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){const h=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new g.Texture(s,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const s=[];for(const D in this.patterns)s.push(this.patterns[D].bin);const{w:h,h:v}=g.potpack(s),E=this.atlasImage;E.resize({width:h||1,height:v||1});for(const D in this.patterns){const{bin:R}=this.patterns[D],B=R.x+1,z=R.y+1,$=this.images[D].data,H=$.width,Q=$.height;g.RGBAImage.copy($,E,{x:0,y:0},{x:B,y:z},{width:H,height:Q}),g.RGBAImage.copy($,E,{x:0,y:Q-1},{x:B,y:z-1},{width:H,height:1}),g.RGBAImage.copy($,E,{x:0,y:0},{x:B,y:z+Q},{width:H,height:1}),g.RGBAImage.copy($,E,{x:H-1,y:0},{x:B-1,y:z},{width:1,height:Q}),g.RGBAImage.copy($,E,{x:0,y:0},{x:B+H,y:z},{width:1,height:Q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(const h of s){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const v=this.images[h];di(v)&&this.updateImage(h,v)}}}const fu=new g.Properties({anchor:new g.DataConstantProperty(g.spec.light.anchor),position:new class{constructor(){this.specification=g.spec.light.position}possiblyEvaluate(_,s){return function([h,v,E]){const D=g.degToRad(v+90),R=g.degToRad(E);return{x:h*Math.cos(D)*Math.sin(R),y:h*Math.sin(D)*Math.sin(R),z:h*Math.cos(R),azimuthal:v,polar:E}}(_.expression.evaluate(s))}interpolate(_,s,h){return{x:g.number(_.x,s.x,h),y:g.number(_.y,s.y,h),z:g.number(_.z,s.z,h),azimuthal:g.number(_.azimuthal,s.azimuthal,h),polar:g.number(_.polar,s.polar,h)}}},color:new g.DataConstantProperty(g.spec.light.color),intensity:new g.DataConstantProperty(g.spec.light.intensity)}),Hn="-transition";class Ai extends g.Evented{constructor(s){super(),this._transitionable=new g.Transitionable(fu),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,h={}){if(!this._validate(g.validateLight,s,h))for(const v in s){const E=s[v];g.endsWith(v,Hn)?this._transitionable.setTransition(v.slice(0,-Hn.length),E):this._transitionable.setValue(v,E)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,h,v){return(!v||!1!==v.validate)&&g.emitValidationErrors(this,s.call(g.validateStyle,g.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:g.spec})))}}const lf=new g.Properties({source:new g.DataConstantProperty(g.spec.terrain.source),exaggeration:new g.DataConstantProperty(g.spec.terrain.exaggeration)}),_s="-transition";class xl extends g.Evented{constructor(s){super(),this._transitionable=new g.Transitionable(lf),this.set(s),this._transitioning=this._transitionable.untransitioned()}get(){return this._transitionable.serialize()}set(s){for(const h in s){const v=s[h];g.endsWith(h,_s)?this._transitionable.setTransition(h.slice(0,-_s.length),v):this._transitionable.setValue(h,v)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}}function bl(_,s,h,v){const E=g.smoothstep(45,65,h),[D,R]=vi(_,v),B=g.length(s);let z=1-Math.min(1,Math.exp((B-D)/(R-D)*-6));return z*=z*z,z=Math.min(1,1.00747*z),z*E*_.alpha}function vi(_,s){const h=.5/Math.tan(.5*s);return[_.range[0]+h,_.range[1]+h]}const lc=new g.Properties({range:new g.DataConstantProperty(g.spec.fog.range),color:new g.DataConstantProperty(g.spec.fog.color),"horizon-blend":new g.DataConstantProperty(g.spec.fog["horizon-blend"])}),ys="-transition";class pn extends g.Evented{constructor(s){super(),this._transitionable=new g.Transitionable(lc),this.set(s),this._transitioning=this._transitionable.untransitioned()}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,h={}){if(!this._validate(g.validateFog,s,h))for(const v in s){const E=s[v];g.endsWith(v,ys)?this._transitionable.setTransition(v.slice(0,-ys.length),E):this._transitionable.setValue(v,E)}}getOpacity(s){const h=this.properties&&this.properties.get("color")||1;return g.smoothstep(45,65,s)*h.a}getOpacityAtLatLng(s,h){return function(v,E,D){const R=g.MercatorCoordinate.fromLngLat(E),B=D.elevation?D.elevation.getAtPointOrZero(R):0,z=[R.x,R.y,B];return g.transformMat4$1(z,z,D.mercatorFogMatrix),bl(v,z,D.pitch,D._fov)}(this.state,s,h)}getFovAdjustedRange(s){return vi(this.state,s)}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,h,v){return(!v||!1!==v.validate)&&g.emitValidationErrors(this,s.call(g.validateStyle,g.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:g.spec})))}}class Zo{constructor(s,h){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=g.uniqueId();const v=this.workerPool.acquire(this.id);for(let E=0;E<v.length;E++){const D=new Zo.Actor(v[E],h,this.id);D.name=`Worker ${E}`,this.actors.push(D)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(s,h,v){g.asyncAll(this.actors,(E,D)=>{E.send(s,h,D)},v=v||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(s=>{s.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Br(_,s,h){return s*(g.EXTENT/(_.tileSize*Math.pow(2,h-_.tileID.overscaledZ)))}Zo.Actor=g.Actor;class Ha{constructor(s,h,v,E){this.screenBounds=s,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=v,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(D=>E.pointCoordinate3D(D)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(s,h){let v,E;if(s instanceof g.pointGeometry||"number"==typeof s[0]){const D=g.pointGeometry.convert(s);v=[g.pointGeometry.convert(s)],E=h.isPointAboveHorizon(D)}else{const D=g.pointGeometry.convert(s[0]),R=g.pointGeometry.convert(s[1]);v=[D,R],E=g.polygonizeBounds(D,R).every(B=>h.isPointAboveHorizon(B))}return new Ha(v,h.getCameraPoint(),E,h)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(s){return g.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){const h=this.screenBounds[0],v=1===this.screenBounds.length?this.screenBounds[0].add(new g.pointGeometry(1,1)):this.screenBounds[1],E=g.polygonizeBounds(h,v,0,!1);return this.cameraPoint.y>v.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<v.x?E.splice(3,0,this.cameraPoint):this.cameraPoint.x>=v.x?E[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(E[3]=this.cameraPoint)),g.bufferConvexPolygon(E,s)}containsTile(s,h,v){const E=s.queryPadding+1,D=v?this._bufferedCameraMercator(E,h).map(te=>s.tileID.getTilePoint(te)):this._bufferedScreenMercator(E,h).map(te=>s.tileID.getTilePoint(te)),R=this.screenGeometryMercator.map(te=>s.tileID.getTileVec3(te)),B=R.map(te=>new g.pointGeometry(te[0],te[1])),z=h.getFreeCameraOptions().position||new g.MercatorCoordinate(0,0,0),$=s.tileID.getTileVec3(z),H=R.map(te=>{const le=g.sub(te,te,$);return g.normalize(le,le),new Au($,le)}),Q=Br(s,1,h.zoom);if(g.polygonIntersectsBox(D,0,0,g.EXTENT,g.EXTENT))return{queryGeometry:this,tilespaceGeometry:B,tilespaceRays:H,bufferedTilespaceGeometry:D,bufferedTilespaceBounds:(J=g.getBounds(D),J.min.x=g.clamp(J.min.x,0,g.EXTENT),J.min.y=g.clamp(J.min.y,0,g.EXTENT),J.max.x=g.clamp(J.max.x,0,g.EXTENT),J.max.y=g.clamp(J.max.y,0,g.EXTENT),J),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:Q};var J}_bufferedScreenMercator(s,h){const v=jr(s);if(this._screenRaycastCache[v])return this._screenRaycastCache[v];{const E=this.bufferedScreenGeometry(s).map(D=>h.pointCoordinate3D(D));return this._screenRaycastCache[v]=E,E}}_bufferedCameraMercator(s,h){const v=jr(s);if(this._cameraRaycastCache[v])return this._cameraRaycastCache[v];{const E=this.bufferedCameraGeometry(s).map(D=>h.pointCoordinate3D(D));return this._cameraRaycastCache[v]=E,E}}}function jr(_){return 100*_|0}function vs(_,s,h){const v=function(E,D){if(E)return h(E);if(D){const R=g.pick(g.extend(D,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);D.vector_layers&&(R.vectorLayers=D.vector_layers,R.vectorLayerIds=R.vectorLayers.map(B=>B.id)),R.tiles=s.canonicalizeTileset(R,_.url),h(null,R)}};return _.url?g.getJSON(s.transformRequest(s.normalizeSourceURL(_.url),g.ResourceType.Source),v):g.exported.frame(()=>v(null,_))}class qa{constructor(s,h,v){this.bounds=g.LngLatBounds.convert(this.validateBounds(s)),this.minzoom=h||0,this.maxzoom=v||24}validateBounds(s){return Array.isArray(s)&&4===s.length?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const h=Math.pow(2,s.z),v=Math.floor(g.mercatorXfromLng(this.bounds.getWest())*h),E=Math.floor(g.mercatorYfromLat(this.bounds.getNorth())*h),D=Math.ceil(g.mercatorXfromLng(this.bounds.getEast())*h),R=Math.ceil(g.mercatorYfromLat(this.bounds.getSouth())*h);return s.x>=v&&s.x<D&&s.y>=E&&s.y<R}}class wl{constructor(s,h,v){this.context=s;const E=s.gl;this.buffer=E.createBuffer(),this.dynamicDraw=Boolean(v),this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Za={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wa{constructor(s,h,v,E){this.length=h.length,this.attributes=v,this.itemSize=h.bytesPerElement,this.dynamicDraw=E,this.context=s;const D=s.gl;this.buffer=D.createBuffer(),s.bindVertexBuffer.set(this.buffer),D.bufferData(D.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?D.DYNAMIC_DRAW:D.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,h){for(let v=0;v<this.attributes.length;v++){const E=h.attributes[this.attributes[v].name];void 0!==E&&s.enableVertexAttribArray(E)}}setVertexAttribPointers(s,h,v){for(let E=0;E<this.attributes.length;E++){const D=this.attributes[E],R=h.attributes[D.name];void 0!==R&&s.vertexAttribPointer(R,D.components,s[Za[D.type]],!1,this.itemSize,D.offset+this.itemSize*(v||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class zn{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Cl extends zn{getDefault(){return g.Color.transparent}set(s){const h=this.current;(s.r!==h.r||s.g!==h.g||s.b!==h.b||s.a!==h.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class El extends zn{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class pu extends zn{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class mu extends zn{getDefault(){return[!0,!0,!0,!0]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||s[3]!==h[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class go extends zn{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class _a extends zn{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class Kn extends zn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const h=this.current;(s.func!==h.func||s.ref!==h.ref||s.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class qs extends zn{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class Qa extends zn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=s,this.dirty=!1}}class Nr extends zn{getDefault(){return[0,1]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class ya extends zn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=s,this.dirty=!1}}class Ed extends zn{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class Zs extends zn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.BLEND):h.disable(h.BLEND),this.current=s,this.dirty=!1}}class gu extends zn{getDefault(){const s=this.gl;return[s.ONE,s.ZERO]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class va extends zn{getDefault(){return g.Color.transparent}set(s){const h=this.current;(s.r!==h.r||s.g!==h.g||s.b!==h.b||s.a!==h.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class mr extends zn{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class Xa extends zn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;s?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=s,this.dirty=!1}}class _u extends zn{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class xs extends zn{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}class Wo extends zn{getDefault(){return null}set(s){(s!==this.current||this.dirty)&&(this.gl.useProgram(s),this.current=s,this.dirty=!1)}}class Mo extends zn{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class yu extends zn{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const h=this.current;(s[0]!==h[0]||s[1]!==h[1]||s[2]!==h[2]||s[3]!==h[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Dl extends zn{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class xh extends zn{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class cc extends zn{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class uc extends zn{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class bh extends zn{getDefault(){return null}set(s){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Dd extends zn{constructor(s){super(s),this.vao=s.extVertexArrayObject}getDefault(){return null}set(s){this.vao&&(s!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(s),this.current=s,this.dirty=!1)}}class hc extends zn{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class dc extends zn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Qo extends zn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Ya extends zn{constructor(s,h){super(s),this.context=s,this.parent=h}getDefault(){return null}}class wh extends Ya{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class vu extends Ya{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class On extends vu{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class xa{constructor(s,h,v,E){this.context=s,this.width=h,this.height=v;const D=this.framebuffer=s.gl.createFramebuffer();this.colorAttachment=new wh(s,D),E&&(this.depthAttachment=new vu(s,D))}destroy(){const s=this.context.gl,h=this.colorAttachment.get();if(h&&s.deleteTexture(h),this.depthAttachment){const v=this.depthAttachment.get();v&&s.deleteRenderbuffer(v)}s.deleteFramebuffer(this.framebuffer)}}class un{constructor(s){this.gl=s,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Cl(this),this.clearDepth=new El(this),this.clearStencil=new pu(this),this.colorMask=new mu(this),this.depthMask=new go(this),this.stencilMask=new _a(this),this.stencilFunc=new Kn(this),this.stencilOp=new qs(this),this.stencilTest=new Qa(this),this.depthRange=new Nr(this),this.depthTest=new ya(this),this.depthFunc=new Ed(this),this.blend=new Zs(this),this.blendFunc=new gu(this),this.blendColor=new va(this),this.blendEquation=new mr(this),this.cullFace=new Xa(this),this.cullFaceSide=new _u(this),this.frontFace=new xs(this),this.program=new Wo(this),this.activeTexture=new Mo(this),this.viewport=new yu(this),this.bindFramebuffer=new Dl(this),this.bindRenderbuffer=new xh(this),this.bindTexture=new cc(this),this.bindVertexBuffer=new uc(this),this.bindElementBuffer=new bh(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Dd(this),this.pixelStoreUnpack=new hc(this),this.pixelStoreUnpackPremultiplyAlpha=new dc(this),this.pixelStoreUnpackFlipY=new Qo(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=s.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(s.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,h){return new wl(this,s,h)}createVertexBuffer(s,h,v){return new Wa(this,s,h,v)}createRenderbuffer(s,h,v){const E=this.gl,D=E.createRenderbuffer();return this.bindRenderbuffer.set(D),E.renderbufferStorage(E.RENDERBUFFER,s,h,v),this.bindRenderbuffer.set(null),D}createFramebuffer(s,h,v){return new xa(this,s,h,v)}clear({color:s,depth:h,stencil:v}){const E=this.gl;let D=0;s&&(D|=E.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),void 0!==h&&(D|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),void 0!==v&&(D|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(v),this.stencilMask.set(255)),E.clear(D)}setCullFace(s){!1===s.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){dt(s.blendFunction,g.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ba extends g.Evented{constructor(s,h,v,E){super(),this.id=s,this.dispatcher=v,this.setEventedParent(E),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=g.extend({type:"raster"},h),g.extend(this,g.pick(h,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=vs(this._options,this.map._requestManager,(s,h)=>{this._tileJSONRequest=null,this._loaded=!0,s?this.fire(new g.ErrorEvent(s)):h&&(g.extend(this,h),h.bounds&&(this.tileBounds=new qa(h.bounds,this.minzoom,this.maxzoom)),g.postTurnstileEvent(h.tiles),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return g.extend({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,h){const v=g.exported.devicePixelRatio>=2,E=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),v,this.tileSize);s.request=g.getImage(this.map._requestManager.transformRequest(E,g.ResourceType.Tile),(D,R,B,z)=>{if(delete s.request,s.aborted)s.state="unloaded",h(null);else if(D)s.state="errored",h(D);else if(R){this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:B,expires:z});const $=this.map.painter.context,H=$.gl;s.texture=this.map.painter.getTileTexture(R.width),s.texture?s.texture.update(R,{useMipmap:!0}):(s.texture=new g.Texture($,R,H.RGBA,{useMipmap:!0}),s.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),$.extTextureFilterAnisotropic&&H.texParameterf(H.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax)),s.state="loaded",g.cacheEntryPossiblyAdded(this.dispatcher),h(null)}})}abortTile(s,h){s.request&&(s.request.cancel(),delete s.request),h()}unloadTile(s,h){s.texture&&this.map.painter.saveTileTexture(s.texture),h()}hasTransition(){return!1}}let Ac;var Zn=g.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ne extends g.Evented{constructor(s,h,v,E){super(),this.id=s,this.dispatcher=v,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(E),this.options=h}load(s,h){this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this.url=this.options.url,g.getImage(this.map._requestManager.transformRequest(this.url,g.ResourceType.Image),(v,E)=>{this._loaded=!0,v?this.fire(new g.ErrorEvent(v)):E&&(this.image=g.exported.getImageData(E),s&&(this.coordinates=s),h&&h(),this._finishLoading())})}loaded(){return this._loaded}updateImage(s){return this.image&&s.url?(this.options.url=s.url,this.load(s.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}setCoordinates(s){this.coordinates=s;const h=s.map(g.MercatorCoordinate.fromLngLat);this.tileID=function(E){let D=1/0,R=1/0,B=-1/0,z=-1/0;for(const J of E)D=Math.min(D,J.x),R=Math.min(R,J.y),B=Math.max(B,J.x),z=Math.max(z,J.y);const $=Math.max(B-D,z-R),H=Math.max(0,Math.floor(-Math.log($)/Math.LN2)),Q=Math.pow(2,H);return new g.CanonicalTileID(H,Math.floor((D+B)/2*Q),Math.floor((R+z)/2*Q))}(h),this.minzoom=this.maxzoom=this.tileID.z;const v=h.map(E=>this.tileID.getTilePoint(E)._round());return this._boundsArray=new g.StructArrayLayout4i8,this._boundsArray.emplaceBack(v[0].x,v[0].y,0,0),this._boundsArray.emplaceBack(v[1].x,v[1].y,g.EXTENT,0),this._boundsArray.emplaceBack(v[3].x,v[3].y,0,g.EXTENT),this._boundsArray.emplaceBack(v[2].x,v[2].y,g.EXTENT,g.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const s=this.map.painter.context,h=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,Zn.members)),this.boundsSegments||(this.boundsSegments=g.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new g.Texture(s,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE));for(const v in this.tiles){const E=this.tiles[v];"loaded"!==E.state&&(E.state="loaded",E.texture=this.texture)}}loadTile(s,h){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={},h(null)):(s.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Z={vector:class extends g.Evented{constructor(_,s,h,v){if(super(),this.id=_,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,g.extend(this,g.pick(s,["url","scheme","tileSize","promoteId"])),this._options=g.extend({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v),this._tileWorkers={},this._deduped=new g.DedupedRequest}load(){this._loaded=!1,this.fire(new g.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=vs(this._options,this.map._requestManager,(_,s)=>{this._tileJSONRequest=null,this._loaded=!0,_?this.fire(new g.ErrorEvent(_)):s&&(g.extend(this,s),s.bounds&&(this.tileBounds=new qa(s.bounds,this.minzoom,this.maxzoom)),g.postTurnstileEvent(s.tiles,this.map._requestManager._customAccessToken),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(_){return!this.tileBounds||this.tileBounds.contains(_.canonical)}onAdd(_){this.map=_,this.load()}setSourceProperty(_){this._tileJSONRequest&&this._tileJSONRequest.cancel(),_();const s=this.map.style._getSourceCaches(this.id);for(const h of s)h.clearTiles();this.load()}setTiles(_){return this.setSourceProperty(()=>{this._options.tiles=_}),this}setUrl(_){return this.setSourceProperty(()=>{this.url=_,this._options.url=_}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return g.extend({},this._options)}loadTile(_,s){const h=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme)),v={request:this.map._requestManager.transformRequest(h,g.ResourceType.Tile),data:void 0,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,tileSize:this.tileSize*_.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:g.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:_.isSymbolTile};if(v.request.collectResourceTiming=this._collectResourceTiming,_.actor&&"expired"!==_.state)"loading"===_.state?_.reloadCallback=s:_.request=_.actor.send("reloadTile",v,E.bind(this));else if(_.actor=this._tileWorkers[h]=this._tileWorkers[h]||this.dispatcher.getActor(),this.dispatcher.ready)_.request=_.actor.send("loadTile",v,E.bind(this),void 0,!0);else{const D=g.loadVectorTile.call({deduped:this._deduped},v,(R,B)=>{R||!B?E.call(this,R):(v.data={cacheControl:B.cacheControl,expires:B.expires,rawData:B.rawData.slice(0)},_.actor&&_.actor.send("loadTile",v,E.bind(this),void 0,!0))},!0);_.request={cancel:D}}function E(D,R){return delete _.request,_.aborted?s(null):D&&404!==D.status?s(D):(R&&R.resourceTiming&&(_.resourceTiming=R.resourceTiming),this.map._refreshExpiredTiles&&R&&_.setExpiryData(R),_.loadVectorData(R,this.map.painter),g.cacheEntryPossiblyAdded(this.dispatcher),s(null),void(_.reloadCallback&&(this.loadTile(_,_.reloadCallback),_.reloadCallback=null)))}}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.actor&&_.actor.send("abortTile",{uid:_.uid,type:this.type,source:this.id})}unloadTile(_){_.unloadVectorData(),_.actor&&_.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:ba,"raster-dem":class extends ba{constructor(_,s,h,v){super(_,s,h,v),this.type="raster-dem",this.maxzoom=22,this._options=g.extend({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(_,s){const h=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function v(E,D){E&&(_.state="errored",s(E)),D&&(_.dem=D,_.dem.onDeserialize(),_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0,_.state="loaded",s(null))}_.request=g.getImage(this.map._requestManager.transformRequest(h,g.ResourceType.Tile),function(E,D,R,B){if(delete _.request,_.aborted)_.state="unloaded",s(null);else if(E)_.state="errored",s(E);else if(D){this.map._refreshExpiredTiles&&_.setExpiryData({cacheControl:R,expires:B});const z=g.window.ImageBitmap&&D instanceof g.window.ImageBitmap&&(null==Ac&&(Ac=g.window.OffscreenCanvas&&new g.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof g.window.createImageBitmap),Ac),$=1-(D.width-g.prevPowerOfTwo(D.width))/2;$<1||_.neighboringTiles||(_.neighboringTiles=this._getNeighboringTiles(_.tileID));const H=z?D:g.exported.getImageData(D,$),Q={uid:_.uid,coord:_.tileID,source:this.id,rawImageData:H,encoding:this.encoding,padding:$};_.actor&&"expired"!==_.state||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",Q,v.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(_){const s=_.canonical,h=Math.pow(2,s.z),v=(s.x-1+h)%h,E=0===s.x?_.wrap-1:_.wrap,D=(s.x+1+h)%h,R=s.x+1===h?_.wrap+1:_.wrap,B={};return B[new g.OverscaledTileID(_.overscaledZ,E,s.z,v,s.y).key]={backfilled:!1},B[new g.OverscaledTileID(_.overscaledZ,R,s.z,D,s.y).key]={backfilled:!1},s.y>0&&(B[new g.OverscaledTileID(_.overscaledZ,E,s.z,v,s.y-1).key]={backfilled:!1},B[new g.OverscaledTileID(_.overscaledZ,_.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},B[new g.OverscaledTileID(_.overscaledZ,R,s.z,D,s.y-1).key]={backfilled:!1}),s.y+1<h&&(B[new g.OverscaledTileID(_.overscaledZ,E,s.z,v,s.y+1).key]={backfilled:!1},B[new g.OverscaledTileID(_.overscaledZ,_.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},B[new g.OverscaledTileID(_.overscaledZ,R,s.z,D,s.y+1).key]={backfilled:!1}),B}unloadTile(_){_.demTexture&&this.map.painter.saveTileTexture(_.demTexture),_.fbo&&(_.fbo.destroy(),delete _.fbo),_.dem&&delete _.dem,delete _.neighboringTiles,_.state="unloaded"}},geojson:class extends g.Evented{constructor(_,s,h,v){super(),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(v),this._data=s.data,this._options=g.extend({},s),this._collectResourceTiming=s.collectResourceTiming,void 0!==s.maxzoom&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const E=g.EXTENT/this.tileSize;this.workerOptions=g.extend({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(void 0!==s.buffer?s.buffer:128)*E,tolerance:(void 0!==s.tolerance?s.tolerance:.375)*E,extent:g.EXTENT,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:void 0!==s.clusterMaxZoom?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:g.EXTENT,radius:(void 0!==s.clusterRadius?s.clusterRadius:50)*E,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions)}onAdd(_){this.map=_,this.setData(this._data)}setData(_){return this._data=_,this._updateWorkerData(),this}getClusterExpansionZoom(_,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id},s),this}getClusterChildren(_,s){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id},s),this}getClusterLeaves(_,s,h,v){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:_,limit:s,offset:h},v),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new g.Event("dataloading",{dataType:"source"})),this._loaded=!1;const _=g.extend({},this.workerOptions),s=this._data;"string"==typeof s?(_.request=this.map._requestManager.transformRequest(g.exported.resolveURL(s),g.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(s),this._pendingLoad=this.actor.send(`${this.type}.loadData`,_,(h,v)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new g.ErrorEvent(h));else{const E={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&v&&v.resourceTiming&&v.resourceTiming[this.id]&&(E.resourceTiming=v.resourceTiming[this.id]),this.fire(new g.Event("data",E)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(_,s){const h=_.actor?"reloadTile":"loadTile";_.actor=this.actor,_.request=this.actor.send(h,{type:this.type,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:g.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(v,E)=>(delete _.request,_.unloadVectorData(),_.aborted?s(null):v?s(v):(_.loadVectorData(E,this.map.painter,"reloadTile"===h),s(null))),void 0,"loadTile"===h)}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0}unloadTile(_){_.unloadVectorData(),this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return g.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends ne{constructor(_,s,h,v){super(_,s,h,v),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const _=this.options;this.urls=[];for(const s of _.urls)this.urls.push(this.map._requestManager.transformRequest(s,g.ResourceType.Source).url);g.getVideo(this.urls,(s,h)=>{this._loaded=!0,s?this.fire(new g.ErrorEvent(s)):h&&(this.video=h,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(_){if(this.video){const s=this.video.seekable;_<s.start(0)||_>s.end(0)?this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=_}}getVideo(){return this.video}onAdd(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const _=this.map.painter.context,s=_.gl;this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,Zn.members)),this.boundsSegments||(this.boundsSegments=g.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new g.Texture(_,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));for(const h in this.tiles){const v=this.tiles[h];"loaded"!==v.state&&(v.state="loaded",v.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:ne,canvas:class extends ne{constructor(_,s,h,v){super(_,s,h,v),s.coordinates?Array.isArray(s.coordinates)&&4===s.coordinates.length&&!s.coordinates.some(E=>!Array.isArray(E)||2!==E.length||E.some(D=>"number"!=typeof D))||this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${_}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${_}`,null,'missing required property "coordinates"'))),s.animate&&"boolean"!=typeof s.animate&&this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${_}`,null,'optional "animate" property must be a boolean value'))),s.canvas?"string"==typeof s.canvas||s.canvas instanceof g.window.HTMLCanvasElement||this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${_}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new g.ErrorEvent(new g.ValidationError(`sources.${_}`,null,'missing required property "canvas"'))),this.options=s,this.animate=void 0===s.animate||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof g.window.HTMLCanvasElement?this.options.canvas:g.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new g.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const s=this.map.painter.context,h=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,Zn.members)),this.boundsSegments||(this.boundsSegments=g.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(_||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new g.Texture(s,this.canvas,h.RGBA,{premultiply:!0});for(const v in this.tiles){const E=this.tiles[v];"loaded"!==E.state&&(E.state="loaded",E.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const _ of[this.canvas.width,this.canvas.height])if(isNaN(_)||_<=0)return!0;return!1}}},Y=function(_,s,h,v){const E=new Z[s.type](_,s,h,v);if(E.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${E.id}`);return g.bindAll(["load","abort","unload","serialize","prepare"],E),E};function ae(_,s){const h=g.identity([]);return g.scale$1(h,h,[.5*_.width,.5*-_.height,1]),g.translate(h,h,[1,-1,0]),g.multiply(h,h,_.calculateProjMatrix(s.toUnwrapped()))}function he(_,s,h,v,E,D,R,B=!1){const z=_.tilesIn(v,R,B);z.sort(we);const $=[];for(const Q of z)$.push({wrappedTileID:Q.tile.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(s,h,_._state,Q,E,D,ae(_.transform,Q.tile.tileID),B)});const H=function(Q){const J={},te={};for(const le of Q){const ce=le.queryResults,_e=le.wrappedTileID,se=te[_e]=te[_e]||{};for(const ue in ce){const ge=ce[ue],ve=se[ue]=se[ue]||{},Me=J[ue]=J[ue]||[];for(const de of ge)ve[de.featureIndex]||(ve[de.featureIndex]=!0,Me.push(de))}}return J}($);for(const Q in H)H[Q].forEach(J=>{const te=J.feature,le=_.getFeatureState(te.layer["source-layer"],te.id);te.source=te.layer.source,te.layer["source-layer"]&&(te.sourceLayer=te.layer["source-layer"]),te.state=le});return H}function be(_,s){const h=_.getRenderableIds().map(D=>_.getTileByID(D)),v=[],E={};for(let D=0;D<h.length;D++){const R=h[D],B=R.tileID.canonical.key;E[B]||(E[B]=!0,R.querySourceFeatures(v,s))}return v}function we(_,s){const h=_.tileID,v=s.tileID;return h.overscaledZ-v.overscaledZ||h.canonical.y-v.canonical.y||h.wrap-v.wrap||h.canonical.x-v.canonical.x}function ke(){return null!=Pc.workerClass?new Pc.workerClass:new g.window.Worker(Pc.workerUrl)}const Ee="mapboxgl_preloaded_worker_pool";class Oe{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<Oe.workerCount;)this.workers.push(new ke);return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],0===this.numActive()&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ee]}numActive(){return Object.keys(this.active).length}}let Je;function mt(){return Je||(Je=new Oe),Je}function Ke(_,s){const h={};for(const v in _)"ref"!==v&&(h[v]=_[v]);return g.refProperties.forEach(v=>{v in s&&(h[v]=s[v])}),h}function $t(_){_=_.slice();const s=Object.create(null);for(let h=0;h<_.length;h++)s[_[h].id]=_[h];for(let h=0;h<_.length;h++)"ref"in _[h]&&(_[h]=Ke(_[h],s[_[h].ref]));return _}Oe.workerCount=2;const Ce={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog"};function $e(_,s,h){h.push({command:Ce.addSource,args:[_,s[_]]})}function qt(_,s,h){s.push({command:Ce.removeSource,args:[_]}),h[_]=!0}function _n(_,s,h,v){qt(_,h,v),$e(_,s,h)}function an(_,s,h){let v;for(v in _[h])if(_[h].hasOwnProperty(v)&&"data"!==v&&!dt(_[h][v],s[h][v]))return!1;for(v in s[h])if(s[h].hasOwnProperty(v)&&"data"!==v&&!dt(_[h][v],s[h][v]))return!1;return!0}function er(_,s,h,v,E,D){let R;for(R in s=s||{},_=_||{})_.hasOwnProperty(R)&&(dt(_[R],s[R])||h.push({command:D,args:[v,R,s[R],E]}));for(R in s)s.hasOwnProperty(R)&&!_.hasOwnProperty(R)&&(dt(_[R],s[R])||h.push({command:D,args:[v,R,s[R],E]}))}function Vn(_){return _.id}function xr(_,s){return _[s.id]=s,_}class Ka{constructor(s,h){this.reset(s,h)}reset(s,h){this.points=s||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(1===this.points.length)return this.points[0];s=g.clamp(s,0,1);let h=1,v=this._distances[h];const E=s*this.paddedLength+this.padding;for(;v<E&&h<this._distances.length;)v=this._distances[++h];const D=h-1,R=this._distances[D],B=v-R,z=B>0?(E-R)/B:0;return this.points[D].mult(1-z).add(this.points[h].mult(z))}}class bt{constructor(s,h,v){const E=this.boxCells=[],D=this.circleCells=[];this.xCellCount=Math.ceil(s/v),this.yCellCount=Math.ceil(h/v);for(let R=0;R<this.xCellCount*this.yCellCount;R++)E.push([]),D.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=h,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,h,v,E,D){this._forEachCell(h,v,E,D,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(h),this.bboxes.push(v),this.bboxes.push(E),this.bboxes.push(D)}insertCircle(s,h,v,E){this._forEachCell(h-E,v-E,h+E,v+E,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(h),this.circles.push(v),this.circles.push(E)}_insertBoxCell(s,h,v,E,D,R){this.boxCells[D].push(R)}_insertCircleCell(s,h,v,E,D,R){this.circleCells[D].push(R)}_query(s,h,v,E,D,R){if(v<0||s>this.width||E<0||h>this.height)return!D&&[];const B=[];if(s<=0&&h<=0&&this.width<=v&&this.height<=E){if(D)return!0;for(let z=0;z<this.boxKeys.length;z++)B.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const $=this.circles[3*z],H=this.circles[3*z+1],Q=this.circles[3*z+2];B.push({key:this.circleKeys[z],x1:$-Q,y1:H-Q,x2:$+Q,y2:H+Q})}return R?B.filter(R):B}return this._forEachCell(s,h,v,E,this._queryCell,B,{hitTest:D,seenUids:{box:{},circle:{}}},R),D?B.length>0:B}_queryCircle(s,h,v,E,D){const R=s-v,B=s+v,z=h-v,$=h+v;if(B<0||R>this.width||$<0||z>this.height)return!E&&[];const H=[];return this._forEachCell(R,z,B,$,this._queryCellCircle,H,{hitTest:E,circle:{x:s,y:h,radius:v},seenUids:{box:{},circle:{}}},D),E?H.length>0:H}query(s,h,v,E,D){return this._query(s,h,v,E,!1,D)}hitTest(s,h,v,E,D){return this._query(s,h,v,E,!0,D)}hitTestCircle(s,h,v,E){return this._queryCircle(s,h,v,!0,E)}_queryCell(s,h,v,E,D,R,B,z){const $=B.seenUids,H=this.boxCells[D];if(null!==H){const J=this.bboxes;for(const te of H)if(!$.box[te]){$.box[te]=!0;const le=4*te;if(s<=J[le+2]&&h<=J[le+3]&&v>=J[le+0]&&E>=J[le+1]&&(!z||z(this.boxKeys[te]))){if(B.hitTest)return R.push(!0),!0;R.push({key:this.boxKeys[te],x1:J[le],y1:J[le+1],x2:J[le+2],y2:J[le+3]})}}}const Q=this.circleCells[D];if(null!==Q){const J=this.circles;for(const te of Q)if(!$.circle[te]){$.circle[te]=!0;const le=3*te;if(this._circleAndRectCollide(J[le],J[le+1],J[le+2],s,h,v,E)&&(!z||z(this.circleKeys[te]))){if(B.hitTest)return R.push(!0),!0;{const ce=J[le],_e=J[le+1],se=J[le+2];R.push({key:this.circleKeys[te],x1:ce-se,y1:_e-se,x2:ce+se,y2:_e+se})}}}}}_queryCellCircle(s,h,v,E,D,R,B,z){const $=B.circle,H=B.seenUids,Q=this.boxCells[D];if(null!==Q){const te=this.bboxes;for(const le of Q)if(!H.box[le]){H.box[le]=!0;const ce=4*le;if(this._circleAndRectCollide($.x,$.y,$.radius,te[ce+0],te[ce+1],te[ce+2],te[ce+3])&&(!z||z(this.boxKeys[le])))return R.push(!0),!0}}const J=this.circleCells[D];if(null!==J){const te=this.circles;for(const le of J)if(!H.circle[le]){H.circle[le]=!0;const ce=3*le;if(this._circlesCollide(te[ce],te[ce+1],te[ce+2],$.x,$.y,$.radius)&&(!z||z(this.circleKeys[le])))return R.push(!0),!0}}}_forEachCell(s,h,v,E,D,R,B,z){const $=this._convertToXCellCoord(s),H=this._convertToYCellCoord(h),Q=this._convertToXCellCoord(v),J=this._convertToYCellCoord(E);for(let te=$;te<=Q;te++)for(let le=H;le<=J;le++)if(D.call(this,s,h,v,E,this.xCellCount*le+te,R,B,z))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,h,v,E,D,R){const B=E-s,z=D-h,$=v+R;return $*$>B*B+z*z}_circleAndRectCollide(s,h,v,E,D,R,B){const z=(R-E)/2,$=Math.abs(s-(E+z));if($>z+v)return!1;const H=(B-D)/2,Q=Math.abs(h-(D+H));if(Q>H+v)return!1;if($<=z||Q<=H)return!0;const J=$-z,te=Q-H;return J*J+te*te<=v*v}}const wn=Math.tan(85*Math.PI/180);function Xt(_,s,h,v,E){const D=g.create$1();return s?(g.scale$1(D,D,[1/E,1/E,1]),h||g.rotateZ(D,D,v.angle)):g.multiply(D,v.labelPlaneMatrix,_),D}function Wn(_,s,h,v,E){if(s){const D=g.clone$1(_);return g.scale$1(D,D,[E,E,1]),h||g.rotateZ(D,D,-v.angle),D}return v.glCoordMatrix}function Ji(_,s,h=0){const v=[_.x,_.y,h,1];h?g.transformMat4(v,v,s):bu(v,v,s);const E=v[3];return{point:new g.pointGeometry(v[0]/E,v[1]/E),signedDistanceFromCamera:E}}function Cn(_,s){return Math.min(.5+_/s*.5,1.5)}function Md(_,s){const h=_[0]/_[3],v=_[1]/_[3];return h>=-s[0]&&h<=s[0]&&v>=-s[1]&&v<=s[1]}function Wt(_,s,h,v,E,D,R,B,z){const $=v?_.textSizeData:_.iconSizeData,H=g.evaluateSizeForZoom($,h.transform.zoom),Q=[256/h.width*2+1,256/h.height*2+1],J=v?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;J.clear();const te=_.lineVertexArray,le=v?_.text.placedSymbolArray:_.icon.placedSymbolArray,ce=h.transform.width/h.transform.height;let _e=!1;for(let se=0;se<le.length;se++){const ue=le.get(se);if(ue.writingMode!==g.WritingMode.vertical||_e||0!==se&&le.get(se-1).writingMode===g.WritingMode.horizontal||(_e=!0),ue.hidden||ue.writingMode===g.WritingMode.vertical&&!_e){Xo(ue.numGlyphs,J);continue}_e=!1;const ge=new g.pointGeometry(ue.tileAnchorX,ue.tileAnchorY),ve=z?z(ge):0,Me=[ge.x,ge.y,ve],de=[...Me,1];if(g.transformMat4(de,de,s),!Md(de,Q)){Xo(ue.numGlyphs,J);continue}const Fe=Cn(h.transform.cameraToCenterDistance,de[3]),Xe=g.evaluateSizeForFeature($,H,ue),it=R?Xe/Fe:Xe*Fe,Pe=Ji(new g.pointGeometry(Me[0],Me[1]),E,Me[2]);if(Pe.signedDistanceFromCamera<=0){Xo(ue.numGlyphs,J);continue}let Ge={};const wt=R?null:z,St=tr(ue,it,!1,B,s,E,D,_.glyphOffsetArray,te,J,Pe.point,ge,Ge,ce,wt);_e=St.useVertical,wt&&St.needsFlipping&&(Ge={}),(St.notEnoughRoom||_e||St.needsFlipping&&tr(ue,it,!0,B,s,E,D,_.glyphOffsetArray,te,J,Pe.point,ge,Ge,ce,wt).notEnoughRoom)&&Xo(ue.numGlyphs,J)}v?_.text.dynamicLayoutVertexBuffer.updateData(J):_.icon.dynamicLayoutVertexBuffer.updateData(J)}function xu(_,s,h,v,E,D,R,B,z,$,H,Q,J){const te=B.glyphStartIndex+B.numGlyphs,le=B.lineStartIndex,ce=B.lineStartIndex+B.lineLength,_e=s.getoffsetX(B.glyphStartIndex),se=s.getoffsetX(te-1),ue=pc(_*_e,h,v,E,D,R,B.segment,le,ce,z,$,H,Q,J,!0);if(!ue)return null;const ge=pc(_*se,h,v,E,D,R,B.segment,le,ce,z,$,H,Q,J,!0);return ge?{first:ue,last:ge}:null}function gr(_,s,h,v){return _.writingMode===g.WritingMode.horizontal&&Math.abs(h.y-s.y)>Math.abs(h.x-s.x)*v?{useVertical:!0}:_.writingMode===g.WritingMode.vertical?s.y<h.y?{needsFlipping:!0}:null:0!==_.flipState&&function(E,D,R){const B=(D.x-E.x)*R;return 0===B||Math.abs((D.y-E.y)/B)>wn}(s,h,v)?1===_.flipState?{needsFlipping:!0}:null:s.x>h.x?{needsFlipping:!0}:null}function tr(_,s,h,v,E,D,R,B,z,$,H,Q,J,te,le){const ce=s/24,_e=_.lineOffsetX*ce,se=_.lineOffsetY*ce;let ue;if(_.numGlyphs>1){const ge=_.glyphStartIndex+_.numGlyphs,ve=_.lineStartIndex,Me=_.lineStartIndex+_.lineLength,de=xu(ce,B,_e,se,h,H,Q,_,z,D,J,le,!1);if(!de)return{notEnoughRoom:!0};const Fe=Ji(de.first.point,R).point,Xe=Ji(de.last.point,R).point;if(v&&!h){const it=gr(_,Fe,Xe,te);if(_.flipState=it&&it.needsFlipping?1:2,it)return it}ue=[de.first];for(let it=_.glyphStartIndex+1;it<ge-1;it++)ue.push(pc(ce*B.getoffsetX(it),_e,se,h,H,Q,_.segment,ve,Me,z,D,J,le,!1,!1));ue.push(de.last)}else{if(v&&!h){const ve=Ji(Q,E).point,Me=_.lineStartIndex+_.segment+1,de=new g.pointGeometry(z.getx(Me),z.gety(Me)),Fe=Ji(de,E),Xe=gr(_,ve,Fe.signedDistanceFromCamera>0?Fe.point:fc(Q,de,ve,1,E,void 0),te);if(_.flipState=Xe&&Xe.needsFlipping?1:2,Xe)return Xe}const ge=pc(ce*B.getoffsetX(_.glyphStartIndex),_e,se,h,H,Q,_.segment,_.lineStartIndex,_.lineStartIndex+_.lineLength,z,D,J,le,!1,!1);if(!ge)return{notEnoughRoom:!0};ue=[ge]}for(const ge of ue)g.addDynamicAttributes($,ge.point,ge.angle);return{}}function Sd(_,s,h){const v={x:_.x,y:_.y,z:0};if(!h)return Ji(v,s,v.z);const E=h(_);return Ji(new g.pointGeometry(v.x,v.y),s,v.z+E)}function fc(_,s,h,v,E,D){const R=Sd(_.add(_.sub(s)._unit()),E,D).point,B=h.sub(R);return h.add(B._mult(v/B.mag()))}function pc(_,s,h,v,E,D,R,B,z,$,H,Q,J,te,le){const ce=v?_-s:_+s;let _e=ce>0?1:-1,se=0;v&&(_e*=-1,se=Math.PI),_e<0&&(se+=Math.PI);let ue=_e>0?B+R:B+R+1,ge=E,ve=E,Me=0,de=0;const Fe=Math.abs(ce),Xe=[],it=[];let Pe=D;const Ge=()=>{const Dn=ue-_e;return 0===Me?D:new g.pointGeometry($.getx(Dn),$.gety(Dn))},wt=()=>fc(Ge(),Pe,ve,Fe-Me+1,H,J);for(;Me+de<=Fe;){if(ue+=_e,ue<B||ue>=z)return null;if(ve=ge,Xe.push(ge),te&&it.push(Pe||Ge()),ge=Q[ue],void 0===ge){Pe=new g.pointGeometry($.getx(ue),$.gety(ue));const Dn=Sd(Pe,H,J);ge=Dn.signedDistanceFromCamera>0?Q[ue]=Dn.point:wt()}else Pe=null;Me+=de,de=ve.dist(ge)}le&&J&&(Pe=Pe||new g.pointGeometry($.getx(ue),$.gety(ue)),Q[ue]=ge=void 0===Q[ue]?ge:wt(),de=ve.dist(ge));const St=(Fe-Me)/de,Mt=ge.sub(ve),ft=Mt.mult(St)._add(ve);h&&ft._add(Mt._unit()._perp()._mult(h*_e));const It=se+Math.atan2(ge.y-ve.y,ge.x-ve.x);return Xe.push(ft),te&&(Pe=Pe||new g.pointGeometry($.getx(ue),$.gety(ue)),it.push(function(Dn,tn,$r){const Cr=1-$r;return new g.pointGeometry(Dn.x*Cr+tn.x*$r,Dn.y*Cr+tn.y*$r)}(it.length>0?it[it.length-1]:Pe,Pe,St))),{point:ft,angle:It,path:Xe,tilePath:it}}const mc=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Xo(_,s){for(let h=0;h<_;h++){const v=s.length;s.resize(v+4),s.float32.set(mc,3*v)}}function bu(_,s,h){const v=s[0],E=s[1];return _[0]=h[0]*v+h[4]*E+h[12],_[1]=h[1]*v+h[5]*E+h[13],_[3]=h[3]*v+h[7]*E+h[15],_}const dn=100;class Td{constructor(s,h,v=new bt(s.width+200,s.height+200,25),E=new bt(s.width+200,s.height+200,25)){this.transform=s,this.grid=v,this.ignoredGrid=E,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+dn,this.screenBottomBoundary=s.height+dn,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=h}placeCollisionBox(s,h,v,E,D,R,B){let z=h.projectedAnchorZ;h.elevation&&(z+=h.elevation);const $=this.projectAndGetPerspectiveRatio(R,h.projectedAnchorX,h.projectedAnchorY,z,h.tileID),H=D*$.perspectiveRatio,Q=(h.x1*s+v.x-h.padding)*H+$.point.x,J=(h.y1*s+v.y-h.padding)*H+$.point.y,te=(h.x2*s+v.x+h.padding)*H+$.point.x,le=(h.y2*s+v.y+h.padding)*H+$.point.y,ce=$.perspectiveRatio<=.55||$.aboveHorizon;return!this.isInsideGrid(Q,J,te,le)||!E&&this.grid.hitTest(Q,J,te,le,B)||ce?{box:[],offscreen:!1}:{box:[Q,J,te,le],offscreen:this.isOffscreen(Q,J,te,le)}}placeCollisionCircles(s,h,v,E,D,R,B,z,$,H,Q,J,te,le){const ce=[],_e=this.transform.elevation,se=_e?wt=>_e.getAtTileOffset(le,wt.x,wt.y):wt=>0,ue=new g.pointGeometry(h.tileAnchorX,h.tileAnchorY),ge=se(ue),ve=this.projectAndGetPerspectiveRatio(R,ue.x,ue.y,ge,le),{perspectiveRatio:Me}=ve,de=(H?D/Me:D*Me)/g.ONE_EM,Fe=Ji(ue,B,ge).point,Xe=ve.signedDistanceFromCamera>0?xu(de,E,h.lineOffsetX*de,h.lineOffsetY*de,!1,Fe,ue,h,v,B,{},_e&&!H?se:null,H&&!!_e):null;let it=!1,Pe=!1,Ge=!0;if(Xe&&!ve.aboveHorizon){const wt=.5*J*Me+te,St=new g.pointGeometry(-100,-100),Mt=new g.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),ft=new Ka,It=Xe.first,Dn=Xe.last;let tn=[];for(let hn=It.path.length-1;hn>=1;hn--)tn.push(It.path[hn]);for(let hn=1;hn<Dn.path.length;hn++)tn.push(Dn.path[hn]);const $r=2.5*wt;if(z){const hn=tn.map(_e?(Mn,zr)=>{const yo=se(zr<It.path.length-1?It.tilePath[It.path.length-1-zr]:Dn.tilePath[zr-It.path.length+2]);return Ji(Mn,z,yo)}:Mn=>Ji(Mn,z));tn=hn.some(Mn=>Mn.signedDistanceFromCamera<=0)?[]:hn.map(Mn=>Mn.point)}let Cr=[];if(tn.length>0){const hn=tn[0].clone(),Mn=tn[0].clone();for(let zr=1;zr<tn.length;zr++)hn.x=Math.min(hn.x,tn[zr].x),hn.y=Math.min(hn.y,tn[zr].y),Mn.x=Math.max(Mn.x,tn[zr].x),Mn.y=Math.max(Mn.y,tn[zr].y);Cr=hn.x>=St.x&&Mn.x<=Mt.x&&hn.y>=St.y&&Mn.y<=Mt.y?[tn]:Mn.x<St.x||hn.x>Mt.x||Mn.y<St.y||hn.y>Mt.y?[]:g.clipLine([tn],St.x,St.y,Mt.x,Mt.y)}for(const hn of Cr){ft.reset(hn,.25*wt);let Mn=0;Mn=ft.length<=.5*wt?1:Math.ceil(ft.paddedLength/$r)+1;for(let zr=0;zr<Mn;zr++){const yo=zr/Math.max(Mn-1,1),Po=ft.lerp(yo),oo=Po.x+dn,vo=Po.y+dn;ce.push(oo,vo,wt,0);const Ms=oo-wt,Ro=vo-wt,Pn=oo+wt,Tr=vo+wt;if(Ge=Ge&&this.isOffscreen(Ms,Ro,Pn,Tr),Pe=Pe||this.isInsideGrid(Ms,Ro,Pn,Tr),!s&&this.grid.hitTestCircle(oo,vo,wt,Q)&&(it=!0,!$))return{circles:[],offscreen:!1,collisionDetected:it}}}}return{circles:!$&&it||!Pe?[]:ce,offscreen:Ge,collisionDetected:it}}queryRenderedSymbols(s){if(0===s.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const h=[];let v=1/0,E=1/0,D=-1/0,R=-1/0;for(const H of s){const Q=new g.pointGeometry(H.x+dn,H.y+dn);v=Math.min(v,Q.x),E=Math.min(E,Q.y),D=Math.max(D,Q.x),R=Math.max(R,Q.y),h.push(Q)}const B=this.grid.query(v,E,D,R).concat(this.ignoredGrid.query(v,E,D,R)),z={},$={};for(const H of B){const Q=H.key;if(void 0===z[Q.bucketInstanceId]&&(z[Q.bucketInstanceId]={}),z[Q.bucketInstanceId][Q.featureIndex])continue;const J=[new g.pointGeometry(H.x1,H.y1),new g.pointGeometry(H.x2,H.y1),new g.pointGeometry(H.x2,H.y2),new g.pointGeometry(H.x1,H.y2)];g.polygonIntersectsPolygon(h,J)&&(z[Q.bucketInstanceId][Q.featureIndex]=!0,void 0===$[Q.bucketInstanceId]&&($[Q.bucketInstanceId]=[]),$[Q.bucketInstanceId].push(Q.featureIndex))}return $}insertCollisionBox(s,h,v,E,D){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:E,collisionGroupID:D},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,h,v,E,D){const R=h?this.ignoredGrid:this.grid,B={bucketInstanceId:v,featureIndex:E,collisionGroupID:D};for(let z=0;z<s.length;z+=4)R.insertCircle(B,s[z],s[z+1],s[z+2])}projectAndGetPerspectiveRatio(s,h,v,E,D){const R=[h,v,E||0,1];let B=!1;if(E||this.transform.pitch>0){g.transformMat4(R,R,s);let z=!1;this.fogState&&D&&(z=function($,H,Q,J,te,le){const ce=le.calculateFogTileMatrix(te),_e=[H,Q,J];return g.transformMat4$1(_e,_e,ce),bl($,_e,le.pitch,le._fov)}(this.fogState,h,v,E||0,D.toUnwrapped(),this.transform)>.9),B=R[2]>R[3]||z}else bu(R,R,s);return{point:new g.pointGeometry((R[0]/R[3]+1)/2*this.transform.width+dn,(-R[1]/R[3]+1)/2*this.transform.height+dn),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/R[3]*.5,1.5),signedDistanceFromCamera:R[3],aboveHorizon:B}}isOffscreen(s,h,v,E){return v<dn||s>=this.screenRightBoundary||E<dn||h>this.screenBottomBoundary}isInsideGrid(s,h,v,E){return v>=0&&s<this.gridRightBoundary&&E>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const s=g.identity([]);return g.translate(s,s,[-100,-100,0]),s}}class Yt{constructor(s,h,v,E){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?h:-h))):E&&v?1:0,this.placed=v}isHidden(){return 0===this.opacity&&!this.placed}}class fi{constructor(s,h,v,E,D){this.text=new Yt(s?s.text:null,h,v,D),this.icon=new Yt(s?s.icon:null,h,E,D)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Bo{constructor(s,h,v){this.text=s,this.icon=h,this.skipFade=v}}class wa{constructor(){this.invProjMatrix=g.create$1(),this.viewportMatrix=g.create$1(),this.circles=[]}}class wu{constructor(s,h,v,E,D){this.bucketInstanceId=s,this.featureIndex=h,this.sourceLayerIndex=v,this.bucketIndex=E,this.tileID=D}}class xi{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const h=++this.maxGroupID;this.collisionGroups[s]={ID:h,predicate:v=>v.collisionGroupID===h}}return this.collisionGroups[s]}}function No(_,s,h,v,E){const{horizontalAlign:D,verticalAlign:R}=g.getAnchorAlignment(_),B=-(D-.5)*s,z=-(R-.5)*h,$=g.evaluateVariableOffset(_,v);return new g.pointGeometry(B+$[0]*E,z+$[1]*E)}function pi(_,s,h,v,E){const D=new g.pointGeometry(_,s);return h&&D._rotate(v?E:-E),D}class eo{constructor(s,h,v,E,D){this.transform=s.clone(),this.collisionIndex=new Td(this.transform,D),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new xi(v),this.collisionCircleArrays={},this.prevPlacement=E,E&&(E.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,h,v,E){const D=v.getBucket(h),R=v.latestFeatureIndex;if(!D||!R||h.id!==D.layerIds[0])return;const B=v.collisionBoxArray,z=D.layers[0].layout,$=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),H=v.tileSize/g.EXTENT,Q=this.transform.calculateProjMatrix(v.tileID.toUnwrapped()),J="map"===z.get("text-pitch-alignment"),te="map"===z.get("text-rotation-alignment"),le=Br(v,1,this.transform.zoom),ce=Xt(Q,J,te,this.transform,le);let _e=null;if(J){const ue=Wn(Q,J,te,this.transform,le);_e=g.multiply([],this.transform.labelPlaneMatrix,ue)}this.retainedQueryData[D.bucketInstanceId]=new wu(D.bucketInstanceId,R,D.sourceLayerIndex,D.index,v.tileID);const se={bucket:D,layout:z,posMatrix:Q,textLabelPlaneMatrix:ce,labelToScreenMatrix:_e,scale:$,textPixelRatio:H,holdingForFade:v.holdingForFade(),collisionBoxArray:B,partiallyEvaluatedTextSize:g.evaluateSizeForZoom(D.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:g.evaluateSizeForZoom(D.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(D.sourceID)};if(E)for(const ue of D.sortKeyRanges){const{sortKey:ge,symbolInstanceStart:ve,symbolInstanceEnd:Me}=ue;s.push({sortKey:ge,symbolInstanceStart:ve,symbolInstanceEnd:Me,parameters:se})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:D.symbolInstances.length,parameters:se})}attemptAnchorPlacement(s,h,v,E,D,R,B,z,$,H,Q,J,te,le,ce,_e,se,ue){const ge=[J.textOffset0,J.textOffset1],ve=No(s,v,E,ge,D),Me=this.collisionIndex.placeCollisionBox(D,h,pi(ve.x,ve.y,R,B,this.transform.angle),Q,z,$,H.predicate);if((!_e||0!==this.collisionIndex.placeCollisionBox(le.getSymbolInstanceIconSize(ue,this.transform.zoom,te),_e,pi(ve.x,ve.y,R,B,this.transform.angle),Q,z,$,H.predicate).box.length)&&Me.box.length>0){let de;return this.prevPlacement&&this.prevPlacement.variableOffsets[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID].text&&(de=this.prevPlacement.variableOffsets[J.crossTileID].anchor),this.variableOffsets[J.crossTileID]={textOffset:ge,width:v,height:E,anchor:s,textScale:D,prevAnchor:de},this.markUsedJustification(le,s,J,ce),le.allowVerticalPlacement&&(this.markUsedOrientation(le,ce,J),this.placedOrientations[J.crossTileID]=ce),{shift:ve,placedGlyphBoxes:Me}}}placeLayerBucketPart(s,h,v,E){const{bucket:D,layout:R,posMatrix:B,textLabelPlaneMatrix:z,labelToScreenMatrix:$,textPixelRatio:H,holdingForFade:Q,collisionBoxArray:J,partiallyEvaluatedTextSize:te,partiallyEvaluatedIconSize:le,collisionGroup:ce}=s.parameters,_e=R.get("text-optional"),se=R.get("icon-optional"),ue=R.get("text-allow-overlap"),ge=R.get("icon-allow-overlap"),ve="map"===R.get("text-rotation-alignment"),Me="map"===R.get("text-pitch-alignment"),de="none"!==R.get("icon-text-fit"),Fe="viewport-y"===R.get("symbol-z-order"),Xe=ue&&(ge||!D.hasIconData()||se),it=ge&&(ue||!D.hasTextData()||_e);!D.collisionArrays&&J&&D.deserializeCollisionBoxes(J),v&&E&&D.updateCollisionDebugBuffers(this.transform.zoom,J);const Pe=(Ge,wt,St)=>{if(h[Ge.crossTileID])return;if(Q)return void(this.placements[Ge.crossTileID]=new Bo(!1,!1,!1));let Mt=!1,ft=!1,It=!0,Dn=null,tn={box:null,offscreen:null},$r={box:null,offscreen:null},Cr=null,hn=null,Mn=null,zr=0,yo=0,Po=0;St.textFeatureIndex?zr=St.textFeatureIndex:Ge.useRuntimeCollisionCircles&&(zr=Ge.featureIndex),St.verticalTextFeatureIndex&&(yo=St.verticalTextFeatureIndex);const oo=Pn=>{Pn.tileID=this.retainedQueryData[D.bucketInstanceId].tileID,(this.transform.elevation||Pn.elevation)&&(Pn.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[D.bucketInstanceId].tileID,Pn.tileAnchorX,Pn.tileAnchorY):0)},vo=St.textBox;if(vo){oo(vo);const Pn=Un=>{let br=g.WritingMode.horizontal;if(D.allowVerticalPlacement&&!Un&&this.prevPlacement){const Di=this.prevPlacement.placedOrientations[Ge.crossTileID];Di&&(this.placedOrientations[Ge.crossTileID]=Di,br=Di,this.markUsedOrientation(D,br,Ge))}return br},Tr=(Un,br)=>{if(D.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&St.verticalTextBox){for(const Di of D.writingModes)if(Di===g.WritingMode.vertical?(tn=br(),$r=tn):tn=Un(),tn&&tn.box&&tn.box.length)break}else tn=Un()};if(R.get("text-variable-anchor")){let Un=R.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ge.crossTileID]){const sr=this.prevPlacement.variableOffsets[Ge.crossTileID];Un.indexOf(sr.anchor)>0&&(Un=Un.filter(ci=>ci!==sr.anchor),Un.unshift(sr.anchor))}const br=(sr,ci,Fo)=>{const so=D.getSymbolInstanceTextSize(te,Ge,this.transform.zoom,wt),Qd=(sr.x2-sr.x1)*so+2*sr.padding,vf=(sr.y2-sr.y1)*so+2*sr.padding,Uh=de&&!ge?ci:null;Uh&&oo(Uh);let Rc={box:[],offscreen:!1};const xf=ue?2*Un.length:Un.length;for(let on=0;on<xf;++on){const jh=this.attemptAnchorPlacement(Un[on%Un.length],sr,Qd,vf,so,ve,Me,H,B,ce,on>=Un.length,Ge,wt,D,Fo,Uh,te,le);if(jh&&(Rc=jh.placedGlyphBoxes,Rc&&Rc.box&&Rc.box.length)){Mt=!0,Dn=jh.shift;break}}return Rc};Tr(()=>br(vo,St.iconBox,g.WritingMode.horizontal),()=>{const sr=St.verticalTextBox;return sr&&oo(sr),D.allowVerticalPlacement&&!(tn&&tn.box&&tn.box.length)&&Ge.numVerticalGlyphVertices>0&&sr?br(sr,St.verticalIconBox,g.WritingMode.vertical):{box:null,offscreen:null}}),tn&&(Mt=tn.box,It=tn.offscreen);const Di=Pn(tn&&tn.box);if(!Mt&&this.prevPlacement){const sr=this.prevPlacement.variableOffsets[Ge.crossTileID];sr&&(this.variableOffsets[Ge.crossTileID]=sr,this.markUsedJustification(D,sr.anchor,Ge,Di))}}else{const Un=(br,Di)=>{const sr=D.getSymbolInstanceTextSize(te,Ge,this.transform.zoom,wt),ci=this.collisionIndex.placeCollisionBox(sr,br,new g.pointGeometry(0,0),ue,H,B,ce.predicate);return ci&&ci.box&&ci.box.length&&(this.markUsedOrientation(D,Di,Ge),this.placedOrientations[Ge.crossTileID]=Di),ci};Tr(()=>Un(vo,g.WritingMode.horizontal),()=>{const br=St.verticalTextBox;return D.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&br?(oo(br),Un(br,g.WritingMode.vertical)):{box:null,offscreen:null}}),Pn(tn&&tn.box&&tn.box.length)}}if(Cr=tn,Mt=Cr&&Cr.box&&Cr.box.length>0,It=Cr&&Cr.offscreen,Ge.useRuntimeCollisionCircles){const Pn=D.text.placedSymbolArray.get(Ge.centerJustifiedTextSymbolIndex>=0?Ge.centerJustifiedTextSymbolIndex:Ge.verticalPlacedTextSymbolIndex),Tr=g.evaluateSizeForFeature(D.textSizeData,te,Pn),Un=R.get("text-padding");hn=this.collisionIndex.placeCollisionCircles(ue,Pn,D.lineVertexArray,D.glyphOffsetArray,Tr,B,z,$,v,Me,ce.predicate,Ge.collisionCircleDiameter*Tr/g.ONE_EM,Un,this.retainedQueryData[D.bucketInstanceId].tileID),Mt=ue||hn.circles.length>0&&!hn.collisionDetected,It=It&&hn.offscreen}if(St.iconFeatureIndex&&(Po=St.iconFeatureIndex),St.iconBox){const Pn=Tr=>{oo(Tr);const Un=de&&Dn?pi(Dn.x,Dn.y,ve,Me,this.transform.angle):new g.pointGeometry(0,0),br=D.getSymbolInstanceIconSize(le,this.transform.zoom,wt);return this.collisionIndex.placeCollisionBox(br,Tr,Un,ge,H,B,ce.predicate)};$r&&$r.box&&$r.box.length&&St.verticalIconBox?(Mn=Pn(St.verticalIconBox),ft=Mn.box.length>0):(Mn=Pn(St.iconBox),ft=Mn.box.length>0),It=It&&Mn.offscreen}const Ms=_e||0===Ge.numHorizontalGlyphVertices&&0===Ge.numVerticalGlyphVertices,Ro=se||0===Ge.numIconVertices;if(Ms||Ro?Ro?Ms||(ft=ft&&Mt):Mt=ft&&Mt:ft=Mt=ft&&Mt,Mt&&Cr&&Cr.box&&this.collisionIndex.insertCollisionBox(Cr.box,R.get("text-ignore-placement"),D.bucketInstanceId,$r&&$r.box&&yo?yo:zr,ce.ID),ft&&Mn&&this.collisionIndex.insertCollisionBox(Mn.box,R.get("icon-ignore-placement"),D.bucketInstanceId,Po,ce.ID),hn&&(Mt&&this.collisionIndex.insertCollisionCircles(hn.circles,R.get("text-ignore-placement"),D.bucketInstanceId,zr,ce.ID),v)){const Pn=D.bucketInstanceId;let Tr=this.collisionCircleArrays[Pn];void 0===Tr&&(Tr=this.collisionCircleArrays[Pn]=new wa);for(let Un=0;Un<hn.circles.length;Un+=4)Tr.circles.push(hn.circles[Un+0]),Tr.circles.push(hn.circles[Un+1]),Tr.circles.push(hn.circles[Un+2]),Tr.circles.push(hn.collisionDetected?1:0)}this.placements[Ge.crossTileID]=new Bo(Mt||Xe,ft||it,It||D.justReloaded),h[Ge.crossTileID]=!0};if(Fe){const Ge=D.getSortedSymbolIndexes(this.transform.angle);for(let wt=Ge.length-1;wt>=0;--wt){const St=Ge[wt];Pe(D.symbolInstances.get(St),St,D.collisionArrays[St])}}else for(let Ge=s.symbolInstanceStart;Ge<s.symbolInstanceEnd;Ge++)Pe(D.symbolInstances.get(Ge),Ge,D.collisionArrays[Ge]);if(v&&D.bucketInstanceId in this.collisionCircleArrays){const Ge=this.collisionCircleArrays[D.bucketInstanceId];g.invert(Ge.invProjMatrix,B),Ge.viewportMatrix=this.collisionIndex.getViewportMatrix()}D.justReloaded=!1}markUsedJustification(s,h,v,E){let D;D=E===g.WritingMode.vertical?v.verticalPlacedTextSymbolIndex:{left:v.leftJustifiedTextSymbolIndex,center:v.centerJustifiedTextSymbolIndex,right:v.rightJustifiedTextSymbolIndex}[g.getAnchorJustification(h)];const R=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex,v.verticalPlacedTextSymbolIndex];for(const B of R)B>=0&&(s.text.placedSymbolArray.get(B).crossTileID=D>=0&&B!==D?0:v.crossTileID)}markUsedOrientation(s,h,v){const E=h===g.WritingMode.horizontal||h===g.WritingMode.horizontalOnly?h:0,D=h===g.WritingMode.vertical?h:0,R=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex];for(const B of R)s.text.placedSymbolArray.get(B).placedOrientation=E;v.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(v.verticalPlacedTextSymbolIndex).placedOrientation=D)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let v=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const E=h?h.symbolFadeChange(s):1,D=h?h.opacities:{},R=h?h.variableOffsets:{},B=h?h.placedOrientations:{};for(const z in this.placements){const $=this.placements[z],H=D[z];H?(this.opacities[z]=new fi(H,E,$.text,$.icon),v=v||$.text!==H.text.placed||$.icon!==H.icon.placed):(this.opacities[z]=new fi(null,E,$.text,$.icon,$.skipFade),v=v||$.text||$.icon)}for(const z in D){const $=D[z];if(!this.opacities[z]){const H=new fi($,E,!1,!1);H.isHidden()||(this.opacities[z]=H,v=v||$.text.placed||$.icon.placed)}}for(const z in R)this.variableOffsets[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.variableOffsets[z]=R[z]);for(const z in B)this.placedOrientations[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.placedOrientations[z]=B[z]);v?this.lastPlacementChangeTime=s:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:s)}updateLayerOpacities(s,h){const v={};for(const E of h){const D=E.getBucket(s);D&&E.latestFeatureIndex&&s.id===D.layerIds[0]&&this.updateBucketOpacities(D,v,E.collisionBoxArray)}}updateBucketOpacities(s,h,v){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const E=s.layers[0].layout,D=new fi(null,0,!1,!1,!0),R=E.get("text-allow-overlap"),B=E.get("icon-allow-overlap"),z=E.get("text-variable-anchor"),$="map"===E.get("text-rotation-alignment"),H="map"===E.get("text-pitch-alignment"),Q="none"!==E.get("icon-text-fit"),J=new fi(null,0,R&&(B||!s.hasIconData()||E.get("icon-optional")),B&&(R||!s.hasTextData()||E.get("text-optional")),!0);!s.collisionArrays&&v&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(v);const te=(le,ce,_e)=>{for(let se=0;se<ce/4;se++)le.opacityVertexArray.emplaceBack(_e)};for(let le=0;le<s.symbolInstances.length;le++){const ce=s.symbolInstances.get(le),{numHorizontalGlyphVertices:_e,numVerticalGlyphVertices:se,crossTileID:ue}=ce;let ge=this.opacities[ue];h[ue]?ge=D:ge||(ge=J,this.opacities[ue]=ge),h[ue]=!0;const ve=ce.numIconVertices>0,Me=this.placedOrientations[ce.crossTileID],de=Me===g.WritingMode.vertical,Fe=Me===g.WritingMode.horizontal||Me===g.WritingMode.horizontalOnly;if(_e>0||se>0){const Xe=Yo(ge.text);te(s.text,_e,de?Ko:Xe),te(s.text,se,Fe?Ko:Xe);const it=ge.text.isHidden();[ce.rightJustifiedTextSymbolIndex,ce.centerJustifiedTextSymbolIndex,ce.leftJustifiedTextSymbolIndex].forEach(wt=>{wt>=0&&(s.text.placedSymbolArray.get(wt).hidden=it||de?1:0)}),ce.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(ce.verticalPlacedTextSymbolIndex).hidden=it||Fe?1:0);const Pe=this.variableOffsets[ce.crossTileID];Pe&&this.markUsedJustification(s,Pe.anchor,ce,Me);const Ge=this.placedOrientations[ce.crossTileID];Ge&&(this.markUsedJustification(s,"left",ce,Ge),this.markUsedOrientation(s,Ge,ce))}if(ve){const Xe=Yo(ge.icon);ce.placedIconSymbolIndex>=0&&(te(s.icon,ce.numIconVertices,de?Ko:Xe),s.icon.placedSymbolArray.get(ce.placedIconSymbolIndex).hidden=ge.icon.isHidden()),ce.verticalPlacedIconSymbolIndex>=0&&(te(s.icon,ce.numVerticalIconVertices,Fe?Ko:Xe),s.icon.placedSymbolArray.get(ce.verticalPlacedIconSymbolIndex).hidden=ge.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const Xe=s.collisionArrays[le];if(Xe){let it=new g.pointGeometry(0,0);if(Xe.textBox||Xe.verticalTextBox){let Ge=!0;if(z){const wt=this.variableOffsets[ue];wt?(it=No(wt.anchor,wt.width,wt.height,wt.textOffset,wt.textScale),$&&it._rotate(H?this.transform.angle:-this.transform.angle)):Ge=!1}Xe.textBox&&Cu(s.textCollisionBox.collisionVertexArray,ge.text.placed,!Ge||de,it.x,it.y),Xe.verticalTextBox&&Cu(s.textCollisionBox.collisionVertexArray,ge.text.placed,!Ge||Fe,it.x,it.y)}const Pe=Boolean(!Fe&&Xe.verticalIconBox);Xe.iconBox&&Cu(s.iconCollisionBox.collisionVertexArray,ge.icon.placed,Pe,Q?it.x:0,Q?it.y:0),Xe.verticalIconBox&&Cu(s.iconCollisionBox.collisionVertexArray,ge.icon.placed,!Pe,Q?it.x:0,Q?it.y:0)}}}if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){const le=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=le.invProjMatrix,s.placementViewportMatrix=le.viewportMatrix,s.collisionCircleArray=le.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return 0===this.fadeDuration?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,h){const v=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*v>s}setStale(){this.stale=!0}}function Cu(_,s,h,v,E){_.emplaceBack(s?1:0,h?1:0,v||0,E||0),_.emplaceBack(s?1:0,h?1:0,v||0,E||0),_.emplaceBack(s?1:0,h?1:0,v||0,E||0),_.emplaceBack(s?1:0,h?1:0,v||0,E||0)}const _r=Math.pow(2,25),Eu=Math.pow(2,24),Ch=Math.pow(2,17),om=Math.pow(2,16),Ml=Math.pow(2,9),cr=Math.pow(2,8),sm=Math.pow(2,1);function Yo(_){if(0===_.opacity&&!_.placed)return 0;if(1===_.opacity&&_.placed)return 4294967295;const s=_.placed?1:0,h=Math.floor(127*_.opacity);return h*_r+s*Eu+h*Ch+s*om+h*Ml+s*cr+h*sm+s}const Ko=0;class Qn{constructor(s){this._sortAcrossTiles="viewport-y"!==s.layout.get("symbol-z-order")&&void 0!==s.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(s,h,v,E,D){const R=this._bucketParts;for(;this._currentTileIndex<s.length;)if(h.getBucketParts(R,E,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,D())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort((B,z)=>B.sortKey-z.sortKey));this._currentPartIndex<R.length;){const B=R[this._currentPartIndex];if(h.placeLayerBucketPart(B,this._seenCrossTileIDs,v,0===B.symbolInstanceStart),this._currentPartIndex++,D())return!0}return!1}}class gc{constructor(s,h,v,E,D,R,B,z){this.placement=new eo(s,D,R,B,z),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=E,this._done=!1}isDone(){return this._done}continuePlacement(s,h,v){const E=g.exported.now(),D=()=>{const R=g.exported.now()-E;return!this._forceFullPlacement&&R>2};for(;this._currentPlacementIndex>=0;){const R=h[s[this._currentPlacementIndex]],B=this.placement.collisionIndex.transform.zoom;if("symbol"===R.type&&(!R.minzoom||R.minzoom<=B)&&(!R.maxzoom||R.maxzoom>B)){if(this._inProgressLayer||(this._inProgressLayer=new Qn(R)),this._inProgressLayer.continuePlacement(v[R.source],this.placement,this._showCollisionBoxes,R,D))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const _c=512/g.EXTENT/2;class Id{constructor(s,h,v){this.tileID=s,this.indexedSymbolInstances={},this.bucketInstanceId=v;for(let E=0;E<h.length;E++){const D=h.get(E),R=D.key;this.indexedSymbolInstances[R]||(this.indexedSymbolInstances[R]=[]),this.indexedSymbolInstances[R].push({crossTileID:D.crossTileID,coord:this.getScaledCoordinates(D,s)})}}getScaledCoordinates(s,h){const v=_c/Math.pow(2,h.canonical.z-this.tileID.canonical.z);return{x:Math.floor((h.canonical.x*g.EXTENT+s.tileAnchorX)*v),y:Math.floor((h.canonical.y*g.EXTENT+s.tileAnchorY)*v)}}findMatches(s,h,v){const E=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z);for(let D=0;D<s.length;D++){const R=s.get(D);if(R.crossTileID)continue;const B=this.indexedSymbolInstances[R.key];if(!B)continue;const z=this.getScaledCoordinates(R,h);for(const $ of B)if(Math.abs($.coord.x-z.x)<=E&&Math.abs($.coord.y-z.y)<=E&&!v[$.crossTileID]){v[$.crossTileID]=!0,R.crossTileID=$.crossTileID;break}}}}class cf{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class kd{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const h=Math.round((s-this.lng)/360);if(0!==h)for(const v in this.indexes){const E=this.indexes[v],D={};for(const R in E){const B=E[R];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+h),D[B.tileID.key]=B}this.indexes[v]=D}this.lng=s}addBucket(s,h,v){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let D=0;D<h.symbolInstances.length;D++)h.symbolInstances.get(D).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});const E=this.usedCrossTileIDs[s.overscaledZ];for(const D in this.indexes){const R=this.indexes[D];if(Number(D)>s.overscaledZ)for(const B in R){const z=R[B];z.tileID.isChildOf(s)&&z.findMatches(h.symbolInstances,s,E)}else{const B=R[s.scaledTo(Number(D)).key];B&&B.findMatches(h.symbolInstances,s,E)}}for(let D=0;D<h.symbolInstances.length;D++){const R=h.symbolInstances.get(D);R.crossTileID||(R.crossTileID=v.generate(),E[R.crossTileID]=!0)}return void 0===this.indexes[s.overscaledZ]&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Id(s,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(s,h){for(const v in h.indexedSymbolInstances)for(const E of h.indexedSymbolInstances[v])delete this.usedCrossTileIDs[s][E.crossTileID]}removeStaleBuckets(s){let h=!1;for(const v in this.indexes){const E=this.indexes[v];for(const D in E)s[E[D].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,E[D]),delete E[D],h=!0)}return h}}class Ws{constructor(){this.layerIndexes={},this.crossTileIDs=new cf,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,h,v){let E=this.layerIndexes[s.id];void 0===E&&(E=this.layerIndexes[s.id]=new kd);let D=!1;const R={};E.handleWrapJump(v);for(const B of h){const z=B.getBucket(s);z&&s.id===z.layerIds[0]&&(z.bucketInstanceId||(z.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(B.tileID,z,this.crossTileIDs)&&(D=!0),R[z.bucketInstanceId]=!0)}return E.removeStaleBuckets(R)&&(D=!0),D}pruneUnusedLayers(s){const h={};s.forEach(v=>{h[v]=!0});for(const v in this.layerIndexes)h[v]||delete this.layerIndexes[v]}}const Ca=(_,s)=>g.emitValidationErrors(_,s&&s.filter(h=>"source.canvas"!==h.identifier)),am=g.pick(Ce,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog"]),zo=g.pick(Ce,["setCenter","setZoom","setBearing","setPitch"]),lm=function(){const _={},s=g.spec.$version;for(const h in g.spec.$root){const v=g.spec.$root[h];if(v.required){let E=null;E="version"===h?s:"array"===v.type?[]:{},null!=E&&(_[h]=E)}}return _}(),Eh={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Jo extends g.Evented{constructor(s,h={}){super(),this.map=s,this.dispatcher=new Zo(mt(),this),this.imageManager=new $a,this.imageManager.setEventedParent(this),this.glyphManager=new g.GlyphManager(s._requestManager,h.localFontFamily?g.LocalGlyphMode.all:h.localIdeographFontFamily?g.LocalGlyphMode.ideographs:g.LocalGlyphMode.none,h.localFontFamily||h.localIdeographFontFamily),this.lineAtlas=new g.LineAtlas(256,512),this.crossTileSymbolIndex=new Ws,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new g.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",g.getReferrer());const v=this;this._rtlTextPluginCallback=Jo.registerForPluginStateChange(E=>{v.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:E.pluginStatus,pluginURL:E.pluginURL},(D,R)=>{if(g.triggerPluginCompletionEvent(D),R&&R.every(B=>B))for(const B in v._sourceCaches){const z=v._sourceCaches[B],$=z.getSource().type;"vector"!==$&&"geojson"!==$||z.reload()}})}),this.on("data",E=>{if("source"!==E.dataType||"metadata"!==E.sourceDataType)return;const D=this.getSource(E.sourceId);if(D&&D.vectorLayerIds)for(const R in this._layers){const B=this._layers[R];B.source===D.id&&this._validateLayer(B)}})}loadURL(s,h={}){this.fire(new g.Event("dataloading",{dataType:"style"}));const v="boolean"==typeof h.validate?h.validate:!g.isMapboxURL(s);s=this.map._requestManager.normalizeStyleURL(s,h.accessToken);const E=this.map._requestManager.transformRequest(s,g.ResourceType.Style);this._request=g.getJSON(E,(D,R)=>{this._request=null,D?this.fire(new g.ErrorEvent(D)):R&&this._load(R,v)})}loadJSON(s,h={}){this.fire(new g.Event("dataloading",{dataType:"style"})),this._request=g.exported.frame(()=>{this._request=null,this._load(s,!1!==h.validate)})}loadEmpty(){this.fire(new g.Event("dataloading",{dataType:"style"})),this._load(lm,!1)}_updateLayerCount(s,h){const v=h?1:-1;s.is3D()&&(this._num3DLayers+=v),"circle"===s.type&&(this._numCircleLayers+=v),"symbol"===s.type&&(this._numSymbolLayers+=v)}_load(s,h){if(h&&Ca(this,g.validateStyle(s)))return;this._loaded=!0,this.stylesheet=s;for(const E in s.sources)this.addSource(E,s.sources[E],{validate:!1});this._changed=!1,s.sprite?this._loadSprite(s.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(s.glyphs);const v=$t(this.stylesheet.layers);this._order=v.map(E=>E.id),this._layers={},this._serializedLayers={};for(let E of v)E=g.createStyleLayer(E),E.setEventedParent(this,{layer:{id:E.id}}),this._layers[E.id]=E,this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ai(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new g.Event("data",{dataType:"style"})),this.fire(new g.Event("style.load"))}_loadSprite(s){this._spriteRequest=function(h,v,E){let D,R,B;const z=g.exported.devicePixelRatio>1?"@2x":"";let $=g.getJSON(v.transformRequest(v.normalizeSpriteURL(h,z,".json"),g.ResourceType.SpriteJSON),(J,te)=>{$=null,B||(B=J,D=te,Q())}),H=g.getImage(v.transformRequest(v.normalizeSpriteURL(h,z,".png"),g.ResourceType.SpriteImage),(J,te)=>{H=null,B||(B=J,R=te,Q())});function Q(){if(B)E(B);else if(D&&R){const J=g.exported.getImageData(R),te={};for(const le in D){const{width:ce,height:_e,x:se,y:ue,sdf:ge,pixelRatio:ve,stretchX:Me,stretchY:de,content:Fe}=D[le],Xe=new g.RGBAImage({width:ce,height:_e});g.RGBAImage.copy(J,Xe,{x:se,y:ue},{x:0,y:0},{width:ce,height:_e}),te[le]={data:Xe,pixelRatio:ve,sdf:ge,stretchX:Me,stretchY:de,content:Fe}}E(null,te)}}return{cancel(){$&&($.cancel(),$=null),H&&(H.cancel(),H=null)}}}(s,this.map._requestManager,(h,v)=>{if(this._spriteRequest=null,h)this.fire(new g.ErrorEvent(h));else if(v)for(const E in v)this.imageManager.addImage(E,v[E]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new g.Event("data",{dataType:"style"}))})}_validateLayer(s){const h=this.getSource(s.source);if(!h)return;const v=s.sourceLayer;v&&("geojson"===h.type||h.vectorLayerIds&&-1===h.vectorLayerIds.indexOf(v))&&this.fire(new g.ErrorEvent(new Error(`Source layer "${v}" does not exist on source "${h.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(s){const h=[];for(const v of s){const E=this._layers[v];"custom"!==E.type&&h.push(E.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(s){return!!this.terrain&&Eh[s.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(s){if(!this._loaded)return;const h=this._changed;if(this._changed){const E=Object.keys(this._updatedLayers),D=Object.keys(this._removedLayers);(E.length||D.length)&&this._updateWorkerLayers(E,D);for(const R in this._updatedSources){const B=this._updatedSources[R];"reload"===B?this._reloadSource(R):"clear"===B&&this._clearSource(R)}this._updateTilesForChangedImages();for(const R in this._updatedPaintProps)this._layers[R].updateTransitions(s);this.light.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this._resetUpdates()}const v={};for(const E in this._sourceCaches){const D=this._sourceCaches[E];v[E]=D.used,D.used=!1}for(const E of this._order){const D=this._layers[E];if(D.recalculate(s,this._availableImages),!D.isHidden(s.zoom)){const B=this._getLayerSourceCache(D);B&&(B.used=!0)}const R=this.map.painter;if(R){const B=D.getProgramIds();if(!B)continue;const z=D.getProgramConfiguration(s.zoom);for(const $ of B)R.useProgram($,z)}}for(const E in v){const D=this._sourceCaches[E];v[E]!==D.used&&D.getSource().fire(new g.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new g.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=Object.keys(this._changedImages);if(s.length){for(const h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateWorkerLayers(s,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(s),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(s){if(this._checkLoaded(),Ca(this,g.validateStyle(s)))return!1;(s=g.clone$2(s)).layers=$t(s.layers);const h=function(E,D){if(!E)return[{command:Ce.setStyle,args:[D]}];let R=[];try{if(!dt(E.version,D.version))return[{command:Ce.setStyle,args:[D]}];dt(E.center,D.center)||R.push({command:Ce.setCenter,args:[D.center]}),dt(E.zoom,D.zoom)||R.push({command:Ce.setZoom,args:[D.zoom]}),dt(E.bearing,D.bearing)||R.push({command:Ce.setBearing,args:[D.bearing]}),dt(E.pitch,D.pitch)||R.push({command:Ce.setPitch,args:[D.pitch]}),dt(E.sprite,D.sprite)||R.push({command:Ce.setSprite,args:[D.sprite]}),dt(E.glyphs,D.glyphs)||R.push({command:Ce.setGlyphs,args:[D.glyphs]}),dt(E.transition,D.transition)||R.push({command:Ce.setTransition,args:[D.transition]}),dt(E.light,D.light)||R.push({command:Ce.setLight,args:[D.light]}),dt(E.fog,D.fog)||R.push({command:Ce.setFog,args:[D.fog]});const B={},z=[];!function(Q,J,te,le){let ce;for(ce in J=J||{},Q=Q||{})Q.hasOwnProperty(ce)&&(J.hasOwnProperty(ce)||qt(ce,te,le));for(ce in J)J.hasOwnProperty(ce)&&(Q.hasOwnProperty(ce)?dt(Q[ce],J[ce])||("geojson"===Q[ce].type&&"geojson"===J[ce].type&&an(Q,J,ce)?te.push({command:Ce.setGeoJSONSourceData,args:[ce,J[ce].data]}):_n(ce,J,te,le)):$e(ce,J,te))}(E.sources,D.sources,z,B);const $=[];E.layers&&E.layers.forEach(Q=>{B[Q.source]?R.push({command:Ce.removeLayer,args:[Q.id]}):$.push(Q)});let H=E.terrain;H&&B[H.source]&&(R.push({command:Ce.setTerrain,args:[void 0]}),H=void 0),R=R.concat(z),dt(H,D.terrain)||R.push({command:Ce.setTerrain,args:[D.terrain]}),function(Q,J,te){J=J||[];const le=(Q=Q||[]).map(Vn),ce=J.map(Vn),_e=Q.reduce(xr,{}),se=J.reduce(xr,{}),ue=le.slice(),ge=Object.create(null);let ve,Me,de,Fe,Xe,it,Pe;for(ve=0,Me=0;ve<le.length;ve++)de=le[ve],se.hasOwnProperty(de)?Me++:(te.push({command:Ce.removeLayer,args:[de]}),ue.splice(ue.indexOf(de,Me),1));for(ve=0,Me=0;ve<ce.length;ve++)de=ce[ce.length-1-ve],ue[ue.length-1-ve]!==de&&(_e.hasOwnProperty(de)?(te.push({command:Ce.removeLayer,args:[de]}),ue.splice(ue.lastIndexOf(de,ue.length-Me),1)):Me++,it=ue[ue.length-ve],te.push({command:Ce.addLayer,args:[se[de],it]}),ue.splice(ue.length-ve,0,de),ge[de]=!0);for(ve=0;ve<ce.length;ve++)if(de=ce[ve],Fe=_e[de],Xe=se[de],!ge[de]&&!dt(Fe,Xe))if(dt(Fe.source,Xe.source)&&dt(Fe["source-layer"],Xe["source-layer"])&&dt(Fe.type,Xe.type)){for(Pe in er(Fe.layout,Xe.layout,te,de,null,Ce.setLayoutProperty),er(Fe.paint,Xe.paint,te,de,null,Ce.setPaintProperty),dt(Fe.filter,Xe.filter)||te.push({command:Ce.setFilter,args:[de,Xe.filter]}),dt(Fe.minzoom,Xe.minzoom)&&dt(Fe.maxzoom,Xe.maxzoom)||te.push({command:Ce.setLayerZoomRange,args:[de,Xe.minzoom,Xe.maxzoom]}),Fe)Fe.hasOwnProperty(Pe)&&"layout"!==Pe&&"paint"!==Pe&&"filter"!==Pe&&"metadata"!==Pe&&"minzoom"!==Pe&&"maxzoom"!==Pe&&(0===Pe.indexOf("paint.")?er(Fe[Pe],Xe[Pe],te,de,Pe.slice(6),Ce.setPaintProperty):dt(Fe[Pe],Xe[Pe])||te.push({command:Ce.setLayerProperty,args:[de,Pe,Xe[Pe]]}));for(Pe in Xe)Xe.hasOwnProperty(Pe)&&!Fe.hasOwnProperty(Pe)&&"layout"!==Pe&&"paint"!==Pe&&"filter"!==Pe&&"metadata"!==Pe&&"minzoom"!==Pe&&"maxzoom"!==Pe&&(0===Pe.indexOf("paint.")?er(Fe[Pe],Xe[Pe],te,de,Pe.slice(6),Ce.setPaintProperty):dt(Fe[Pe],Xe[Pe])||te.push({command:Ce.setLayerProperty,args:[de,Pe,Xe[Pe]]}))}else te.push({command:Ce.removeLayer,args:[de]}),it=ue[ue.lastIndexOf(de)+1],te.push({command:Ce.addLayer,args:[Xe,it]})}($,D.layers,R)}catch(B){console.warn("Unable to compute style diff:",B),R=[{command:Ce.setStyle,args:[D]}]}return R}(this.serialize(),s).filter(E=>!(E.command in zo));if(0===h.length)return!1;const v=h.filter(E=>!(E.command in am));if(v.length>0)throw new Error(`Unimplemented: ${v.map(E=>E.command).join(", ")}.`);return h.forEach(E=>{"setTransition"!==E.command&&this[E.command].apply(this,E.args)}),this.stylesheet=s,!0}addImage(s,h){if(this.getImage(s))return this.fire(new g.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(s,h),this._afterImageUpdated(s)}updateImage(s,h){this.imageManager.updateImage(s,h)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){if(!this.getImage(s))return this.fire(new g.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(s),this._afterImageUpdated(s)}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new g.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(s,h,v={}){if(this._checkLoaded(),void 0!==this.getSource(s))throw new Error("There is already a source with this ID");if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(g.validateStyle.source,`sources.${s}`,h,null,v))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const E=Y(s,h,this.dispatcher,this);E.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:E.serialize(),sourceId:s}));const D=R=>{const B=(R?"symbol:":"other:")+s,z=this._sourceCaches[B]=new g.SourceCache(B,E,R);(R?this._symbolSourceCaches:this._otherSourceCaches)[s]=z,z.style=this,z.onAdd(this.map)};D(!1),"vector"!==h.type&&"geojson"!==h.type||D(!0),E.onAdd&&E.onAdd(this.map),this._changed=!0}removeSource(s){this._checkLoaded();const h=this.getSource(s);if(void 0===h)throw new Error("There is no source with this ID");for(const E in this._layers)if(this._layers[E].source===s)return this.fire(new g.ErrorEvent(new Error(`Source "${s}" cannot be removed while layer "${E}" is using it.`)));if(this.terrain&&this.terrain.get().source===s)return this.fire(new g.ErrorEvent(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));const v=this._getSourceCaches(s);for(const E of v)delete this._sourceCaches[E.id],delete this._updatedSources[E.id],E.fire(new g.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:E.getSource().id})),E.setEventedParent(null),E.clearTiles();delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(s,h){this._checkLoaded(),this.getSource(s).setData(h),this._changed=!0}getSource(s){const h=this._getSourceCache(s);return h&&h.getSource()}addLayer(s,h,v={}){this._checkLoaded();const E=s.id;if(this.getLayer(E))return void this.fire(new g.ErrorEvent(new Error(`Layer with id "${E}" already exists on this map`)));let D;if("custom"===s.type){if(Ca(this,g.validateCustomStyleLayer(s)))return;D=g.createStyleLayer(s)}else{if("object"==typeof s.source&&(this.addSource(E,s.source),s=g.clone$2(s),s=g.extend(s,{source:E})),this._validate(g.validateStyle.layer,`layers.${E}`,s,{arrayIndex:-1},v))return;D=g.createStyleLayer(s),this._validateLayer(D),D.setEventedParent(this,{layer:{id:E}}),this._serializedLayers[D.id]=D.serialize(),this._updateLayerCount(D,!0)}const R=h?this._order.indexOf(h):this._order.length;if(h&&-1===R)return void this.fire(new g.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`)));this._order.splice(R,0,E),this._layerOrderChanged=!0,this._layers[E]=D;const B=this._getLayerSourceCache(D);if(this._removedLayers[E]&&D.source&&B&&"custom"!==D.type){const z=this._removedLayers[E];delete this._removedLayers[E],z.type!==D.type?this._updatedSources[D.source]="clear":(this._updatedSources[D.source]="reload",B.pause())}this._updateLayer(D),D.onAdd&&D.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(s,h){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new g.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===h)return;const v=this._order.indexOf(s);this._order.splice(v,1);const E=h?this._order.indexOf(h):this._order.length;h&&-1===E?this.fire(new g.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`))):(this._order.splice(E,0,s),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(s){this._checkLoaded();const h=this._layers[s];if(!h)return void this.fire(new g.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be removed.`)));h.setEventedParent(null),this._updateLayerCount(h,!1);const v=this._order.indexOf(s);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=h,delete this._layers[s],delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],h.onRemove&&h.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(s){return this._layers[s]}hasLayer(s){return s in this._layers}hasLayerType(s){for(const h in this._layers)if(this._layers[h].type===s)return!0;return!1}setLayerZoomRange(s,h,v){this._checkLoaded();const E=this.getLayer(s);E?E.minzoom===h&&E.maxzoom===v||(null!=h&&(E.minzoom=h),null!=v&&(E.maxzoom=v),this._updateLayer(E)):this.fire(new g.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(s,h,v={}){this._checkLoaded();const E=this.getLayer(s);if(E){if(!dt(E.filter,h))return null==h?(E.filter=void 0,void this._updateLayer(E)):void(this._validate(g.validateStyle.filter,`layers.${E.id}.filter`,h,null,v)||(E.filter=g.clone$2(h),this._updateLayer(E)))}else this.fire(new g.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be filtered.`)))}getFilter(s){return g.clone$2(this.getLayer(s).filter)}setLayoutProperty(s,h,v,E={}){this._checkLoaded();const D=this.getLayer(s);D?dt(D.getLayoutProperty(h),v)||(D.setLayoutProperty(h,v,E),this._updateLayer(D)):this.fire(new g.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(s,h){const v=this.getLayer(s);if(v)return v.getLayoutProperty(h);this.fire(new g.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style.`)))}setPaintProperty(s,h,v,E={}){this._checkLoaded();const D=this.getLayer(s);D?dt(D.getPaintProperty(h),v)||(D.setPaintProperty(h,v,E)&&this._updateLayer(D),this._changed=!0,this._updatedPaintProps[s]=!0):this.fire(new g.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(s,h){return this.getLayer(s).getPaintProperty(h)}setFeatureState(s,h){this._checkLoaded();const v=s.source,E=s.sourceLayer,D=this.getSource(v);if(void 0===D)return void this.fire(new g.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const R=D.type;if("geojson"===R&&E)return void this.fire(new g.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===R&&!E)return void this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===s.id&&this.fire(new g.ErrorEvent(new Error("The feature id parameter must be provided.")));const B=this._getSourceCaches(v);for(const z of B)z.setFeatureState(E,s.id,h)}removeFeatureState(s,h){this._checkLoaded();const v=s.source,E=this.getSource(v);if(void 0===E)return void this.fire(new g.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const D=E.type,R="vector"===D?s.sourceLayer:void 0;if("vector"===D&&!R)return void this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&"string"!=typeof s.id&&"number"!=typeof s.id)return void this.fire(new g.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const B=this._getSourceCaches(v);for(const z of B)z.removeFeatureState(R,s.id,h)}getFeatureState(s){this._checkLoaded();const h=s.source,v=s.sourceLayer,E=this.getSource(h);if(void 0!==E){if("vector"!==E.type||v)return void 0===s.id&&this.fire(new g.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(h)[0].getFeatureState(v,s.id);this.fire(new g.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new g.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return g.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const s={};for(const h in this._sourceCaches){const v=this._sourceCaches[h].getSource();s[v.id]||(s[v.id]=v.serialize())}return g.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:s,layers:this._serializeLayers(this._order)},h=>void 0!==h)}_updateLayer(s){this._updatedLayers[s.id]=!0;const h=this._getLayerSourceCache(s);s.source&&!this._updatedSources[s.source]&&h&&"raster"!==h.getSource().type&&(this._updatedSources[s.source]="reload",h.pause()),this._changed=!0}_flattenAndSortRenderedFeatures(s){const h=R=>"fill-extrusion"===this._layers[R].type,v={},E=[];for(let R=this._order.length-1;R>=0;R--){const B=this._order[R];if(h(B)){v[B]=R;for(const z of s){const $=z[B];if($)for(const H of $)E.push(H)}}}E.sort((R,B)=>B.intersectionZ-R.intersectionZ);const D=[];for(let R=this._order.length-1;R>=0;R--){const B=this._order[R];if(h(B))for(let z=E.length-1;z>=0;z--){const $=E[z].feature;if(v[$.layer.id]<R)break;D.push($),E.pop()}else for(const z of s){const $=z[B];if($)for(const H of $)D.push(H.feature)}}return D}queryRenderedFeatures(s,h,v){h&&h.filter&&this._validate(g.validateStyle.filter,"queryRenderedFeatures.filter",h.filter,null,h);const E={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new g.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const z of h.layers){const $=this._layers[z];if(!$)return this.fire(new g.ErrorEvent(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];E[$.source]=!0}}const D=[];h.availableImages=this._availableImages;const R=h&&h.layers?h.layers.some(z=>{const $=this.getLayer(z);return $&&$.is3D()}):this.has3DLayers(),B=Ha.createFromScreenPoints(s,v);for(const z in this._sourceCaches){const $=this._sourceCaches[z].getSource().id;h.layers&&!E[$]||D.push(he(this._sourceCaches[z],this._layers,this._serializedLayers,B,h,v,R,!!this.map._showQueryGeometry))}return this.placement&&D.push(function(z,$,H,Q,J,te,le){const ce={},_e=te.queryRenderedSymbols(Q),se=[];for(const ue of Object.keys(_e).map(Number))se.push(le[ue]);se.sort(we);for(const ue of se){const ge=ue.featureIndex.lookupSymbolFeatures(_e[ue.bucketInstanceId],$,ue.bucketIndex,ue.sourceLayerIndex,J.filter,J.layers,J.availableImages,z);for(const ve in ge){const Me=ce[ve]=ce[ve]||[],de=ge[ve];de.sort((Fe,Xe)=>{const it=ue.featureSortOrder;if(it){const Pe=it.indexOf(Fe.featureIndex);return it.indexOf(Xe.featureIndex)-Pe}return Xe.featureIndex-Fe.featureIndex});for(const Fe of de)Me.push(Fe)}}for(const ue in ce)ce[ue].forEach(ge=>{const ve=ge.feature,Me=H(z[ue]).getFeatureState(ve.layer["source-layer"],ve.id);ve.source=ve.layer.source,ve.layer["source-layer"]&&(ve.sourceLayer=ve.layer["source-layer"]),ve.state=Me});return ce}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),B.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(D)}querySourceFeatures(s,h){h&&h.filter&&this._validate(g.validateStyle.filter,"querySourceFeatures.filter",h.filter,null,h);const v=this._getSourceCaches(s);let E=[];for(const D of v)E=E.concat(be(D,h));return E}addSourceType(s,h,v){return Jo.getSourceType(s)?v(new Error(`A source type called "${s}" already exists.`)):(Jo.setSourceType(s,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:h.workerSourceURL},v):v(null,null))}getLight(){return this.light.getLight()}setLight(s,h={}){this._checkLoaded();const v=this.light.getLight();let E=!1;for(const R in s)if(!dt(s[R],v[R])){E=!0;break}if(!E)return;const D={now:g.exported.now(),transition:g.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(s,h),this.light.updateTransitions(D)}getTerrain(){return this.terrain?this.terrain.get():null}setTerrain(s){if(this._checkLoaded(),!s)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if("object"==typeof s.source){const h="terrain-dem-src";this.addSource(h,s.source),s=g.clone$2(s),s=g.extend(s,{source:h})}if(!this._validate(g.validateStyle.terrain,"terrain",s)){if(this.terrain){const h=this.terrain,v=h.get();for(const E in s)if(!dt(s[E],v[E])){h.set(s),this.stylesheet.terrain=s;const D={now:g.exported.now(),transition:g.extend({duration:0},this.stylesheet.transition)};h.updateTransitions(D);break}}else this._createTerrain(s);this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}}_createFog(s){const h=this.fog=new pn(s);this.stylesheet.fog=s;const v={now:g.exported.now(),transition:g.extend({duration:0},this.stylesheet.transition)};h.updateTransitions(v)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog,v=h.get();for(const E in s)if(!dt(s[E],v[E])){h.set(s),this.stylesheet.fog=s;const D={now:g.exported.now(),transition:g.extend({duration:0},this.stylesheet.transition)};h.updateTransitions(D);break}}else this._createFog(s);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const s=this._order.filter(v=>this.isLayerDraped(this._layers[v])),h=this._order.filter(v=>!this.isLayerDraped(this._layers[v]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...h)}_createTerrain(s){const h=this.terrain=new xl(s);this.stylesheet.terrain=s,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const v={now:g.exported.now(),transition:g.extend({duration:0},this.stylesheet.transition)};h.updateTransitions(v)}_force3DLayerUpdate(){for(const s in this._layers){const h=this._layers[s];"fill-extrusion"===h.type&&this._updateLayer(h)}}_validate(s,h,v,E,D={}){return(!D||!1!==D.validate)&&Ca(this,s.call(g.validateStyle,g.extend({key:h,style:this.serialize(),value:v,styleSpec:g.spec},E)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),g.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this._sourceCaches)this._sourceCaches[s].clearTiles(),this._sourceCaches[s].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(s){const h=this._getSourceCaches(s);for(const v of h)v.clearTiles()}_reloadSource(s){const h=this._getSourceCaches(s);for(const v of h)v.resume(),v.reload()}_updateSources(s){for(const h in this._sourceCaches)this._sourceCaches[h].update(s)}_generateCollisionBoxes(){for(const s in this._sourceCaches){const h=this._sourceCaches[s];h.resume(),h.reload()}}_updatePlacement(s,h,v,E,D=!1){let R=!1,B=!1;const z={};for(const $ of this._order){const H=this._layers[$];if("symbol"!==H.type)continue;if(!z[H.source]){const J=this._getLayerSourceCache(H);if(!J)continue;z[H.source]=J.getRenderableIds(!0).map(te=>J.getTileByID(te)).sort((te,le)=>le.tileID.overscaledZ-te.tileID.overscaledZ||(te.tileID.isLessThan(le.tileID)?-1:1))}const Q=this.crossTileSymbolIndex.addLayer(H,z[H.source],s.center.lng);R=R||Q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),D=D||this._layerOrderChanged||0===v,this._layerOrderChanged&&this.fire(new g.Event("neworder")),(D||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(g.exported.now(),s.zoom))&&(this.pauseablePlacement=new gc(s,this._order,D,h,v,E,this.placement,this.fog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,z),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(g.exported.now()),B=!0),R&&this.pauseablePlacement.placement.setStale()),B||R)for(const $ of this._order){const H=this._layers[$];"symbol"===H.type&&this.placement.updateLayerOpacities(H,z[H.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(g.exported.now())}_releaseSymbolFadeTiles(){for(const s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,h,v){this.imageManager.getImages(h.icons,v),this._updateTilesForChangedImages();const E=D=>{D&&D.setDependencies(h.tileID.key,h.type,h.icons)};E(this._otherSourceCaches[h.source]),E(this._symbolSourceCaches[h.source])}getGlyphs(s,h,v){this.glyphManager.getGlyphs(h.stacks,v)}getResource(s,h,v){return g.makeRequest(h,v)}_getSourceCache(s){return this._otherSourceCaches[s]}_getLayerSourceCache(s){return"symbol"===s.type?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}_getSourceCaches(s){const h=[];return this._otherSourceCaches[s]&&h.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&h.push(this._symbolSourceCaches[s]),h}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}}Jo.getSourceType=function(_){return Z[_]},Jo.setSourceType=function(_,s){Z[_]=s},Jo.registerForPluginStateChange=g.registerForPluginStateChange;var Dh="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}\n#endif",Gi="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let Du={},es={};Du=mn("","\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec3 elevationVector(vec2 pos) {vec2 uv=pos/8192.0;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif",!0),es=mn("#ifdef FOG\nuniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif","#ifdef FOG\nuniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",!0);const Kt=mn("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef TERRAIN\nhighp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),bi=Dh;var Fi={background:mn("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:mn("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:mn("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:mn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:mn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\ngl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec3 pos=vec3(floor(a_pos*0.5)+extrude,elevation(floor(a_pos*0.5)));gl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:mn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:mn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:mn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:mn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:mn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:mn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:mn("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:mn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:mn("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:mn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);\n#else\nvec3 p=vec3(pos_nx.xy,z);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:mn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:mn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:mn("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\n#ifdef RENDER_LINE_GRADIENT\nvec4 out_color=texture2D(u_gradient_image,v_uv);\n#else\nvec4 out_color=color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#ifdef RENDER_LINE_GRADIENT\nattribute vec3 a_packed;\n#else\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);\n#endif\n#ifdef RENDER_LINE_DASH\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:mn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:mn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:mn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));}"),symbolSDF:mn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:mn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrainRaster:mn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),terrainDepth:mn("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:mn("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Gi),skyboxGradient:mn("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Gi),skyboxCapture:mn("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:mn("uniform sampler2D u_image0;varying vec2 v_pos0;void main() {vec4 color=texture2D(u_image0,v_pos0);gl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_globe_matrix;attribute vec3 a_globe_pos;attribute vec2 a_uv;varying vec2 v_pos0;void main() {v_pos0=a_uv;gl_Position=u_globe_matrix*vec4(a_globe_pos+elevationVector(a_uv*8192.0)*elevation(a_uv*8192.0),1.0);}"),globeAtmosphere:mn("uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)\ndiscard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}","attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}"),globeDepth:mn("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_globe_matrix;attribute vec3 a_globe_pos;attribute vec2 a_uv;varying float v_depth;void main() {gl_Position=u_globe_matrix*vec4(a_globe_pos+elevationVector(a_uv*8192.0)*elevation(a_uv*8192.0),1.0);v_depth=gl_Position.z/gl_Position.w;}")};function mn(_,s,h){const v=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,E=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,D=s.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),R=_.match(E),B=s.match(E),z=Dh.match(E);let $=B?B.concat(R):R;h||(Du.staticUniforms&&($=Du.staticUniforms.concat($)),es.staticUniforms&&($=es.staticUniforms.concat($))),$&&($=$.concat(z));const H={};return{fragmentSource:_=_.replace(v,(Q,J,te,le,ce)=>(H[ce]=!0,"define"===J?`\n#ifndef HAS_UNIFORM_u_${ce}\nvarying ${te} ${le} ${ce};\n#else\nuniform ${te} ${le} u_${ce};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${ce}\n    ${te} ${le} ${ce} = u_${ce};\n#endif\n`)),vertexSource:s=s.replace(v,(Q,J,te,le,ce)=>{const _e="float"===le?"vec2":"vec4",se=ce.match(/color/)?"color":_e;return H[ce]?"define"===J?`\n#ifndef HAS_UNIFORM_u_${ce}\nuniform lowp float u_${ce}_t;\nattribute ${te} ${_e} a_${ce};\nvarying ${te} ${le} ${ce};\n#else\nuniform ${te} ${le} u_${ce};\n#endif\n`:"vec4"===se?`\n#ifndef HAS_UNIFORM_u_${ce}\n    ${ce} = a_${ce};\n#else\n    ${te} ${le} ${ce} = u_${ce};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${ce}\n    ${ce} = unpack_mix_${se}(a_${ce}, u_${ce}_t);\n#else\n    ${te} ${le} ${ce} = u_${ce};\n#endif\n`:"define"===J?`\n#ifndef HAS_UNIFORM_u_${ce}\nuniform lowp float u_${ce}_t;\nattribute ${te} ${_e} a_${ce};\n#else\nuniform ${te} ${le} u_${ce};\n#endif\n`:"vec4"===se?`\n#ifndef HAS_UNIFORM_u_${ce}\n    ${te} ${le} ${ce} = a_${ce};\n#else\n    ${te} ${le} ${ce} = u_${ce};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${ce}\n    ${te} ${le} ${ce} = unpack_mix_${se}(a_${ce}, u_${ce}_t);\n#else\n    ${te} ${le} ${ce} = u_${ce};\n#endif\n`}),staticAttributes:D,staticUniforms:$}}class Qs{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(s,h,v,E,D,R,B,z){this.context=s;let $=this.boundPaintVertexBuffers.length!==E.length;for(let H=0;!$&&H<E.length;H++)this.boundPaintVertexBuffers[H]!==E[H]&&($=!0);s.extVertexArrayObject&&this.vao&&this.boundProgram===h&&this.boundLayoutVertexBuffer===v&&!$&&this.boundIndexBuffer===D&&this.boundVertexOffset===R&&this.boundDynamicVertexBuffer===B&&this.boundDynamicVertexBuffer2===z?(s.bindVertexArrayOES.set(this.vao),B&&B.bind(),D&&D.dynamicDraw&&D.bind(),z&&z.bind()):this.freshBind(h,v,E,D,R,B,z)}freshBind(s,h,v,E,D,R,B){let z;const $=s.numAttributes,H=this.context,Q=H.gl;if(H.extVertexArrayObject)this.vao&&this.destroy(),this.vao=H.extVertexArrayObject.createVertexArrayOES(),H.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=s,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=E,this.boundVertexOffset=D,this.boundDynamicVertexBuffer=R,this.boundDynamicVertexBuffer2=B;else{z=H.currentNumAttributes||0;for(let J=$;J<z;J++)Q.disableVertexAttribArray(J)}h.enableAttributes(Q,s);for(const J of v)J.enableAttributes(Q,s);R&&R.enableAttributes(Q,s),B&&B.enableAttributes(Q,s),h.bind(),h.setVertexAttribPointers(Q,s,D);for(const J of v)J.bind(),J.setVertexAttribPointers(Q,s,D);R&&(R.bind(),R.setVertexAttribPointers(Q,s,D)),E&&E.bind(),B&&(B.bind(),B.setVertexAttribPointers(Q,s,D)),H.currentNumAttributes=$}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function So(_,s){const h=Math.pow(2,s.canonical.z),v=s.canonical.y;return[new g.MercatorCoordinate(0,v/h).toLngLat().lat,new g.MercatorCoordinate(0,(v+1)/h).toLngLat().lat]}function Mh(_,s,h,v,E,D,R){const B=_.context,z=B.gl,$=h.fbo;if(!$)return;_.prepareDrawTile(s);const H=_.useProgram("hillshade");B.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,$.colorAttachment.get());const Q=((J,te,le,ce)=>{const _e=le.paint.get("hillshade-shadow-color"),se=le.paint.get("hillshade-highlight-color"),ue=le.paint.get("hillshade-accent-color");let ge=le.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===le.paint.get("hillshade-illumination-anchor")&&(ge-=J.transform.angle);const ve=!J.options.moving;return{u_matrix:ce||J.transform.calculateProjMatrix(te.tileID.toUnwrapped(),ve),u_image:0,u_latrange:So(0,te.tileID),u_light:[le.paint.get("hillshade-exaggeration"),ge],u_shadow:_e,u_highlight:se,u_accent:ue}})(_,h,v,_.terrain?s.projMatrix:null);_.prepareDrawProgram(B,H,s.toUnwrapped()),H.draw(B,z.TRIANGLES,E,D,R,g.CullFaceMode.disabled,Q,v.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}function $i(_,s,h){if(!s.needsDEMTextureUpload)return;const v=_.context,E=v.gl;v.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||_.getTileTexture(h.stride);const D=h.getPixels();s.demTexture?s.demTexture.update(D,{premultiply:!1}):s.demTexture=new g.Texture(v,D,E.RGBA,{premultiply:!1}),s.needsDEMTextureUpload=!1}function At(_,s,h,v,E,D){const R=_.context,B=R.gl;if(!s.dem)return;const z=s.dem;if(R.activeTexture.set(B.TEXTURE1),$i(_,s,z),!s.demTexture)return;s.demTexture.bind(B.NEAREST,B.CLAMP_TO_EDGE);const $=z.dim;R.activeTexture.set(B.TEXTURE0);let H=s.fbo;if(!H){const Q=new g.Texture(R,{width:$,height:$,data:null},B.RGBA);Q.bind(B.LINEAR,B.CLAMP_TO_EDGE),H=s.fbo=R.createFramebuffer($,$,!0),H.colorAttachment.set(Q.texture)}R.bindFramebuffer.set(H.framebuffer),R.viewport.set([0,0,$,$]),_.useProgram("hillshadePrepare").draw(R,B.TRIANGLES,v,E,D,g.CullFaceMode.disabled,((Q,J)=>{const te=J.stride,le=g.create$1();return g.ortho(le,0,g.EXTENT,-g.EXTENT,0,0,1),g.translate(le,le,[0,-g.EXTENT,0]),{u_matrix:le,u_image:1,u_dimension:[te,te],u_zoom:Q.overscaledZ,u_unpack:J.unpackVector}})(s.tileID,z),h.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments),s.needsHillshadePrepare=!1}const En=(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_image0:new g.Uniform1i(_,s.u_image0),u_skirt_height:new g.Uniform1f(_,s.u_skirt_height)}),Mr=(_,s)=>({u_matrix:_,u_image0:0,u_skirt_height:s}),to=new class{constructor(){this.operations={}}newMorphing(_,s,h,v,E){if(_ in this.operations){const D=this.operations[_];D.to.tileID.key!==h.tileID.key&&(D.queued=h)}else this.operations[_]={startTime:v,phase:0,duration:E,from:s,to:h,queued:null}}getMorphValuesForProxy(_){if(!(_ in this.operations))return null;const s=this.operations[_];return{from:s.from,to:s.to,phase:s.phase}}update(_){for(const s in this.operations){const h=this.operations[s];for(h.phase=(_-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,_)){delete this.operations[s];break}}}_nextOp(_,s){return!!_.queued&&(_.from=_.to,_.to=_.queued,_.queued=null,_.phase=0,_.startTime=s,!0)}_validOp(_){return _.from.hasData()&&_.to.hasData()}},Ea={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function mi(_,s){const h=1<<_.z;return!s&&(0===_.x||_.x===h-1)||0===_.y||_.y===h-1}const Xs=_=>({u_matrix:_});function Yr(_,s,h,v,E){if(E>0){const D=g.exported.now(),R=(D-_.timeAdded)/E,B=s?(D-s.timeAdded)/E:-1,z=h.getSource(),$=v.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),H=!s||Math.abs(s.tileID.overscaledZ-$)>Math.abs(_.tileID.overscaledZ-$),Q=H&&_.refreshedUponExpiration?1:g.clamp(H?R:1-B,0,1);return _.refreshedUponExpiration&&R>=1&&(_.refreshedUponExpiration=!1),s?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}class Mu extends g.SourceCache{constructor(s){const h=Y("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},new Zo(mt(),null),s.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,h,v){if(s.freezeTileCoverage)return;this.transform=s;const E=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((D,R)=>{if(D[R.key]="",!this._tiles[R.key]){const B=new g.Tile(R,this._source.tileSize*R.overscaleFactor(),s.tileZoom);B.state="loaded",this._tiles[R.key]=B}return D},{});for(const D in this._tiles)D in E||(this.freeFBO(D),this._tiles[D].unloadVectorData(),delete this._tiles[D])}freeFBO(s){const h=this.proxyCachedFBO[s];if(void 0!==h){const v=Object.values(h);this.renderCachePool.push(...v),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Da extends g.OverscaledTileID{constructor(s,h,v){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=h,this.projMatrix=v}}class yn extends g.Elevation{constructor(s,h){super(),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[v,E,D]=function(z){const $=new g.StructArrayLayout4i8,H=new g.StructArrayLayout3ui6,Q=131;$.reserve(17161),H.reserve(33800);const J=g.EXTENT/128,te=g.EXTENT+J/2,le=te+J;for(let _e=-J;_e<le;_e+=J)for(let se=-J;se<le;se+=J){const ue=se<0||se>te||_e<0||_e>te?24575:0,ge=g.clamp(Math.round(se),0,g.EXTENT),ve=g.clamp(Math.round(_e),0,g.EXTENT);$.emplaceBack(ge+ue,ve,ge,ve)}const ce=(_e,se)=>{const ue=se*Q+_e;H.emplaceBack(ue+1,ue,ue+Q),H.emplaceBack(ue+Q,ue+Q+1,ue+1)};for(let _e=1;_e<129;_e++)for(let se=1;se<129;se++)ce(se,_e);return[0,129].forEach(_e=>{for(let se=0;se<130;se++)ce(se,_e),ce(_e,se)}),[$,H,32768]}(),R=s.context;this.gridBuffer=R.createVertexBuffer(v,Zn.members),this.gridIndexBuffer=R.createIndexBuffer(E),this.gridSegments=g.SegmentVector.simpleSegment(0,0,v.length,E.length),this.gridNoSkirtSegments=g.SegmentVector.simpleSegment(0,0,v.length,D),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Mu(h.map),this.orthoMatrix=g.create$1(),g.ortho(this.orthoMatrix,0,g.EXTENT,0,g.EXTENT,0,1);const B=R.gl;this._overlapStencilMode=new g.StencilMode({func:B.GEQUAL,mask:255},0,255,B.KEEP,B.KEEP,B.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),s.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=s,this._checkRenderCacheEfficiency()}update(s,h,v){if(s&&s.terrain){this._style!==s&&(this.style=s),this.enabled=!0;const E=s.terrain.properties;this.sourceCache=s._getSourceCache(E.get("source")),this._exaggeration=E.get("exaggeration");const D=()=>{this.sourceCache.used&&g.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const R=this.sourceCache.getSource().tileSize/128,B=this.proxySourceCache.getSource().tileSize;this.sourceCache.update(h,R*B,!0),this._findCoveringTileCache[this.sourceCache.id]={}};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,D(),this._initializing=!0),D(),h.updateElevation(!v),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0}else this._disable()}_checkRenderCacheEfficiency(){const s=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==s.efficiency&&g.warnOnce(`Terrain render cache efficiency is not optimal (${s.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${s.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(s){s.coord&&"source"===s.dataType?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):"style"===s.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const s in this._style._sourceCaches)this._style._sourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,v=this.painter.transform;this._initializing&&(this._initializing=0===v._centerAltitude&&-1===this.getAtPointOrZero(g.MercatorCoordinate.fromLngLat(v.center),-1),this._emptyDEMTextureDirty=!this._initializing);const E=this.proxyCoords=h.getIds().map(z=>{const $=h.getTileByID(z).tileID;return $.projMatrix=v.calculateProjMatrix($.toUnwrapped()),$});(function(z,$){const H=$.transform.pointCoordinate($.transform.getCameraPoint()),Q=new g.pointGeometry(H.x,H.y);z.sort((J,te)=>{if(te.overscaledZ-J.overscaledZ)return te.overscaledZ-J.overscaledZ;const le=new g.pointGeometry(J.canonical.x+(1<<J.canonical.z)*J.wrap,J.canonical.y),ce=new g.pointGeometry(te.canonical.x+(1<<te.canonical.z)*te.wrap,te.canonical.y),_e=Q.mult(1<<J.canonical.z);return _e.x-=.5,_e.y-=.5,_e.distSqr(le)-_e.distSqr(ce)})})(E,this.painter),this._previousZoom=v.zoom;const D=this.proxyToSource||{};this.proxyToSource={},E.forEach(z=>{this.proxyToSource[z.key]={}}),this.terrainTileForTile={};const R=this._style._sourceCaches;for(const z in R){const $=R[z];if(!$.used||($!==this.sourceCache&&(this._findCoveringTileCache[$.id]={}),this._setupProxiedCoordsForOrtho($,s[z],D),$.usedForTerrain))continue;const H=s[z];$.getSource().reparseOverscaled&&this._assignTerrainTiles(H)}this.proxiedCoords[h.id]=E.map(z=>new Da(z,z.key,this.orthoMatrix)),this._assignTerrainTiles(E),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(D),this.renderingToTexture=!1,this._updateTimestamp=g.exported.now();const B={};this._visibleDemTiles=[];for(const z of this.proxyCoords){const $=this.terrainTileForTile[z.key];if(!$)continue;const H=$.tileID.key;H in B||(this._visibleDemTiles.push($),B[H]=H)}}_assignTerrainTiles(s){this._initializing||s.forEach(h=>{if(this.terrainTileForTile[h.key])return;const v=this._findTileCoveringTileID(h,this.sourceCache);v&&(this.terrainTileForTile[h.key]=v)})}_prepareDEMTextures(){const s=this.painter.context,h=s.gl;for(const v in this.terrainTileForTile){const E=this.terrainTileForTile[v],D=E.dem;!D||E.demTexture&&!E.needsDEMTextureUpload||(s.activeTexture.set(h.TEXTURE1),$i(this.painter,E,D))}}_prepareDemTileUniforms(s,h,v,E){if(!h||null==h.demTexture)return!1;const D=s.tileID.canonical,R=Math.pow(2,h.tileID.canonical.z-D.z),B=E||"";return v[`u_dem_tl${B}`]=[D.x*R%1,D.y*R%1],v[`u_dem_scale${B}`]=R,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){let s=0;const h=this._visibleDemTiles.reduce((v,E)=>{if(!E.dem)return v;const D=E.dem.tree.minimums[0];return D>0&&s++,v+D},0);return s?h/s:0}_updateEmptyDEMTexture(){const s=this.painter.context,h=s.gl;s.activeTexture.set(h.TEXTURE2);const v=this._getLoadedAreaMinimum(),E={width:1,height:1,data:new Uint8Array(g.DEMData.pack(v,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let D=this._emptyDEMTexture;return D?D.update(E,{premultiply:!1}):D=this._emptyDEMTexture=new g.Texture(s,E,h.RGBA,{premultiply:!1}),D}setupElevationDraw(s,h,v){const E=this.painter.context,D=E.gl,R=(B=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:g.DEMData.getUnpackVector(B),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var B;R.u_dem_size=this.sourceCache.getSource().tileSize,R.u_exaggeration=this.exaggeration();let z=null,$=null,H=1;if(v&&v.morphing&&this._useVertexMorphing){const Q=v.morphing.srcDemTile,J=v.morphing.dstDemTile;H=v.morphing.phase,Q&&J&&(this._prepareDemTileUniforms(s,Q,R,"_prev")&&($=Q),this._prepareDemTileUniforms(s,J,R)&&(z=J))}if($&&z?(E.activeTexture.set(D.TEXTURE2),z.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE,D.NEAREST),E.activeTexture.set(D.TEXTURE4),$.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE,D.NEAREST),R.u_dem_lerp=H):(z=this.terrainTileForTile[s.tileID.key],E.activeTexture.set(D.TEXTURE2),(this._prepareDemTileUniforms(s,z,R)?z.demTexture:this.emptyDEMTexture).bind(D.NEAREST,D.CLAMP_TO_EDGE,D.NEAREST)),v&&v.useDepthForOcclusion&&(E.activeTexture.set(D.TEXTURE3),this._depthTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE,D.NEAREST),R.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),v&&v.useMeterToDem&&z){const Q=(1<<z.tileID.canonical.z)*g.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;R.u_meter_to_dem=Q}v&&v.labelPlaneMatrixInv&&(R.u_label_plane_matrix_inv=v.labelPlaneMatrixInv),h.setTerrainUniformValues(E,R)}renderToBackBuffer(s){const h=this.painter,v=this.painter.context;0!==s.length&&(v.bindFramebuffer.set(null),v.viewport.set([0,0,h.width,h.height]),this.renderingToTexture=!1,function(E,D,R,B,z){const $=E.context,H=$.gl;let Q,J;const te=E.options.showTerrainWireframe?2:0,le=(ge,ve)=>{if(J===ge)return;const Me=[Ea[ge]];ve&&Me.push(Ea[te]),Q=E.useProgram("terrainRaster",null,Me),J=ge},ce=E.colorModeForRenderPass(),_e=new g.DepthMode(H.LEQUAL,g.DepthMode.ReadWrite,E.depthRangeFor3D);to.update(z);const se=E.transform,ue=6*Math.pow(1.5,22-se.zoom)*D.exaggeration();(te?[!1,!0]:[!1]).forEach(ge=>{J=-1;const ve=ge?H.LINES:H.TRIANGLES,[Me,de]=ge?D.getWirefameBuffer():[D.gridIndexBuffer,D.gridSegments];for(const it of B){const Pe=R.getTile(it),Ge=g.StencilMode.disabled,wt=D.prevTerrainTileForTile[it.key],St=D.terrainTileForTile[it.key];Xe=St,null!=(Fe=wt)&&null!=Xe&&Fe.hasData()&&Xe.hasData()&&null!=Fe.demTexture&&null!=Xe.demTexture&&Fe.tileID.key!==Xe.tileID.key&&to.newMorphing(it.key,wt,St,z,250),$.activeTexture.set(H.TEXTURE0),Pe.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST);const Mt=to.getMorphValuesForProxy(it.key),ft=Mt?1:0;let It;Mt&&(It={morphing:{srcDemTile:Mt.from,dstDemTile:Mt.to,phase:g.easeCubicInOut(Mt.phase)}});const Dn=Mr(it.projMatrix,mi(it.canonical,se.renderWorldCopies)?ue/10:ue);le(ft,ge),D.setupElevationDraw(Pe,Q,It),E.prepareDrawProgram($,Q,it.toUnwrapped()),Q.draw($,ve,_e,Ge,ce,g.CullFaceMode.backCCW,Dn,"terrain_raster",D.gridBuffer,Me,de)}var Fe,Xe})}(h,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,s.splice(0,s.length))}renderBatch(s){if(0===this._drapedRenderBatches.length)return s+1;this.renderingToTexture=!0;const h=this.painter,v=this.painter.context,E=this.proxySourceCache,D=this.proxiedCoords[E.id],R=this._drapedRenderBatches.shift(),B=[],z=h.style.order;let $=0;for(const H of D){const Q=E.getTileByID(H.proxyTileKey),J=E.proxyCachedFBO[H.key]?E.proxyCachedFBO[H.key][s]:void 0,te=void 0!==J?E.renderCache[J]:this.pool[$++],le=void 0!==J;if(Q.texture=te.tex,le&&!te.dirty){B.push(Q.tileID);continue}let ce;v.bindFramebuffer.set(te.fb.framebuffer),this.renderedToTile=!1,te.dirty&&(v.clear({color:g.Color.transparent}),te.dirty=!1);for(let _e=R.start;_e<=R.end;++_e){const se=h.style._layers[z[_e]];if(se.isHidden(h.transform.zoom))continue;const ue=h.style._getLayerSourceCache(se),ge=ue?this.proxyToSource[H.key][ue.id]:[H];if(!ge)continue;const ve=ge;v.viewport.set([0,0,te.fb.width,te.fb.height]),ce!==(ue?ue.id:null)&&(this._setupStencil(te,ge,se,ue),ce=ue?ue.id:null),h.renderLayer(h,ue,se,ve)}this.renderedToTile?(te.dirty=!0,B.push(Q.tileID)):le||--$,5===$&&($=0,this.renderToBackBuffer(B))}return this.renderToBackBuffer(B),this.renderingToTexture=!1,v.bindFramebuffer.set(null),v.viewport.set([0,0,h.width,h.height]),R.end+1}postRender(){}renderCacheEfficiency(s){const h=s.order.length;if(0===h)return{efficiency:100};let v,E=0,D=0,R=!1;for(let B=0;B<h;++B){const z=s._layers[s.order[B]];this._style.isLayerDraped(z)?(R&&++E,++D):R||(R=!0,v=z.id)}return 0===D?{efficiency:100}:{efficiency:100*(1-E/D),firstUndrapedLayer:v}}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{s=Math.min(s,h.dem.tree.minimums[0])}),0===s?s:(s-30)*this._exaggeration}raycast(s,h,v){if(!this._visibleDemTiles)return null;const E=this._visibleDemTiles.filter(D=>D.dem).map(D=>{const R=D.tileID,B=Math.pow(2,R.overscaledZ),{x:z,y:$}=R.canonical,H=z/B,Q=(z+1)/B,J=$/B,te=($+1)/B;return{minx:H,miny:J,maxx:Q,maxy:te,t:D.dem.tree.raycastRoot(H,J,Q,te,s,h,v),tile:D}});E.sort((D,R)=>(null!==D.t?D.t:Number.MAX_VALUE)-(null!==R.t?R.t:Number.MAX_VALUE));for(const D of E){if(null==D.t)return null;const R=D.tile.dem.tree.raycast(D.minx,D.miny,D.maxx,D.maxy,s,h,v);if(null!=R)return R}return null}_createFBO(){const s=this.painter.context,h=s.gl,v=this.drapeBufferSize;s.activeTexture.set(h.TEXTURE0);const E=new g.Texture(s,{width:v[0],height:v[1],data:null},h.RGBA);E.bind(h.LINEAR,h.CLAMP_TO_EDGE);const D=s.createFramebuffer(v[0],v[1],!1);return D.colorAttachment.set(E.texture),D.depthAttachment=new On(s,D.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,v[0],v[1]),this._stencilRef=0,D.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):D.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&!s.extTextureFilterAnisotropicForceOff&&h.texParameterf(h.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:D,tex:E,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const s in this._style._sourceCaches)if(this._style._sourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{const h=this._style._layers[s],v=h.isHidden(this.painter.transform.zoom),E=h.getCrossfadeParameters(),D=!!E&&1!==E.t,R=h.hasTransition();return"custom"!==h.type&&!v&&(D||R)})}_clearRasterFadeFromRenderCache(){let s=!1;for(const h in this._style._sourceCaches)if(this._style._sourceCaches[h]._source instanceof ba){s=!0;break}if(s)for(let h=0;h<this._style.order.length;++h){const v=this._style._layers[this._style.order[h]],E=v.isHidden(this.painter.transform.zoom),D=this._style._getLayerSourceCache(v);if("raster"!==v.type||E||!D)continue;const R=v.paint.get("raster-fade-duration");for(const B of this.proxyCoords){const z=this.proxyToSource[B.key][D.id];if(z)for(const $ of z){const H=Yr(D.getTile($),D.findLoadedParent($,0),D,this.painter.transform,R);(1!==H.opacity||0!==H.mix)&&this._clearRenderCacheForTile(D.id,$)}}}}_setupDrapedRenderBatches(){const s=this._style.order,h=s.length;if(0===h)return;const v=[];let E,D=0,R=this._style._layers[s[D]];for(;!this._style.isLayerDraped(R)&&R.isHidden(this.painter.transform.zoom)&&++D<h;)R=this._style._layers[s[D]];for(;D<h;++D){const B=this._style._layers[s[D]];B.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(B)?void 0===E&&(E=D):void 0!==E&&(v.push({start:E,end:D-1}),E=void 0))}void 0!==E&&v.push({start:E,end:D-1}),this._drapedRenderBatches=v}_setupRenderCache(s){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const R=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let B=0;B<R.length;++B){const z=Object.values(R[B]);h.renderCachePool.push(...z)}}return}this._clearRasterFadeFromRenderCache();const v=this.proxyCoords,E=this._tilesDirty;for(let R=v.length-1;R>=0;R--){const B=v[R];if(h.getTileByID(B.key),void 0!==h.proxyCachedFBO[B.key]){const z=s[B.key],$=this.proxyToSource[B.key];let H=0;for(const Q in $){const J=$[Q],te=z[Q];if(!te||te.length!==J.length||J.some((le,ce)=>le!==te[ce]||E[Q]&&E[Q].hasOwnProperty(le.key))){H=-1;break}++H}for(const Q in h.proxyCachedFBO[B.key])h.renderCache[h.proxyCachedFBO[B.key][Q]].dirty=H<0||H!==Object.values(z).length}}const D=[...this._drapedRenderBatches];D.sort((R,B)=>B.end-B.start-(R.end-R.start));for(const R of D)for(const B of v){if(h.proxyCachedFBO[B.key])continue;let z=h.renderCachePool.pop();void 0===z&&h.renderCache.length<50&&(z=h.renderCache.length,h.renderCache.push(this._createFBO())),void 0!==z&&(h.proxyCachedFBO[B.key]={},h.proxyCachedFBO[B.key][R.start]=z,h.renderCache[z].dirty=!0)}this._tilesDirty={}}_setupStencil(s,h,v,E){if(!E||!this._sourceTilesOverlap[E.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const D=this.painter.context,R=D.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let B;if(v.isTileClipped())B=h.length,this._overlapStencilMode.test={func:R.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);B=1,this._overlapStencilMode.test={func:R.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+B>255&&(D.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=B,this._overlapStencilMode.ref=this._stencilRef,v.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):g.StencilMode.disabled}_renderTileClippingMasks(s,h){const v=this.painter,E=this.painter.context,D=E.gl;v._tileClippingMaskIDs={},E.setColorMode(g.ColorMode.disabled),E.setDepthMode(g.DepthMode.disabled);const R=v.useProgram("clippingMask");for(const B of s){const z=v._tileClippingMaskIDs[B.key]=--h;R.draw(E,D.TRIANGLES,g.DepthMode.disabled,new g.StencilMode({func:D.ALWAYS,mask:0},z,255,D.KEEP,D.KEEP,D.REPLACE),g.ColorMode.disabled,g.CullFaceMode.disabled,Xs(B.projMatrix),"$clipping",v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}}pointCoordinate(s){const h=this.painter.transform;if(s.x<0||s.x>h.width||s.y<0||s.y>h.height)return null;const v=[s.x,s.y,1,1];g.transformMat4(v,v,h.pixelMatrixInverse),g.scale$2(v,v,1/v[3]),v[0]/=h.worldSize,v[1]/=h.worldSize;const E=h._camera.position,D=g.mercatorZfromAltitude(1,h.center.lat),R=[E[0],E[1],E[2]/D,0],B=g.subtract([],v.slice(0,3),R);g.normalize(B,B);const z=this.raycast(R,B,this._exaggeration);return null!==z&&z?(g.scaleAndAdd(R,R,B,z),R[3]=R[2],R[2]*=D,R):null}drawDepth(){const s=this.painter,h=s.context,v=this.proxySourceCache,E=Math.ceil(s.width),D=Math.ceil(s.height);if(!this._depthFBO||this._depthFBO.width===E&&this._depthFBO.height===D||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const R=h.gl,B=h.createFramebuffer(E,D,!0);h.activeTexture.set(R.TEXTURE0);const z=new g.Texture(h,{width:E,height:D,data:null},R.RGBA);z.bind(R.NEAREST,R.CLAMP_TO_EDGE),B.colorAttachment.set(z.texture);const $=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,E,D);B.depthAttachment.set($),this._depthFBO=B,this._depthTexture=z}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,E,D]),function(R,B,z,$){const H=R.context,Q=H.gl;H.clear({depth:1});const J=R.useProgram("terrainDepth"),te=new g.DepthMode(Q.LESS,g.DepthMode.ReadWrite,R.depthRangeFor3D);for(const le of $){const ce=z.getTile(le),_e=Mr(le.projMatrix,0);B.setupElevationDraw(ce,J),J.draw(H,Q.TRIANGLES,te,g.StencilMode.disabled,g.ColorMode.unblended,g.CullFaceMode.backCCW,_e,"terrain_depth",B.gridBuffer,B.gridIndexBuffer,B.gridNoSkirtSegments)}}(s,this,v,this.proxyCoords)}_setupProxiedCoordsForOrtho(s,h,v){if(s.getSource()instanceof ne)return this._setupProxiedCoordsForImageSource(s,h,v);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};const E=this.proxiedCoords[s.id]=[],D=this.proxyCoords;for(let B=0;B<D.length;B++){const z=D[B],$=this._findTileCoveringTileID(z,s);if($){const H=this._createProxiedId(z,$,v[z.key]&&v[z.key][s.id]);E.push(H),this.proxyToSource[z.key][s.id]=[H]}}let R=!1;for(let B=0;B<h.length;B++){const z=s.getTile(h[B]);if(!z||!z.hasData())continue;const $=this._findTileCoveringTileID(z.tileID,this.proxySourceCache);if($&&$.tileID.canonical.z!==z.tileID.canonical.z){const H=this.proxyToSource[$.tileID.key][s.id],Q=this._createProxiedId($.tileID,z,v[$.tileID.key]&&v[$.tileID.key][s.id]);H?H.splice(H.length-1,0,Q):this.proxyToSource[$.tileID.key][s.id]=[Q],E.push(Q),R=!0}}this._sourceTilesOverlap[s.id]=R}_setupProxiedCoordsForImageSource(s,h,v){if(!s.getSource().loaded())return;const E=this.proxiedCoords[s.id]=[],D=this.proxyCoords,R=s.getSource(),B=new g.pointGeometry(R.tileID.x,R.tileID.y)._div(1<<R.tileID.z),z=R.coordinates.map(g.MercatorCoordinate.fromLngLat).reduce((H,Q)=>(H.min.x=Math.min(H.min.x,Q.x-B.x),H.min.y=Math.min(H.min.y,Q.y-B.y),H.max.x=Math.max(H.max.x,Q.x-B.x),H.max.y=Math.max(H.max.y,Q.y-B.y),H),{min:new g.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new g.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),$=(H,Q)=>{const J=H.wrap+H.canonical.x/(1<<H.canonical.z),te=H.canonical.y/(1<<H.canonical.z),le=g.EXTENT/(1<<H.canonical.z),ce=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),_e=Q.canonical.y/(1<<Q.canonical.z);return J+le<ce+z.min.x||J>ce+z.max.x||te+le<_e+z.min.y||te>_e+z.max.y};for(let H=0;H<D.length;H++){const Q=D[H];for(let J=0;J<h.length;J++){const te=s.getTile(h[J]);if(!te||!te.hasData()||$(Q,te.tileID))continue;const le=this._createProxiedId(Q,te,v[Q.key]&&v[Q.key][s.id]),ce=this.proxyToSource[Q.key][s.id];ce?ce.push(le):this.proxyToSource[Q.key][s.id]=[le],E.push(le)}}}_createProxiedId(s,h,v){let E=this.orthoMatrix;if(v){const D=v.find(R=>R.key===h.tileID.key);if(D)return D}if(h.tileID.key!==s.key){const D=s.canonical.z-h.tileID.canonical.z;let R,B,z;E=g.create$1();const $=h.tileID.wrap-s.wrap<<s.overscaledZ;D>0?(R=g.EXTENT>>D,B=R*((h.tileID.canonical.x<<D)-s.canonical.x+$),z=R*((h.tileID.canonical.y<<D)-s.canonical.y)):(R=g.EXTENT<<-D,B=g.EXTENT*(h.tileID.canonical.x-(s.canonical.x+$<<-D)),z=g.EXTENT*(h.tileID.canonical.y-(s.canonical.y<<-D))),g.ortho(E,0,R,0,R,0,1),g.translate(E,E,[B,z,0])}return new Da(h.tileID,s.key,E)}_findTileCoveringTileID(s,h){let v=h.getTile(s);if(v&&v.hasData())return v;const E=this._findCoveringTileCache[h.id],D=E[s.key];if(v=D?h.getTileByID(D):null,v&&v.hasData()||null===D)return v;let R=v?v.tileID:s,B=R.overscaledZ;const z=h.getSource().minzoom,$=[];if(!D){const Q=h.getSource().maxzoom;if(s.canonical.z>=Q){const J=s.canonical.z-Q;h.getSource().reparseOverscaled?(B=Math.max(s.canonical.z+2,h.transform.tileZoom),R=new g.OverscaledTileID(B,s.wrap,Q,s.canonical.x>>J,s.canonical.y>>J)):0!==J&&(B=Q,R=new g.OverscaledTileID(B,s.wrap,Q,s.canonical.x>>J,s.canonical.y>>J))}R.key!==s.key&&($.push(R.key),v=h.getTile(R))}const H=Q=>{$.forEach(J=>{E[J]=Q}),$.length=0};for(B-=1;B>=z&&(!v||!v.hasData());B--){v&&H(v.tileID.key);const Q=R.calculateScaledKey(B);if(v=h.getTileByID(Q),v&&v.hasData())break;const J=E[Q];if(null===J)break;void 0===J?$.push(Q):v=h.getTileByID(J)}return H(v?v.tileID.key:null),v&&v.hasData()?v:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(s){this.renderedToTile=!0}_clearRenderCacheForTile(s,h){let v=this._tilesDirty[s];v||(v=this._tilesDirty[s]={}),v[h.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const s=function(h){let v,E,D;const R=new g.StructArrayLayout2ui4,B=131;for(E=1;E<129;E++){for(v=1;v<129;v++)D=E*B+v,R.emplaceBack(D,D+1),R.emplaceBack(D,D+B),R.emplaceBack(D+1,D+B),128===E&&R.emplaceBack(D+B,D+B+1);R.emplaceBack(D+1,D+1+B)}return R}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(s),this.wireframeSegments=g.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,s.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function Sl(_){const s=[];for(let h=0;h<_.length;h++){if(null===_[h])continue;const v=_[h].split(" ");s.push(v.pop())}return s}class Ma{static cacheKey(s,h,v){let E=`${s}${v?v.cacheKey:""}`;for(const D of h)E+=`/${D}`;return E}constructor(s,h,v,E,D,R){const B=s.gl;this.program=B.createProgram();const z=Sl(v.staticAttributes),$=E?E.getBinderAttributes():[],H=z.concat($),Q=v.staticUniforms?Sl(v.staticUniforms):[],J=E?E.getBinderUniforms():[],te=Q.concat(J),le=[];for(const Me of te)le.indexOf(Me)<0&&le.push(Me);let ce=E?E.defines():[];ce=ce.concat(R.map(Me=>`#define ${Me}`));const _e=ce.concat(Kt.fragmentSource,bi,es.fragmentSource,v.fragmentSource).join("\n"),se=ce.concat(Kt.vertexSource,bi,es.vertexSource,Du.vertexSource,v.vertexSource).join("\n"),ue=B.createShader(B.FRAGMENT_SHADER);if(B.isContextLost())return void(this.failedToCreate=!0);B.shaderSource(ue,_e),B.compileShader(ue),B.attachShader(this.program,ue);const ge=B.createShader(B.VERTEX_SHADER);if(B.isContextLost())return void(this.failedToCreate=!0);B.shaderSource(ge,se),B.compileShader(ge),B.attachShader(this.program,ge),this.attributes={};const ve={};this.numAttributes=H.length;for(let Me=0;Me<this.numAttributes;Me++)H[Me]&&(B.bindAttribLocation(this.program,Me,H[Me]),this.attributes[H[Me]]=Me);B.linkProgram(this.program),B.deleteShader(ge),B.deleteShader(ue);for(let Me=0;Me<le.length;Me++){const de=le[Me];if(de&&!ve[de]){const Fe=B.getUniformLocation(this.program,de);Fe&&(ve[de]=Fe)}}var Me,de;this.fixedUniforms=D(s,ve),this.binderUniforms=E?E.getUniforms(s,ve):[],-1!==R.indexOf("TERRAIN")&&(this.terrainUniforms={u_dem:new g.Uniform1i(Me=s,(de=ve).u_dem),u_dem_prev:new g.Uniform1i(Me,de.u_dem_prev),u_dem_unpack:new g.Uniform4f(Me,de.u_dem_unpack),u_dem_tl:new g.Uniform2f(Me,de.u_dem_tl),u_dem_scale:new g.Uniform1f(Me,de.u_dem_scale),u_dem_tl_prev:new g.Uniform2f(Me,de.u_dem_tl_prev),u_dem_scale_prev:new g.Uniform1f(Me,de.u_dem_scale_prev),u_dem_size:new g.Uniform1f(Me,de.u_dem_size),u_dem_lerp:new g.Uniform1f(Me,de.u_dem_lerp),u_exaggeration:new g.Uniform1f(Me,de.u_exaggeration),u_depth:new g.Uniform1i(Me,de.u_depth),u_depth_size_inv:new g.Uniform2f(Me,de.u_depth_size_inv),u_meter_to_dem:new g.Uniform1f(Me,de.u_meter_to_dem),u_label_plane_matrix_inv:new g.UniformMatrix4f(Me,de.u_label_plane_matrix_inv),u_tile_tl_up:new g.Uniform3f(Me,de.u_tile_tl_up),u_tile_tr_up:new g.Uniform3f(Me,de.u_tile_tr_up),u_tile_br_up:new g.Uniform3f(Me,de.u_tile_br_up),u_tile_bl_up:new g.Uniform3f(Me,de.u_tile_bl_up),u_tile_up_scale:new g.Uniform1f(Me,de.u_tile_up_scale)}),-1!==R.indexOf("FOG")&&(this.fogUniforms=((Me,de)=>({u_fog_matrix:new g.UniformMatrix4f(Me,de.u_fog_matrix),u_fog_range:new g.Uniform2f(Me,de.u_fog_range),u_fog_color:new g.Uniform4f(Me,de.u_fog_color),u_fog_horizon_blend:new g.Uniform1f(Me,de.u_fog_horizon_blend),u_fog_temporal_offset:new g.Uniform1f(Me,de.u_fog_temporal_offset)}))(s,ve))}setTerrainUniformValues(s,h){if(!this.terrainUniforms)return;const v=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const E in h)v[E].set(h[E])}}setFogUniformValues(s,h){if(!this.fogUniforms)return;const v=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const E in h)v[E].location&&v[E].set(h[E])}}draw(s,h,v,E,D,R,B,z,$,H,Q,J,te,le,ce,_e){const se=s.gl;if(this.failedToCreate)return;s.program.set(this.program),s.setDepthMode(v),s.setStencilMode(E),s.setColorMode(D),s.setCullFace(R);for(const ge in this.fixedUniforms)this.fixedUniforms[ge].set(B[ge]);le&&le.setUniforms(s,this.binderUniforms,J,{zoom:te});const ue={[se.LINES]:2,[se.TRIANGLES]:3,[se.LINE_STRIP]:1}[h];for(const ge of Q.get()){const ve=ge.vaos||(ge.vaos={});(ve[z]||(ve[z]=new Qs)).bind(s,this,$,le?le.getPaintVertexBuffers():[],H,ge.vertexOffset,ce,_e),se.drawElements(h,ge.primitiveLength*ue,se.UNSIGNED_SHORT,ge.primitiveOffset*ue*2)}}}function Su(_,s,h){const v=1/Br(h,1,s.transform.tileZoom),E=Math.pow(2,h.tileID.overscaledZ),D=h.tileSize*Math.pow(2,s.transform.tileZoom)/E,R=D*(h.tileID.canonical.x+h.tileID.wrap*E),B=D*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[v,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[R>>16,B>>16],u_pixel_coord_lower:[65535&R,65535&B]}}const Ja=(_,s,h,v)=>{const E=s.style.light,D=E.properties.get("position"),R=[D.x,D.y,D.z],B=g.create$2();"viewport"===E.properties.get("anchor")&&(g.fromRotation(B,-s.transform.angle),g.transformMat3(R,R,B));const z=E.properties.get("color");return{u_matrix:_,u_lightpos:R,u_lightintensity:E.properties.get("intensity"),u_lightcolor:[z.r,z.g,z.b],u_vertical_gradient:+h,u_opacity:v}},To=(_,s,h,v,E,D,R)=>g.extend(Ja(_,s,h,v),Su(D,s,R),{u_height_factor:-Math.pow(2,E.overscaledZ)/R.tileSize/8}),Ys=_=>({u_matrix:_}),bs=(_,s,h,v)=>g.extend(Ys(_),Su(h,s,v)),ts=(_,s)=>({u_matrix:_,u_world:s}),Ln=(_,s,h,v,E)=>g.extend(bs(_,s,h,v),{u_world:E}),Pd=(_,s,h,v)=>{const E=_.transform;let D;if("map"===v.paint.get("circle-pitch-alignment")){const R=Br(h,1,E.zoom);D=[R,R]}else D=E.pixelsToGLUnits;return{u_camera_to_center_distance:E.cameraToCenterDistance,u_matrix:_.translatePosMatrix(s.projMatrix,h,v.paint.get("circle-translate"),v.paint.get("circle-translate-anchor")),u_device_pixel_ratio:g.exported.devicePixelRatio,u_extrude_scale:D}},Sh=_=>{const s=[];return"map"===_.paint.get("circle-pitch-alignment")&&s.push("PITCH_WITH_MAP"),"map"===_.paint.get("circle-pitch-scale")&&s.push("SCALE_WITH_MAP"),s},Tl=(_,s,h)=>{const v=g.EXTENT/h.tileSize;return{u_matrix:_,u_camera_to_center_distance:s.cameraToCenterDistance,u_extrude_scale:[s.pixelsToGLUnits[0]/v,s.pixelsToGLUnits[1]/v]}},yc=(_,s,h=1)=>({u_matrix:_,u_color:s,u_overlay:0,u_overlay_scale:h}),Il=(_,s,h,v)=>({u_matrix:_,u_extrude_scale:Br(s,1,h),u_intensity:v}),kl=(_,s,h,v,E,D)=>{const R=_.transform,B={u_matrix:Tu(_,s,h,E),u_ratio:1/Br(s,1,R.zoom),u_device_pixel_ratio:g.exported.devicePixelRatio,u_units_to_pixels:[1/R.pixelsToGLUnits[0],1/R.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:D,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0};if(Vo(h)){const z=wi(s,_.transform);B.u_texsize=s.lineAtlasTexture.size,B.u_scale=[z,v.fromScale,v.toScale],B.u_mix=v.t}return B},Sa=(_,s,h,v,E)=>{const D=_.transform,R=wi(s,D);return{u_matrix:Tu(_,s,h,E),u_texsize:s.imageAtlasTexture.size,u_ratio:1/Br(s,1,D.zoom),u_device_pixel_ratio:g.exported.devicePixelRatio,u_image:0,u_scale:[R,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]]}};function wi(_,s){return 1/Br(_,1,s.tileZoom)}function Tu(_,s,h,v){return _.translatePosMatrix(v||s.tileID.projMatrix,s,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}const ws=_=>{const s=[];return Vo(_)&&s.push("RENDER_LINE_DASH"),_.paint.get("line-gradient")&&s.push("RENDER_LINE_GRADIENT"),s};function Vo(_){const s=_.paint.get("line-dasharray").value;return s.value||"constant"!==s.kind}const el=(_,s,h,v,E)=>{return{u_matrix:_,u_tl_parent:s,u_scale_parent:h,u_buffer_scale:1,u_fade_t:v.mix,u_opacity:v.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(R=E.paint.get("raster-saturation"),R>0?1-1/(1.001-R):-R),u_contrast_factor:(D=E.paint.get("raster-contrast"),D>0?1/(1-D):1+D),u_spin_weights:Th(E.paint.get("raster-hue-rotate"))};var D,R};function Th(_){_*=Math.PI/180;const s=Math.sin(_),h=Math.cos(_);return[(2*h+1)/3,(-Math.sqrt(3)*s-h+1)/3,(Math.sqrt(3)*s-h+1)/3]}const Iu=(_,s,h,v,E,D,R,B,z,$)=>{const H=E.transform;return{u_is_size_zoom_constant:+("constant"===_||"source"===_),u_is_size_feature_constant:+("constant"===_||"camera"===_),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:H.cameraToCenterDistance,u_pitch:H.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:H.width/H.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:D,u_label_plane_matrix:R,u_coord_matrix:B,u_is_text:+z,u_pitch_with_map:+v,u_texsize:$,u_texture:0}},ns=(_,s,h,v,E,D,R,B,z,$,H)=>{const{cameraToCenterDistance:Q,_pitch:J}=E.transform;return g.extend(Iu(_,s,h,v,E,D,R,B,z,$),{u_gamma_scale:v?Q*Math.cos(E.terrain?0:J):1,u_device_pixel_ratio:g.exported.devicePixelRatio,u_is_halo:+H})},cm=(_,s,h,v,E,D,R,B,z,$)=>g.extend(ns(_,s,h,v,E,D,R,B,!0,z,!0),{u_texsize_icon:$,u_texture_icon:1}),E0=(_,s,h)=>({u_matrix:_,u_opacity:s,u_color:h}),um=(_,s,h,v,E,D)=>g.extend(function(R,B,z,$){const H=z.imageManager.getPattern(R.from.toString()),Q=z.imageManager.getPattern(R.to.toString()),{width:J,height:te}=z.imageManager.getPixelSize(),le=Math.pow(2,$.tileID.overscaledZ),ce=$.tileSize*Math.pow(2,z.transform.tileZoom)/le,_e=ce*($.tileID.canonical.x+$.tileID.wrap*le),se=ce*$.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:H.tl,u_pattern_br_a:H.br,u_pattern_tl_b:Q.tl,u_pattern_br_b:Q.br,u_texsize:[J,te],u_mix:B.t,u_pattern_size_a:H.displaySize,u_pattern_size_b:Q.displaySize,u_scale_a:B.fromScale,u_scale_b:B.toScale,u_tile_units_to_pixels:1/Br($,1,z.transform.tileZoom),u_pixel_coord_upper:[_e>>16,se>>16],u_pixel_coord_lower:[65535&_e,65535&se]}}(v,D,h,E),{u_matrix:_,u_opacity:s}),Rd={fillExtrusion:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_lightpos:new g.Uniform3f(_,s.u_lightpos),u_lightintensity:new g.Uniform1f(_,s.u_lightintensity),u_lightcolor:new g.Uniform3f(_,s.u_lightcolor),u_vertical_gradient:new g.Uniform1f(_,s.u_vertical_gradient),u_opacity:new g.Uniform1f(_,s.u_opacity)}),fillExtrusionPattern:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_lightpos:new g.Uniform3f(_,s.u_lightpos),u_lightintensity:new g.Uniform1f(_,s.u_lightintensity),u_lightcolor:new g.Uniform3f(_,s.u_lightcolor),u_vertical_gradient:new g.Uniform1f(_,s.u_vertical_gradient),u_height_factor:new g.Uniform1f(_,s.u_height_factor),u_image:new g.Uniform1i(_,s.u_image),u_texsize:new g.Uniform2f(_,s.u_texsize),u_pixel_coord_upper:new g.Uniform2f(_,s.u_pixel_coord_upper),u_pixel_coord_lower:new g.Uniform2f(_,s.u_pixel_coord_lower),u_scale:new g.Uniform3f(_,s.u_scale),u_fade:new g.Uniform1f(_,s.u_fade),u_opacity:new g.Uniform1f(_,s.u_opacity)}),fill:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix)}),fillPattern:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_image:new g.Uniform1i(_,s.u_image),u_texsize:new g.Uniform2f(_,s.u_texsize),u_pixel_coord_upper:new g.Uniform2f(_,s.u_pixel_coord_upper),u_pixel_coord_lower:new g.Uniform2f(_,s.u_pixel_coord_lower),u_scale:new g.Uniform3f(_,s.u_scale),u_fade:new g.Uniform1f(_,s.u_fade)}),fillOutline:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_world:new g.Uniform2f(_,s.u_world)}),fillOutlinePattern:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_world:new g.Uniform2f(_,s.u_world),u_image:new g.Uniform1i(_,s.u_image),u_texsize:new g.Uniform2f(_,s.u_texsize),u_pixel_coord_upper:new g.Uniform2f(_,s.u_pixel_coord_upper),u_pixel_coord_lower:new g.Uniform2f(_,s.u_pixel_coord_lower),u_scale:new g.Uniform3f(_,s.u_scale),u_fade:new g.Uniform1f(_,s.u_fade)}),circle:(_,s)=>({u_camera_to_center_distance:new g.Uniform1f(_,s.u_camera_to_center_distance),u_extrude_scale:new g.Uniform2f(_,s.u_extrude_scale),u_device_pixel_ratio:new g.Uniform1f(_,s.u_device_pixel_ratio),u_matrix:new g.UniformMatrix4f(_,s.u_matrix)}),collisionBox:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_camera_to_center_distance:new g.Uniform1f(_,s.u_camera_to_center_distance),u_extrude_scale:new g.Uniform2f(_,s.u_extrude_scale)}),collisionCircle:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_inv_matrix:new g.UniformMatrix4f(_,s.u_inv_matrix),u_camera_to_center_distance:new g.Uniform1f(_,s.u_camera_to_center_distance),u_viewport_size:new g.Uniform2f(_,s.u_viewport_size)}),debug:(_,s)=>({u_color:new g.UniformColor(_,s.u_color),u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_overlay:new g.Uniform1i(_,s.u_overlay),u_overlay_scale:new g.Uniform1f(_,s.u_overlay_scale)}),clippingMask:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix)}),heatmap:(_,s)=>({u_extrude_scale:new g.Uniform1f(_,s.u_extrude_scale),u_intensity:new g.Uniform1f(_,s.u_intensity),u_matrix:new g.UniformMatrix4f(_,s.u_matrix)}),heatmapTexture:(_,s)=>({u_image:new g.Uniform1i(_,s.u_image),u_color_ramp:new g.Uniform1i(_,s.u_color_ramp),u_opacity:new g.Uniform1f(_,s.u_opacity)}),hillshade:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_image:new g.Uniform1i(_,s.u_image),u_latrange:new g.Uniform2f(_,s.u_latrange),u_light:new g.Uniform2f(_,s.u_light),u_shadow:new g.UniformColor(_,s.u_shadow),u_highlight:new g.UniformColor(_,s.u_highlight),u_accent:new g.UniformColor(_,s.u_accent)}),hillshadePrepare:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_image:new g.Uniform1i(_,s.u_image),u_dimension:new g.Uniform2f(_,s.u_dimension),u_zoom:new g.Uniform1f(_,s.u_zoom),u_unpack:new g.Uniform4f(_,s.u_unpack)}),line:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_ratio:new g.Uniform1f(_,s.u_ratio),u_device_pixel_ratio:new g.Uniform1f(_,s.u_device_pixel_ratio),u_units_to_pixels:new g.Uniform2f(_,s.u_units_to_pixels),u_dash_image:new g.Uniform1i(_,s.u_dash_image),u_gradient_image:new g.Uniform1i(_,s.u_gradient_image),u_image_height:new g.Uniform1f(_,s.u_image_height),u_texsize:new g.Uniform2f(_,s.u_texsize),u_scale:new g.Uniform3f(_,s.u_scale),u_mix:new g.Uniform1f(_,s.u_mix)}),linePattern:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_texsize:new g.Uniform2f(_,s.u_texsize),u_ratio:new g.Uniform1f(_,s.u_ratio),u_device_pixel_ratio:new g.Uniform1f(_,s.u_device_pixel_ratio),u_image:new g.Uniform1i(_,s.u_image),u_units_to_pixels:new g.Uniform2f(_,s.u_units_to_pixels),u_scale:new g.Uniform3f(_,s.u_scale),u_fade:new g.Uniform1f(_,s.u_fade)}),raster:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_tl_parent:new g.Uniform2f(_,s.u_tl_parent),u_scale_parent:new g.Uniform1f(_,s.u_scale_parent),u_buffer_scale:new g.Uniform1f(_,s.u_buffer_scale),u_fade_t:new g.Uniform1f(_,s.u_fade_t),u_opacity:new g.Uniform1f(_,s.u_opacity),u_image0:new g.Uniform1i(_,s.u_image0),u_image1:new g.Uniform1i(_,s.u_image1),u_brightness_low:new g.Uniform1f(_,s.u_brightness_low),u_brightness_high:new g.Uniform1f(_,s.u_brightness_high),u_saturation_factor:new g.Uniform1f(_,s.u_saturation_factor),u_contrast_factor:new g.Uniform1f(_,s.u_contrast_factor),u_spin_weights:new g.Uniform3f(_,s.u_spin_weights)}),symbolIcon:(_,s)=>({u_is_size_zoom_constant:new g.Uniform1i(_,s.u_is_size_zoom_constant),u_is_size_feature_constant:new g.Uniform1i(_,s.u_is_size_feature_constant),u_size_t:new g.Uniform1f(_,s.u_size_t),u_size:new g.Uniform1f(_,s.u_size),u_camera_to_center_distance:new g.Uniform1f(_,s.u_camera_to_center_distance),u_pitch:new g.Uniform1f(_,s.u_pitch),u_rotate_symbol:new g.Uniform1i(_,s.u_rotate_symbol),u_aspect_ratio:new g.Uniform1f(_,s.u_aspect_ratio),u_fade_change:new g.Uniform1f(_,s.u_fade_change),u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_label_plane_matrix:new g.UniformMatrix4f(_,s.u_label_plane_matrix),u_coord_matrix:new g.UniformMatrix4f(_,s.u_coord_matrix),u_is_text:new g.Uniform1i(_,s.u_is_text),u_pitch_with_map:new g.Uniform1i(_,s.u_pitch_with_map),u_texsize:new g.Uniform2f(_,s.u_texsize),u_texture:new g.Uniform1i(_,s.u_texture)}),symbolSDF:(_,s)=>({u_is_size_zoom_constant:new g.Uniform1i(_,s.u_is_size_zoom_constant),u_is_size_feature_constant:new g.Uniform1i(_,s.u_is_size_feature_constant),u_size_t:new g.Uniform1f(_,s.u_size_t),u_size:new g.Uniform1f(_,s.u_size),u_camera_to_center_distance:new g.Uniform1f(_,s.u_camera_to_center_distance),u_pitch:new g.Uniform1f(_,s.u_pitch),u_rotate_symbol:new g.Uniform1i(_,s.u_rotate_symbol),u_aspect_ratio:new g.Uniform1f(_,s.u_aspect_ratio),u_fade_change:new g.Uniform1f(_,s.u_fade_change),u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_label_plane_matrix:new g.UniformMatrix4f(_,s.u_label_plane_matrix),u_coord_matrix:new g.UniformMatrix4f(_,s.u_coord_matrix),u_is_text:new g.Uniform1i(_,s.u_is_text),u_pitch_with_map:new g.Uniform1i(_,s.u_pitch_with_map),u_texsize:new g.Uniform2f(_,s.u_texsize),u_texture:new g.Uniform1i(_,s.u_texture),u_gamma_scale:new g.Uniform1f(_,s.u_gamma_scale),u_device_pixel_ratio:new g.Uniform1f(_,s.u_device_pixel_ratio),u_is_halo:new g.Uniform1i(_,s.u_is_halo)}),symbolTextAndIcon:(_,s)=>({u_is_size_zoom_constant:new g.Uniform1i(_,s.u_is_size_zoom_constant),u_is_size_feature_constant:new g.Uniform1i(_,s.u_is_size_feature_constant),u_size_t:new g.Uniform1f(_,s.u_size_t),u_size:new g.Uniform1f(_,s.u_size),u_camera_to_center_distance:new g.Uniform1f(_,s.u_camera_to_center_distance),u_pitch:new g.Uniform1f(_,s.u_pitch),u_rotate_symbol:new g.Uniform1i(_,s.u_rotate_symbol),u_aspect_ratio:new g.Uniform1f(_,s.u_aspect_ratio),u_fade_change:new g.Uniform1f(_,s.u_fade_change),u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_label_plane_matrix:new g.UniformMatrix4f(_,s.u_label_plane_matrix),u_coord_matrix:new g.UniformMatrix4f(_,s.u_coord_matrix),u_is_text:new g.Uniform1i(_,s.u_is_text),u_pitch_with_map:new g.Uniform1i(_,s.u_pitch_with_map),u_texsize:new g.Uniform2f(_,s.u_texsize),u_texsize_icon:new g.Uniform2f(_,s.u_texsize_icon),u_texture:new g.Uniform1i(_,s.u_texture),u_texture_icon:new g.Uniform1i(_,s.u_texture_icon),u_gamma_scale:new g.Uniform1f(_,s.u_gamma_scale),u_device_pixel_ratio:new g.Uniform1f(_,s.u_device_pixel_ratio),u_is_halo:new g.Uniform1i(_,s.u_is_halo)}),background:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_opacity:new g.Uniform1f(_,s.u_opacity),u_color:new g.UniformColor(_,s.u_color)}),backgroundPattern:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_opacity:new g.Uniform1f(_,s.u_opacity),u_image:new g.Uniform1i(_,s.u_image),u_pattern_tl_a:new g.Uniform2f(_,s.u_pattern_tl_a),u_pattern_br_a:new g.Uniform2f(_,s.u_pattern_br_a),u_pattern_tl_b:new g.Uniform2f(_,s.u_pattern_tl_b),u_pattern_br_b:new g.Uniform2f(_,s.u_pattern_br_b),u_texsize:new g.Uniform2f(_,s.u_texsize),u_mix:new g.Uniform1f(_,s.u_mix),u_pattern_size_a:new g.Uniform2f(_,s.u_pattern_size_a),u_pattern_size_b:new g.Uniform2f(_,s.u_pattern_size_b),u_scale_a:new g.Uniform1f(_,s.u_scale_a),u_scale_b:new g.Uniform1f(_,s.u_scale_b),u_pixel_coord_upper:new g.Uniform2f(_,s.u_pixel_coord_upper),u_pixel_coord_lower:new g.Uniform2f(_,s.u_pixel_coord_lower),u_tile_units_to_pixels:new g.Uniform1f(_,s.u_tile_units_to_pixels)}),terrainRaster:En,terrainDepth:En,skybox:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_sun_direction:new g.Uniform3f(_,s.u_sun_direction),u_cubemap:new g.Uniform1i(_,s.u_cubemap),u_opacity:new g.Uniform1f(_,s.u_opacity),u_temporal_offset:new g.Uniform1f(_,s.u_temporal_offset)}),skyboxGradient:(_,s)=>({u_matrix:new g.UniformMatrix4f(_,s.u_matrix),u_color_ramp:new g.Uniform1i(_,s.u_color_ramp),u_center_direction:new g.Uniform3f(_,s.u_center_direction),u_radius:new g.Uniform1f(_,s.u_radius),u_opacity:new g.Uniform1f(_,s.u_opacity),u_temporal_offset:new g.Uniform1f(_,s.u_temporal_offset)}),skyboxCapture:(_,s)=>({u_matrix_3f:new g.UniformMatrix3f(_,s.u_matrix_3f),u_sun_direction:new g.Uniform3f(_,s.u_sun_direction),u_sun_intensity:new g.Uniform1f(_,s.u_sun_intensity),u_color_tint_r:new g.Uniform4f(_,s.u_color_tint_r),u_color_tint_m:new g.Uniform4f(_,s.u_color_tint_m),u_luminance:new g.Uniform1f(_,s.u_luminance)})};let ku;function vc(_,s,h,v,E,D,R){const B=_.context,z=B.gl,$=_.useProgram("collisionBox"),H=[];let Q=0,J=0;for(let ge=0;ge<v.length;ge++){const ve=v[ge],Me=s.getTile(ve),de=Me.getBucket(h);if(!de)continue;let Fe=ve.projMatrix;0===E[0]&&0===E[1]||(Fe=_.translatePosMatrix(ve.projMatrix,Me,E,D));const Xe=R?de.textCollisionBox:de.iconCollisionBox,it=de.collisionCircleArray;if(it.length>0){const Pe=g.create$1(),Ge=Fe;g.mul$1(Pe,de.placementInvProjMatrix,_.transform.glCoordMatrix),g.mul$1(Pe,Pe,de.placementViewportMatrix),H.push({circleArray:it,circleOffset:J,transform:Ge,invTransform:Pe}),Q+=it.length/4,J=Q}Xe&&(_.terrain&&_.terrain.setupElevationDraw(Me,$),$.draw(B,z.LINES,g.DepthMode.disabled,g.StencilMode.disabled,_.colorModeForRenderPass(),g.CullFaceMode.disabled,Tl(Fe,_.transform,Me),h.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,null,_.transform.zoom,null,Xe.collisionVertexBuffer,Xe.collisionVertexBufferExt))}if(!R||!H.length)return;const te=_.useProgram("collisionCircle"),le=new g.StructArrayLayout2f1f2i16;le.resize(4*Q),le._trim();let ce=0;for(const ge of H)for(let ve=0;ve<ge.circleArray.length/4;ve++){const Me=4*ve,de=ge.circleArray[Me+0],Fe=ge.circleArray[Me+1],Xe=ge.circleArray[Me+2],it=ge.circleArray[Me+3];le.emplace(ce++,de,Fe,Xe,it,0),le.emplace(ce++,de,Fe,Xe,it,1),le.emplace(ce++,de,Fe,Xe,it,2),le.emplace(ce++,de,Fe,Xe,it,3)}(!ku||ku.length<2*Q)&&(ku=function(ge){const ve=2*ge,Me=new g.StructArrayLayout3ui6;Me.resize(ve),Me._trim();for(let de=0;de<ve;de++){const Fe=6*de;Me.uint16[Fe+0]=4*de+0,Me.uint16[Fe+1]=4*de+1,Me.uint16[Fe+2]=4*de+2,Me.uint16[Fe+3]=4*de+2,Me.uint16[Fe+4]=4*de+3,Me.uint16[Fe+5]=4*de+0}return Me}(Q));const _e=B.createIndexBuffer(ku,!0),se=B.createVertexBuffer(le,g.collisionCircleLayout.members,!0);for(const ge of H){const ve={u_matrix:ge.transform,u_inv_matrix:ge.invTransform,u_camera_to_center_distance:(ue=_.transform).cameraToCenterDistance,u_viewport_size:[ue.width,ue.height]};te.draw(B,z.TRIANGLES,g.DepthMode.disabled,g.StencilMode.disabled,_.colorModeForRenderPass(),g.CullFaceMode.disabled,ve,h.id,se,_e,g.SegmentVector.simpleSegment(0,2*ge.circleOffset,ge.circleArray.length,ge.circleArray.length/2),null,_.transform.zoom,null,null,null)}var ue;se.destroy(),_e.destroy()}const uf=g.identity(new Float32Array(16));function hm(_,s,h,v,E,D){const{horizontalAlign:R,verticalAlign:B}=g.getAnchorAlignment(_),z=-(R-.5)*s,$=-(B-.5)*h,H=g.evaluateVariableOffset(_,v);return new g.pointGeometry((z/E+H[0])*D,($/E+H[1])*D)}function hf(_,s,h,v,E,D,R,B,z,$,H,Q){const J=_.text.placedSymbolArray,te=_.text.dynamicLayoutVertexArray,le=_.icon.dynamicLayoutVertexArray,ce={};te.clear();for(let _e=0;_e<J.length;_e++){const se=J.get(_e),ue=_.allowVerticalPlacement&&!se.placedOrientation,ge=se.hidden||!se.crossTileID||ue?null:v[se.crossTileID];if(ge){const ve=new g.pointGeometry(se.tileAnchorX,se.tileAnchorY),Me=Q(ve),de=Ji(ve,h?B:R,Me),Fe=Cn(D.cameraToCenterDistance,de.signedDistanceFromCamera);let Xe=E.evaluateSizeForFeature(_.textSizeData,$,se)*Fe/g.ONE_EM;h&&(Xe*=_.tilePixelRatio/z);const{width:it,height:Pe,anchor:Ge,textOffset:wt,textScale:St}=ge,Mt=hm(Ge,it,Pe,wt,St,Xe),ft=h?Ji(ve.add(Mt),R,Me).point:de.point.add(s?Mt.rotate(-D.angle):Mt),It=_.allowVerticalPlacement&&se.placedOrientation===g.WritingMode.vertical?Math.PI/2:0;for(let Dn=0;Dn<se.numGlyphs;Dn++)g.addDynamicAttributes(te,ft,It);H&&se.associatedIconIndex>=0&&(ce[se.associatedIconIndex]={shiftedAnchor:ft,angle:It})}else Xo(se.numGlyphs,te)}if(H){le.clear();const _e=_.icon.placedSymbolArray;for(let se=0;se<_e.length;se++){const ue=_e.get(se);if(ue.hidden)Xo(ue.numGlyphs,le);else{const ge=ce[se];if(ge)for(let ve=0;ve<ue.numGlyphs;ve++)g.addDynamicAttributes(le,ge.shiftedAnchor,ge.angle);else Xo(ue.numGlyphs,le)}}_.icon.dynamicLayoutVertexBuffer.updateData(le)}_.text.dynamicLayoutVertexBuffer.updateData(te)}function xc(_,s,h){return h.iconsInText&&s?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function df(_,s,h,v,E,D,R,B,z,$,H,Q){const J=_.context,te=J.gl,le=_.transform,ce="map"===B,_e="map"===z,se=ce&&"point"!==h.layout.get("symbol-placement"),ue=ce&&!_e&&!se,ge=void 0!==h.layout.get("symbol-sort-key").constantOr(1);let ve=!1;const Me=_.depthModeForSublayer(0,g.DepthMode.ReadOnly),de=h.layout.get("text-variable-anchor"),Fe=[],Xe=_.terrain&&_e?["PITCH_WITH_MAP_TERRAIN"]:null;for(const it of v){const Pe=s.getTile(it),Ge=Pe.getBucket(h);if(!Ge)continue;const wt=E?Ge.text:Ge.icon;if(!wt||!wt.segments.get().length)continue;const St=wt.programConfigurations.get(h.id),Mt=E||Ge.sdfIcons,ft=E?Ge.textSizeData:Ge.iconSizeData,It=_e||0!==le.pitch,Dn=_.useProgram(xc(Mt,E,Ge),St,Xe),tn=g.evaluateSizeForZoom(ft,le.zoom);let $r,Cr,hn,Mn,zr=[0,0],yo=null;if(E){if(Cr=Pe.glyphAtlasTexture,hn=te.LINEAR,$r=Pe.glyphAtlasTexture.size,Ge.iconsInText){zr=Pe.imageAtlasTexture.size,yo=Pe.imageAtlasTexture;const Fo="composite"===ft.kind||"camera"===ft.kind;Mn=It||_.options.rotating||_.options.zooming||Fo?te.LINEAR:te.NEAREST}}else{const Fo=1!==h.layout.get("icon-size").constantOr(0)||Ge.iconsNeedLinear;Cr=Pe.imageAtlasTexture,hn=Mt||_.options.rotating||_.options.zooming||Fo||It?te.LINEAR:te.NEAREST,$r=Pe.imageAtlasTexture.size}const Po=Br(Pe,1,_.transform.zoom),oo=Xt(it.projMatrix,_e,ce,_.transform,Po),vo=_.terrain&&_e&&se?g.invert(new Float32Array(16),oo):uf,Ms=Wn(it.projMatrix,_e,ce,_.transform,Po),Ro=de&&Ge.hasTextData(),Pn="none"!==h.layout.get("icon-text-fit")&&Ro&&Ge.hasIconData();if(se){const Fo=le.elevation;Wt(Ge,it.projMatrix,_,E,oo,Ms,_e,$,Fo?so=>Fo.getAtTileOffset(it,so.x,so.y):null)}const Tr=_.translatePosMatrix(it.projMatrix,Pe,D,R),Un=se||E&&de||Pn?uf:oo,br=_.translatePosMatrix(Ms,Pe,D,R,!0),Di=Mt&&0!==h.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1);let sr;sr=Mt?Ge.iconsInText?cm(ft.kind,tn,ue,_e,_,Tr,Un,br,$r,zr):ns(ft.kind,tn,ue,_e,_,Tr,Un,br,E,$r,!0):Iu(ft.kind,tn,ue,_e,_,Tr,Un,br,E,$r);const ci={program:Dn,buffers:wt,uniformValues:sr,atlasTexture:Cr,atlasTextureIcon:yo,atlasInterpolation:hn,atlasInterpolationIcon:Mn,isSDF:Mt,hasHalo:Di,tile:Pe,labelPlaneMatrixInv:vo};if(ge&&Ge.canOverlap){ve=!0;const Fo=wt.segments.get();for(const so of Fo)Fe.push({segments:new g.SegmentVector([so]),sortKey:so.sortKey,state:ci})}else Fe.push({segments:wt.segments,sortKey:0,state:ci})}ve&&Fe.sort((it,Pe)=>it.sortKey-Pe.sortKey);for(const it of Fe){const Pe=it.state;if(_.terrain&&_.terrain.setupElevationDraw(Pe.tile,Pe.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:Pe.labelPlaneMatrixInv}),J.activeTexture.set(te.TEXTURE0),Pe.atlasTexture.bind(Pe.atlasInterpolation,te.CLAMP_TO_EDGE),Pe.atlasTextureIcon&&(J.activeTexture.set(te.TEXTURE1),Pe.atlasTextureIcon&&Pe.atlasTextureIcon.bind(Pe.atlasInterpolationIcon,te.CLAMP_TO_EDGE)),Pe.isSDF){const Ge=Pe.uniformValues;Pe.hasHalo&&(Ge.u_is_halo=1,bc(Pe.buffers,it.segments,h,_,Pe.program,Me,H,Q,Ge)),Ge.u_is_halo=0}bc(Pe.buffers,it.segments,h,_,Pe.program,Me,H,Q,Pe.uniformValues)}}function bc(_,s,h,v,E,D,R,B,z){const $=v.context;E.draw($,$.gl.TRIANGLES,D,R,B,g.CullFaceMode.disabled,z,h.id,_.layoutVertexBuffer,_.indexBuffer,s,h.paint,v.transform.zoom,_.programConfigurations.get(h.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function wc(_,s,h,v,E,D,R){const B=_.context.gl,z=h.paint.get("fill-pattern"),$=z&&z.constantOr(1),H=h.getCrossfadeParameters();let Q,J,te,le,ce;R?(J=$&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Q=B.LINES):(J=$?"fillPattern":"fill",Q=B.TRIANGLES);for(const _e of v){const se=s.getTile(_e);if($&&!se.patternsLoaded())continue;const ue=se.getBucket(h);if(!ue)continue;_.prepareDrawTile(_e);const ge=ue.programConfigurations.get(h.id),ve=_.useProgram(J,ge);$&&(_.context.activeTexture.set(B.TEXTURE0),se.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),ge.updatePaintBuffers(H));const Me=z.constantOr(null);if(Me&&se.imageAtlas){const Fe=se.imageAtlas,Xe=Fe.patternPositions[Me.to.toString()],it=Fe.patternPositions[Me.from.toString()];Xe&&it&&ge.setConstantPatternPositions(Xe,it)}const de=_.translatePosMatrix(_e.projMatrix,se,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(R){le=ue.indexBuffer2,ce=ue.segments2;const Fe=_.terrain&&_.terrain.renderingToTexture?_.terrain.drapeBufferSize:[B.drawingBufferWidth,B.drawingBufferHeight];te="fillOutlinePattern"===J&&$?Ln(de,_,H,se,Fe):ts(de,Fe)}else le=ue.indexBuffer,ce=ue.segments,te=$?bs(de,_,H,se):Ys(de);_.prepareDrawProgram(_.context,ve,_e.toUnwrapped()),ve.draw(_.context,Q,E,_.stencilModeForClipping(_e),D,g.CullFaceMode.disabled,te,h.id,ue.layoutVertexBuffer,le,ce,h.paint,_.transform.zoom,ge)}}function Fd(_,s,h,v,E,D,R){const B=_.context,z=B.gl,$=h.paint.get("fill-extrusion-pattern"),H=$.constantOr(1),Q=h.getCrossfadeParameters(),J=h.paint.get("fill-extrusion-opacity");for(const te of v){const le=s.getTile(te),ce=le.getBucket(h);if(!ce)continue;const _e=ce.programConfigurations.get(h.id),se=_.useProgram(H?"fillExtrusionPattern":"fillExtrusion",_e);if(_.terrain){const de=_.terrain;if(!ce.enableTerrain)continue;if(de.setupElevationDraw(le,se,{useMeterToDem:!0}),Af(B,s,te,ce,h,de),!ce.centroidVertexBuffer){const Fe=se.attributes.a_centroid_pos;void 0!==Fe&&z.vertexAttrib2f(Fe,0,0)}}H&&(_.context.activeTexture.set(z.TEXTURE0),le.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),_e.updatePaintBuffers(Q));const ue=$.constantOr(null);if(ue&&le.imageAtlas){const de=le.imageAtlas,Fe=de.patternPositions[ue.to.toString()],Xe=de.patternPositions[ue.from.toString()];Fe&&Xe&&_e.setConstantPatternPositions(Fe,Xe)}const ge=_.translatePosMatrix(te.projMatrix,le,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),ve=h.paint.get("fill-extrusion-vertical-gradient"),Me=H?To(ge,_,ve,J,te,Q,le):Ja(ge,_,ve,J);_.prepareDrawProgram(B,se,te.toUnwrapped()),se.draw(B,B.gl.TRIANGLES,E,D,R,g.CullFaceMode.backCCW,Me,h.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,h.paint,_.transform.zoom,_e,_.terrain?ce.centroidVertexBuffer:null)}}function Af(_,s,h,v,E,D){const R=[se=>{let ue=se.canonical.x-1,ge=se.wrap;return ue<0&&(ue=(1<<se.canonical.z)-1,ge--),new g.OverscaledTileID(se.overscaledZ,ge,se.canonical.z,ue,se.canonical.y)},se=>{let ue=se.canonical.x+1,ge=se.wrap;return ue===1<<se.canonical.z&&(ue=0,ge++),new g.OverscaledTileID(se.overscaledZ,ge,se.canonical.z,ue,se.canonical.y)},se=>new g.OverscaledTileID(se.overscaledZ,se.wrap,se.canonical.z,se.canonical.x,(0===se.canonical.y?1<<se.canonical.z:se.canonical.y)-1),se=>new g.OverscaledTileID(se.overscaledZ,se.wrap,se.canonical.z,se.canonical.x,se.canonical.y===(1<<se.canonical.z)-1?0:se.canonical.y+1)],B=se=>{const ue=s.getSource().maxzoom,ge=Fe=>{const Xe=s.getTileByID(Fe);if(Xe&&Xe.hasData())return Xe.getBucket(E)};let ve,Me,de;return(se.overscaledZ===se.canonical.z||se.overscaledZ>=ue)&&(ve=ge(se.key)),se.overscaledZ>=ue&&(Me=ge(se.calculateScaledKey(se.overscaledZ+1))),se.overscaledZ>ue&&(de=ge(se.calculateScaledKey(se.overscaledZ-1))),ve||Me||de},z=[0,0,0],$=(se,ue)=>(z[0]=Math.min(se.min.y,ue.min.y),z[1]=Math.max(se.max.y,ue.max.y),z[2]=g.EXTENT-ue.min.x>se.max.x?ue.min.x-g.EXTENT:se.max.x,z),H=(se,ue)=>(z[0]=Math.min(se.min.x,ue.min.x),z[1]=Math.max(se.max.x,ue.max.x),z[2]=g.EXTENT-ue.min.y>se.max.y?ue.min.y-g.EXTENT:se.max.y,z),Q=[(se,ue)=>$(se,ue),(se,ue)=>$(ue,se),(se,ue)=>H(se,ue),(se,ue)=>H(ue,se)],J=new g.pointGeometry(0,0);let te,le,ce;const _e=(se,ue,ge,ve,Me)=>{const de=[[ve?ge:se,ve?se:ge,0],[ve?ge:ue,ve?ue:ge,0]],Fe=Me<0?g.EXTENT+Me:Me,Xe=[ve?Fe:(se+ue)/2,ve?(se+ue)/2:Fe,0];return 0===ge&&Me<0||0!==ge&&Me>0?D.getForTilePoints(ce,[Xe],!0,le):de.push(Xe),D.getForTilePoints(h,de,!0,te),Math.max(de[0][2],de[1][2],Xe[2])/D.exaggeration()};for(let se=0;se<4;se++){const ue=v.borders[se];if(0===ue.length&&(v.borderDone[se]=!0),v.borderDone[se])continue;const ge=ce=R[se](h),ve=B(ge);if(!(ve&&ve.enableTerrain&&(le=D.findDEMTileFor(ge),le&&le.dem)))continue;if(!te){const Xe=D.findDEMTileFor(h);if(!Xe||!Xe.dem)return;te=Xe}const Me=(se<2?1:5)-se,de=ve.borders[Me];let Fe=0;for(let Xe=0;Xe<ue.length;Xe++){const it=v.featuresOnBorder[ue[Xe]],Pe=it.borders[se];let Ge;for(;Fe<de.length&&(Ge=ve.featuresOnBorder[de[Fe]],!(Ge.borders[Me][1]>Pe[0]+3));)ve.borderDone[Me]||ve.encodeCentroid(void 0,Ge,!1),Fe++;if(Ge&&Fe<de.length){const wt=Fe;let St=0;for(;!(Ge.borders[Me][0]>Pe[1]-3)&&(St++,++Fe!==de.length);)Ge=ve.featuresOnBorder[de[Fe]];if(Ge=ve.featuresOnBorder[de[wt]],it.intersectsCount()>1||Ge.intersectsCount()>1||1!==St){1!==St&&(Fe=wt),v.encodeCentroid(void 0,it,!1),ve.borderDone[Me]||ve.encodeCentroid(void 0,Ge,!1);continue}const Mt=Q[se](it,Ge),ft=se%2?g.EXTENT-1:0;J.x=_e(Mt[0],Math.min(g.EXTENT-1,Mt[1]),ft,se<2,Mt[2]),J.y=0,v.encodeCentroid(J,it,!1),ve.borderDone[Me]||ve.encodeCentroid(J,Ge,!1)}else v.encodeCentroid(void 0,it,!1)}v.borderDone[se]=v.needsCentroidUpdate=!0,ve.borderDone[Me]||(ve.borderDone[Me]=ve.needsCentroidUpdate=!0)}(v.needsCentroidUpdate||!v.centroidVertexBuffer&&0!==v.centroidVertexArray.length)&&v.uploadCentroid(_)}const or=new g.Color(1,0,0,1),Od=new g.Color(0,1,0,1),D0=new g.Color(0,0,1,1),Ld=new g.Color(1,0,1,1),Pl=new g.Color(0,1,1,1);function dm(_,s,h,v){Ih(_,0,s+h/2,_.transform.width,h,v)}function Am(_,s,h,v){Ih(_,s-h/2,0,h,_.transform.height,v)}function Ih(_,s,h,v,E,D){const R=_.context,B=R.gl;B.enable(B.SCISSOR_TEST),B.scissor(s*g.exported.devicePixelRatio,h*g.exported.devicePixelRatio,v*g.exported.devicePixelRatio,E*g.exported.devicePixelRatio),R.clear({color:D}),B.disable(B.SCISSOR_TEST)}function Rl(_,s,h){const v=_.context,E=v.gl,D=h.projMatrix,R=_.useProgram("debug"),B=s.getTileByID(h.key);_.terrain&&_.terrain.setupElevationDraw(B,R);const z=g.DepthMode.disabled,$=g.StencilMode.disabled,H=_.colorModeForRenderPass(),Q="$debug";v.activeTexture.set(E.TEXTURE0),_.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),R.draw(v,E.LINE_STRIP,z,$,H,g.CullFaceMode.disabled,yc(D,g.Color.red),Q,_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments);const J=B.latestRawTileData,te=Math.floor((J&&J.byteLength||0)/1024),le=s.getTile(h).tileSize,ce=512/Math.min(le,512)*(h.overscaledZ/_.transform.zoom)*.5;let _e=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(_e+=` => ${h.overscaledZ}`),function(se,ue){se.initDebugOverlayCanvas();const ge=se.debugOverlayCanvas,ve=se.context.gl,Me=se.debugOverlayCanvas.getContext("2d");Me.clearRect(0,0,ge.width,ge.height),Me.shadowColor="white",Me.shadowBlur=2,Me.lineWidth=1.5,Me.strokeStyle="white",Me.textBaseline="top",Me.font="bold 36px Open Sans, sans-serif",Me.fillText(ue,5,5),Me.strokeText(ue,5,5),se.debugOverlayTexture.update(ge),se.debugOverlayTexture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE)}(_,`${_e} ${te}kb`),R.draw(v,E.TRIANGLES,z,$,g.ColorMode.alphaBlended,g.CullFaceMode.disabled,yc(D,g.Color.transparent,ce),Q,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments)}const kh=g.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Sr}=kh;function rs(_,s,h,v){_.emplaceBack(s,h,v)}class Ph{constructor(s){this.vertexArray=new g.StructArrayLayout3f12,this.indices=new g.StructArrayLayout3ui6,rs(this.vertexArray,-1,-1,1),rs(this.vertexArray,1,-1,1),rs(this.vertexArray,-1,1,1),rs(this.vertexArray,1,1,1),rs(this.vertexArray,-1,-1,-1),rs(this.vertexArray,1,-1,-1),rs(this.vertexArray,-1,1,-1),rs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,Sr),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=g.SegmentVector.simpleSegment(0,0,36,12)}}function tl(_,s,h,v,E,D){const R=_.gl,B=s.paint.get("sky-atmosphere-color"),z=s.paint.get("sky-atmosphere-halo-color"),$=s.paint.get("sky-atmosphere-sun-intensity"),H={u_matrix_3f:g.fromMat4([],v),u_sun_direction:E,u_sun_intensity:$,u_color_tint_r:[(le=B).r,le.g,le.b,le.a],u_color_tint_m:[(ce=z).r,ce.g,ce.b,ce.a],u_luminance:5e-5};var le,ce;R.framebufferTexture2D(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,R.TEXTURE_CUBE_MAP_POSITIVE_X+D,s.skyboxTexture,0),h.draw(_,R.TRIANGLES,g.DepthMode.disabled,g.StencilMode.disabled,g.ColorMode.unblended,g.CullFaceMode.frontCW,H,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}const Rh={symbol:function(_,s,h,v,E){if("translucent"!==_.renderPass)return;const D=g.StencilMode.disabled,R=_.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(B,z,$,H,Q,J,te){const le=z.transform,ce="map"===Q,_e="map"===J;for(const se of B){const ue=H.getTile(se),ge=ue.getBucket($);if(!ge||!ge.text||!ge.text.segments.get().length)continue;const ve=g.evaluateSizeForZoom(ge.textSizeData,le.zoom),Me=Br(ue,1,z.transform.zoom),de=Xt(se.projMatrix,_e,ce,z.transform,Me),Fe="none"!==$.layout.get("icon-text-fit")&&ge.hasIconData();if(ve){const Xe=Math.pow(2,le.zoom-ue.tileID.overscaledZ),it=le.elevation;hf(ge,ce,_e,te,g.symbolSize,le,de,se.projMatrix,Xe,ve,Fe,it?Pe=>it.getAtTileOffset(se,Pe.x,Pe.y):Pe=>0)}}}(v,_,h,s,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),E),0!==h.paint.get("icon-opacity").constantOr(1)&&df(_,s,h,v,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),D,R),0!==h.paint.get("text-opacity").constantOr(1)&&df(_,s,h,v,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),D,R),s.map.showCollisionBoxes&&(vc(_,s,h,v,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),vc(_,s,h,v,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(_,s,h,v){if("translucent"!==_.renderPass)return;const E=h.paint.get("circle-opacity"),D=h.paint.get("circle-stroke-width"),R=h.paint.get("circle-stroke-opacity"),B=void 0!==h.layout.get("circle-sort-key").constantOr(1);if(0===E.constantOr(1)&&(0===D.constantOr(1)||0===R.constantOr(1)))return;const z=_.context,$=z.gl,H=_.depthModeForSublayer(0,g.DepthMode.ReadOnly),Q=g.StencilMode.disabled,J=_.colorModeForRenderPass(),te=[];for(let le=0;le<v.length;le++){const ce=v[le],_e=s.getTile(ce),se=_e.getBucket(h);if(!se)continue;const ue=se.programConfigurations.get(h.id),ge=Sh(h),ve={programConfiguration:ue,program:_.useProgram("circle",ue,ge),layoutVertexBuffer:se.layoutVertexBuffer,indexBuffer:se.indexBuffer,uniformValues:Pd(_,ce,_e,h),tile:_e};if(B){const Me=se.segments.get();for(const de of Me)te.push({segments:new g.SegmentVector([de]),sortKey:de.sortKey,state:ve})}else te.push({segments:se.segments,sortKey:0,state:ve})}B&&te.sort((le,ce)=>le.sortKey-ce.sortKey);for(const le of te){const{programConfiguration:ce,program:_e,layoutVertexBuffer:se,indexBuffer:ue,uniformValues:ge,tile:ve}=le.state,Me=le.segments;_.terrain&&_.terrain.setupElevationDraw(ve,_e,{useDepthForOcclusion:!0}),_.prepareDrawProgram(z,_e,ve.tileID.toUnwrapped()),_e.draw(z,$.TRIANGLES,H,Q,J,g.CullFaceMode.disabled,ge,h.id,se,ue,Me,h.paint,_.transform.zoom,ce)}},heatmap:function(_,s,h,v){if(0!==h.paint.get("heatmap-opacity"))if("offscreen"===_.renderPass){const E=_.context,D=E.gl,R=g.StencilMode.disabled,B=new g.ColorMode([D.ONE,D.ONE],g.Color.transparent,[!0,!0,!0,!0]);(function(z,$,H){const Q=z.gl;z.activeTexture.set(Q.TEXTURE1),z.viewport.set([0,0,$.width/4,$.height/4]);let J=H.heatmapFbo;if(J)Q.bindTexture(Q.TEXTURE_2D,J.colorAttachment.get()),z.bindFramebuffer.set(J.framebuffer);else{const te=Q.createTexture();Q.bindTexture(Q.TEXTURE_2D,te),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MAG_FILTER,Q.LINEAR),J=H.heatmapFbo=z.createFramebuffer($.width/4,$.height/4,!1),function(le,ce,_e,se){const ue=le.gl;ue.texImage2D(ue.TEXTURE_2D,0,ue.RGBA,ce.width/4,ce.height/4,0,ue.RGBA,le.extRenderToTextureHalfFloat?le.extTextureHalfFloat.HALF_FLOAT_OES:ue.UNSIGNED_BYTE,null),se.colorAttachment.set(_e)}(z,$,te,J)}})(E,_,h),E.clear({color:g.Color.transparent});for(let z=0;z<v.length;z++){const $=v[z];if(s.hasRenderableParent($))continue;const H=s.getTile($),Q=H.getBucket(h);if(!Q)continue;const J=Q.programConfigurations.get(h.id),te=_.useProgram("heatmap",J),{zoom:le}=_.transform;_.terrain&&_.terrain.setupElevationDraw(H,te),_.prepareDrawProgram(E,te,$.toUnwrapped()),te.draw(E,D.TRIANGLES,g.DepthMode.disabled,R,B,g.CullFaceMode.disabled,Il($.projMatrix,H,le,h.paint.get("heatmap-intensity")),h.id,Q.layoutVertexBuffer,Q.indexBuffer,Q.segments,h.paint,_.transform.zoom,J)}E.viewport.set([0,0,_.width,_.height])}else"translucent"===_.renderPass&&(_.context.setColorMode(_.colorModeForRenderPass()),function(E,D){const R=E.context,B=R.gl,z=D.heatmapFbo;if(!z)return;R.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,z.colorAttachment.get()),R.activeTexture.set(B.TEXTURE1);let $=D.colorRampTexture;$||($=D.colorRampTexture=new g.Texture(R,D.colorRamp,B.RGBA)),$.bind(B.LINEAR,B.CLAMP_TO_EDGE),E.useProgram("heatmapTexture").draw(R,B.TRIANGLES,g.DepthMode.disabled,g.StencilMode.disabled,E.colorModeForRenderPass(),g.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:D.paint.get("heatmap-opacity")},D.id,E.viewportBuffer,E.quadTriangleIndexBuffer,E.viewportSegments,D.paint,E.transform.zoom)}(_,h))},line:function(_,s,h,v){if("translucent"!==_.renderPass)return;const E=h.paint.get("line-opacity"),D=h.paint.get("line-width");if(0===E.constantOr(1)||0===D.constantOr(1))return;const R=_.depthModeForSublayer(0,g.DepthMode.ReadOnly),B=_.colorModeForRenderPass(),z=h.paint.get("line-dasharray"),$=z.constantOr(1),H=h.layout.get("line-cap"),Q=h.paint.get("line-pattern"),J=Q.constantOr(1),te=h.paint.get("line-gradient"),le=h.getCrossfadeParameters(),ce=J?"linePattern":"line",_e=_.context,se=_e.gl;for(const ue of v){const ge=s.getTile(ue);if(J&&!ge.patternsLoaded())continue;const ve=ge.getBucket(h);if(!ve)continue;_.prepareDrawTile(ue);const Me=ve.programConfigurations.get(h.id),de=ws(h),Fe=_.useProgram(ce,Me,de),Xe=Q.constantOr(null);if(Xe&&ge.imageAtlas){const St=ge.imageAtlas,Mt=St.patternPositions[Xe.to.toString()],ft=St.patternPositions[Xe.from.toString()];Mt&&ft&&Me.setConstantPatternPositions(Mt,ft)}const it=z.constantOr(null),Pe=H.constantOr(null);if(!J&&it&&Pe&&ge.lineAtlas){const St=ge.lineAtlas,Mt=St.getDash(it.to,Pe),ft=St.getDash(it.from,Pe);Mt&&ft&&Me.setConstantPatternPositions(Mt,ft)}const Ge=_.terrain?ue.projMatrix:null,wt=J?Sa(_,ge,h,le,Ge):kl(_,ge,h,le,Ge,ve.lineClipsArray.length);if(te){const St=ve.gradients[h.id];let Mt=St.texture;if(h.gradientVersion!==St.version){let ft=256;if(h.stepInterpolant){const It=s.getSource().maxzoom,Dn=ue.canonical.z===It?Math.ceil(1<<_.transform.maxZoom-ue.canonical.z):1;ft=g.clamp(g.nextPowerOfTwo(ve.maxLineLength/g.EXTENT*1024*Dn),256,_e.maxTextureSize)}St.gradient=g.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:ft,image:St.gradient||void 0,clips:ve.lineClipsArray}),St.texture?St.texture.update(St.gradient):St.texture=new g.Texture(_e,St.gradient,se.RGBA),St.version=h.gradientVersion,Mt=St.texture}_e.activeTexture.set(se.TEXTURE1),Mt.bind(h.stepInterpolant?se.NEAREST:se.LINEAR,se.CLAMP_TO_EDGE)}$&&(_e.activeTexture.set(se.TEXTURE0),ge.lineAtlasTexture.bind(se.LINEAR,se.REPEAT),Me.updatePaintBuffers(le)),J&&(_e.activeTexture.set(se.TEXTURE0),ge.imageAtlasTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE),Me.updatePaintBuffers(le)),_.prepareDrawProgram(_e,Fe,ue.toUnwrapped()),Fe.draw(_e,se.TRIANGLES,R,_.stencilModeForClipping(ue),B,g.CullFaceMode.disabled,wt,h.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,h.paint,_.transform.zoom,Me,ve.layoutVertexBuffer2)}},fill:function(_,s,h,v){const E=h.paint.get("fill-color"),D=h.paint.get("fill-opacity");if(0===D.constantOr(1))return;const R=_.colorModeForRenderPass(),B=h.paint.get("fill-pattern"),z=_.opaquePassEnabledForLayer()&&!B.constantOr(1)&&1===E.constantOr(g.Color.transparent).a&&1===D.constantOr(0)?"opaque":"translucent";if(_.renderPass===z){const $=_.depthModeForSublayer(1,"opaque"===_.renderPass?g.DepthMode.ReadWrite:g.DepthMode.ReadOnly);wc(_,s,h,v,$,R,!1)}if("translucent"===_.renderPass&&h.paint.get("fill-antialias")){const $=_.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,g.DepthMode.ReadOnly);wc(_,s,h,v,$,R,!0)}},"fill-extrusion":function(_,s,h,v){const E=h.paint.get("fill-extrusion-opacity");if(0!==E&&"translucent"===_.renderPass){const D=new g.DepthMode(_.context.gl.LEQUAL,g.DepthMode.ReadWrite,_.depthRangeFor3D);if(1!==E||h.paint.get("fill-extrusion-pattern").constantOr(1))Fd(_,s,h,v,D,g.StencilMode.disabled,g.ColorMode.disabled),Fd(_,s,h,v,D,_.stencilModeFor3D(),_.colorModeForRenderPass());else{const R=_.colorModeForRenderPass();Fd(_,s,h,v,D,g.StencilMode.disabled,R)}}},hillshade:function(_,s,h,v){if("offscreen"!==_.renderPass&&"translucent"!==_.renderPass)return;const E=_.context,D=_.depthModeForSublayer(0,g.DepthMode.ReadOnly),R=_.colorModeForRenderPass(),B=_.terrain&&_.terrain.renderingToTexture,[z,$]="translucent"!==_.renderPass||B?[{},v]:_.stencilConfigForOverlap(v);for(const H of $){const Q=s.getTile(H);if(Q.needsHillshadePrepare&&"offscreen"===_.renderPass)At(_,Q,h,D,g.StencilMode.disabled,R);else if("translucent"===_.renderPass){const J=B&&_.terrain?_.terrain.stencilModeForRTTOverlap(H):z[H.overscaledZ];Mh(_,H,Q,h,D,J,R)}}E.viewport.set([0,0,_.width,_.height])},raster:function(_,s,h,v,E,D){if("translucent"!==_.renderPass||0===h.paint.get("raster-opacity")||!v.length)return;const R=_.context,B=R.gl,z=s.getSource(),$=_.useProgram("raster"),H=_.colorModeForRenderPass(),Q=_.terrain&&_.terrain.renderingToTexture,[J,te]=z instanceof ne||Q?[{},v]:_.stencilConfigForOverlap(v),le=te[te.length-1].overscaledZ,ce=!_.options.moving;for(const _e of te){const se=Q?g.DepthMode.disabled:_.depthModeForSublayer(_e.overscaledZ-le,1===h.paint.get("raster-opacity")?g.DepthMode.ReadWrite:g.DepthMode.ReadOnly,B.LESS),ue=_e.toUnwrapped(),ge=s.getTile(_e);if(Q&&(!ge||!ge.hasData()))continue;const ve=Q?_e.projMatrix:_.transform.calculateProjMatrix(ue,ce),Me=_.terrain&&Q?_.terrain.stencilModeForRTTOverlap(_e):J[_e.overscaledZ],de=D?0:h.paint.get("raster-fade-duration");ge.registerFadeDuration(de);const Fe=s.findLoadedParent(_e,0),Xe=Yr(ge,Fe,s,_.transform,de);let it,Pe;_.terrain&&_.terrain.prepareDrawTile(_e);const Ge="nearest"===h.paint.get("raster-resampling")?B.NEAREST:B.LINEAR;R.activeTexture.set(B.TEXTURE0),ge.texture.bind(Ge,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),R.activeTexture.set(B.TEXTURE1),Fe?(Fe.texture.bind(Ge,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),it=Math.pow(2,Fe.tileID.overscaledZ-ge.tileID.overscaledZ),Pe=[ge.tileID.canonical.x*it%1,ge.tileID.canonical.y*it%1]):ge.texture.bind(Ge,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST);const wt=el(ve,Pe||[0,0],it||1,Xe,h);_.prepareDrawProgram(R,$,ue),z instanceof ne?$.draw(R,B.TRIANGLES,se,g.StencilMode.disabled,H,g.CullFaceMode.disabled,wt,h.id,z.boundsBuffer,_.quadTriangleIndexBuffer,z.boundsSegments):$.draw(R,B.TRIANGLES,se,Me,H,g.CullFaceMode.disabled,wt,h.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}},background:function(_,s,h,v){const E=h.paint.get("background-color"),D=h.paint.get("background-opacity");if(0===D)return;const R=_.context,B=R.gl,z=_.transform,$=z.tileSize,H=h.paint.get("background-pattern");if(_.isPatternMissing(H))return;const Q=!H&&1===E.a&&1===D&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==Q)return;const J=g.StencilMode.disabled,te=_.depthModeForSublayer(0,"opaque"===Q?g.DepthMode.ReadWrite:g.DepthMode.ReadOnly),le=_.colorModeForRenderPass(),ce=_.useProgram(H?"backgroundPattern":"background"),_e=v||z.coveringTiles({tileSize:$});H&&(R.activeTexture.set(B.TEXTURE0),_.imageManager.bind(_.context));const se=h.getCrossfadeParameters();for(const ue of _e){const ge=ue.toUnwrapped(),ve=v?ue.projMatrix:_.transform.calculateProjMatrix(ge);_.prepareDrawTile(ue);const Me=H?um(ve,D,_,H,{tileID:ue,tileSize:$},se):E0(ve,D,E);_.prepareDrawProgram(R,ce,ge),ce.draw(R,B.TRIANGLES,te,J,le,g.CullFaceMode.disabled,Me,h.id,_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}},sky:function(_,s,h){const v=h.paint.get("sky-opacity");if(0===v)return;const E=_.context,D=h.paint.get("sky-type"),R=new g.DepthMode(E.gl.LEQUAL,g.DepthMode.ReadOnly,[0,1]),B=_.frameCounter/1e3%1;"atmosphere"===D?"offscreen"===_.renderPass?h.needsSkyboxCapture(_)&&(function(z,$,H,Q){const J=z.context,te=J.gl;let le=$.skyboxFbo;if(!le){le=$.skyboxFbo=J.createFramebuffer(32,32,!1),$.skyboxGeometry=new Ph(J),$.skyboxTexture=J.gl.createTexture(),te.bindTexture(te.TEXTURE_CUBE_MAP,$.skyboxTexture),te.texParameteri(te.TEXTURE_CUBE_MAP,te.TEXTURE_WRAP_S,te.CLAMP_TO_EDGE),te.texParameteri(te.TEXTURE_CUBE_MAP,te.TEXTURE_WRAP_T,te.CLAMP_TO_EDGE),te.texParameteri(te.TEXTURE_CUBE_MAP,te.TEXTURE_MIN_FILTER,te.LINEAR),te.texParameteri(te.TEXTURE_CUBE_MAP,te.TEXTURE_MAG_FILTER,te.LINEAR);for(let ue=0;ue<6;++ue)te.texImage2D(te.TEXTURE_CUBE_MAP_POSITIVE_X+ue,0,te.RGBA,32,32,0,te.RGBA,te.UNSIGNED_BYTE,null)}J.bindFramebuffer.set(le.framebuffer),J.viewport.set([0,0,32,32]);const ce=$.getCenter(z,!0),_e=z.useProgram("skyboxCapture"),se=new Float64Array(16);g.identity(se),g.rotateY(se,se,.5*-Math.PI),tl(J,$,_e,se,ce,0),g.identity(se),g.rotateY(se,se,.5*Math.PI),tl(J,$,_e,se,ce,1),g.identity(se),g.rotateX(se,se,.5*-Math.PI),tl(J,$,_e,se,ce,2),g.identity(se),g.rotateX(se,se,.5*Math.PI),tl(J,$,_e,se,ce,3),g.identity(se),tl(J,$,_e,se,ce,4),g.identity(se),g.rotateY(se,se,Math.PI),tl(J,$,_e,se,ce,5),J.viewport.set([0,0,z.width,z.height])}(_,h),h.markSkyboxValid(_)):"sky"===_.renderPass&&function(z,$,H,Q,J){const te=z.context,le=te.gl,ce=z.transform,_e=z.useProgram("skybox");te.activeTexture.set(le.TEXTURE0),le.bindTexture(le.TEXTURE_CUBE_MAP,$.skyboxTexture);const se={u_matrix:ce.skyboxMatrix,u_sun_direction:$.getCenter(z,!1),u_cubemap:0,u_opacity:Q,u_temporal_offset:J};z.prepareDrawProgram(te,_e),_e.draw(te,le.TRIANGLES,H,g.StencilMode.disabled,z.colorModeForRenderPass(),g.CullFaceMode.backCW,se,"skybox",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(_,h,R,v,B):"gradient"===D&&"sky"===_.renderPass&&function(z,$,H,Q,J){const te=z.context,le=te.gl,ce=z.transform,_e=z.useProgram("skyboxGradient");$.skyboxGeometry||($.skyboxGeometry=new Ph(te)),te.activeTexture.set(le.TEXTURE0);let se=$.colorRampTexture;se||(se=$.colorRampTexture=new g.Texture(te,$.colorRamp,le.RGBA)),se.bind(le.LINEAR,le.CLAMP_TO_EDGE);const ue=(ge=ce.skyboxMatrix,ve=$.getCenter(z,!1),Me=$.paint.get("sky-gradient-radius"),de=Q,Fe=J,{u_matrix:ge,u_color_ramp:0,u_center_direction:ve,u_radius:g.degToRad(Me),u_opacity:de,u_temporal_offset:Fe});var ge,ve,Me,de,Fe;z.prepareDrawProgram(te,_e),_e.draw(te,le.TRIANGLES,H,g.StencilMode.disabled,z.colorModeForRenderPass(),g.CullFaceMode.backCW,ue,"skyboxGradient",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(_,h,R,v,B)},debug:function(_,s,h){for(let v=0;v<h.length;v++)Rl(_,s,h[v])},custom:function(_,s,h){const v=_.context,E=h.implementation;if("offscreen"===_.renderPass){const D=E.prerender;D&&(_.setCustomLayerDefaults(),v.setColorMode(_.colorModeForRenderPass()),D.call(E,v.gl,_.transform.customLayerMatrix()),v.setDirty(),_.setBaseState())}else if("translucent"===_.renderPass){_.setCustomLayerDefaults(),v.setColorMode(_.colorModeForRenderPass()),v.setStencilMode(g.StencilMode.disabled);const D="3d"===E.renderingMode?new g.DepthMode(_.context.gl.LEQUAL,g.DepthMode.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,g.DepthMode.ReadOnly);v.setDepthMode(D),E.render(v.gl,_.transform.customLayerMatrix()),v.setDirty(),_.setBaseState(),v.bindFramebuffer.set(null)}}};class Pu{constructor(s,h){this.context=new un(s),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=g.SourceCache.maxUnderzooming+g.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ws,this.gpuTimers={},this.frameCounter=0}updateTerrain(s,h){const v=!!s&&!!s.terrain;if(!(v||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new yn(this,s));const E=this._terrain;this.transform.elevation=v?E:null,E.update(s,this.transform,h)}_updateFog(s){const h=s.fog;if(!h||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[v,E]=h.getFovAdjustedRange(this.transform._fov);if(v>E)return void(this.transform.fogCullDistSq=null);const D=v+.78*(E-v);this.transform.fogCullDistSq=D*D}get terrain(){return this._terrain&&this._terrain.enabled?this._terrain:null}resize(s,h){if(this.width=s*g.exported.devicePixelRatio,this.height=h*g.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style.order)this.style._layers[v].resize()}setup(){const s=this.context,h=new g.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(g.EXTENT,0),h.emplaceBack(0,g.EXTENT),h.emplaceBack(g.EXTENT,g.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(h,g.posAttributes.members),this.tileExtentSegments=g.SegmentVector.simpleSegment(0,0,4,2);const v=new g.StructArrayLayout2i4;v.emplaceBack(0,0),v.emplaceBack(g.EXTENT,0),v.emplaceBack(0,g.EXTENT),v.emplaceBack(g.EXTENT,g.EXTENT),this.debugBuffer=s.createVertexBuffer(v,g.posAttributes.members),this.debugSegments=g.SegmentVector.simpleSegment(0,0,4,5);const E=new g.StructArrayLayout4i8;E.emplaceBack(0,0,0,0),E.emplaceBack(g.EXTENT,0,g.EXTENT,0),E.emplaceBack(0,g.EXTENT,0,g.EXTENT),E.emplaceBack(g.EXTENT,g.EXTENT,g.EXTENT,g.EXTENT),this.rasterBoundsBuffer=s.createVertexBuffer(E,Zn.members),this.rasterBoundsSegments=g.SegmentVector.simpleSegment(0,0,4,2);const D=new g.StructArrayLayout2i4;D.emplaceBack(-1,-1),D.emplaceBack(1,-1),D.emplaceBack(-1,1),D.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(D,g.posAttributes.members),this.viewportSegments=g.SegmentVector.simpleSegment(0,0,4,2);const R=new g.StructArrayLayout1ui2;R.emplaceBack(0),R.emplaceBack(1),R.emplaceBack(3),R.emplaceBack(2),R.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(R);const B=new g.StructArrayLayout3ui6;B.emplaceBack(0,1,2),B.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(B),this.emptyTexture=new g.Texture(s,{width:1,height:1,data:new Uint8Array([0,0,0,0])},s.gl.RGBA),this.identityMat=g.create$1();const z=this.context.gl;this.stencilClearMode=new g.StencilMode({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.loadTimeStamps.push(g.window.performance.now())}clearStencil(){const s=this.context,h=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this.useProgram("clippingMask").draw(s,h.TRIANGLES,g.DepthMode.disabled,this.stencilClearMode,g.ColorMode.disabled,g.CullFaceMode.disabled,Xs(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(s,h,v){if(!(h&&this.currentStencilSource!==h.id&&s.isTileClipped()&&v&&v.length))return;this.currentStencilSource=h.id;const E=this.context,D=E.gl;this.nextStencilID+v.length>256&&this.clearStencil(),E.setColorMode(g.ColorMode.disabled),E.setDepthMode(g.DepthMode.disabled);const R=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const B of v){const z=this._tileClippingMaskIDs[B.key]=this.nextStencilID++;R.draw(E,D.TRIANGLES,g.DepthMode.disabled,new g.StencilMode({func:D.ALWAYS,mask:0},z,255,D.KEEP,D.KEEP,D.REPLACE),g.ColorMode.disabled,g.CullFaceMode.disabled,Xs(B.projMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,h=this.context.gl;return new g.StencilMode({func:h.NOTEQUAL,mask:255},s,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);const h=this.context.gl;return new g.StencilMode({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(s){const h=this.context.gl,v=s.sort((R,B)=>B.overscaledZ-R.overscaledZ),E=v[v.length-1].overscaledZ,D=v[0].overscaledZ-E+1;if(D>1){this.currentStencilSource=void 0,this.nextStencilID+D>256&&this.clearStencil();const R={};for(let B=0;B<D;B++)R[B+E]=new g.StencilMode({func:h.GEQUAL,mask:255},B+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=D,[R,v]}return[{[E]:g.StencilMode.disabled},v]}colorModeForRenderPass(){const s=this.context.gl;if(this._showOverdrawInspector){const h=1/8;return new g.ColorMode([s.CONSTANT_COLOR,s.ONE],new g.Color(h,h,h,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?g.ColorMode.unblended:g.ColorMode.alphaBlended}depthModeForSublayer(s,h,v){if(!this.opaquePassEnabledForLayer())return g.DepthMode.disabled;const E=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new g.DepthMode(v||this.context.gl.LEQUAL,h,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,h){this.style=s,this.options=h,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(g.exported.now()),this.imageManager.beginFrame();const v=this.style.order,E=this.style._sourceCaches;for(const $ in E){const H=E[$];H.used&&H.prepare(this.context)}const D={},R={},B={};for(const $ in E){const H=E[$];D[$]=H.getVisibleCoordinates(),R[$]=D[$].slice().reverse(),B[$]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let $=0;$<v.length;$++)if(this.style._layers[v[$]].is3D()){this.opaquePassCutoff=$;break}if(this.terrain&&(this.terrain.updateTileBinding(B),this.opaquePassCutoff=0),!g.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const $ of v){const H=this.style._layers[$],Q=s._getLayerSourceCache(H);if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const J=Q?R[Q.id]:void 0;("custom"===H.type||H.isSky()||J&&J.length)&&this.renderLayer(this,Q,H,J)}this.depthRangeFor3D=[0,1-(s.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let z=g.Color.transparent;if(this.style.fog&&(z=this.style.fog.properties.get("color")),this.context.clear({color:h.showOverdrawInspector?g.Color.black:z,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){const $=this.style._layers[v[this.currentLayer]],H=s._getLayerSourceCache($);if($.isSky())continue;const Q=H?R[H.id]:void 0;this._renderTileClippingMasks($,H,Q),this.renderLayer(this,H,$,Q)}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){const $=this.style._layers[v[this.currentLayer]],H=s._getLayerSourceCache($);$.isSky()&&this.renderLayer(this,H,$,H?R[H.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<v.length;){const $=this.style._layers[v[this.currentLayer]],H=s._getLayerSourceCache($);if($.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped($)){if($.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Q=H?("symbol"===$.type?B:R)[H.id]:void 0;this._renderTileClippingMasks($,H,H?D[H.id]:void 0),this.renderLayer(this,H,$,Q),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let $=null;g.values(this.style._layers).forEach(H=>{const Q=s._getLayerSourceCache(H);Q&&!H.isHidden(this.transform.zoom)&&(!$||$.getSource().maxzoom<Q.getSource().maxzoom)&&($=Q)}),$&&this.options.showTileBoundaries&&Rh.debug(this,$,$.getVisibleCoordinates())}this.options.showPadding&&function($){const H=$.transform.padding;dm($,$.transform.height-(H.top||0),3,or),dm($,H.bottom||0,3,Od),Am($,H.left||0,3,D0),Am($,$.transform.width-(H.right||0),3,Ld);const Q=$.transform.centerPoint;var J,te,le,ce;Ih(J=$,(te=Q.x)-1,(le=$.transform.height-Q.y)-10,2,20,ce=Pl),Ih(J,te-10,le-1,20,2,ce)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%g.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(g.window.performance.now()),this.saveCanvasCopy())}renderLayer(s,h,v,E){v.isHidden(this.transform.zoom)||("background"===v.type||"sky"===v.type||"custom"===v.type||E&&E.length)&&(this.id=v.id,this.gpuTimingStart(v),Rh[v.type](s,h,v,E,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let v=this.gpuTimers[s.id];v||(v=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),v.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,v.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}collectGpuTimers(){const s=this.gpuTimers;return this.gpuTimers={},s}queryGpuTimers(s){const h={};for(const v in s){const E=s[v],D=this.context.extTimerQuery,R=D.getQueryObjectEXT(E.query,D.QUERY_RESULT_EXT)/1e6;D.deleteQueryEXT(E.query),h[v]=R}return h}translatePosMatrix(s,h,v,E,D){if(!v[0]&&!v[1])return s;const R=D?"map"===E?this.transform.angle:0:"viewport"===E?-this.transform.angle:0;if(R){const $=Math.sin(R),H=Math.cos(R);v=[v[0]*H-v[1]*$,v[0]*$+v[1]*H]}const B=[D?v[0]:Br(h,v[0],this.transform.zoom),D?v[1]:Br(h,v[1],this.transform.zoom),0],z=new Float32Array(16);return g.translate(z,s,B),z}saveTileTexture(s){const h=this._tileTextures[s.size[0]];h?h.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){const h=this._tileTextures[s];return h&&h.length>0?h.pop():null}isPatternMissing(s){if(!s)return!1;if(!s.from||!s.to)return!0;const h=this.imageManager.getPattern(s.from.toString()),v=this.imageManager.getPattern(s.to.toString());return!h||!v}currentGlobalDefines(){const s=this.terrain&&this.terrain.renderingToTexture,h=this.style&&this.style.fog,v=[];return this.terrain&&!this.terrain.renderingToTexture&&v.push("TERRAIN"),h&&!s&&0!==h.getOpacity(this.transform.pitch)&&v.push("FOG"),s&&v.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&v.push("OVERDRAW_INSPECTOR"),v}useProgram(s,h,v){this.cache=this.cache||{};const E=v||[],D=this.currentGlobalDefines().concat(E),R=Ma.cacheKey(s,D,h);return this.cache[R]||(this.cache[R]=new Ma(this.context,s,Fi[s],h,Rd[s],D)),this.cache[R]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=g.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new g.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(s){this.terrain&&this.terrain.prepareDrawTile(s)}prepareDrawProgram(s,h,v){if(this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const D=E.getOpacity(this.transform.pitch);0!==D&&h.setFogUniformValues(s,((R,B,z,$)=>{const H=B.properties.get("color"),Q=R.frameCounter/1e3%1,J=[H.r/H.a,H.g/H.a,H.b/H.a,$];return{u_fog_matrix:z?R.transform.calculateFogTileMatrix(z):R.identityMat,u_fog_range:B.getFovAdjustedRange(R.transform._fov),u_fog_color:J,u_fog_horizon_blend:B.properties.get("horizon-blend"),u_fog_temporal_offset:Q}})(this,E,v,D))}}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const s=this.context.gl,h=s.createTexture();return s.bindTexture(s.TEXTURE_2D,h),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const s=this.style&&this.style.fog;return!!s&&0!==s.getOpacity(this.transform.pitch)}}class Cc{constructor(s=0,h=0,v=0,E=0){if(isNaN(s)||s<0||isNaN(h)||h<0||isNaN(v)||v<0||isNaN(E)||E<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=h,this.left=v,this.right=E}interpolate(s,h,v){return null!=h.top&&null!=s.top&&(this.top=g.number(s.top,h.top,v)),null!=h.bottom&&null!=s.bottom&&(this.bottom=g.number(s.bottom,h.bottom,v)),null!=h.left&&null!=s.left&&(this.left=g.number(s.left,h.left,v)),null!=h.right&&null!=s.right&&(this.right=g.number(s.right,h.right,v)),this}getCenter(s,h){const v=g.clamp((this.left+s-this.right)/2,0,s),E=g.clamp((this.top+h-this.bottom)/2,0,h);return new g.pointGeometry(v,E)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new Cc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Hi(_,s){return[_[4*s],_[4*s+1],_[4*s+2],_[4*s+3]]}function Bd(_,s,h){_[4*s+0]=h[0],_[4*s+1]=h[1],_[4*s+2]=h[2],_[4*s+3]=h[3]}function _o(_,s){const h=Hi(_,3);g.fromQuat(_,s),Bd(_,3,h)}function Fh(_,s){Bd(_,3,[s[0],s[1],s[2],1])}function Ta(_,s){const h=g.identity$1([]);return g.rotateZ$1(h,h,-s),g.rotateX$1(h,h,-_),h}function nl(_,s){const h=[_[0],_[1],0],v=[s[0],s[1],0];if(g.length(h)>=1e-15){const R=g.normalize([],h);g.scale(v,R,g.dot(v,R)),s[0]=v[0],s[1]=v[1]}const E=g.cross([],s,_);if(g.len(E)<1e-15)return null;const D=Math.atan2(-E[1],E[0]);return Ta(Math.atan2(Math.sqrt(_[0]*_[0]+_[1]*_[1]),-_[2]),D)}class Oh{constructor(s,h){this.position=s,this.orientation=h}get position(){return this._position}set position(s){this._position=this._renderWorldCopies?function(h){if(!h)return;const v=Array.isArray(h)?new g.MercatorCoordinate(h[0],h[1],h[2]):h;return v.x=g.wrap(v.x,0,1),v}(s):s}lookAtPoint(s,h){if(this.orientation=null,!this.position)return;const v=this._elevation?this._elevation.getAtPointOrZero(g.MercatorCoordinate.fromLngLat(s)):0,E=this.position,D=g.MercatorCoordinate.fromLngLat(s,v),R=[D.x-E.x,D.y-E.y,D.z-E.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=nl(R,h)}setPitchBearing(s,h){this.orientation=Ta(g.degToRad(s),g.degToRad(-h))}}class Ru{constructor(s,h){this._transform=g.identity([]),this._orientation=g.identity$1([]),h&&(this._orientation=h,_o(this._transform,this._orientation)),s&&Fh(this._transform,s)}get mercatorPosition(){const s=this.position;return new g.MercatorCoordinate(s[0],s[1],s[2])}get position(){const s=Hi(this._transform,3);return[s[0],s[1],s[2]]}set position(s){Fh(this._transform,s)}get orientation(){return this._orientation}set orientation(s){this._orientation=s,_o(this._transform,this._orientation)}getPitchBearing(){const s=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,h){this._orientation=Ta(s,h),_o(this._transform,this._orientation)}forward(){const s=Hi(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){const s=Hi(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){const s=Hi(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,h){const v=new Float64Array(16);return g.invert(v,this.getWorldToCamera(s,h)),v}getWorldToCameraPosition(s,h,v){const E=this.position;g.scale(E,E,-s);const D=new Float64Array(16);return g.fromScaling(D,[v,v,v]),g.translate(D,D,E),D[10]*=h,D}getWorldToCamera(s,h){const v=new Float64Array(16),E=new Float64Array(4),D=this.position;return g.conjugate(E,this._orientation),g.scale(D,D,-s),g.fromQuat(v,E),g.translate(v,v,D),v[1]*=-1,v[5]*=-1,v[9]*=-1,v[13]*=-1,v[8]*=h,v[9]*=h,v[10]*=h,v[11]*=h,v}getCameraToClipPerspective(s,h,v,E){const D=new Float64Array(16);return g.perspective(D,s,h,v,E),D}getDistanceToElevation(s){const h=0===s?0:g.mercatorZfromAltitude(s,this.position[1]),v=this.forward();return(h-this.position[2])/v[2]}clone(){return new Ru([...this.position],[...this.orientation])}}class Fu{constructor(s,h,v,E,D){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===D||D,this._minZoom=s||0,this._maxZoom=h||22,this._minPitch=null==v?0:v,this._maxPitch=null==E?60:E,this.setMaxBounds(),this.width=0,this.height=0,this._center=new g.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Cc,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._camera=new Ru,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._horizonShift=.1}clone(){const s=new Fu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s.tileSize=this.tileSize,s.latRange=this.latRange,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._cameraZoom=this._cameraZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._averageElevation=this._averageElevation,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,s?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(s){this._terrainEnabled()&&null==this._cameraZoom&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),s&&this._constrainCameraAltitude(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(s){void 0===s?s=!0:null===s&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return g.mercatorZfromAltitude(1,this.center.lat)*this.worldSize}get cameraPixelsPerMeter(){return g.mercatorZfromAltitude(1,this.center.lat)*this.cameraWorldSize}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new g.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(s){const h=-g.wrap(s,-180,180)*Math.PI/180;var v,E,D,R,B,z,$,H,Q,J;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(v=new g.ARRAY_TYPE(4),g.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0),v[0]=1,v[3]=1,v),E=this.rotationMatrix,R=this.angle,B=(D=this.rotationMatrix)[0],z=D[1],$=D[2],H=D[3],Q=Math.sin(R),J=Math.cos(R),E[0]=B*J+$*Q,E[1]=z*J+H*Q,E[2]=B*-Q+$*J,E[3]=z*-Q+H*J)}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const h=g.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(s){const h=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const s=this._elevation.getAtPointOrZero(g.MercatorCoordinate.fromLngLat(this.center),-1);return-1===s?(this._cameraZoom=null,!1):(this._centerAltitude=s,!0)}_updateCameraOnTerrain(){const s=this.cameraToCenterDistance/this.worldSize,h=g.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(h+s)}sampleAverageElevation(){if(!this._elevation)return 0;const s=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],v=this.horizonLineFromTop();let E=0,D=0;for(let R=0;R<h.length;R++){const B=new g.pointGeometry(h[R][0]*this.width,v+h[R][1]*(this.height-v)),z=s.pointCoordinate(B);if(!z)continue;const $=1/Math.hypot(z[0]-this._camera.position[0],z[1]-this._camera.position[1]);E+=z[3]*$,D+=$}return 0===D?NaN:E/D}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._cameraZoom||!this._elevation)return;const s=this._cameraZoom,h=this._elevation.getAtPointOrZero(g.MercatorCoordinate.fromLngLat(this.center)),v=g.mercatorZfromAltitude(h,this.center.lat),E=this._mercatorZfromZoom(s),D=this._mercatorZfromZoom(this._maxZoom),R=Math.max(E-v,D);this._setZoom(this._zoomFromMercatorZ(R))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude()));let v;v=s.z<this._camera.position[2]?[h.x,h.y,h.z]:[s.x,s.y,s.z];const E=g.length(g.sub([],this._camera.position,v));return g.clamp(this._zoomFromMercatorZ(E),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let h=!1;if(s.orientation&&!g.exactEquals(s.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(s.orientation)),s.position){const v=[s.position.x,s.position.y,s.position.z];g.exactEquals$1(v,this._camera.position)||(this._setCameraPosition(v),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const s=this._camera.position,h=new Oh;return h.position=new g.MercatorCoordinate(s[0],s[1],s[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this._renderWorldCopies,h}_setCameraOrientation(s){if(!g.length$1(s))return!1;g.normalize$1(s,s);const h=g.transformQuat([],[0,0,-1],s),v=g.transformQuat([],[0,-1,0],s);if(v[2]<0)return!1;const E=nl(h,v);return!!E&&(this._camera.orientation=E,!0)}_setCameraPosition(s){const h=this.zoomScale(this.minZoom)*this.tileSize,v=this.zoomScale(this.maxZoom)*this.tileSize,E=this.cameraToCenterDistance;s[2]=g.clamp(s[2],E/v,E/h),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,h,v){this._unmodified=!1,this._edgeInsets.interpolate(s,h,v),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const h=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(s){const h=[new g.UnwrappedTileID(0,s)];if(this._renderWorldCopies){const v=this.pointCoordinate(new g.pointGeometry(0,0)),E=this.pointCoordinate(new g.pointGeometry(this.width,0)),D=this.pointCoordinate(new g.pointGeometry(this.width,this.height)),R=this.pointCoordinate(new g.pointGeometry(0,this.height)),B=Math.floor(Math.min(v.x,E.x,D.x,R.x)),z=Math.floor(Math.max(v.x,E.x,D.x,R.x)),$=1;for(let H=B-$;H<=z+$;H++)0!==H&&h.push(new g.UnwrappedTileID(H,s))}return h}coveringTiles(s){let h=this.coveringZoomLevel(s);const v=h,E=this.elevation&&!s.isTerrainDEM;if(void 0!==s.minzoom&&h<s.minzoom)return[];void 0!==s.maxzoom&&h>s.maxzoom&&(h=s.maxzoom);const D=g.MercatorCoordinate.fromLngLat(this.center),R=1<<h,B=[R*D.x,R*D.y,0],z=Ga.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h),$=this.pointCoordinate(this.getCameraPoint()),H=R*g.mercatorZfromAltitude(1,this.center.lat),Q=this._camera.position[2]/g.mercatorZfromAltitude(1,this.center.lat),J=[R*$.x,R*$.y,Q],te=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),le=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation?h:0,ce=s.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,_e=s.isTerrainDEM?-ce:this._elevation?this._elevation.getMinElevationBelowMSL():0,se=Pe=>({aabb:new gs([Pe*R,0,_e],[(Pe+1)*R,R,ce]),zoom:0,x:0,y:0,wrap:Pe,fullyVisible:!1}),ue=[];let ge=[];const ve=h,Me=s.reparseOverscaled?v:h,de=Pe=>{if(!this._elevation||!Pe.tileID)return;const Ge=this._elevation.getMinMaxForTile(Pe.tileID),wt=Pe.aabb;Ge?(wt.min[2]=Ge.min,wt.max[2]=Ge.max,wt.center[2]=(wt.min[2]+wt.max[2])/2):(Pe.shouldSplit=it(Pe),Pe.shouldSplit||(wt.min[2]=wt.max[2]=wt.center[2]=this._centerAltitude))},Fe=Pe=>Pe*Pe,Xe=Fe((Q-this._centerAltitude)*H),it=Pe=>{if(Pe.zoom<le)return!0;if(Pe.zoom===ve)return!1;if(null!=Pe.shouldSplit)return Pe.shouldSplit;const Ge=Pe.aabb.distanceX(J),wt=Pe.aabb.distanceY(J);let St=Xe;E&&(St=Fe(Pe.aabb.distanceZ(J)*H));const Mt=Ge*Ge+wt*wt+St;return Mt<Fe((1<<ve-Pe.zoom)*te*((ft,It)=>{if(It*Fe(.707)<ft)return 1;const Dn=Math.sqrt(It/ft);return Dn/(1.4144271570014144+(Math.pow(1.1,Dn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(St,Xe),Mt))};if(this._renderWorldCopies)for(let Pe=1;Pe<=3;Pe++)ue.push(se(-Pe)),ue.push(se(Pe));for(ue.push(se(0));ue.length>0;){const Pe=ue.pop(),Ge=Pe.x,wt=Pe.y;let St=Pe.fullyVisible;if(!St){const Mt=Pe.aabb.intersects(z);if(0===Mt)continue;St=2===Mt}if(Pe.zoom!==ve&&it(Pe))for(let Mt=0;Mt<4;Mt++){const ft=(Ge<<1)+Mt%2,It=(wt<<1)+(Mt>>1),Dn={aabb:Pe.aabb.quadrant(Mt),zoom:Pe.zoom+1,x:ft,y:It,wrap:Pe.wrap,fullyVisible:St,tileID:void 0,shouldSplit:void 0};E&&(Dn.tileID=new g.OverscaledTileID(Pe.zoom+1===ve?Me:Pe.zoom+1,Pe.wrap,Pe.zoom+1,ft,It),de(Dn)),ue.push(Dn)}else{const Mt=Pe.zoom===ve?Me:Pe.zoom;if(s.minzoom&&s.minzoom>Mt)continue;const ft=B[0]-(.5+Ge+(Pe.wrap<<Pe.zoom))*(1<<h-Pe.zoom),It=B[1]-.5-wt,Dn=Pe.tileID?Pe.tileID:new g.OverscaledTileID(Mt,Pe.wrap,Pe.zoom,Ge,wt);ge.push({tileID:Dn,distanceSq:ft*ft+It*It})}}if(this.fogCullDistSq){const Pe=this.fogCullDistSq,Ge=this.horizonLineFromTop();ge=ge.filter(wt=>{const St=[0,0,0,1],Mt=[g.EXTENT,g.EXTENT,0,1],ft=this.calculateFogTileMatrix(wt.tileID.toUnwrapped());g.transformMat4(St,St,ft),g.transformMat4(Mt,Mt,ft);const It=g.getAABBPointSquareDist(St,Mt);if(0===It)return!0;let Dn=!1;const tn=this._elevation;if(tn&&It>Pe&&0!==Ge){const $r=this.calculateProjMatrix(wt.tileID.toUnwrapped());let Cr;s.isTerrainDEM||(Cr=tn.getMinMaxForTile(wt.tileID)),Cr||(Cr={min:_e,max:ce});const hn=g.furthestTileCorner(this.bearing),Mn=[hn[0]*g.EXTENT,hn[1]*g.EXTENT,Cr.max];g.transformMat4$1(Mn,Mn,$r),Dn=(1-Mn[1])*this.height*.5<Ge}return It<Pe||Dn})}return ge.sort((Pe,Ge)=>Pe.distanceSq-Ge.distanceSq).map(Pe=>Pe.tileID)}resize(s,h){this.width=s,this.height=h,this.pixelsToGLUnits=[2/s,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const h=g.clamp(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new g.pointGeometry(g.mercatorXfromLng(s.lng)*this.worldSize,g.mercatorYfromLat(h)*this.worldSize)}unproject(s){return new g.MercatorCoordinate(s.x/this.worldSize,s.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(s,h){const v=this.pointCoordinate(h),E=this.pointCoordinate(this.centerPoint),D=this.locationCoordinate(s),R=new g.MercatorCoordinate(D.x-(v.x-E.x),D.y-(v.y-E.y));this.center=this.coordinateLocation(R),this._renderWorldCopies&&(this.center=this.center.wrap())}setLocation(s){this.center=this.coordinateLocation(s),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(s){return this._coordinatePoint(this.locationCoordinate(s),!1)}locationPoint3D(s){return this._coordinatePoint(this.locationCoordinate(s),!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s){return this.coordinateLocation(this.pointCoordinate3D(s))}locationCoordinate(s){return g.MercatorCoordinate.fromLngLat(s)}coordinateLocation(s){return s.toLngLat()}pointRayIntersection(s,h){const v=null!=h?h:this._centerAltitude,E=[s.x,s.y,0,1],D=[s.x,s.y,1,1];g.transformMat4(E,E,this.pixelMatrixInverse),g.transformMat4(D,D,this.pixelMatrixInverse);const R=D[3];g.scale$2(E,E,1/E[3]),g.scale$2(D,D,1/R);const B=E[2],z=D[2];return{p0:E,p1:D,t:B===z?0:(v-B)/(z-B)}}screenPointToMercatorRay(s){const h=[s.x,s.y,0,1],v=[s.x,s.y,1,1];return g.transformMat4(h,h,this.pixelMatrixInverse),g.transformMat4(v,v,this.pixelMatrixInverse),g.scale$2(h,h,1/h[3]),g.scale$2(v,v,1/v[3]),h[2]=g.mercatorZfromAltitude(h[2],this._center.lat)*this.worldSize,v[2]=g.mercatorZfromAltitude(v[2],this._center.lat)*this.worldSize,g.scale$2(h,h,1/this.worldSize),g.scale$2(v,v,1/this.worldSize),new Au([h[0],h[1],h[2]],g.normalize([],g.sub([],v,h)))}rayIntersectionCoordinate(s){const{p0:h,p1:v,t:E}=s,D=g.mercatorZfromAltitude(h[2],this._center.lat),R=g.mercatorZfromAltitude(v[2],this._center.lat);return new g.MercatorCoordinate(g.number(h[0],v[0],E)/this.worldSize,g.number(h[1],v[1],E)/this.worldSize,g.number(D,R,E))}pointCoordinate(s,h=this._centerAltitude){const v=this.horizonLineFromTop(!1),E=new g.pointGeometry(s.x,Math.max(v,s.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(E,h))}pointCoordinate3D(s){if(!this.elevation)return this.pointCoordinate(s);const h=this.elevation;let v=this.elevation.pointCoordinate(s);if(v)return new g.MercatorCoordinate(v[0],v[1],v[2]);let E=0,D=this.horizonLineFromTop();if(s.y>D)return this.pointCoordinate(s);const R=.02*D,B=s.clone();for(let z=0;z<10&&D-E>R;z++){B.y=g.number(E,D,.66);const $=h.pointCoordinate(B);$?(D=B.y,v=$):E=B.y}return v?new g.MercatorCoordinate(v[0],v[1],v[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){if(this.elevation)return!this.elevation.pointCoordinate(s);{const h=this.horizonLineFromTop();return s.y<h}}_coordinatePoint(s,h){const v=h&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,E=[s.x*this.worldSize,s.y*this.worldSize,v+s.toAltitude(),1];return g.transformMat4(E,E,this.pixelMatrix),E[3]>0?new g.pointGeometry(E[0]/E[3],E[1]/E[3]):new g.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(s,h){const v=new g.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),E=new g.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),D=new g.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),R=new g.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let B=this.pointCoordinate(v,s),z=this.pointCoordinate(E,s);const $=this.pointCoordinate(D,h),H=this.pointCoordinate(R,h),Q=(J,te)=>(te.y-J.y)/(te.x-J.x);return B.y>1&&z.y>=0?B=new g.MercatorCoordinate((1-H.y)/Q(H,B)+H.x,1):B.y<0&&z.y<=1&&(B=new g.MercatorCoordinate(-H.y/Q(H,B)+H.x,0)),z.y>1&&B.y>=0?z=new g.MercatorCoordinate((1-$.y)/Q($,z)+$.x,1):z.y<0&&B.y<=1&&(z=new g.MercatorCoordinate(-$.y/Q($,z)+$.x,0)),(new g.LngLatBounds).extend(this.coordinateLocation(B)).extend(this.coordinateLocation(z)).extend(this.coordinateLocation(H)).extend(this.coordinateLocation($))}_getBounds3D(){const s=this.elevation,h=s.visibleDemTiles.reduce((v,E)=>{if(E.dem){const D=E.dem.tree;v.min=Math.min(v.min,D.minimums[0]),v.max=Math.max(v.max,D.maximums[0])}return v},{min:Number.MAX_VALUE,max:0});return this._getBounds(h.min*s.exaggeration(),h.max*s.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(s=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,v=this.height/2-h*(1-this._horizonShift);return s?Math.max(0,v):v}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new g.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(s){if(s){const h=s.getEast(),v=s.getWest();this.lngRange=[v,h>v?h:h+360],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()}else this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude]}calculatePosMatrix(s,h){const v=s.canonical,E=h/this.zoomScale(v.z),D=v.x+Math.pow(2,v.z)*s.wrap,R=g.identity(new Float64Array(16));return g.translate(R,R,[D*E,v.y*E,0]),g.scale$1(R,R,[E/g.EXTENT,E/g.EXTENT,1]),R}calculateFogTileMatrix(s){const h=s.key,v=this._fogTileMatrixCache;if(v[h])return v[h];const E=this.calculatePosMatrix(s,this.cameraWorldSize);return g.multiply(E,this.worldToFogMatrix,E),v[h]=new Float32Array(E),v[h]}calculateProjMatrix(s,h=!1){const v=s.key,E=h?this._alignedProjMatrixCache:this._projMatrixCache;if(E[v])return E[v];const D=this.calculatePosMatrix(s,this.worldSize);return g.multiply(D,h?this.alignedProjMatrix:this.projMatrix,D),E[v]=new Float32Array(D),E[v]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const s=this._elevation;this._updateCameraState();const h=this._camera.position,v=this._camera.forward();if(h[2]<=0||v[2]>=0)return;const E=g.mercatorZfromAltitude(1,this._center.lat);h[2]/=E,v[2]/=E,g.normalize(v,v);const D=s.raycast(h,v,s.exaggeration());if(D){const R=g.scaleAndAdd([],h,v,D),B=new g.MercatorCoordinate(R[0],R[1],g.mercatorZfromAltitude(R[2],g.latFromMercatorY(R[1]))),z=this._camera.position,$=B.z+g.length([B.x-z[0],B.y-z[1],B.z-z[2]]);this._cameraZoom=this._zoomFromMercatorZ($),this._centerAltitude=B.toAltitude(),this._center=B.toLngLat(),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const s=this._elevation;this._updateCameraState();const h=s.getAtPointOrZero(this._camera.mercatorPosition),v=this._minimumHeightOverTerrain()*Math.cos(g.degToRad(this._maxPitch)),E=g.mercatorZfromAltitude(h,this._center.lat),D=this._camera.position[2]-E;if(D<v){const R=g.MercatorCoordinate.fromLngLat(this._center,this._centerAltitude),B=this._camera.mercatorPosition,z=[R.x-B.x,R.y-B.y,R.z-B.z],$=g.length(z);z[2]-=v-D;const H=g.length(z);if(0===H)return;g.scale(z,z,$/H),this._camera.position=[R.x-z[0],R.y-z[1],R.z-z[2]],this._camera.orientation=nl(z,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let s,h,v,E,D,R=1/0,B=-1/0;const z=this.size,$=this._unmodified;if(this.latRange){const te=this.latRange;R=g.mercatorYfromLat(te[1])*this.worldSize,B=g.mercatorYfromLat(te[0])*this.worldSize,v=B-R<z.y?z.y/(B-R):0}if(this.lngRange){const te=this.lngRange;s=g.mercatorXfromLng(te[0])*this.worldSize,h=g.mercatorXfromLng(te[1])*this.worldSize,E=h-s<z.x?z.x/(h-s):0}const H=this.point,Q=Math.max(E||0,v||0);if(Q)return this.center=this.unproject(new g.pointGeometry(E?(h+s)/2:H.x,v?(B+R)/2:H.y)),this.zoom+=this.scaleZoom(Q),this._unmodified=$,void(this._constraining=!1);if(this.latRange){const te=H.y,le=z.y/2;te-le<R&&(D=R+le),te+le>B&&(D=B-le)}let J=H.x;if(this.lngRange){const te=this.worldSize/2-(s+h)/2;J=(J+te+this.worldSize)%this.worldSize,s+=te,h+=te;const le=z.x/2;J-le<s&&(J=s+le),J+le>h&&(J=h-le),J-=te}J===H.x&&void 0===D||(this.center=this.unproject(new g.pointGeometry(J,void 0!==D?D:H.y))),this._constrainCameraAltitude(),this._unmodified=$,this._constraining=!1}_minZoomForBounds(){const s=(E,D)=>Math.log2(E/(this.tileSize*Math.abs(D[1]-D[0])));let h=0;if(this.latRange){const E=this.latRange;h=s(this.height,[g.mercatorYfromLat(E[0]),g.mercatorYfromLat(E[1])])}let v=0;if(this.lngRange){const E=this.lngRange;v=s(this.width,[g.mercatorXfromLng(E[0]),g.mercatorXfromLng(E[1])])}return Math.max(h,v)}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const s=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const h=this.pixelsPerMeter;this._updateCameraState();const v=Math.PI/2+this._pitch,E=this.fovAboveCenter,D=this.elevation?this.elevation.getMinElevationBelowMSL()*h:0,R=(this._camera.position[2]*this.worldSize-D)/Math.cos(this._pitch),B=Math.sin(E)*R/Math.sin(g.clamp(Math.PI-v-E,.01,Math.PI-.01)),z=this.point,$=z.x,H=z.y,Q=Math.cos(Math.PI/2-this._pitch)*B+R,J=Math.min(1.01*Q,R*(1/this._horizonShift)),te=this.height/50,le=this._camera.getWorldToCamera(this.worldSize,h),ce=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,te,J);ce[8]=2*-s.x/this.width,ce[9]=2*s.y/this.height;let _e=g.mul$1([],ce,le);this.mercatorMatrix=g.scale$1([],_e,[this.worldSize,this.worldSize,this.worldSize/h]),this.projMatrix=_e,this.invProjMatrix=g.invert(new Float64Array(16),this.projMatrix);const se=new Float32Array(16);g.identity(se),g.scale$1(se,se,[1,-1,1]),g.rotateX(se,se,this._pitch),g.rotateZ(se,se,this.angle);const ue=g.perspective(new Float32Array(16),this._fov,this.width/this.height,te,J),ge=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ue[8]=2*-s.x/this.width,ue[9]=2*(s.y+ge)/this.height,this.skyboxMatrix=g.multiply(se,ue,se);const ve=this.width%2/2,Me=this.height%2/2,de=Math.cos(this.angle),Fe=Math.sin(this.angle),Xe=$-Math.round($)+de*ve+Fe*Me,it=H-Math.round(H)+de*Me+Fe*ve,Pe=new Float64Array(_e);if(g.translate(Pe,Pe,[Xe>.5?Xe-1:Xe,it>.5?it-1:it,0]),this.alignedProjMatrix=Pe,_e=g.create$1(),g.scale$1(_e,_e,[this.width/2,-this.height/2,1]),g.translate(_e,_e,[1,-1,0]),this.labelPlaneMatrix=_e,_e=g.create$1(),g.scale$1(_e,_e,[1,-1,1]),g.translate(_e,_e,[-1,-1,0]),g.scale$1(_e,_e,[2/this.width,2/this.height,1]),this.glCoordMatrix=_e,this.pixelMatrix=g.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),_e=g.invert(new Float64Array(16),this.pixelMatrix),!_e)throw new Error("failed to invert matrix");this.pixelMatrixInverse=_e,this._projMatrixCache={},this._alignedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const s=this.cameraWorldSize,h=this.cameraPixelsPerMeter,v=this._camera.position,E=1/this.height,D=[s,s,h];g.scale(D,D,E),g.scale(v,v,-1),g.multiply$1(v,v,D);const R=g.create$1();g.translate(R,R,v),g.scale$1(R,R,D),this.mercatorFogMatrix=R,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,h,E)}_updateCameraState(){if(!this.height)return;this._camera.setPitchBearing(this._pitch,this.angle);const s=this._camera.forward(),h=this.cameraToCenterDistance,v=this.point,E=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-g.mercatorZfromAltitude(this._centerAltitude,this.center.lat),D=this.cameraToCenterDistance/E;this._camera.position=[v.x/this.worldSize-s[0]*h/D,v.y/this.worldSize-s[1]*h/D,g.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-s[2]*h/D]}_translateCameraConstrained(s){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),v=s[2];let E=1;v>0&&(E=Math.min((h-this._camera.position[2])/v,1)),this._camera.position=g.scaleAndAdd([],this._camera.position,s,E),this._updateStateFromCamera()}_updateStateFromCamera(){const s=this._camera.position,h=this._camera.forward(),{pitch:v,bearing:E}=this._camera.getPitchBearing(),D=g.mercatorZfromAltitude(this._centerAltitude,this.center.lat),R=this._mercatorZfromZoom(this._maxZoom)*Math.cos(g.degToRad(this._maxPitch)),B=Math.max((s[2]-D)/Math.cos(v),R),z=this._zoomFromMercatorZ(B);g.scaleAndAdd(s,s,h,B),this._pitch=g.clamp(v,g.degToRad(this.minPitch),g.degToRad(this.maxPitch)),this.angle=g.wrap(E,-Math.PI,Math.PI),this._setZoom(g.clamp(z,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=new g.MercatorCoordinate(s[0],s[1],s[2]).toLngLat(),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){const s=Math.min((null!=this._cameraZoom?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(s*this.tileSize))}_terrainEnabled(){return!!this._elevation}isCornerOffEdge(s,h){const v=Math.min(s.x,h.x),E=Math.max(s.x,h.x),D=Math.min(s.y,h.y),R=Math.max(s.y,h.y);if(D<this.horizonLineFromTop(!1))return!0;const B=[new g.pointGeometry(v,D),new g.pointGeometry(E,R),new g.pointGeometry(v,R),new g.pointGeometry(E,D)],z=this._renderWorldCopies?-3:0,$=this._renderWorldCopies?4:1;for(const H of B){const Q=this.pointRayIntersection(H);if(Q.t<0)return!0;const J=this.rayIntersectionCoordinate(Q);if(J.x<z||J.y<0||J.x>$||J.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+g.radToDeg(this.fovAboveCenter)>88||this.isCornerOffEdge(new g.pointGeometry(0,0),new g.pointGeometry(this.width,this.height))}zoomDeltaToMovement(s,h){const v=g.length(g.sub([],this._camera.position,s)),E=this._zoomFromMercatorZ(v)+h;return v-this._mercatorZfromZoom(E)}getCameraPoint(){const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new g.pointGeometry(0,s))}}function Qr(_,s){let h=!1,v=null;const E=()=>{v=null,h&&(_(),v=setTimeout(E,s),h=!1)};return()=>(h=!0,v||E(),v)}class fm{constructor(s){this._hashName=s&&encodeURIComponent(s),g.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Qr(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,g.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return g.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(s){const h=this._map.getCenter(),v=Math.round(100*this._map.getZoom())/100,E=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),D=Math.pow(10,E),R=Math.round(h.lng*D)/D,B=Math.round(h.lat*D)/D,z=this._map.getBearing(),$=this._map.getPitch();let H="";if(H+=s?`/${R}/${B}/${v}`:`${v}/${B}/${R}`,(z||$)&&(H+="/"+Math.round(10*z)/10),$&&(H+=`/${Math.round($)}`),this._hashName){const Q=this._hashName;let J=!1;const te=g.window.location.hash.slice(1).split("&").map(le=>{const ce=le.split("=")[0];return ce===Q?(J=!0,`${ce}=${H}`):le}).filter(le=>le);return J||te.push(`${Q}=${H}`),`#${te.join("&")}`}return`#${H}`}_getCurrentHash(){const s=g.window.location.hash.replace("#","");if(this._hashName){let h;return s.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(h=v)}),(h&&h[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._getCurrentHash();if(s.length>=3&&!s.some(h=>isNaN(h))){const h=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:h,pitch:+(s[4]||0)}),!0}return!1}_updateHashUnthrottled(){const s=g.window.location.href.replace(/(#.+)?$/,this.getHashString());g.window.history.replaceState(g.window.history.state,null,s)}}const rl={linearity:.3,easing:g.bezier(0,0,.3,1)},Nd=g.extend({deceleration:2500,maxSpeed:1400},rl),ai=g.extend({deceleration:20,maxSpeed:1400},rl),ff=g.extend({deceleration:1e3,maxSpeed:360},rl),zd=g.extend({deceleration:1e3,maxSpeed:90},rl);class Ec{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:g.exported.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,h=g.exported.now();for(;s.length>0&&h-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const h={zoom:0,bearing:0,pitch:0,pan:new g.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:D}of this._inertiaBuffer)h.zoom+=D.zoomDelta||0,h.bearing+=D.bearingDelta||0,h.pitch+=D.pitchDelta||0,D.panDelta&&h.pan._add(D.panDelta),D.around&&(h.around=D.around),D.pinchAround&&(h.pinchAround=D.pinchAround);const v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,E={};if(h.pan.mag()){const D=Ou(h.pan.mag(),v,g.extend({},Nd,s||{}));E.offset=h.pan.mult(D.amount/h.pan.mag()),E.center=this._map.transform.center,no(E,D)}if(h.zoom){const D=Ou(h.zoom,v,ai);E.zoom=this._map.transform.zoom+D.amount,no(E,D)}if(h.bearing){const D=Ou(h.bearing,v,ff);E.bearing=this._map.transform.bearing+g.clamp(D.amount,-179,179),no(E,D)}if(h.pitch){const D=Ou(h.pitch,v,zd);E.pitch=this._map.transform.pitch+D.amount,no(E,D)}if(E.zoom||E.bearing){const D=void 0===h.pinchAround?h.around:h.pinchAround;E.around=D?this._map.unproject(D):this._map.getCenter()}return this.clear(),g.extend(E,{noMoveStart:!0})}}function no(_,s){(!_.duration||_.duration<s.duration)&&(_.duration=s.duration,_.easing=s.easing)}function Ou(_,s,h){const{maxSpeed:v,linearity:E,deceleration:D}=h,R=g.clamp(_*E/(s/1e3),-v,v),B=Math.abs(R)/(D*E);return{easing:h.easing,duration:1e3*B,amount:R*(B/2)}}class ro extends g.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h,v,E={}){const D=ct.mousePos(h.getCanvasContainer(),v),R=h.unproject(D);super(s,g.extend({point:D,lngLat:R,originalEvent:v},E)),this._defaultPrevented=!1,this.target=h}}class Ks extends g.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h,v){const E="touchend"===s?v.changedTouches:v.touches,D=ct.touchPos(h.getCanvasContainer(),E),R=D.map(z=>h.unproject(z)),B=D.reduce((z,$,H,Q)=>z.add($.div(Q.length)),new g.pointGeometry(0,0));super(s,{points:D,point:B,lngLats:R,lngLat:h.unproject(B),originalEvent:v}),this._defaultPrevented=!1}}class Io extends g.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,h,v){super(s,{originalEvent:v}),this._defaultPrevented=!1}}class Fl{constructor(s,h){this._map=s,this._clickTolerance=h.clickTolerance}reset(){delete this._mousedownPos}wheel(s){return this._firePreventable(new Io(s.type,this._map,s))}mousedown(s,h){return this._mousedownPos=h,this._firePreventable(new ro(s.type,this._map,s))}mouseup(s){this._map.fire(new ro(s.type,this._map,s))}preclick(s){const h=g.extend({},s);h.type="preclick",this._map.fire(new ro(h.type,this._map,h))}click(s,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(s),this._map.fire(new ro(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new ro(s.type,this._map,s))}mouseover(s){this._map.fire(new ro(s.type,this._map,s))}mouseout(s){this._map.fire(new ro(s.type,this._map,s))}touchstart(s){return this._firePreventable(new Ks(s.type,this._map,s))}touchmove(s){this._map.fire(new Ks(s.type,this._map,s))}touchend(s){this._map.fire(new Ks(s.type,this._map,s))}touchcancel(s){this._map.fire(new Ks(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Lh{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(s){this._map.fire(new ro(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ro("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new ro(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class pf{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,h){this.isEnabled()&&s.shiftKey&&0===s.button&&(ct.disableDrag(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(s,h){if(!this._active)return;const v=h;if(this._lastPos.equals(v)||!this._box&&v.dist(this._startPos)<this._clickTolerance)return;const E=this._startPos;this._lastPos=v,this._box||(this._box=ct.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));const D=Math.min(E.x,v.x),R=Math.max(E.x,v.x),B=Math.min(E.y,v.y),z=Math.max(E.y,v.y);this._map._requestDomTask(()=>{this._box&&(ct.setTransform(this._box,`translate(${D}px,${B}px)`),this._box.style.width=R-D+"px",this._box.style.height=z-B+"px")})}mouseupWindow(s,h){if(!this._active||0!==s.button)return;const v=this._startPos,E=h;if(this.reset(),ct.suppressClick(),v.x!==E.x||v.y!==E.y)return this._map.fire(new g.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:D=>D.fitScreenCoordinates(v,E,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}keydown(s){this._active&&27===s.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(ct.remove(this._box),this._box=null),ct.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(s,h){return this._map.fire(new g.Event(s,{originalEvent:h}))}}function Cs(_,s){const h={};for(let v=0;v<_.length;v++)h[_[v].identifier]=s[v];return h}class Vd{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(s,h,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=s.timeStamp),v.length===this.numTouches&&(this.centroid=function(E){const D=new g.pointGeometry(0,0);for(const R of E)D._add(R);return D.div(E.length)}(h),this.touches=Cs(v,h)))}touchmove(s,h,v){if(this.aborted||!this.centroid)return;const E=Cs(v,h);for(const D in this.touches){const R=this.touches[D],B=E[D];(!B||B.dist(R)>30)&&(this.aborted=!0)}}touchend(s,h,v){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),0===v.length){const E=!this.aborted&&this.centroid;if(this.reset(),E)return E}}}class Dc{constructor(s){this.singleTap=new Vd(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(s,h,v){this.singleTap.touchstart(s,h,v)}touchmove(s,h,v){this.singleTap.touchmove(s,h,v)}touchend(s,h,v){const E=this.singleTap.touchend(s,h,v);if(E){const D=s.timeStamp-this.lastTime<500,R=!this.lastTap||this.lastTap.dist(E)<30;if(D&&R||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=E,this.count===this.numTaps)return this.reset(),E}}}class ln{constructor(){this._zoomIn=new Dc({numTouches:1,numTaps:2}),this._zoomOut=new Dc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,h,v){this._zoomIn.touchstart(s,h,v),this._zoomOut.touchstart(s,h,v)}touchmove(s,h,v){this._zoomIn.touchmove(s,h,v),this._zoomOut.touchmove(s,h,v)}touchend(s,h,v){const E=this._zoomIn.touchend(s,h,v),D=this._zoomOut.touchend(s,h,v);return E?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()+1,around:R.unproject(E)},{originalEvent:s})}):D?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()-1,around:R.unproject(D)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const ko={0:1,2:2};class Ud{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(s,h){return!1}_move(s,h){return{}}mousedown(s,h){if(this._lastPoint)return;const v=ct.mouseButton(s);this._correctButton(s,v)&&(this._lastPoint=h,this._eventButton=v)}mousemoveWindow(s,h){const v=this._lastPoint;if(v)if(s.preventDefault(),function(E,D){const R=ko[D];return void 0===E.buttons||(E.buttons&R)!==R}(s,this._eventButton))this.reset();else if(this._moved||!(h.dist(v)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(v,h)}mouseupWindow(s){this._lastPoint&&ct.mouseButton(s)===this._eventButton&&(this._moved&&ct.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ia extends Ud{mousedown(s,h){super.mousedown(s,h),this._lastPoint&&(this._active=!0)}_correctButton(s,h){return 0===h&&!s.ctrlKey}_move(s,h){return{around:h,panDelta:h.sub(s)}}}class jd extends Ud{_correctButton(s,h){return 0===h&&s.ctrlKey||2===h}_move(s,h){const v=.8*(h.x-s.x);if(v)return this._active=!0,{bearingDelta:v}}contextmenu(s){s.preventDefault()}}class Js extends Ud{_correctButton(s,h){return 0===h&&s.ctrlKey||2===h}_move(s,h){const v=-.5*(h.y-s.y);if(v)return this._active=!0,{pitchDelta:v}}contextmenu(s){s.preventDefault()}}class Mc{constructor(s){this._minTouches=1,this._clickTolerance=s.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new g.pointGeometry(0,0)}touchstart(s,h,v){return this._calculateTransform(s,h,v)}touchmove(s,h,v){if(this._active&&!(v.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,h,v)}touchend(s,h,v){this._calculateTransform(s,h,v),this._active&&v.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,h,v){v.length>0&&(this._active=!0);const E=Cs(v,h),D=new g.pointGeometry(0,0),R=new g.pointGeometry(0,0);let B=0;for(const $ in E){const H=E[$],Q=this._touches[$];Q&&(D._add(H),R._add(H.sub(Q)),B++,E[$]=H)}if(this._touches=E,B<this._minTouches||!R.mag())return;const z=R.div(B);return this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:D.div(B),panDelta:z}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gd{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(s){}_move(s,h,v){return{}}touchstart(s,h,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([h[0],h[1]]))}touchmove(s,h,v){if(!this._firstTwoTouches)return;s.preventDefault();const[E,D]=this._firstTwoTouches,R=ht(v,h,E),B=ht(v,h,D);if(!R||!B)return;const z=this._aroundCenter?null:R.add(B).div(2);return this._move([R,B],z,s)}touchend(s,h,v){if(!this._firstTwoTouches)return;const[E,D]=this._firstTwoTouches,R=ht(v,h,E),B=ht(v,h,D);R&&B||(this._active&&ct.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&"center"===s.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ht(_,s,h){for(let v=0;v<_.length;v++)if(_[v].identifier===h)return s[v]}function Xn(_,s){return Math.log(_/s)/Math.LN2}class qi extends Gd{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,h){const v=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(Xn(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Xn(this._distance,v),pinchAround:h}}}function li(_,s){return 180*_.angleWith(s)/Math.PI}class Sc extends Gd{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,h){const v=this._vector;if(this._vector=s[0].sub(s[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:li(this._vector,v),pinchAround:h}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const h=25/(Math.PI*this._minDiameter)*360,v=li(s,this._startVector);return Math.abs(v)<h}}function io(_){return Math.abs(_.y)>Math.abs(_.x)}class Es extends Gd{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(s){this._lastPoints=s,io(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,h,v){const E=s[0].sub(this._lastPoints[0]),D=s[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(E,D,v.timeStamp),this._valid)return this._lastPoints=s,this._active=!0,{pitchDelta:(E.y+D.y)/2*-.5}}gestureBeginsVertically(s,h,v){if(void 0!==this._valid)return this._valid;const E=s.mag()>=2,D=h.mag()>=2;if(!E&&!D)return;if(!E||!D)return void 0===this._firstMove&&(this._firstMove=v),v-this._firstMove<100&&void 0;const R=s.y>0==h.y>0;return io(s)&&io(h)&&R}}const Bh={panStep:100,bearingStep:15,pitchStep:10};class Ol{constructor(){const s=Bh;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let h=0,v=0,E=0,D=0,R=0;switch(s.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:s.shiftKey?v=-1:(s.preventDefault(),D=-1);break;case 39:s.shiftKey?v=1:(s.preventDefault(),D=1);break;case 38:s.shiftKey?E=1:(s.preventDefault(),R=-1);break;case 40:s.shiftKey?E=-1:(s.preventDefault(),R=1);break;default:return}return this._rotationDisabled&&(v=0,E=0),{cameraAnimation:B=>{const z=B.getZoom();B.easeTo({duration:300,easeId:"keyboardHandler",easing:Ft,zoom:h?Math.round(z)+h*(s.shiftKey?2:1):z,bearing:B.getBearing()+v*this._bearingStep,pitch:B.getPitch()+E*this._pitchStep,offset:[-D*this._panStep,-R*this._panStep],center:B.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ft(_){return _*(2-_)}const $d=4.000244140625;class Lu{constructor(s,h){this._map=s,this._el=s.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,g.bindAll(["_onTimeout"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=s&&"center"===s.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(s){if(!this.isEnabled())return;let h=s.deltaMode===g.window.WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const v=g.exported.now(),E=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,0!==h&&h%$d==0?this._type="wheel":0!==h&&Math.abs(h)<4?this._type="trackpad":E>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(E*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),s.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=s,this._delta-=h,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=ct.mousePos(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._map.transform,h=()=>s._terrainEnabled()?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(0!==this._delta){const z="wheel"===this._type&&Math.abs(this._delta)>$d?this._wheelZoomRate:this._defaultZoomRate;let $=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&0!==$&&($=1/$);const H=h(),Q=Math.pow(2,H),J="number"==typeof this._targetZoom?s.zoomScale(this._targetZoom):Q;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(J*$))),"wheel"===this._type&&(this._startZoom=h(),this._easing=this._smoothOutEasing(200)),this._delta=0}const v="number"==typeof this._targetZoom?this._targetZoom:h(),E=this._startZoom,D=this._easing;let R,B=!1;if("wheel"===this._type&&E&&D){const z=Math.min((g.exported.now()-this._lastWheelEventTime)/200,1),$=D(z);R=g.number(E,v,$),z<1?this._frameId||(this._frameId=!0):B=!0}else R=v,B=!0;return this._active=!0,B&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!B,zoomDelta:R-h(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let h=g.ease;if(this._prevEase){const v=this._prevEase,E=(g.exported.now()-v.start)/v.duration,D=v.easing(E+.01)-v.easing(E),R=.27/Math.sqrt(D*D+1e-4)*.01,B=Math.sqrt(.0729-R*R);h=g.bezier(R,B,.25,1)}return this._prevEase={start:g.exported.now(),duration:s,easing:h},h}blur(){this.reset()}reset(){this._active=!1}}class il{constructor(s,h){this._clickZoom=s,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ci{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,h){return s.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:v.getZoom()+(s.shiftKey?-1:1),around:v.unproject(h)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ds{constructor(){this._tap=new Dc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(s,h,v){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?v.length>0&&(this._swipePoint=h[0],this._swipeTouch=v[0].identifier):this._tap.touchstart(s,h,v))}touchmove(s,h,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;const E=h[0],D=E.y-this._swipePoint.y;return this._swipePoint=E,s.preventDefault(),this._active=!0,{zoomDelta:D/128}}}else this._tap.touchmove(s,h,v)}touchend(s,h,v){this._tapTime?this._swipePoint&&0===v.length&&this.reset():this._tap.touchend(s,h,v)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hd{constructor(s,h,v){this._el=s,this._mousePan=h,this._touchPan=v}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ll{constructor(s,h,v){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=h,this._mousePitch=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ea{constructor(s,h,v,E){this._el=s,this._touchZoom=h,this._touchRotate=v,this._tapDragZoom=E,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Bu=_=>_.zoom||_.drag||_.pitch||_.rotate;class qd extends g.Event{}class mf{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,h){const v=g.sub([],h,s);this.radius=g.length(v[2]<0?g.div([],v,this.constants):[v[0],v[1],0])}projectRay(s){g.div(s,s,this.constants),g.normalize(s,s),g.mul$2(s,s,this.constants);const h=g.scale([],s,this.radius);if(h[2]>0){const v=g.scale([],[0,0,1],g.dot(h,[0,0,1])),E=g.scale([],g.normalize([],[h[0],h[1],0]),this.radius),D=g.add([],h,g.scale([],g.sub([],g.add([],E,v),h),2));h[0]=D[0],h[1]=D[1]}return h}}function Bl(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class Nu{constructor(s,h){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ec(s),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new mf,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),g.bindAll(["handleEvent","handleWindowEvent"],this);const v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[g.window.document,"mousemove",{capture:!0}],[g.window.document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[g.window,"blur",void 0]];for(const[E,D,R]of this._listeners)ct.addEventListener(E,D,E===g.window.document?this.handleWindowEvent:this.handleEvent,R)}destroy(){for(const[s,h,v]of this._listeners)ct.removeEventListener(s,h,s===g.window.document?this.handleWindowEvent:this.handleEvent,v)}_addDefaultHandlers(s){const h=this._map,v=h.getCanvasContainer();this._add("mapEvent",new Fl(h,s));const E=h.boxZoom=new pf(h,s);this._add("boxZoom",E);const D=new ln,R=new Ci;h.doubleClickZoom=new il(R,D),this._add("tapZoom",D),this._add("clickZoom",R);const B=new Ds;this._add("tapDragZoom",B);const z=h.touchPitch=new Es;this._add("touchPitch",z);const $=new jd(s),H=new Js(s);h.dragRotate=new Ll(s,$,H),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",H,["mouseRotate"]);const Q=new Ia(s),J=new Mc(s);h.dragPan=new Hd(v,Q,J),this._add("mousePan",Q),this._add("touchPan",J,["touchZoom","touchRotate"]);const te=new Sc,le=new qi;h.touchZoomRotate=new ea(v,le,te,B),this._add("touchRotate",te,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Lh(h));const ce=h.scrollZoom=new Lu(h,this);this._add("scrollZoom",ce,["mousePan"]);const _e=h.keyboard=new Ol;this._add("keyboard",_e);for(const se of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[se]&&h[se].enable(s[se])}_add(s,h,v){this._handlers.push({handlerName:s,handler:h,allowed:v}),this._handlersById[s]=h}stop(s){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Bu(this._eventsInProgress))||this.isZooming()}_blockedByActive(s,h,v){for(const E in s)if(E!==v&&(!h||h.indexOf(E)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const h=[];for(const v of s)this._el.contains(v.target)&&h.push(v);return h}handleEvent(s,h){this._updatingCamera=!0;const v="renderFrame"===s.type,E=v?void 0:s,D={needsRenderFrame:!1},R={},B={},z=s.touches?this._getMapTouches(s.touches):void 0,$=z?ct.touchPos(this._el,z):v?void 0:ct.mousePos(this._el,s);for(const{handlerName:J,handler:te,allowed:le}of this._handlers){if(!te.isEnabled())continue;let ce;this._blockedByActive(B,le,J)?te.reset():te[h||s.type]&&(ce=te[h||s.type](s,$,z),this.mergeHandlerResult(D,R,ce,J,E),ce&&ce.needsRenderFrame&&this._triggerRenderFrame()),(ce||te.isActive())&&(B[J]=te)}const H={};for(const J in this._previousActiveHandlers)B[J]||(H[J]=E);this._previousActiveHandlers=B,(Object.keys(H).length||Bl(D))&&(this._changes.push([D,R,H]),this._triggerRenderFrame()),(Object.keys(B).length||Bl(D))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Q}=D;Q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Q(this._map))}mergeHandlerResult(s,h,v,E,D){if(!v)return;g.extend(s,v);const R={handlerName:E,originalEvent:v.originalEvent||D};void 0!==v.zoomDelta&&(h.zoom=R),void 0!==v.panDelta&&(h.drag=R),void 0!==v.pitchDelta&&(h.pitch=R),void 0!==v.bearingDelta&&(h.rotate=R)}_applyChanges(){const s={},h={},v={};for(const[E,D,R]of this._changes)E.panDelta&&(s.panDelta=(s.panDelta||new g.pointGeometry(0,0))._add(E.panDelta)),E.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+E.zoomDelta),E.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+E.bearingDelta),E.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+E.pitchDelta),void 0!==E.around&&(s.around=E.around),void 0!==E.aroundCoord&&(s.aroundCoord=E.aroundCoord),void 0!==E.pinchAround&&(s.pinchAround=E.pinchAround),E.noInertia&&(s.noInertia=E.noInertia),g.extend(h,D),g.extend(v,R);this._updateMapTransform(s,h,v),this._changes=[]}_updateMapTransform(s,h,v){const E=this._map,D=E.transform,R=ue=>[ue.x,ue.y,ue.z];if((ue=>{const ge=this._eventsInProgress.drag;return ge&&!this._handlersById[ge.handlerName].isActive()})()&&!Bl(s)){const ue=D.zoom;D.cameraElevationReference="sea",D.recenterOnTerrain(),D.cameraElevationReference="ground",ue!==D.zoom&&this._map._update(!0)}if(!Bl(s))return this._fireEvents(h,v,!0);let{panDelta:B,zoomDelta:z,bearingDelta:$,pitchDelta:H,around:Q,aroundCoord:J,pinchAround:te}=s;void 0!==te&&(Q=te),(ue=>h.drag&&!this._eventsInProgress.drag)()&&Q&&(this._dragOrigin=R(D.pointCoordinate3D(Q)),this._trackingEllipsoid.setup(D._camera.position,this._dragOrigin)),D.cameraElevationReference="sea",E._stop(!0),Q=Q||E.transform.centerPoint,$&&(D.bearing+=$),H&&(D.pitch+=H),D._updateCameraState();const le=[0,0,0];if(B){const ue=D.screenPointToMercatorRay(Q),ge=D.screenPointToMercatorRay(Q.sub(B)),ve=this._trackingEllipsoid.projectRay(ue.dir),Me=this._trackingEllipsoid.projectRay(ge.dir);le[0]=Me[0]-ve[0],le[1]=Me[1]-ve[1]}const ce=D.zoom,_e=[0,0,0];if(z){const ue=R(J||D.pointCoordinate3D(Q)),ge={dir:g.normalize([],g.sub([],ue,D._camera.position))},ve=D.screenPointToMercatorRay(D.centerPoint);if(ge.dir[2]<0){const Me=g.altitudeFromMercatorZ(ue[2],ue[1]),de=D.rayIntersectionCoordinate(D.pointRayIntersection(D.centerPoint,Me)),Fe=D.zoomDeltaToMovement(R(de),z)*(ve.dir[2]/ge.dir[2]);g.scale(_e,ge.dir,Fe)}else if(D._terrainEnabled()){const Me=D.zoomDeltaToMovement(ue,z);g.scale(_e,ge.dir,Me)}}const se=g.add(le,le,_e);D._translateCameraConstrained(se),z&&Math.abs(D.zoom-ce)>1e-4&&D.recenterOnTerrain(),D.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(h,v,!0)}_fireEvents(s,h,v){const E=Bu(this._eventsInProgress),D=Bu(s),R={};for(const H in s){const{originalEvent:Q}=s[H];this._eventsInProgress[H]||(R[`${H}start`]=Q),this._eventsInProgress[H]=s[H]}!E&&D&&this._fireEvent("movestart",D.originalEvent);for(const H in R)this._fireEvent(H,R[H]);D&&this._fireEvent("move",D.originalEvent);for(const H in s){const{originalEvent:Q}=s[H];this._fireEvent(H,Q)}const B={};let z;for(const H in this._eventsInProgress){const{handlerName:Q,originalEvent:J}=this._eventsInProgress[H];this._handlersById[Q].isActive()||(delete this._eventsInProgress[H],z=h[Q]||J,B[`${H}end`]=z)}for(const H in B)this._fireEvent(H,B[H]);const $=Bu(this._eventsInProgress);if(v&&(E||D)&&!$){this._updatingCamera=!0;const H=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Q=J=>0!==J&&-this._bearingSnap<J&&J<this._bearingSnap;H?(Q(H.bearing||this._map.getBearing())&&(H.bearing=0),this._map.easeTo(H,{originalEvent:z})):(this._map.fire(new g.Event("moveend",{originalEvent:z})),Q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,h){this._map.fire(new g.Event(s,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{delete this._frameId,this.handleEvent(new qd("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class Tc extends g.Evented{constructor(s,h){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=h.bearingSnap,g.bindAll(["_renderFrameCallback"],this)}getCenter(){return new g.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(s,h){return this.jumpTo({center:s},h)}panBy(s,h,v){return s=g.pointGeometry.convert(s).mult(-1),this.panTo(this.transform.center,g.extend({offset:s},h),v)}panTo(s,h,v){return this.easeTo(g.extend({center:s},h),v)}getZoom(){return this.transform.zoom}setZoom(s,h){return this.jumpTo({zoom:s},h),this}zoomTo(s,h,v){return this.easeTo(g.extend({zoom:s},h),v)}zoomIn(s,h){return this.zoomTo(this.getZoom()+1,s,h),this}zoomOut(s,h){return this.zoomTo(this.getZoom()-1,s,h),this}getBearing(){return this.transform.bearing}setBearing(s,h){return this.jumpTo({bearing:s},h),this}getPadding(){return this.transform.padding}setPadding(s,h){return this.jumpTo({padding:s},h),this}rotateTo(s,h,v){return this.easeTo(g.extend({bearing:s},h),v)}resetNorth(s,h){return this.rotateTo(0,g.extend({duration:1e3},s),h),this}resetNorthPitch(s,h){return this.easeTo(g.extend({bearing:0,pitch:0,duration:1e3},s),h),this}snapToNorth(s,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,h):this}getPitch(){return this.transform.pitch}setPitch(s,h){return this.jumpTo({pitch:s},h),this}cameraForBounds(s,h){s=g.LngLatBounds.convert(s);const v=h&&h.bearing||0;return this._cameraForBoxAndBearing(s.getNorthWest(),s.getSouthEast(),v,h)}_extendCameraOptions(s){const h={top:0,bottom:0,right:0,left:0};if("number"==typeof(s=g.extend({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding){const v=s.padding;s.padding={top:v,bottom:v,right:v,left:v}}return s.padding=g.extend(h,s.padding),s}_cameraForBoxAndBearing(s,h,v,E){const D=this._extendCameraOptions(E),R=this.transform,B=R.padding,z=R.project(g.LngLat.convert(s)),$=R.project(g.LngLat.convert(h)),H=z.rotate(-g.degToRad(v)),Q=$.rotate(-g.degToRad(v)),J=new g.pointGeometry(Math.max(H.x,Q.x),Math.max(H.y,Q.y)),te=new g.pointGeometry(Math.min(H.x,Q.x),Math.min(H.y,Q.y)),le=J.sub(te),ce=(R.width-(B.left+B.right+D.padding.left+D.padding.right))/le.x,_e=(R.height-(B.top+B.bottom+D.padding.top+D.padding.bottom))/le.y;if(_e<0||ce<0)return void g.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const se=Math.min(R.scaleZoom(R.scale*Math.min(ce,_e)),D.maxZoom),ue="number"==typeof D.offset.x?new g.pointGeometry(D.offset.x,D.offset.y):g.pointGeometry.convert(D.offset),ge=new g.pointGeometry((D.padding.left-D.padding.right)/2,(D.padding.top-D.padding.bottom)/2).rotate(v*Math.PI/180),ve=ue.add(ge).mult(R.scale/R.zoomScale(se));return{center:R.unproject(z.add($).div(2).sub(ve)),zoom:se,bearing:v}}_cameraForBox(s,h,v,E,D){const R=this._extendCameraOptions(D);v=v||0,E=E||0,s=g.LngLat.convert(s),h=g.LngLat.convert(h);const B=this.transform.clone();B.padding=R.padding;const z=this.getFreeCameraOptions(),$=new g.LngLat(.5*(s.lng+h.lng),.5*(s.lat+h.lat)),H=.5*(v+E);if(B._camera.position[2]<g.mercatorZfromAltitude(H,$.lat))return void g.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");z.lookAtPoint($),B.setFreeCameraOptions(z);const Q=g.MercatorCoordinate.fromLngLat(s),J=g.MercatorCoordinate.fromLngLat(h),te=B.pointRayIntersection(B.centerPoint,H),le=[(ce=B.rayIntersectionCoordinate(te)).x,ce.y,ce.z];var ce;const _e=B.screenPointToMercatorRay(B.centerPoint);let se,ue=0;do{const ge=Math.floor(B.zoom),ve=1<<ge,Me=Math.min(ve*Q.x,ve*J.x),de=Math.min(ve*Q.y,ve*J.y),Fe=Math.max(ve*Q.x,ve*J.x),Xe=Math.max(ve*Q.y,ve*J.y),it=new gs([Me,de,v],[Fe,Xe,E]),Pe=Ga.fromInvProjectionMatrix(B.invProjMatrix,B.worldSize,ge);if(2!==it.intersects(Pe)){se&&(B._camera.position=g.scaleAndAdd([],B._camera.position,_e.dir,-se),B._updateStateFromCamera());break}const Ge=g.sub([],B._camera.position,le);se=.5*g.length(Ge),B._camera.position=g.scaleAndAdd([],B._camera.position,_e.dir,se);try{B._updateStateFromCamera()}catch(wt){return void g.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++ue<10);return{center:B.center,zoom:B.zoom,bearing:B.bearing,pitch:B.pitch}}fitBounds(s,h,v){return this._fitInternal(this.cameraForBounds(s,h),h,v)}_raycastElevationBox(s,h){const v=this.transform.elevation;if(!v)return;const E=new g.pointGeometry(s.x,h.y),D=new g.pointGeometry(h.x,s.y),R=v.pointCoordinate(s);if(!R)return;const B=v.pointCoordinate(h);if(!B)return;const z=v.pointCoordinate(E);if(!z)return;const $=v.pointCoordinate(D);if(!$)return;const H=new g.MercatorCoordinate(R[0],R[1]).toLngLat(),Q=new g.MercatorCoordinate(B[0],B[1]).toLngLat(),J=new g.MercatorCoordinate(z[0],z[1]).toLngLat(),te=new g.MercatorCoordinate($[0],$[1]).toLngLat(),le=Math.min(H.lng,Math.min(Q.lng,Math.min(J.lng,te.lng))),ce=Math.min(H.lat,Math.min(Q.lat,Math.min(J.lat,te.lat))),_e=Math.max(H.lng,Math.max(Q.lng,Math.max(J.lng,te.lng))),se=Math.max(H.lat,Math.max(Q.lat,Math.max(J.lat,te.lat))),ue=Math.min(R[3],Math.min(B[3],Math.min(z[3],$[3]))),ge=Math.max(R[3],Math.max(B[3],Math.max(z[3],$[3])));return{minLngLat:new g.LngLat(le,ce),maxLngLat:new g.LngLat(_e,se),minAltitude:ue,maxAltitude:ge}}fitScreenCoordinates(s,h,v,E,D){let R,B,z,$;const H=g.pointGeometry.convert(s),Q=g.pointGeometry.convert(h),J=this._raycastElevationBox(H,Q);if(J)R=J.minLngLat,B=J.maxLngLat,z=J.minAltitude,$=J.maxAltitude;else{if(this.transform.isCornerOffEdge(H,Q))return this;R=this.transform.pointLocation(H),B=this.transform.pointLocation(Q)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(g.pointGeometry.convert(s)),this.transform.pointLocation(g.pointGeometry.convert(h)),v,E):this._cameraForBox(R,B,z,$,E),E,D)}_fitInternal(s,h,v){return s?(delete(h=g.extend(s,h)).padding,h.linear?this.easeTo(h,v):this.flyTo(h,v)):this}jumpTo(s,h){this.stop();const v=this.transform;let E=!1,D=!1,R=!1;return"zoom"in s&&v.zoom!==+s.zoom&&(E=!0,v.zoom=+s.zoom),void 0!==s.center&&(v.center=g.LngLat.convert(s.center)),"bearing"in s&&v.bearing!==+s.bearing&&(D=!0,v.bearing=+s.bearing),"pitch"in s&&v.pitch!==+s.pitch&&(R=!0,v.pitch=+s.pitch),null==s.padding||v.isPaddingEqual(s.padding)||(v.padding=s.padding),this.fire(new g.Event("movestart",h)).fire(new g.Event("move",h)),E&&this.fire(new g.Event("zoomstart",h)).fire(new g.Event("zoom",h)).fire(new g.Event("zoomend",h)),D&&this.fire(new g.Event("rotatestart",h)).fire(new g.Event("rotate",h)).fire(new g.Event("rotateend",h)),R&&this.fire(new g.Event("pitchstart",h)).fire(new g.Event("pitch",h)).fire(new g.Event("pitchend",h)),this.fire(new g.Event("moveend",h))}getFreeCameraOptions(){return this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,h){this.stop();const v=this.transform,E=v.zoom,D=v.pitch,R=v.bearing;v.setFreeCameraOptions(s);const B=E!==v.zoom,z=D!==v.pitch,$=R!==v.bearing;return this.fire(new g.Event("movestart",h)).fire(new g.Event("move",h)),B&&this.fire(new g.Event("zoomstart",h)).fire(new g.Event("zoom",h)).fire(new g.Event("zoomend",h)),$&&this.fire(new g.Event("rotatestart",h)).fire(new g.Event("rotate",h)).fire(new g.Event("rotateend",h)),z&&this.fire(new g.Event("pitchstart",h)).fire(new g.Event("pitch",h)).fire(new g.Event("pitchend",h)),this.fire(new g.Event("moveend",h)),this}easeTo(s,h){this._stop(!1,s.easeId),(!1===(s=g.extend({offset:[0,0],duration:500,easing:g.ease},s)).animate||!s.essential&&g.exported.prefersReducedMotion)&&(s.duration=0);const v=this.transform,E=this.getZoom(),D=this.getBearing(),R=this.getPitch(),B=this.getPadding(),z="zoom"in s?+s.zoom:E,$="bearing"in s?this._normalizeBearing(s.bearing,D):D,H="pitch"in s?+s.pitch:R,Q="padding"in s?s.padding:v.padding,J=g.pointGeometry.convert(s.offset);let te=v.centerPoint.add(J);const le=v.pointLocation(te),ce=g.LngLat.convert(s.center||le);this._normalizeCenter(ce);const _e=v.project(le),se=v.project(ce).sub(_e),ue=v.zoomScale(z-E);let ge,ve;s.around&&(ge=g.LngLat.convert(s.around),ve=v.locationPoint(ge));const Me={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||z!==E,this._rotating=this._rotating||D!==$,this._pitching=this._pitching||H!==R,this._padding=!v.isPaddingEqual(Q),this._easeId=s.easeId,this._prepareEase(h,s.noMoveStart,Me),this._ease(de=>{if(this._zooming&&(v.zoom=g.number(E,z,de)),this._rotating&&(v.bearing=g.number(D,$,de)),this._pitching&&(v.pitch=g.number(R,H,de)),this._padding&&(v.interpolatePadding(B,Q,de),te=v.centerPoint.add(J)),ge)v.setLocationAtPoint(ge,ve);else{const Fe=v.zoomScale(v.zoom-E),Xe=z>E?Math.min(2,ue):Math.max(.5,ue),it=Math.pow(Xe,1-de),Pe=v.unproject(_e.add(se.mult(de*it)).mult(Fe));v.setLocationAtPoint(v.renderWorldCopies?Pe.wrap():Pe,te)}this._fireMoveEvents(h)},de=>{v.recenterOnTerrain(),this._afterEase(h,de)},s),this}_prepareEase(s,h,v={}){this._moving=!0,this.transform.cameraElevationReference="sea",h||v.moving||this.fire(new g.Event("movestart",s)),this._zooming&&!v.zooming&&this.fire(new g.Event("zoomstart",s)),this._rotating&&!v.rotating&&this.fire(new g.Event("rotatestart",s)),this._pitching&&!v.pitching&&this.fire(new g.Event("pitchstart",s))}_fireMoveEvents(s){this.fire(new g.Event("move",s)),this._zooming&&this.fire(new g.Event("zoom",s)),this._rotating&&this.fire(new g.Event("rotate",s)),this._pitching&&this.fire(new g.Event("pitch",s))}_afterEase(s,h){if(this._easeId&&h&&this._easeId===h)return;delete this._easeId,this.transform.cameraElevationReference="ground";const v=this._zooming,E=this._rotating,D=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new g.Event("zoomend",s)),E&&this.fire(new g.Event("rotateend",s)),D&&this.fire(new g.Event("pitchend",s)),this.fire(new g.Event("moveend",s))}flyTo(s,h){if(!s.essential&&g.exported.prefersReducedMotion){const ft=g.pick(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ft,h)}this.stop(),s=g.extend({offset:[0,0],speed:1.2,curve:1.42,easing:g.ease},s);const v=this.transform,E=this.getZoom(),D=this.getBearing(),R=this.getPitch(),B=this.getPadding(),z="zoom"in s?g.clamp(+s.zoom,v.minZoom,v.maxZoom):E,$="bearing"in s?this._normalizeBearing(s.bearing,D):D,H="pitch"in s?+s.pitch:R,Q="padding"in s?s.padding:v.padding,J=v.zoomScale(z-E),te=g.pointGeometry.convert(s.offset);let le=v.centerPoint.add(te);const ce=v.pointLocation(le),_e=g.LngLat.convert(s.center||ce);this._normalizeCenter(_e);const se=v.project(ce),ue=v.project(_e).sub(se);let ge=s.curve;const ve=Math.max(v.width,v.height),Me=ve/J,de=ue.mag();if("minZoom"in s){const ft=g.clamp(Math.min(s.minZoom,E,z),v.minZoom,v.maxZoom),It=ve/v.zoomScale(ft-E);ge=Math.sqrt(It/de*2)}const Fe=ge*ge;function Xe(ft){const It=(Me*Me-ve*ve+(ft?-1:1)*Fe*Fe*de*de)/(2*(ft?Me:ve)*Fe*de);return Math.log(Math.sqrt(It*It+1)-It)}function it(ft){return(Math.exp(ft)-Math.exp(-ft))/2}function Pe(ft){return(Math.exp(ft)+Math.exp(-ft))/2}const Ge=Xe(0);let wt=function(ft){return Pe(Ge)/Pe(Ge+ge*ft)},St=function(ft){return ve*((Pe(Ge)*(it(It=Ge+ge*ft)/Pe(It))-it(Ge))/Fe)/de;var It},Mt=(Xe(1)-Ge)/ge;if(Math.abs(de)<1e-6||!isFinite(Mt)){if(Math.abs(ve-Me)<1e-6)return this.easeTo(s,h);const ft=Me<ve?-1:1;Mt=Math.abs(Math.log(Me/ve))/ge,St=function(){return 0},wt=function(It){return Math.exp(ft*ge*It)}}return s.duration="duration"in s?+s.duration:1e3*Mt/("screenSpeed"in s?+s.screenSpeed/ge:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this._zooming=!0,this._rotating=D!==$,this._pitching=H!==R,this._padding=!v.isPaddingEqual(Q),this._prepareEase(h,!1),this._ease(ft=>{const It=ft*Mt,Dn=1/wt(It);v.zoom=1===ft?z:E+v.scaleZoom(Dn),this._rotating&&(v.bearing=g.number(D,$,ft)),this._pitching&&(v.pitch=g.number(R,H,ft)),this._padding&&(v.interpolatePadding(B,Q,ft),le=v.centerPoint.add(te));const tn=1===ft?_e:v.unproject(se.add(ue.mult(St(It))).mult(Dn));v.setLocationAtPoint(v.renderWorldCopies?tn.wrap():tn,le),v._updateCenterElevation(),this._fireMoveEvents(h)},()=>this._afterEase(h),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,h)}if(!s){const v=this.handlers;v&&v.stop(!1)}return this}_ease(s,h,v){!1===v.animate||0===v.duration?(s(1),h()):(this._easeStart=g.exported.now(),this._easeOptions=v,this._onEaseFrame=s,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((g.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,h){s=g.wrap(s,-180,180);const v=Math.abs(s-h);return Math.abs(s-360-h)<v&&(s-=360),Math.abs(s+360-h)<v&&(s+=360),s}_normalizeCenter(s){const h=this.transform;if(!h.renderWorldCopies||h.lngRange)return;const v=s.lng-h.center.lng;s.lng+=v>180?-360:v<-180?360:0}}class Nh{constructor(s={}){this.options=s,g.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){const h=this.options&&this.options.compact;return this._map=s,this._container=ct.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ct.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ct.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===h&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){ct.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(s,h){const v=this._map._getUIString(`AttributionControl.${h}`);s.title=v,s.setAttribute("aria-label",v)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||g.config.ACCESS_TOKEN}];if(s){const v=h.reduce((E,D,R)=>(D.value&&(E+=`${D.key}=${D.value}${R<h.length-1?"&":""}`),E),"?");s.href=`${g.config.FEEDBACK_URL}/${v}${this._map._hash?this._map._hash.getHashString(!0):""}`,s.rel="noopener nofollow",this._setElementTitle(s,"MapFeedback")}}_updateData(s){!s||"metadata"!==s.sourceDataType&&"visibility"!==s.sourceDataType&&"style"!==s.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(E=>"string"!=typeof E?"":E)):"string"==typeof this.options.customAttribution&&s.push(this.options.customAttribution)),this._map.style.stylesheet){const E=this._map.style.stylesheet;this.styleOwner=E.owner,this.styleId=E.id}const h=this._map.style._sourceCaches;for(const E in h){const D=h[E];if(D.used){const R=D.getSource();R.attribution&&s.indexOf(R.attribution)<0&&s.push(R.attribution)}}s.sort((E,D)=>E.length-D.length),s=s.filter((E,D)=>{for(let R=D+1;R<s.length;R++)if(s[R].indexOf(E)>=0)return!1;return!0});const v=s.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,s.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class zu{constructor(){g.bindAll(["_updateLogo"],this),g.bindAll(["_updateCompact"],this)}onAdd(s){this._map=s,this._container=ct.create("div","mapboxgl-ctrl");const h=ct.create("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ct.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&"metadata"!==s.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const s=this._map.style._sourceCaches;if(0===Object.entries(s).length)return!0;for(const h in s){const v=s[h].getSource();if(v.hasOwnProperty("mapbox_logo")&&!v.mapbox_logo)return!1}return!0}_updateCompact(){const s=this._container.children;if(s.length){const h=s[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class Zd{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const h=++this._id;return this._queue.push({callback:s,id:h,cancelled:!1}),h}remove(s){const h=this._currentlyRunning,v=h?this._queue.concat(h):this._queue;for(const E of v)if(E.id===s)return void(E.cancelled=!0)}run(s=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const v of h)if(!v.cancelled&&(v.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function zh(_,s,h){if(_=new g.LngLat(_.lng,_.lat),s){const v=new g.LngLat(_.lng-360,_.lat),E=new g.LngLat(_.lng+360,_.lat),D=360*Math.ceil(Math.abs(_.lng-h.center.lng)/360),R=h.locationPoint(_).distSqr(s),B=s.x<0||s.y<0||s.x>h.width||s.y>h.height;h.locationPoint(v).distSqr(s)<R&&(B||Math.abs(v.lng-h.center.lng)<D)?_=v:h.locationPoint(E).distSqr(s)<R&&(B||Math.abs(E.lng-h.center.lng)<D)&&(_=E)}for(;Math.abs(_.lng-h.center.lng)>180;){const v=h.locationPoint(_);if(v.x>=0&&v.y>=0&&v.x<=h.width&&v.y<=h.height)break;_.lng>h.center.lng?_.lng-=360:_.lng+=360}return _}const Nl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Vu extends g.Evented{constructor(s,h){if(super(),(s instanceof g.window.HTMLElement||h)&&(s=g.extend({element:s},h)),g.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&"auto"!==s.pitchAlignment?s.pitchAlignment:this._rotationAlignment,s&&s.element)this._element=s.element,this._offset=g.pointGeometry.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=ct.create("div"),this._element.setAttribute("aria-label","Map marker");const E=ct.createNS("http://www.w3.org/2000/svg","svg"),D=41,R=27;E.setAttributeNS(null,"display","block"),E.setAttributeNS(null,"height",`${D}px`),E.setAttributeNS(null,"width",`${R}px`),E.setAttributeNS(null,"viewBox",`0 0 ${R} ${D}`);const B=ct.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"stroke","none"),B.setAttributeNS(null,"stroke-width","1"),B.setAttributeNS(null,"fill","none"),B.setAttributeNS(null,"fill-rule","evenodd");const z=ct.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill-rule","nonzero");const $=ct.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(3.0, 29.0)"),$.setAttributeNS(null,"fill","#000000");const H=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ge of H){const ve=ct.createNS("http://www.w3.org/2000/svg","ellipse");ve.setAttributeNS(null,"opacity","0.04"),ve.setAttributeNS(null,"cx","10.5"),ve.setAttributeNS(null,"cy","5.80029008"),ve.setAttributeNS(null,"rx",ge.rx),ve.setAttributeNS(null,"ry",ge.ry),$.appendChild(ve)}const Q=ct.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"fill",this._color);const J=ct.createNS("http://www.w3.org/2000/svg","path");J.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Q.appendChild(J);const te=ct.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"fill","#000000");const le=ct.createNS("http://www.w3.org/2000/svg","path");le.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),te.appendChild(le);const ce=ct.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ce.setAttributeNS(null,"fill","#FFFFFF");const _e=ct.createNS("http://www.w3.org/2000/svg","g");_e.setAttributeNS(null,"transform","translate(8.0, 8.0)");const se=ct.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#000000"),se.setAttributeNS(null,"opacity","0.25"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962");const ue=ct.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#FFFFFF"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962"),_e.appendChild(se),_e.appendChild(ue),z.appendChild($),z.appendChild(Q),z.appendChild(te),z.appendChild(ce),z.appendChild(_e),E.appendChild(z),E.setAttributeNS(null,"height",D*this._scale+"px"),E.setAttributeNS(null,"width",R*this._scale+"px"),this._element.appendChild(E),this._offset=g.pointGeometry.convert(s&&s.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",E=>{E.preventDefault()}),this._element.addEventListener("mousedown",E=>{E.preventDefault()});const v=this._element.classList;for(const E in Nl)v.remove(`mapboxgl-marker-anchor-${E}`);v.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(s){return this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._update),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),ct.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=g.LngLat.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const h=38.1,v=13.5,E=Math.sqrt(Math.pow(v,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-h],"bottom-left":[E,-1*(h-v+E)],"bottom-right":[-E,-1*(h-v+E)],left:[v,-1*(h-v)],right:[-v,-1*(h-v)]}:this._offset}this._popup=s,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(s){const h=s.code,v=s.charCode||s.keyCode;"Space"!==h&&"Enter"!==h&&32!==v&&13!==v||this.togglePopup()}_onMapClick(s){const h=s.originalEvent.target,v=this._element;this._popup&&(h===v||v.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?s.remove():s.addTo(this._map),this):this}_evaluateOpacity(){const s=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(s))return void this._clearFadeTimer();const h=this._map.unproject(s);let v=!1;if(this._map.getTerrain()){const D=this._map.getFreeCameraOptions();if(D.position){const R=D.position.toLngLat();v=R.distanceTo(h)<.9*R.distanceTo(this._lngLat)}}const E=(1-this._map._queryFogOpacity(h))*(v?.2:1);this._element.style.opacity=`${E}`,this._popup&&this._popup._setOpacity(`${E}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(s){const h=this._map.transform;return!!s&&s.x>=0&&s.x<h.width&&s.y>=0&&s.y<h.height}_update(s){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=zh(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset());let h="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?h=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(h=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let v="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?v="rotateX(0deg)":"map"===this._pitchAlignment&&(v=`rotateX(${this._map.getPitch()}deg)`),s&&"moveend"!==s.type||(this._pos=this._pos.round()),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&ct.setTransform(this._element,`${Nl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${v} ${h}`),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})}_transformedOffset(){if(!this._defaultMarker)return this._offset;const s=this._map.transform,h=this._offset.mult(this._scale);return"map"===this._rotationAlignment&&h._rotate(s.angle),"map"===this._pitchAlignment&&(h.y*=Math.cos(s._pitch)),h}getOffset(){return this._offset}setOffset(s){return this._offset=g.pointGeometry.convert(s),this._update(),this}_onMove(s){if(!this._isDragging){const h=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new g.Event("dragstart"))),this.fire(new g.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new g.Event("dragend")),this._state="inactive"}_addDragHandler(s){this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(s){return this._draggable=!!s,this._map&&(s?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s&&"auto"!==s?s:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class Wd{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;const h=g.easeCubicInOut((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,h,v){this._start=this.getValue(h),this._end=s,this._startTime=h,this._endTime=h+v}}const Vh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},{HTMLImageElement:Ic,HTMLElement:Uu,ImageBitmap:zl}=g.window,gf={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Ei(_){_.parentNode&&_.parentNode.removeChild(_)}const ka={showCompass:!0,showZoom:!0,visualizePitch:!1};class Gr{constructor(s,h,v=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new jd({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,v&&(this.mousePitch=new Js({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),g.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),ct.addEventListener(h,"mousedown",this.mousedown),ct.addEventListener(h,"touchstart",this.touchstart,{passive:!1}),ct.addEventListener(h,"touchmove",this.touchmove),ct.addEventListener(h,"touchend",this.touchend),ct.addEventListener(h,"touchcancel",this.reset)}down(s,h){this.mouseRotate.mousedown(s,h),this.mousePitch&&this.mousePitch.mousedown(s,h),ct.disableDrag()}move(s,h){const v=this.map,E=this.mouseRotate.mousemoveWindow(s,h);if(E&&E.bearingDelta&&v.setBearing(v.getBearing()+E.bearingDelta),this.mousePitch){const D=this.mousePitch.mousemoveWindow(s,h);D&&D.pitchDelta&&v.setPitch(v.getPitch()+D.pitchDelta)}}off(){const s=this.element;ct.removeEventListener(s,"mousedown",this.mousedown),ct.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),ct.removeEventListener(s,"touchmove",this.touchmove),ct.removeEventListener(s,"touchend",this.touchend),ct.removeEventListener(s,"touchcancel",this.reset),this.offTemp()}offTemp(){ct.enableDrag(),ct.removeEventListener(g.window,"mousemove",this.mousemove),ct.removeEventListener(g.window,"mouseup",this.mouseup)}mousedown(s){this.down(g.extend({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),ct.mousePos(this.element,s)),ct.addEventListener(g.window,"mousemove",this.mousemove),ct.addEventListener(g.window,"mouseup",this.mouseup)}mousemove(s){this.move(s,ct.mousePos(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){1!==s.targetTouches.length?this.reset():(this._startPos=this._lastPos=ct.touchPos(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){1!==s.targetTouches.length?this.reset():(this._lastPos=ct.touchPos(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){0===s.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const _f={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let ol,kc=0,Vl=!1;const pm={maxWidth:100,unit:"metric"};function yf(_,s,h){const v=h&&h.maxWidth||100,E=_._container.getBoundingClientRect().height/2,D=_.unproject([0,E]),R=_.unproject([v,E]),B=D.distanceTo(R);if(h&&"imperial"===h.unit){const z=3.2808*B;z>5280?ta(s,v,z/5280,_._getUIString("ScaleControl.Miles"),_):ta(s,v,z,_._getUIString("ScaleControl.Feet"),_)}else h&&"nautical"===h.unit?ta(s,v,B/1852,_._getUIString("ScaleControl.NauticalMiles"),_):B>=1e3?ta(s,v,B/1e3,_._getUIString("ScaleControl.Kilometers"),_):ta(s,v,B,_._getUIString("ScaleControl.Meters"),_)}function ta(_,s,h,v,E){const D=function(B){const z=Math.pow(10,`${Math.floor(B)}`.length-1);let $=B/z;return $=$>=10?10:$>=5?5:$>=3?3:$>=2?2:$>=1?1:function(H){const Q=Math.pow(10,Math.ceil(-Math.log(H)/Math.LN10));return Math.round(H*Q)/Q}($),z*$}(h),R=D/h;E._requestDomTask(()=>{_.style.width=s*R+"px",_.innerHTML=`${D}&nbsp;${v}`})}const ju={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Gu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Pc={version:g.version,supported:Do,setRTLTextPlugin:g.setRTLTextPlugin,getRTLTextPluginStatus:g.getRTLTextPluginStatus,Map:class extends Tc{constructor(_){if(null!=(_=g.extend({},gf,_)).minZoom&&null!=_.maxZoom&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=_.minPitch&&null!=_.maxPitch&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=_.minPitch&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=_.maxPitch&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Fu(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),_),this._interactive=_.interactive,this._maxTileCacheSize=_.maxTileCacheSize,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=_.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=_.collectResourceTiming,this._optimizeForTerrain=_.optimizeForTerrain,this._renderTaskQueue=new Zd,this._domRenderTaskQueue=new Zd,this._controls=[],this._markers=[],this._mapId=g.uniqueId(),this._locale=g.extend({},Vh,_.locale),this._clickTolerance=_.clickTolerance,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new Wd(0),this._requestManager=new g.RequestManager(_.transformRequest,_.accessToken,_.testMode),this._silenceAuthErrors=!!_.testMode,"string"==typeof _.container){if(this._container=g.window.document.getElementById(_.container),!this._container)throw new Error(`Container '${_.container}' not found.`)}else{if(!(_.container instanceof Uu))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(_.maxBounds&&this.setMaxBounds(_.maxBounds),g.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==g.window&&(g.window.addEventListener("online",this._onWindowOnline,!1),g.window.addEventListener("resize",this._onWindowResize,!1),g.window.addEventListener("orientationchange",this._onWindowResize,!1),g.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new Nu(this,_),this._hash=_.hash&&new fm("string"==typeof _.hash&&_.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),_.bounds&&(this.resize(),this.fitBounds(_.bounds,g.extend({},_.fitBoundsOptions,{duration:0})))),this.resize(),this._localFontFamily=_.localFontFamily,this._localIdeographFontFamily=_.localIdeographFontFamily,_.style&&this.setStyle(_.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),_.attributionControl&&this.addControl(new Nh({customAttribution:_.customAttribution})),this._logoControl=new zu,this.addControl(this._logoControl,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update("style"===s.dataType),this.fire(new g.Event(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new g.Event(`${s.dataType}dataloading`,s))})}_getMapId(){return this._mapId}addControl(_,s){if(void 0===s&&(s=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new g.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=_.onAdd(this);this._controls.push(_);const v=this._controlPositions[s];return-1!==s.indexOf("bottom")?v.insertBefore(h,v.firstChild):v.appendChild(h),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new g.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(_);return s>-1&&this._controls.splice(s,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(_){const[s,h]=this._containerDimensions();if(s===this.transform.width&&h===this.transform.height)return this;this._resizeCanvas(s,h),this.transform.resize(s,h),this.painter.resize(Math.ceil(s),Math.ceil(h));const v=!this._moving;return v&&this.fire(new g.Event("movestart",_)).fire(new g.Event("move",_)),this.fire(new g.Event("resize",_)),v&&this.fire(new g.Event("moveend",_)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(_){return this.transform.setMaxBounds(g.LngLatBounds.convert(_)),this._update()}setMinZoom(_){if((_=null==_?-2:_)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_&&this.setZoom(_),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=null==_?22:_)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_&&this.setZoom(_),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=null==_?0:_)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_&&this.setPitch(_),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=null==_?85:_)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_&&this.setPitch(_),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this._update()}project(_){return this.transform.locationPoint3D(g.LngLat.convert(_))}unproject(_){return this.transform.pointLocation3D(g.pointGeometry.convert(_))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(_,s,h){if("mouseenter"===_||"mouseover"===_){let v=!1;return{layer:s,listener:h,delegates:{mousemove:D=>{const R=this.getLayer(s)?this.queryRenderedFeatures(D.point,{layers:[s]}):[];R.length?v||(v=!0,h.call(this,new ro(_,this,D.originalEvent,{features:R}))):v=!1},mouseout:()=>{v=!1}}}}if("mouseleave"===_||"mouseout"===_){let v=!1;return{layer:s,listener:h,delegates:{mousemove:R=>{(this.getLayer(s)?this.queryRenderedFeatures(R.point,{layers:[s]}):[]).length?v=!0:v&&(v=!1,h.call(this,new ro(_,this,R.originalEvent)))},mouseout:R=>{v&&(v=!1,h.call(this,new ro(_,this,R.originalEvent)))}}}}{const v=E=>{const D=this.getLayer(s)?this.queryRenderedFeatures(E.point,{layers:[s]}):[];D.length&&(E.features=D,h.call(this,E),delete E.features)};return{layer:s,listener:h,delegates:{[_]:v}}}}on(_,s,h){if(void 0===h)return super.on(_,s);const v=this._createDelegatedListener(_,s,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(v);for(const E in v.delegates)this.on(E,v.delegates[E]);return this}once(_,s,h){if(void 0===h)return super.once(_,s);const v=this._createDelegatedListener(_,s,h);for(const E in v.delegates)this.once(E,v.delegates[E]);return this}off(_,s,h){return void 0===h?super.off(_,s):(this._delegatedListeners&&this._delegatedListeners[_]&&(v=>{const E=this._delegatedListeners[_];for(let D=0;D<E.length;D++){const R=E[D];if(R.layer===s&&R.listener===h){for(const B in R.delegates)this.off(B,R.delegates[B]);return E.splice(D,1),this}}})(),this)}queryRenderedFeatures(_,s){return this.style?(void 0!==s||void 0===_||_ instanceof g.pointGeometry||Array.isArray(_)||(s=_,_=void 0),this.style.queryRenderedFeatures(_=_||[[0,0],[this.transform.width,this.transform.height]],s=s||{},this.transform)):[]}querySourceFeatures(_,s){return this.style.querySourceFeatures(_,s)}queryTerrainElevation(_,s){const h=this.transform.elevation;return h?(s=g.extend({},{exaggerated:!0},s),h.getAtPoint(g.MercatorCoordinate.fromLngLat(_),null,s.exaggerated)):null}setStyle(_,s){return!1!==(s=g.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s)).diff&&s.localIdeographFontFamily===this._localIdeographFontFamily&&s.localFontFamily===this._localFontFamily&&this.style&&_?(this._diffStyle(_,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(_,s))}_getUIString(_){const s=this._locale[_];if(null==s)throw new Error(`Missing UI string '${_}'`);return s}_updateStyle(_,s){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),_&&(this.style=new Jo(this,s||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof _?this.style.loadURL(_):this.style.loadJSON(_)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Jo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,s){if("string"==typeof _){const h=this._requestManager.normalizeStyleURL(_),v=this._requestManager.transformRequest(h,g.ResourceType.Style);g.getJSON(v,(E,D)=>{E?this.fire(new g.ErrorEvent(E)):D&&this._updateDiff(D,s)})}else"object"==typeof _&&this._updateDiff(_,s)}_updateDiff(_,s){try{this.style.setState(_)&&this._update(!0)}catch(h){g.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(_,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():g.warnOnce("There is no style added to the map.")}addSource(_,s){return this._lazyInitEmptyStyle(),this.style.addSource(_,s),this._update(!0)}isSourceLoaded(_){const s=this.style&&this.style._getSourceCaches(_);if(0!==s.length)return s.every(h=>h.loaded());this.fire(new g.ErrorEvent(new Error(`There is no source with ID '${_}'`)))}areTilesLoaded(){const _=this.style&&this.style._sourceCaches;for(const s in _){const h=_[s]._tiles;for(const v in h){const E=h[v];if("loaded"!==E.state&&"errored"!==E.state)return!1}}return!0}addSourceType(_,s,h){return this._lazyInitEmptyStyle(),this.style.addSourceType(_,s,h)}removeSource(_){return this.style.removeSource(_),this._updateTerrain(),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,s,{pixelRatio:h=1,sdf:v=!1,stretchX:E,stretchY:D,content:R}={}){if(this._lazyInitEmptyStyle(),s instanceof Ic||zl&&s instanceof zl){const{width:B,height:z,data:$}=g.exported.getImageData(s);this.style.addImage(_,{data:new g.RGBAImage({width:B,height:z},$),pixelRatio:h,stretchX:E,stretchY:D,content:R,sdf:v,version:0})}else{if(void 0===s.width||void 0===s.height)return this.fire(new g.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:B,height:z,data:$}=s,H=s;this.style.addImage(_,{data:new g.RGBAImage({width:B,height:z},new Uint8Array($)),pixelRatio:h,stretchX:E,stretchY:D,content:R,sdf:v,version:0,userImage:H}),H.onAdd&&H.onAdd(this,_)}}}updateImage(_,s){const h=this.style.getImage(_);if(!h)return this.fire(new g.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=s instanceof Ic||zl&&s instanceof zl?g.exported.getImageData(s):s,{width:E,height:D,data:R}=v;return void 0===E||void 0===D?this.fire(new g.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):E!==h.data.width||D!==h.data.height?this.fire(new g.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(h.data.replace(R,!(s instanceof Ic||zl&&s instanceof zl)),void this.style.updateImage(_,h))}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new g.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,s){g.getImage(this._requestManager.transformRequest(_,g.ResourceType.Image),(h,v)=>{s(h,v instanceof Ic?g.exported.getImageData(v):v)})}listImages(){return this.style.listImages()}addLayer(_,s){return this._lazyInitEmptyStyle(),this.style.addLayer(_,s),this._update(!0)}moveLayer(_,s){return this.style.moveLayer(_,s),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}setLayerZoomRange(_,s,h){return this.style.setLayerZoomRange(_,s,h),this._update(!0)}setFilter(_,s,h={}){return this.style.setFilter(_,s,h),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,s,h,v={}){return this.style.setPaintProperty(_,s,h,v),this._update(!0)}getPaintProperty(_,s){return this.style.getPaintProperty(_,s)}setLayoutProperty(_,s,h,v={}){return this.style.setLayoutProperty(_,s,h,v),this._update(!0)}getLayoutProperty(_,s){return this.style.getLayoutProperty(_,s)}setLight(_,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,s),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(_){return this._lazyInitEmptyStyle(),this.style.setTerrain(_),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(_){return this._lazyInitEmptyStyle(),this.style.setFog(_),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(_){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(g.LngLat.convert(_),this.transform):0}setFeatureState(_,s){return this.style.setFeatureState(_,s),this._update()}removeFeatureState(_,s){return this.style.removeFeatureState(_,s),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}_containerDimensions(){let _=0,s=0;return this._container&&(_=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300),[_,s]}_detectMissingCSS(){"rgb(250, 128, 114)"!==g.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&g.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const _=this._container;_.classList.add("mapboxgl-map"),(this._missingCSSCanary=ct.create("div","mapboxgl-canary",_)).style.visibility="hidden",this._detectMissingCSS();const s=this._canvasContainer=ct.create("div","mapboxgl-canvas-container",_);this._interactive&&s.classList.add("mapboxgl-interactive"),this._canvas=ct.create("canvas","mapboxgl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const h=this._containerDimensions();this._resizeCanvas(h[0],h[1]);const v=this._controlContainer=ct.create("div","mapboxgl-control-container",_),E=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(D=>{E[D]=ct.create("div",`mapboxgl-ctrl-${D}`,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,s){const h=g.exported.devicePixelRatio||1;this._canvas.width=h*Math.ceil(_),this._canvas.height=h*Math.ceil(s),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${s}px`}_addMarker(_){this._markers.push(_)}_removeMarker(_){const s=this._markers.indexOf(_);-1!==s&&this._markers.splice(s,1)}_setupPainter(){const _=g.extend({},Do.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._canvas.getContext("webgl",_)||this._canvas.getContext("experimental-webgl",_);s?(g.storeAuthState(s,!0),this.painter=new Pu(s,this.transform),this.on("data",h=>{"source"===h.dataType&&this.painter.setTileLoadedFlag(!0)}),g.exported$1.testSupport(s)):this.fire(new g.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(_){_.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new g.Event("webglcontextlost",{originalEvent:_}))}_contextRestored(_){this._setupPainter(),this.resize(),this._update(),this.fire(new g.Event("webglcontextrestored",{originalEvent:_}))}_onMapScroll(_){if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_requestDomTask(_){!this.isMoving()&&this.loaded()?_():this._domRenderTaskQueue.add(_)}_render(_){let s;const h=this.painter.context.extTimerQuery,v=g.exported.now();this.listens("gpu-timing-frame")&&(s=h.createQueryEXT(),h.beginQueryEXT(h.TIME_ELAPSED_EXT,s));let E=this._updateAverageElevation(v);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._domRenderTaskQueue.run(_),this._removed)return;let D=!1;const R=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,$=g.exported.now();this.style.zoomHistory.update(z,$);const H=new g.EvaluationParameters(z,{now:$,fadeDuration:R,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Q=H.crossFadingFactor();1===Q&&Q===this._crossFadingFactor||(D=!0,this._crossFadingFactor=Q),this.style.update(H)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform),this._forceMarkerUpdate()),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,R,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:R,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new g.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new g.Event("load"))),this.style&&(this.style.hasTransitions()||D)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const z=g.exported.now()-v;h.endQueryEXT(h.TIME_ELAPSED_EXT,s),setTimeout(()=>{const $=h.getQueryObjectEXT(s,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(s),this.fire(new g.Event("gpu-timing-frame",{cpuTime:z,gpuTime:$}))},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const $=this.painter.queryGpuTimers(z);this.fire(new g.Event("gpu-timing-layer",{layerTimes:$}))},50)}const B=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(B||this._repaint)this.triggerRepaint();else{const z=!this.isMoving()&&this.loaded();if(z&&(E=this._updateAverageElevation(v,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),z&&(this.fire(new g.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const $=this._calculateSpeedIndex();this.fire(new g.Event("speedindexcompleted",{speedIndex:$})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||B||(this._fullyLoaded=!0,this._authenticate()),this}_forceMarkerUpdate(){for(const _ of this._markers)_._update()}_updateAverageElevation(_,s=!1){const h=v=>(this.transform.averageElevation=v,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&h(0);if((s||_-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(_)){const v=this.transform.averageElevation;let E=this.transform.sampleAverageElevation();isNaN(E)?E=0:this._averageElevationLastSampledAt=_;const D=Math.abs(v-E);if(D>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(E),h(E);this._averageElevation.easeTo(E,_,300)}else if(D>1e-4)return this._averageElevation.jumpTo(E),h(E)}return!!this._averageElevation.isEasing(_)&&h(this._averageElevation.getValue(_))}_authenticate(){g.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,_=>{if(_&&(_.message===g.AUTH_ERR_MSG||401===_.status)){const s=this.painter.context.gl;g.storeAuthState(s,!1),this._logoControl instanceof zu&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new g.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),g.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const _=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());const h=this.painter.context.gl,v=h.createFramebuffer();function E(D){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,D,0);const R=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,R),R}return h.bindFramebuffer(h.FRAMEBUFFER,v),this._canvasPixelComparison(E(_),s.canvasCopies.map(E),s.timeStamps)}_canvasPixelComparison(_,s,h){let v=h[1]-h[0];const E=_.length/4;for(let D=0;D<s.length;D++){const R=s[D];let B=0;for(let z=0;z<R.length;z+=4)R[z]===_[z]&&R[z+1]===_[z+1]&&R[z+2]===_[z+2]&&R[z+3]===_[z+3]&&(B+=1);v+=(h[D+2]-h[D+1])*(1-B/E)}return v}remove(){this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==g.window&&(g.window.removeEventListener("resize",this._onWindowResize,!1),g.window.removeEventListener("orientationchange",this._onWindowResize,!1),g.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),g.window.removeEventListener("online",this._onWindowOnline,!1));const _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),Ei(this._canvasContainer),Ei(this._controlContainer),Ei(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),g.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new g.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(_){this._renderNextFrame=this._renderNextFrame||_,this.style&&!this._frame&&(this._frame=g.exported.frame(s=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(s)}))}_onWindowOnline(){this._update()}_onWindowResize(_){this._trackResize&&this.resize({originalEvent:_})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(_){this._showTerrainWireframe!==_&&(this._showTerrainWireframe=_,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(_){this._speedIndexTiming!==_&&(this._speedIndexTiming=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}_setCacheLimits(_,s){g.setCacheLimits(_,s)}get version(){return g.version}},NavigationControl:class{constructor(_){this.options=g.extend({},ka,_),this._container=ct.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(g.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>this._map.zoomIn({},{originalEvent:s})),ct.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>this._map.zoomOut({},{originalEvent:s})),ct.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(g.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:s}):this._map.resetNorth({},{originalEvent:s})}),this._compassIcon=ct.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const _=this._map.getZoom(),s=_===this._map.getMaxZoom(),h=_===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())}_rotateCompassArrow(){const _=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=_)})}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Gr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ct.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,s){const h=ct.create("button",_,this._container);return h.type="button",h.addEventListener("click",s),h}_setButtonTitle(_,s){const h=this._map._getUIString(`NavigationControl.${s}`);_.title=h,_.setAttribute("aria-label",h)}},GeolocateControl:class extends g.Evented{constructor(_){super(),this.options=g.extend({},_f,_),g.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=Qr(this._updateMarkerRotation,20)}onAdd(_){var s;return this._map=_,this._container=ct.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),s=this._setupUI,void 0!==ol?s(ol):void 0!==g.window.navigator.permissions?g.window.navigator.permissions.query({name:"geolocation"}).then(h=>{ol="denied"!==h.state,s(ol)}):(ol=!!g.window.navigator.geolocation,s(ol)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(g.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ct.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,kc=0,Vl=!1}_isOutOfMapMaxBounds(_){const s=this._map.getMaxBounds(),h=_.coords;return s&&(h.longitude<s.getWest()||h.longitude>s.getEast()||h.latitude<s.getSouth()||h.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new g.Event("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(_),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(_),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new g.Event("geolocate",_)),this._finish()}}_updateCamera(_){const s=new g.LngLat(_.coords.longitude,_.coords.latitude),h=_.coords.accuracy,v=this._map.getBearing(),E=g.extend({bearing:v},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(h),E,{geolocateSource:!0})}_updateMarker(_){if(_){const s=new g.LngLat(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const _=this._map._container.getBoundingClientRect().height/2,s=this._map.unproject([0,_]),h=this._map.unproject([100,_]),v=s.distanceTo(h)/100,E=Math.ceil(2*this._accuracy/v);this._circleElement.style.width=`${E}px`,this._circleElement.style.height=`${E}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(_){if(this._map){if(this.options.trackUserLocation)if(1===_.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===_.code&&Vl)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new g.Event("error",_)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(_){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=ct.create("button","mapboxgl-ctrl-geolocate",this._container),ct.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===_){g.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ct.create("div","mapboxgl-user-location"),this._dotElement.appendChild(ct.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ct.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Vu({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ct.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Vu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||"ACTIVE_LOCK"!==this._watchState||s.originalEvent&&"resize"===s.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new g.Event("trackuserlocationend")))})}_onDeviceOrientation(_){this._userLocationDotMarker&&(_.webkitCompassHeading?this._heading=_.webkitCompassHeading:!0===_.absolute&&(this._heading=-1*_.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return g.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new g.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":kc--,Vl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new g.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new g.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),kc++,kc>1?(_={maximumAge:6e5,timeout:0},Vl=!0):(_=this.options.positionOptions,Vl=!1),this._geolocationWatchID=g.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else g.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const _=()=>{g.window.addEventListener("ondeviceorientationabsolute"in g.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener)};void 0!==g.window.DeviceMotionEvent&&"function"==typeof g.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(s=>{"granted"===s&&_()}).catch(console.error):_()}_clearWatch(){g.window.navigator.geolocation.clearWatch(this._geolocationWatchID),g.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),g.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Nh,ScaleControl:class{constructor(_){this.options=g.extend({},pm,_),g.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){yf(this._map,this._container,this.options)}onAdd(_){return this._map=_,this._container=ct.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ct.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(_){this.options.unit=_,yf(this._map,this._container,this.options)}},FullscreenControl:class{constructor(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof g.window.HTMLElement?this._container=_.container:g.warnOnce("Full screen control 'container' must be a DOM element.")),g.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in g.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in g.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=ct.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",g.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){ct.remove(this._controlContainer),this._map=null,g.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!g.window.document.fullscreenEnabled&&!g.window.document.webkitFullscreenEnabled)}_setupUI(){const _=this._fullscreenButton=ct.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ct.create("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden",!0),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),g.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(g.window.document.fullscreenElement||g.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?g.window.document.exitFullscreen?g.window.document.exitFullscreen():g.window.document.webkitCancelFullScreen&&g.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends g.Evented{constructor(_){super(),this.options=g.extend(Object.create(ju),_),g.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this),this._classList=new Set(_&&_.className?_.className.trim().split(/\s+/):[])}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("preclick",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new g.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&ct.remove(this._content),this._container&&(ct.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new g.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=g.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(g.window.document.createTextNode(_))}setHTML(_){const s=g.window.document.createDocumentFragment(),h=g.window.document.createElement("body");let v;for(h.innerHTML=_;v=h.firstChild,v;)s.appendChild(v);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ct.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){return this._classList.add(_),this._container&&this._updateClassList(),this}removeClassName(_){return this._classList.delete(_),this._container&&this._updateClassList(),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){let s;return this._classList.delete(_)?s=!1:(this._classList.add(_),s=!0),this._container&&this._updateClassList(),s}_createCloseButton(){this.options.closeButton&&(this._closeButton=ct.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(_){this._update(_.point)}_onMouseMove(_){this._update(_.point)}_onDrag(_){this._update(_.point)}_getAnchor(_){if(this.options.anchor)return this.options.anchor;const s=this._pos,h=this._container.offsetWidth,v=this._container.offsetHeight;let E;return E=s.y+_.bottom.y<v?["top"]:s.y>this._map.transform.height-v?["bottom"]:[],s.x<h/2?E.push("left"):s.x>this._map.transform.width-h/2&&E.push("right"),0===E.length?"bottom":E.join("-")}_updateClassList(){const _=[...this._classList];_.push("mapboxgl-popup"),this._anchor&&_.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&_.push("mapboxgl-popup-track-pointer"),this._container.className=_.join(" ")}_update(_){if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(this._container||(this._container=ct.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=ct.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=zh(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||_){const s=this._pos=this._trackPointer&&_?_:this._map.project(this._lngLat),h=function(D){if(D||(D=new g.pointGeometry(0,0)),"number"==typeof D){const R=Math.round(Math.sqrt(.5*Math.pow(D,2)));return{center:new g.pointGeometry(0,0),top:new g.pointGeometry(0,D),"top-left":new g.pointGeometry(R,R),"top-right":new g.pointGeometry(-R,R),bottom:new g.pointGeometry(0,-D),"bottom-left":new g.pointGeometry(R,-R),"bottom-right":new g.pointGeometry(-R,-R),left:new g.pointGeometry(D,0),right:new g.pointGeometry(-D,0)}}if(D instanceof g.pointGeometry||Array.isArray(D)){const R=g.pointGeometry.convert(D);return{center:R,top:R,"top-left":R,"top-right":R,bottom:R,"bottom-left":R,"bottom-right":R,left:R,right:R}}return{center:g.pointGeometry.convert(D.center||[0,0]),top:g.pointGeometry.convert(D.top||[0,0]),"top-left":g.pointGeometry.convert(D["top-left"]||[0,0]),"top-right":g.pointGeometry.convert(D["top-right"]||[0,0]),bottom:g.pointGeometry.convert(D.bottom||[0,0]),"bottom-left":g.pointGeometry.convert(D["bottom-left"]||[0,0]),"bottom-right":g.pointGeometry.convert(D["bottom-right"]||[0,0]),left:g.pointGeometry.convert(D.left||[0,0]),right:g.pointGeometry.convert(D.right||[0,0])}}(this.options.offset),v=this._anchor=this._getAnchor(h),E=s.add(h[v]).round();this._map._requestDomTask(()=>{this._container&&v&&ct.setTransform(this._container,`${Nl[v]} translate(${E.x}px,${E.y}px)`)})}this._updateClassList()}}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(Gu);_&&_.focus()}_onClose(){this.remove()}_setOpacity(_){this._content&&(this._content.style.opacity=_),this._tip&&(this._tip.style.opacity=_)}},Marker:Vu,Style:Jo,LngLat:g.LngLat,LngLatBounds:g.LngLatBounds,Point:g.pointGeometry,MercatorCoordinate:g.MercatorCoordinate,FreeCameraOptions:Oh,Evented:g.Evented,config:g.config,prewarm:function(){mt().acquire(Ee)},clearPrewarmedResources:function(){const _=Je;_&&(_.isPreloaded()&&1===_.numActive()?(_.release(Ee),Je=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return g.config.ACCESS_TOKEN},set accessToken(_){g.config.ACCESS_TOKEN=_},get baseApiUrl(){return g.config.API_URL},set baseApiUrl(_){g.config.API_URL=_},get workerCount(){return Oe.workerCount},set workerCount(_){Oe.workerCount=_},get maxParallelImageRequests(){return g.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){g.config.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage(_){g.clearTileCache(_)},workerUrl:"",workerClass:null,setNow:g.exported.setNow,restoreNow:g.exported.restoreNow};return Pc}),Hs}()},177:(wd,$s,Ua)=>{"use strict";function Hs(n){return"function"==typeof n}let Cd=!1;const ga={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){if(n){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else Cd&&console.log("RxJS: Back to a better error behavior. Thank you. <3");Cd=n},get useDeprecatedSynchronousErrorHandling(){return Cd}};function g(n){setTimeout(()=>{throw n},0)}const Do={closed:!0,next(n){},error(n){if(ga.useDeprecatedSynchronousErrorHandling)throw n;g(n)},complete(){}},qo=Array.isArray||(n=>n&&"number"==typeof n.length);function mo(n){return null!==n&&"object"==typeof n}const ct=(()=>{function n(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((e,r)=>`${r+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return n.prototype=Object.create(Error.prototype),n})();class Et{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let t;if(this.closed)return;let{_parentOrParents:e,_ctorUnsubscribe:r,_unsubscribe:o,_subscriptions:c}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,e instanceof Et)e.remove(this);else if(null!==e)for(let p=0;p<e.length;++p)e[p].remove(this);if(Hs(o)){r&&(this._unsubscribe=void 0);try{o.call(this)}catch(p){t=p instanceof ct?ms(p.errors):[p]}}if(qo(c)){let p=-1,w=c.length;for(;++p<w;){const T=c[p];if(mo(T))try{T.unsubscribe()}catch(O){t=t||[],O instanceof ct?t=t.concat(ms(O.errors)):t.push(O)}}}if(t)throw new ct(t)}add(t){let e=t;if(!t)return Et.EMPTY;switch(typeof t){case"function":e=new Et(t);case"object":if(e===this||e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof Et)){const c=e;e=new Et,e._subscriptions=[c]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}let{_parentOrParents:r}=e;if(null===r)e._parentOrParents=this;else if(r instanceof Et){if(r===this)return e;e._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return e;r.push(this)}const o=this._subscriptions;return null===o?this._subscriptions=[e]:o.push(e),e}remove(t){const e=this._subscriptions;if(e){const r=e.indexOf(t);-1!==r&&e.splice(r,1)}}}var n;function ms(n){return n.reduce((t,e)=>t.concat(e instanceof ct?e.errors:e),[])}Et.EMPTY=((n=new Et).closed=!0,n);const ja="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class qn extends Et{constructor(t,e,r){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=Do;break;case 1:if(!t){this.destination=Do;break}if("object"==typeof t){t instanceof qn?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new du(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new du(this,t,e,r)}}[ja](){return this}static create(t,e,r){const o=new qn(t,e,r);return o.syncErrorThrowable=!1,o}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class du extends qn{constructor(t,e,r,o){super(),this._parentSubscriber=t;let c,p=this;Hs(e)?c=e:e&&(c=e.next,r=e.error,o=e.complete,e!==Do&&(p=Object.create(e),Hs(p.unsubscribe)&&this.add(p.unsubscribe.bind(p)),p.unsubscribe=this.unsubscribe.bind(this))),this._context=p,this._next=c,this._error=r,this._complete=o}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;ga.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:r}=ga;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):g(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;g(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);ga.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(r){if(this.unsubscribe(),ga.useDeprecatedSynchronousErrorHandling)throw r;g(r)}}__tryOrSetError(t,e,r){if(!ga.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(o){return ga.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=o,t.syncErrorThrown=!0,!0):(g(o),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const gs="function"==typeof Symbol&&Symbol.observable||"@@observable";function di(n){return n}let Hn=(()=>{class n{constructor(e){this._isScalar=!1,e&&(this._subscribe=e)}lift(e){const r=new n;return r.source=this,r.operator=e,r}subscribe(e,r,o){const{operator:c}=this,p=function(n,t,e){if(n){if(n instanceof qn)return n;if(n[ja])return n[ja]()}return n||t||e?new qn(n,t,e):new qn(Do)}(e,r,o);if(p.add(c?c.call(p,this.source):this.source||ga.useDeprecatedSynchronousErrorHandling&&!p.syncErrorThrowable?this._subscribe(p):this._trySubscribe(p)),ga.useDeprecatedSynchronousErrorHandling&&p.syncErrorThrowable&&(p.syncErrorThrowable=!1,p.syncErrorThrown))throw p.syncErrorValue;return p}_trySubscribe(e){try{return this._subscribe(e)}catch(r){ga.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=r),function(n){for(;n;){const{closed:t,destination:e,isStopped:r}=n;if(t||r)return!1;n=e&&e instanceof qn?e:null}return!0}(e)?e.error(r):console.warn(r)}}forEach(e,r){return new(r=Ai(r))((o,c)=>{let p;p=this.subscribe(w=>{try{e(w)}catch(T){c(T),p&&p.unsubscribe()}},c,o)})}_subscribe(e){const{source:r}=this;return r&&r.subscribe(e)}[gs](){return this}pipe(...e){return 0===e.length?this:function(n){return 0===n.length?di:1===n.length?n[0]:function(e){return n.reduce((r,o)=>o(r),e)}}(e)(this)}toPromise(e){return new(e=Ai(e))((r,o)=>{let c;this.subscribe(p=>c=p,p=>o(p),()=>r(c))})}}return n.create=t=>new n(t),n})();function Ai(n){if(n||(n=ga.Promise||Promise),!n)throw new Error("no Promise impl found");return n}const _s=(()=>{function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n})();class xl extends Et{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}class bl extends qn{constructor(t){super(t),this.destination=t}}let vi=(()=>{class n extends Hn{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[ja](){return new bl(this)}lift(e){const r=new lc(this,this);return r.operator=e,r}next(e){if(this.closed)throw new _s;if(!this.isStopped){const{observers:r}=this,o=r.length,c=r.slice();for(let p=0;p<o;p++)c[p].next(e)}}error(e){if(this.closed)throw new _s;this.hasError=!0,this.thrownError=e,this.isStopped=!0;const{observers:r}=this,o=r.length,c=r.slice();for(let p=0;p<o;p++)c[p].error(e);this.observers.length=0}complete(){if(this.closed)throw new _s;this.isStopped=!0;const{observers:e}=this,r=e.length,o=e.slice();for(let c=0;c<r;c++)o[c].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(e){if(this.closed)throw new _s;return super._trySubscribe(e)}_subscribe(e){if(this.closed)throw new _s;return this.hasError?(e.error(this.thrownError),Et.EMPTY):this.isStopped?(e.complete(),Et.EMPTY):(this.observers.push(e),new xl(this,e))}asObservable(){const e=new Hn;return e.source=this,e}}return n.create=(t,e)=>new lc(t,e),n})();class lc extends vi{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):Et.EMPTY}}function ys(n){return n&&"function"==typeof n.schedule}function pn(n,t){return function(r){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new Zo(n,t))}}class Zo{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new Br(t,this.project,this.thisArg))}}class Br extends qn{constructor(t,e,r){super(t),this.project=e,this.count=0,this.thisArg=r||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(r){return void this.destination.error(r)}this.destination.next(e)}}const Ha=n=>t=>{for(let e=0,r=n.length;e<r&&!t.closed;e++)t.next(n[e]);t.complete()},qa="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",zn=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Cl(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}const El=n=>{if(n&&"function"==typeof n[gs])return(n=>t=>{const e=n[gs]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)})(n);if(zn(n))return Ha(n);if(Cl(n))return(n=>t=>(n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,g),t))(n);if(n&&"function"==typeof n[qa])return(n=>t=>{const e=n[qa]();for(;;){let r;try{r=e.next()}catch(o){return t.error(o),t}if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof e.return&&t.add(()=>{e.return&&e.return()}),t})(n);{const e=`You provided ${mo(n)?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(e)}};function go(n,t){return new Hn(e=>{const r=new Et;let o=0;return r.add(t.schedule(function(){o!==n.length?(e.next(n[o++]),e.closed||r.add(this.schedule())):e.complete()})),r})}function Nr(n,t){return t?function(n,t){if(null!=n){if(function(n){return n&&"function"==typeof n[gs]}(n))return function(n,t){return new Hn(e=>{const r=new Et;return r.add(t.schedule(()=>{const o=n[gs]();r.add(o.subscribe({next(c){r.add(t.schedule(()=>e.next(c)))},error(c){r.add(t.schedule(()=>e.error(c)))},complete(){r.add(t.schedule(()=>e.complete()))}}))})),r})}(n,t);if(Cl(n))return function(n,t){return new Hn(e=>{const r=new Et;return r.add(t.schedule(()=>n.then(o=>{r.add(t.schedule(()=>{e.next(o),r.add(t.schedule(()=>e.complete()))}))},o=>{r.add(t.schedule(()=>e.error(o)))}))),r})}(n,t);if(zn(n))return go(n,t);if(function(n){return n&&"function"==typeof n[qa]}(n)||"string"==typeof n)return function(n,t){if(!n)throw new Error("Iterable cannot be null");return new Hn(e=>{const r=new Et;let o;return r.add(()=>{o&&"function"==typeof o.return&&o.return()}),r.add(t.schedule(()=>{o=n[qa](),r.add(t.schedule(function(){if(e.closed)return;let c,p;try{const w=o.next();c=w.value,p=w.done}catch(w){return void e.error(w)}p?e.complete():(e.next(c),this.schedule())}))})),r})}(n,t)}throw new TypeError((null!==n&&typeof n||n)+" is not observable")}(n,t):n instanceof Hn?n:new Hn(El(n))}class ya extends qn{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class Zs extends qn{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function va(n,t){if(t.closed)return;if(n instanceof Hn)return n.subscribe(t);let e;try{e=El(n)(t)}catch(r){t.error(r)}return e}function mr(n,t,e=Number.POSITIVE_INFINITY){return"function"==typeof t?r=>r.pipe(mr((o,c)=>Nr(n(o,c)).pipe(pn((p,w)=>t(o,p,c,w))),e)):("number"==typeof t&&(e=t),r=>r.lift(new Xa(n,e)))}class Xa{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new _u(t,this.project,this.concurrent))}}class _u extends Zs{constructor(t,e,r=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=r,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const r=this.index++;try{e=this.project(t,r)}catch(o){return void this.destination.error(o)}this.active++,this._innerSub(e)}_innerSub(t){const e=new ya(this),r=this.destination;r.add(e);const o=va(t,e);o!==e&&r.add(o)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyComplete(){const t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function Wo(n=Number.POSITIVE_INFINITY){return mr(di,n)}function Mo(n,t){return t?go(n,t):new Hn(Ha(n))}function Dl(){return function(t){return t.lift(new xh(t))}}class xh{constructor(t){this.connectable=t}call(t,e){const{connectable:r}=this;r._refCount++;const o=new cc(t,r),c=e.subscribe(o);return o.closed||(o.connection=r.connect()),c}}class cc extends qn{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:r}=this,o=t._connection;this.connection=null,o&&(!r||o===r)&&o.unsubscribe()}}class uc extends Hn{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new Et,t.add(this.source.subscribe(new Dd(this.getSubject(),this))),t.closed&&(this._connection=null,t=Et.EMPTY)),t}refCount(){return Dl()(this)}}const bh=(()=>{const n=uc.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:n._subscribe},_isComplete:{value:n._isComplete,writable:!0},getSubject:{value:n.getSubject},connect:{value:n.connect},refCount:{value:n.refCount}}})();class Dd extends bl{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function wh(){return new vi}function On(n){for(let t in n)if(n[t]===On)return t;throw Error("Could not find renamed property on target object.")}function xa(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function un(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(un).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function ba(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const Ac=On({__forward_ref__:On});function Zn(n){return n.__forward_ref__=Zn,n.toString=function(){return un(this())},n}function ne(n){return Z(n)?n():n}function Z(n){return"function"==typeof n&&n.hasOwnProperty(Ac)&&n.__forward_ref__===Zn}class ae extends Error{constructor(t,e){super(function(n,t){return`${n?`NG0${n}: `:""}${t}`}(t,e)),this.code=t}}function we(n){return"string"==typeof n?n:null==n?"":String(n)}function ke(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():we(n)}function mt(n,t){const e=t?` in ${t}`:"";throw new ae("201",`No provider for ${ke(n)} found${e}`)}function Xt(n,t){null==n&&function(n,t,e,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${e} ${r} ${t} <=Actual]`))}(t,n,null,"!=")}function Wt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function gr(n){return{providers:n.providers||[],imports:n.imports||[]}}function tr(n){return Sd(n,Xo)||Sd(n,dn)}function Sd(n,t){return n.hasOwnProperty(t)?n[t]:null}function mc(n){return n&&(n.hasOwnProperty(bu)||n.hasOwnProperty(Td))?n[bu]:null}const Xo=On({\u0275prov:On}),bu=On({\u0275inj:On}),dn=On({ngInjectableDef:On}),Td=On({ngInjectorDef:On});var Yt=(()=>((Yt=Yt||{})[Yt.Default=0]="Default",Yt[Yt.Host=1]="Host",Yt[Yt.Self=2]="Self",Yt[Yt.SkipSelf=4]="SkipSelf",Yt[Yt.Optional=8]="Optional",Yt))();let fi;function wa(n){const t=fi;return fi=n,t}function wu(n,t,e){const r=tr(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:e&Yt.Optional?null:void 0!==t?t:void mt(un(n),"Injector")}function No(n){return{toString:n}.toString()}var pi=(()=>((pi=pi||{})[pi.OnPush=0]="OnPush",pi[pi.Default=1]="Default",pi))(),_r=(()=>((_r=_r||{})[_r.Emulated=0]="Emulated",_r[_r.None=2]="None",_r[_r.ShadowDom=3]="ShadowDom",_r))();const Eu="undefined"!=typeof globalThis&&globalThis,Ch="undefined"!=typeof window&&window,om="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,cr=Eu||"undefined"!=typeof global&&global||Ch||om,Ko={},Qn=[],gc=On({\u0275cmp:On}),_c=On({\u0275dir:On}),Id=On({\u0275pipe:On}),cf=On({\u0275mod:On}),kd=On({\u0275loc:On}),Ws=On({\u0275fac:On}),Ca=On({__NG_ELEMENT_ID__:On});let am=0;function zo(n){return No(()=>{const e={},r={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===pi.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||Qn,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||_r.Emulated,id:"c",styles:n.styles||Qn,_:null,setInput:null,schemas:n.schemas||null,tView:null},o=n.directives,c=n.features,p=n.pipes;return r.id+=am++,r.inputs=es(n.inputs,e),r.outputs=es(n.outputs),c&&c.forEach(w=>w(r)),r.directiveDefs=o?()=>("function"==typeof o?o():o).map(Eh):null,r.pipeDefs=p?()=>("function"==typeof p?p():p).map(Jo):null,r})}function Eh(n){return Fi(n)||function(n){return n[_c]||null}(n)}function Jo(n){return function(n){return n[Id]||null}(n)}const Dh={};function Gi(n){return No(()=>{const t={type:n.type,bootstrap:n.bootstrap||Qn,declarations:n.declarations||Qn,imports:n.imports||Qn,exports:n.exports||Qn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(Dh[n.id]=n.type),t})}function es(n,t){if(null==n)return Ko;const e={};for(const r in n)if(n.hasOwnProperty(r)){let o=n[r],c=o;Array.isArray(o)&&(c=o[1],o=o[0]),e[o]=r,t&&(t[o]=c)}return e}const Kt=zo;function bi(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Fi(n){return n[gc]||null}function So(n,t){const e=n[cf]||null;if(!e&&!0===t)throw new Error(`Type ${un(n)} does not have '\u0275mod' property.`);return e}function ws(n){return Array.isArray(n)&&"object"==typeof n[1]}function Vo(n){return Array.isArray(n)&&!0===n[1]}function el(n){return 0!=(8&n.flags)}function Th(n){return 2==(2&n.flags)}function Iu(n){return 1==(1&n.flags)}function ns(n){return null!==n.template}function cm(n){return 0!=(512&n[2])}function Rl(n,t){return n.hasOwnProperty(Ws)?n[Ws]:null}class kh{constructor(t,e,r){this.previousValue=t,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}function Sr(){return rs}function rs(n){return n.type.prototype.ngOnChanges&&(n.setInput=tl),Ph}function Ph(){const n=Pu(this),t=null==n?void 0:n.current;if(t){const e=n.previous;if(e===Ko)n.previous=t;else for(let r in t)e[r]=t[r];n.current=null,this.ngOnChanges(t)}}function tl(n,t,e,r){const o=Pu(n)||function(n,t){return n[Rh]=t}(n,{previous:Ko,current:null}),c=o.current||(o.current={}),p=o.previous,w=this.declaredInputs[e],T=p[w];c[w]=new kh(T&&T.currentValue,t,p===Ko),n[r]=t}Sr.ngInherit=!0;const Rh="__ngSimpleChanges__";function Pu(n){return n[Rh]||null}let nl;function Qr(n){return!!n.listen}const rl={createRenderer:(n,t)=>void 0!==nl?nl:"undefined"!=typeof document?document:void 0};function ai(n){for(;Array.isArray(n);)n=n[0];return n}function Ec(n,t){return ai(t[n])}function no(n,t){return ai(t[n.index])}function ro(n,t){return n.data[t]}function Io(n,t){const e=t[n];return ws(e)?e:e[0]}function Fl(n){return 4==(4&n[2])}function Lh(n){return 128==(128&n[2])}function Cs(n,t){return null==t?null:n[t]}function Vd(n){n[18]=0}function Dc(n,t){n[5]+=t;let e=n,r=n[3];for(;null!==r&&(1===t&&1===e[5]||-1===t&&0===e[5]);)r[5]+=t,e=r,r=r[3]}const ln={lFrame:Wd(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Js(){return ln.bindingsEnabled}function ht(){return ln.lFrame.lView}function Xn(){return ln.lFrame.tView}function qi(n){return ln.lFrame.contextLView=n,n[8]}function li(){let n=Sc();for(;null!==n&&64===n.type;)n=n.parent;return n}function Sc(){return ln.lFrame.currentTNode}function Es(n,t){const e=ln.lFrame;e.currentTNode=n,e.isParent=t}function Bh(){return ln.lFrame.isParent}function Ol(){ln.lFrame.isParent=!1}function Lu(){return ln.isInCheckNoChangesMode}function il(n){ln.isInCheckNoChangesMode=n}function Ci(){const n=ln.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function Ds(){return ln.lFrame.bindingIndex}function Ll(){return ln.lFrame.bindingIndex++}function ea(n){const t=ln.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function mf(n,t){const e=ln.lFrame;e.bindingIndex=e.bindingRootIndex=n,Nu(t)}function Nu(n){ln.lFrame.currentDirectiveIndex=n}function Nh(){return ln.lFrame.currentQueryIndex}function zu(n){ln.lFrame.currentQueryIndex=n}function Zd(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function zh(n,t,e){if(e&Yt.SkipSelf){let o=t,c=n;for(;!(o=o.parent,null!==o||e&Yt.Host||(o=Zd(c),null===o||(c=c[15],10&o.type))););if(null===o)return!1;t=o,n=c}const r=ln.lFrame=Vu();return r.currentTNode=t,r.lView=n,!0}function Nl(n){const t=Vu(),e=n[1];ln.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function Vu(){const n=ln.lFrame,t=null===n?null:n.child;return null===t?Wd(n):t}function Wd(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function Vh(){const n=ln.lFrame;return ln.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Ic=Vh;function Uu(){const n=Vh();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Ei(){return ln.lFrame.selectedIndex}function ka(n){ln.lFrame.selectedIndex=n}function Gr(){const n=ln.lFrame;return ro(n.tView,n.selectedIndex)}function ta(n,t){for(let e=t.directiveStart,r=t.directiveEnd;e<r;e++){const c=n.data[e].type.prototype,{ngAfterContentInit:p,ngAfterContentChecked:w,ngAfterViewInit:T,ngAfterViewChecked:O,ngOnDestroy:V}=c;p&&(n.contentHooks||(n.contentHooks=[])).push(-e,p),w&&((n.contentHooks||(n.contentHooks=[])).push(e,w),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,w)),T&&(n.viewHooks||(n.viewHooks=[])).push(-e,T),O&&((n.viewHooks||(n.viewHooks=[])).push(e,O),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,O)),null!=V&&(n.destroyHooks||(n.destroyHooks=[])).push(e,V)}}function ju(n,t,e){_(n,t,3,e)}function Gu(n,t,e,r){(3&n[2])===e&&_(n,t,e,r)}function Pc(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function _(n,t,e,r){const c=null!=r?r:-1,p=t.length-1;let w=0;for(let T=void 0!==r?65535&n[18]:0;T<p;T++)if("number"==typeof t[T+1]){if(w=t[T],null!=r&&w>=r)break}else t[T]<0&&(n[18]+=65536),(w<c||-1==c)&&(s(n,e,t,T),n[18]=(4294901760&n[18])+T+2),T++}function s(n,t,e,r){const o=e[r]<0,c=e[r+1],w=n[o?-e[r]:e[r]];if(o){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{c.call(w)}finally{}}}else try{c.call(w)}finally{}}const h=-1;class v{constructor(t,e,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}}function J(n,t,e){const r=Qr(n);let o=0;for(;o<e.length;){const c=e[o];if("number"==typeof c){if(0!==c)break;o++;const p=e[o++],w=e[o++],T=e[o++];r?n.setAttribute(t,w,T,p):t.setAttributeNS(p,w,T)}else{const p=c,w=e[++o];le(p)?r&&n.setProperty(t,p,w):r?n.setAttribute(t,p,w):t.setAttribute(p,w),o++}}return o}function te(n){return 3===n||4===n||6===n}function le(n){return 64===n.charCodeAt(0)}function ce(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let r=0;r<t.length;r++){const o=t[r];"number"==typeof o?e=o:0===e||_e(n,e,o,null,-1===e||2===e?t[++r]:null)}}return n}function _e(n,t,e,r,o){let c=0,p=n.length;if(-1===t)p=-1;else for(;c<n.length;){const w=n[c++];if("number"==typeof w){if(w===t){p=-1;break}if(w>t){p=c-1;break}}}for(;c<n.length;){const w=n[c];if("number"==typeof w)break;if(w===e){if(null===r)return void(null!==o&&(n[c+1]=o));if(r===n[c+1])return void(n[c+2]=o)}c++,null!==r&&c++,null!==o&&c++}-1!==p&&(n.splice(p,0,t),c=p+1),n.splice(c++,0,e),null!==r&&n.splice(c++,0,r),null!==o&&n.splice(c++,0,o)}function se(n){return n!==h}function ue(n){return 32767&n}function ve(n,t){let e=function(n){return n>>16}(n),r=t;for(;e>0;)r=r[15],e--;return r}let Me=!0;function de(n){const t=Me;return Me=n,t}let Pe=0;function wt(n,t){const e=Mt(n,t);if(-1!==e)return e;const r=t[1];r.firstCreatePass&&(n.injectorIndex=t.length,St(r.data,n),St(t,null),St(r.blueprint,null));const o=ft(n,t),c=n.injectorIndex;if(se(o)){const p=ue(o),w=ve(o,t),T=w[1].data;for(let O=0;O<8;O++)t[c+O]=w[p+O]|T[p+O]}return t[c+8]=o,c}function St(n,t){n.push(0,0,0,0,0,0,0,0,t)}function Mt(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function ft(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,r=null,o=t;for(;null!==o;){const c=o[1],p=c.type;if(r=2===p?c.declTNode:1===p?o[6]:null,null===r)return h;if(e++,o=o[15],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return h}function It(n,t,e){!function(n,t,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty(Ca)&&(r=e[Ca]),null==r&&(r=e[Ca]=Pe++);const o=255&r;t.data[n+(o>>5)]|=1<<o}(n,t,e)}function tn(n,t,e){if(e&Yt.Optional)return n;mt(t,"NodeInjector")}function $r(n,t,e,r){if(e&Yt.Optional&&void 0===r&&(r=null),0==(e&(Yt.Self|Yt.Host))){const o=n[9],c=wa(void 0);try{return o?o.get(t,r,e&Yt.Optional):wu(t,r,e&Yt.Optional)}finally{wa(c)}}return tn(r,t,e)}function Cr(n,t,e,r=Yt.Default,o){if(null!==n){const c=function(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(Ca)?n[Ca]:void 0;return"number"==typeof t?t>=0?255&t:Mn:t}(e);if("function"==typeof c){if(!zh(t,n,r))return r&Yt.Host?tn(o,e,r):$r(t,e,r,o);try{const p=c(r);if(null!=p||r&Yt.Optional)return p;mt(e)}finally{Ic()}}else if("number"==typeof c){let p=null,w=Mt(n,t),T=h,O=r&Yt.Host?t[16][6]:null;for((-1===w||r&Yt.SkipSelf)&&(T=-1===w?ft(n,t):t[w+8],T!==h&&Ms(r,!1)?(p=t[1],w=ue(T),t=ve(T,t)):w=-1);-1!==w;){const V=t[1];if(vo(c,w,V.data)){const W=zr(w,t,e,p,r,O);if(W!==hn)return W}T=t[w+8],T!==h&&Ms(r,t[1].data[w+8]===O)&&vo(c,w,t)?(p=V,w=ue(T),t=ve(T,t)):w=-1}}}return $r(t,e,r,o)}const hn={};function Mn(){return new Ro(li(),ht())}function zr(n,t,e,r,o,c){const p=t[1],w=p.data[n+8],V=yo(w,p,e,null==r?Th(w)&&Me:r!=p&&0!=(3&w.type),o&Yt.Host&&c===w);return null!==V?Po(t,p,V,w):hn}function yo(n,t,e,r,o){const c=n.providerIndexes,p=t.data,w=1048575&c,T=n.directiveStart,V=c>>20,K=o?w+V:n.directiveEnd;for(let ie=r?w:w+V;ie<K;ie++){const fe=p[ie];if(ie<T&&e===fe||ie>=T&&fe.type===e)return ie}if(o){const ie=p[T];if(ie&&ns(ie)&&ie.type===e)return T}return null}function Po(n,t,e,r){let o=n[e];const c=t.data;if(function(n){return n instanceof v}(o)){const p=o;p.resolving&&function(n,t){throw new ae("200",`Circular dependency in DI detected for ${n}`)}(ke(c[e]));const w=de(p.canSeeViewProviders);p.resolving=!0;const T=p.injectImpl?wa(p.injectImpl):null;zh(n,r,Yt.Default);try{o=n[e]=p.factory(void 0,c,n,r),t.firstCreatePass&&e>=r.directiveStart&&function(n,t,e){const{ngOnChanges:r,ngOnInit:o,ngDoCheck:c}=t.type.prototype;if(r){const p=rs(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,p),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,p)}o&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,o),c&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,c),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,c))}(e,c[e],t)}finally{null!==T&&wa(T),de(w),p.resolving=!1,Ic()}}return o}function vo(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function Ms(n,t){return!(n&Yt.Self||n&Yt.Host&&t)}class Ro{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return Cr(this._tNode,this._lView,t,void 0,e)}}function Pn(n){return No(()=>{const t=n.prototype.constructor,e=t[Ws]||Tr(t),r=Object.prototype;let o=Object.getPrototypeOf(n.prototype).constructor;for(;o&&o!==r;){const c=o[Ws]||Tr(o);if(c&&c!==e)return c;o=Object.getPrototypeOf(o)}return c=>new c})}function Tr(n){return Z(n)?()=>{const t=Tr(ne(n));return t&&t()}:Rl(n)}const Di="__parameters__";function so(n,t,e){return No(()=>{const r=function(n){return function(...e){if(n){const r=n(...e);for(const o in r)this[o]=r[o]}}}(t);function o(...c){if(this instanceof o)return r.apply(this,c),this;const p=new o(...c);return w.annotation=p,w;function w(T,O,V){const W=T.hasOwnProperty(Di)?T[Di]:Object.defineProperty(T,Di,{value:[]})[Di];for(;W.length<=V;)W.push(null);return(W[V]=W[V]||[]).push(p),T}}return e&&(o.prototype=Object.create(e.prototype)),o.prototype.ngMetadataName=n,o.annotationCls=o,o})}class on{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Wt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}const jh=new on("AnalyzeForEntryComponents"),$u=Function;function Wi(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let r=n[e];Array.isArray(r)?(t===n&&(t=n.slice(0,e)),Wi(r,t)):t!==n&&t.push(r)}return t}function Ss(n,t){n.forEach(e=>Array.isArray(e)?Ss(e,t):t(e))}function Kd(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function Fc(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function Oc(n,t){const e=[];for(let r=0;r<n;r++)e.push(t);return e}function Oi(n,t,e){let r=ra(n,t);return r>=0?n[1|r]=e:(r=~r,function(n,t,e,r){let o=n.length;if(o==t)n.push(e,r);else if(1===o)n.push(r,n[0]),n[0]=e;else{for(o--,n.push(n[o-1],n[o]);o>t;)n[o]=n[o-2],o--;n[t]=e,n[t+1]=r}}(n,r,t,e)),r}function Pa(n,t){const e=ra(n,t);if(e>=0)return n[1|e]}function ra(n,t){return function(n,t,e){let r=0,o=n.length>>e;for(;o!==r;){const c=r+(o-r>>1),p=n[c<<e];if(t===p)return c<<e;p>t?o=c:r=c+1}return~(o<<e)}(n,t,1)}const Hu={},Ef="__NG_DI_FLAG__",ia="ngTempTokenPath",Df=/\n/gm,Mf="__source",Sf=On({provide:String,useValue:On});let nA;function Bc(n){const t=nA;return nA=n,t}function Lv(n,t=Yt.Default){if(void 0===nA)throw new Error("inject() must be called from an injection context");return null===nA?wu(n,void 0,t):nA.get(n,t&Yt.Optional?null:void 0,t)}function vt(n,t=Yt.Default){return(fi||Lv)(ne(n),t)}const k0=vt;function oa(n){const t=[];for(let e=0;e<n.length;e++){const r=ne(n[e]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let o,c=Yt.Default;for(let p=0;p<r.length;p++){const w=r[p],T=Bv(w);"number"==typeof T?-1===T?o=w.token:c|=T:o=w}t.push(vt(o,c))}else t.push(vt(r))}return t}function Gh(n,t){return n[Ef]=t,n.prototype[Ef]=t,n}function Bv(n){return n[Ef]}function Zu(n,t,e,r){const o=n[ia];throw t[Mf]&&o.unshift(t[Mf]),n.message=function(n,t,e,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let o=un(t);if(Array.isArray(t))o=t.map(un).join(" -> ");else if("object"==typeof t){let c=[];for(let p in t)if(t.hasOwnProperty(p)){let w=t[p];c.push(p+":"+("string"==typeof w?JSON.stringify(w):un(w)))}o=`{${c.join(", ")}}`}return`${e}${r?"("+r+")":""}[${o}]: ${n.replace(Df,"\n  ")}`}("\n"+n.message,o,e,r),n.ngTokenPath=o,n[ia]=null,n}const Wu=Gh(so("Inject",n=>({token:n})),-1),is=Gh(so("Optional"),8),Mi=Gh(so("SkipSelf"),4);let qh;function Xu(n){var t;return(null===(t=function(){if(void 0===qh&&(qh=null,cr.trustedTypes))try{qh=cr.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return qh}())||void 0===t?void 0:t.createHTML(n))||n}class Ul{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Nc extends Ul{getTypeName(){return"HTML"}}class Ts extends Ul{getTypeName(){return"Style"}}class $v extends Ul{getTypeName(){return"Script"}}class Em extends Ul{getTypeName(){return"URL"}}class Hv extends Ul{getTypeName(){return"ResourceURL"}}function Is(n){return n instanceof Ul?n.changingThisBreaksApplicationSecurity:n}function sl(n,t){const e=Lf(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}function Lf(n){return n instanceof Ul&&n.getTypeName()||null}class Zv{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(Xu(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class Wv{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const r=this.inertDocument.createElement("body");e.appendChild(r)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=Xu(t),e;const r=this.inertDocument.createElement("body");return r.innerHTML=Xu(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(r),r}stripCustomNsAttrs(t){const e=t.attributes;for(let o=e.length-1;0<o;o--){const p=e.item(o).name;("xmlns:ns1"===p||0===p.indexOf("ns1:"))&&t.removeAttribute(p)}let r=t.firstChild;for(;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}const Xv=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Yv=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Yu(n){return(n=String(n)).match(Xv)||n.match(Yv)?n:"unsafe:"+n}function N0(n){return(n=String(n)).split(",").map(t=>Yu(t.trim())).join(", ")}function Uo(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function lA(...n){const t={};for(const e of n)for(const r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}const Kr=Uo("area,br,col,hr,img,wbr"),cA=Uo("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Dm=Uo("rp,rt"),zf=lA(Kr,lA(cA,Uo("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),lA(Dm,Uo("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),lA(Dm,cA)),Vf=Uo("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Ku=Uo("srcset"),U0=lA(Vf,Ku,Uo("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Uo("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),j0=Uo("script,style,template");class uA{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,r=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let o=this.checkClobberedElement(e,e.nextSibling);if(o){e=o;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!zf.hasOwnProperty(e))return this.sanitizedSomething=!0,!j0.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const r=t.attributes;for(let o=0;o<r.length;o++){const c=r.item(o),p=c.name,w=p.toLowerCase();if(!U0.hasOwnProperty(w)){this.sanitizedSomething=!0;continue}let T=c.value;Vf[w]&&(T=Yu(T)),Ku[w]&&(T=N0(T)),this.buf.push(" ",p,'="',G0(T),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();zf.hasOwnProperty(e)&&!Kr.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(G0(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const Kv=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Tm=/([^\#-~ |!])/g;function G0(n){return n.replace(/&/g,"&amp;").replace(Kv,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(Tm,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Zh;function Uf(n,t){let e=null;try{Zh=Zh||function(n){const t=new Wv(n);return function(){try{return!!(new window.DOMParser).parseFromString(Xu(""),"text/html")}catch(n){return!1}}()?new Zv(t):t}(n);let r=t?String(t):"";e=Zh.getInertBodyElement(r);let o=5,c=r;do{if(0===o)throw new Error("Failed to sanitize html because the input is unstable");o--,r=c,c=e.innerHTML,e=Zh.getInertBodyElement(r)}while(r!==c);return Xu((new uA).sanitizeChildren(hA(e)||e))}finally{if(e){const r=hA(e)||e;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function hA(n){return"content"in n&&function(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var Vr=(()=>((Vr=Vr||{})[Vr.NONE=0]="NONE",Vr[Vr.HTML=1]="HTML",Vr[Vr.STYLE=2]="STYLE",Vr[Vr.SCRIPT=3]="SCRIPT",Vr[Vr.URL=4]="URL",Vr[Vr.RESOURCE_URL=5]="RESOURCE_URL",Vr))();const Rm="__ngContext__";function ao(n,t){n[Rm]=t}function Fm(n){const t=function(n){return n[Rm]||null}(n);return t?Array.isArray(t)?t:t.lView:null}function Gf(n){return n.ngOriginalError}function h1(n,...t){n.error(...t)}class Vc{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),r=this._findContext(t),o=function(n){return n&&n.ngErrorLogger||h1}(t);o(this._console,"ERROR",t),e&&o(this._console,"ORIGINAL ERROR",e),r&&o(this._console,"ERROR CONTEXT",r)}_findContext(t){return t?function(n){return n.ngDebugContext}(t)||this._findContext(Gf(t)):null}_findOriginalError(t){let e=t&&Gf(t);for(;e&&Gf(e);)e=Gf(e);return e||null}}const zm=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(cr))();function Oa(n){return n instanceof Function?n():n}var ks=(()=>((ks=ks||{})[ks.Important=1]="Important",ks[ks.DashCase=2]="DashCase",ks))();function Gm(n,t){return undefined(n,t)}function gA(n){const t=n[3];return Vo(t)?t[3]:t}function Xh(n){return $m(n[13])}function jc(n){return $m(n[4])}function $m(n){for(;null!==n&&!Vo(n);)n=n[4];return n}function Yh(n,t,e,r,o){if(null!=r){let c,p=!1;Vo(r)?c=r:ws(r)&&(p=!0,r=r[0]);const w=ai(r);0===n&&null!==e?null==o?Ym(t,e,w):eh(t,e,w,o||null,!0):1===n&&null!==e?eh(t,e,w,o||null,!0):2===n?function(n,t,e){const r=yA(n,t);r&&function(n,t,e,r){Qr(n)?n.removeChild(t,e,r):t.removeChild(e)}(n,r,t,e)}(t,w,p):3===n&&t.destroyNode(w),null!=c&&function(n,t,e,r,o){const c=e[7];c!==ai(e)&&Yh(t,n,r,c,o);for(let w=10;w<e.length;w++){const T=e[w];$c(T[1],T,n,t,r,c)}}(t,n,c,e,o)}}function qf(n,t,e){return Qr(n)?n.createElement(t,e):null===e?n.createElement(t):n.createElementNS(e,t)}function Wm(n,t){const e=n[9],r=e.indexOf(t),o=t[3];1024&t[2]&&(t[2]&=-1025,Dc(o,-1)),e.splice(r,1)}function Wf(n,t){if(n.length<=10)return;const e=10+t,r=n[e];if(r){const o=r[17];null!==o&&o!==n&&Wm(o,r),t>0&&(n[e-1][4]=r[4]);const c=Fc(n,10+t);!function(n,t){$c(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const p=c[19];null!==p&&p.detachView(c[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function n_(n,t){if(!(256&t[2])){const e=t[11];Qr(e)&&e.destroyNode&&$c(n,t,e,3,null,null),function(n){let t=n[13];if(!t)return Qf(n[1],n);for(;t;){let e=null;if(ws(t))e=t[13];else{const r=t[10];r&&(e=r)}if(!e){for(;t&&!t[4]&&t!==n;)ws(t)&&Qf(t[1],t),t=t[3];null===t&&(t=n),ws(t)&&Qf(t[1],t),e=t&&t[4]}t=e}}(t)}}function Qf(n,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let r=0;r<e.length;r+=2){const o=t[e[r]];if(!(o instanceof v)){const c=e[r+1];if(Array.isArray(c))for(let p=0;p<c.length;p+=2){const w=o[c[p]],T=c[p+1];try{T.call(w)}finally{}}else try{c.call(o)}finally{}}}}(n,t),function(n,t){const e=n.cleanup,r=t[7];let o=-1;if(null!==e)for(let c=0;c<e.length-1;c+=2)if("string"==typeof e[c]){const p=e[c+1],w="function"==typeof p?p(t):ai(t[p]),T=r[o=e[c+2]],O=e[c+3];"boolean"==typeof O?w.removeEventListener(e[c],T,O):O>=0?r[o=O]():r[o=-O].unsubscribe(),c+=2}else{const p=r[o=e[c+1]];e[c].call(p)}if(null!==r){for(let c=o+1;c<r.length;c++)r[c]();t[7]=null}}(n,t),1===t[1].type&&Qr(t[11])&&t[11].destroy();const e=t[17];if(null!==e&&Vo(t[3])){e!==t[3]&&Wm(e,t);const r=t[19];null!==r&&r.detachView(n)}}}function Xf(n,t,e){return function(n,t,e){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return e[0];if(2&r.flags){const o=n.data[r.directiveStart].encapsulation;if(o===_r.None||o===_r.Emulated)return null}return no(r,e)}(n,t.parent,e)}function eh(n,t,e,r,o){Qr(n)?n.insertBefore(t,e,r,o):t.insertBefore(e,r,o)}function Ym(n,t,e){Qr(n)?n.appendChild(t,e):t.appendChild(e)}function Gl(n,t,e,r,o){null!==r?eh(n,t,e,r,o):Ym(n,t,e)}function yA(n,t){return Qr(n)?n.parentNode(t):t.parentNode}function Km(n,t,e){return a_(n,t,e)}let a_=function(n,t,e){return 40&n.type?no(n,e):null};function Gc(n,t,e,r){const o=Xf(n,r,t),c=t[11],w=Km(r.parent||t[6],r,t);if(null!=o)if(Array.isArray(e))for(let T=0;T<e.length;T++)Gl(c,o,e[T],w,!1);else Gl(c,o,e,w,!1)}function vA(n,t){if(null!==t){const e=t.type;if(3&e)return no(t,n);if(4&e)return xA(-1,n[t.index]);if(8&e){const r=t.child;if(null!==r)return vA(n,r);{const o=n[t.index];return Vo(o)?xA(-1,o):ai(o)}}if(32&e)return Gm(t,n)()||ai(n[t.index]);{const r=eg(n,t);return null!==r?Array.isArray(r)?r[0]:vA(gA(n[16]),r):vA(n,t.next)}}return null}function eg(n,t){return null!==t?n[16][6].projection[t.projection]:null}function xA(n,t){const e=10+n+1;if(e<t.length){const r=t[e],o=r[1].firstChild;if(null!==o)return vA(r,o)}return t[7]}function Kf(n,t,e,r,o,c,p){for(;null!=e;){const w=r[e.index],T=e.type;if(p&&0===t&&(w&&ao(ai(w),r),e.flags|=4),64!=(64&e.flags))if(8&T)Kf(n,t,e.child,r,o,c,!1),Yh(t,n,o,w,c);else if(32&T){const O=Gm(e,r);let V;for(;V=O();)Yh(t,n,o,V,c);Yh(t,n,o,w,c)}else 16&T?bA(n,t,r,e,o,c):Yh(t,n,o,w,c);e=p?e.projectionNext:e.next}}function $c(n,t,e,r,o,c){Kf(e,r,n.firstChild,t,o,c,!1)}function bA(n,t,e,r,o,c){const p=e[16],T=p[6].projection[r.projection];if(Array.isArray(T))for(let O=0;O<T.length;O++)Yh(t,n,o,T[O],c);else Kf(n,t,T,p[3],o,c,!0)}function c_(n,t,e){Qr(n)?n.setAttribute(t,"style",e):t.style.cssText=e}function tg(n,t,e){Qr(n)?""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e):t.className=e}function u_(n,t,e){let r=n.length;for(;;){const o=n.indexOf(t,e);if(-1===o)return o;if(0===o||n.charCodeAt(o-1)<=32){const c=t.length;if(o+c===r||n.charCodeAt(o+c)<=32)return o}e=o+1}}const nh="ng-template";function ng(n,t,e){let r=0;for(;r<n.length;){let o=n[r++];if(e&&"class"===o){if(o=n[r],-1!==u_(o.toLowerCase(),t,0))return!0}else if(1===o){for(;r<n.length&&"string"==typeof(o=n[r++]);)if(o.toLowerCase()===t)return!0;return!1}}return!1}function h_(n){return 4===n.type&&n.value!==nh}function d_(n,t,e){return t===(4!==n.type||e?n.value:nh)}function _1(n,t,e){let r=4;const o=n.attrs||[],c=function(n){for(let t=0;t<n.length;t++)if(te(n[t]))return t;return n.length}(o);let p=!1;for(let w=0;w<t.length;w++){const T=t[w];if("number"!=typeof T){if(!p)if(4&r){if(r=2|1&r,""!==T&&!d_(n,T,e)||""===T&&1===t.length){if(Rs(r))return!1;p=!0}}else{const O=8&r?T:t[++w];if(8&r&&null!==n.attrs){if(!ng(n.attrs,O,e)){if(Rs(r))return!1;p=!0}continue}const W=y1(8&r?"class":T,o,h_(n),e);if(-1===W){if(Rs(r))return!1;p=!0;continue}if(""!==O){let K;K=W>c?"":o[W+1].toLowerCase();const ie=8&r?K:null;if(ie&&-1!==u_(ie,O,0)||2&r&&O!==K){if(Rs(r))return!1;p=!0}}}}else{if(!p&&!Rs(r)&&!Rs(T))return!1;if(p&&Rs(T))continue;p=!1,r=T|1&r}}return Rs(r)||p}function Rs(n){return 0==(1&n)}function y1(n,t,e,r){if(null===t)return-1;let o=0;if(r||!e){let c=!1;for(;o<t.length;){const p=t[o];if(p===n)return o;if(3===p||6===p)c=!0;else{if(1===p||2===p){let w=t[++o];for(;"string"==typeof w;)w=t[++o];continue}if(4===p)break;if(0===p){o+=4;continue}}o+=c?1:2}return-1}return function(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const r=n[e];if("number"==typeof r)return-1;if(r===t)return e;e++}return-1}(t,n)}function $l(n,t,e=!1){for(let r=0;r<t.length;r++)if(_1(n,t[r],e))return!0;return!1}function rg(n,t){e:for(let e=0;e<t.length;e++){const r=t[e];if(n.length===r.length){for(let o=0;o<n.length;o++)if(n[o]!==r[o])continue e;return!0}}return!1}function p_(n,t){return n?":not("+t.trim()+")":t}function v1(n){let t=n[0],e=1,r=2,o="",c=!1;for(;e<n.length;){let p=n[e];if("string"==typeof p)if(2&r){const w=n[++e];o+="["+p+(w.length>0?'="'+w+'"':"")+"]"}else 8&r?o+="."+p:4&r&&(o+=" "+p);else""!==o&&!Rs(p)&&(t+=p_(c,o),o=""),r=p,c=c||!Rs(r);e++}return""!==o&&(t+=p_(c,o)),t}const An={};function Ht(n){np(Xn(),ht(),Ei()+n,Lu())}function np(n,t,e,r){if(!r)if(3==(3&t[2])){const c=n.preOrderCheckHooks;null!==c&&ju(t,c,e)}else{const c=n.preOrderHooks;null!==c&&Gu(t,c,0,e)}ka(e)}function Jh(n,t){return n<<17|t<<2}function co(n){return n>>17&32767}function rp(n){return 2|n}function aa(n){return(131068&n)>>2}function og(n,t){return-131069&n|t<<2}function sg(n){return 1|n}function ql(n,t){const e=n.contentQueries;if(null!==e)for(let r=0;r<e.length;r+=2){const o=e[r],c=e[r+1];if(-1!==c){const p=n.data[c];zu(o),p.contentQueries(2,t[c],c)}}}function MA(n,t,e,r,o,c,p,w,T,O){const V=t.blueprint.slice();return V[0]=o,V[2]=140|r,Vd(V),V[3]=V[15]=n,V[8]=e,V[10]=p||n&&n[10],V[11]=w||n&&n[11],V[12]=T||n&&n[12]||null,V[9]=O||n&&n[9]||null,V[6]=c,V[16]=2==t.type?n[16]:V,V}function La(n,t,e,r,o){let c=n.data[t];if(null===c)c=function(n,t,e,r,o){const c=Sc(),p=Bh(),T=n.data[t]=function(n,t,e,r,o,c){return{type:e,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:o,attrs:c,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,p?c:c&&c.parent,e,t,r,o);return null===n.firstChild&&(n.firstChild=T),null!==c&&(p?null==c.child&&null!==T.parent&&(c.child=T):null===c.next&&(c.next=T)),T}(n,t,e,r,o),ln.lFrame.inI18n&&(c.flags|=64);else if(64&c.type){c.type=e,c.value=r,c.attrs=o;const p=function(){const n=ln.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}();c.injectorIndex=null===p?-1:p.injectorIndex}return Es(c,!0),c}function qc(n,t,e,r){if(0===e)return-1;const o=t.length;for(let c=0;c<e;c++)t.push(r),n.blueprint.push(r),n.data.push(null);return o}function os(n,t,e){Nl(t);try{const r=n.viewQuery;null!==r&&qr(1,r,e);const o=n.template;null!==o&&la(n,t,o,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&ql(n,t),n.staticViewQueries&&qr(2,n.viewQuery,e);const c=n.components;null!==c&&function(n,t){for(let e=0;e<t.length;e++)nr(n,t[e])}(t,c)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{t[2]&=-5,Uu()}}function Zc(n,t,e,r){const o=t[2];if(256==(256&o))return;Nl(t);const c=Lu();try{Vd(t),function(n){ln.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&la(n,t,e,2,r);const p=3==(3&o);if(!c)if(p){const O=n.preOrderCheckHooks;null!==O&&ju(t,O,null)}else{const O=n.preOrderHooks;null!==O&&Gu(t,O,0,null),Pc(t,0)}if(function(n){for(let t=Xh(n);null!==t;t=jc(t)){if(!t[2])continue;const e=t[9];for(let r=0;r<e.length;r++){const o=e[r],c=o[3];0==(1024&o[2])&&Dc(c,1),o[2]|=1024}}}(t),function(n){for(let t=Xh(n);null!==t;t=jc(t))for(let e=10;e<t.length;e++){const r=t[e],o=r[1];Lh(r)&&Zc(o,r,o.template,r[8])}}(t),null!==n.contentQueries&&ql(n,t),!c)if(p){const O=n.contentCheckHooks;null!==O&&ju(t,O)}else{const O=n.contentHooks;null!==O&&Gu(t,O,1),Pc(t,1)}!function(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const o=e[r];if(o<0)ka(~o);else{const c=o,p=e[++r],w=e[++r];mf(p,c),w(2,t[c])}}}finally{ka(-1)}}(n,t);const w=n.components;null!==w&&function(n,t){for(let e=0;e<t.length;e++)Jt(n,t[e])}(t,w);const T=n.viewQuery;if(null!==T&&qr(2,T,r),!c)if(p){const O=n.viewCheckHooks;null!==O&&ju(t,O)}else{const O=n.viewHooks;null!==O&&Gu(t,O,2),Pc(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),c||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Dc(t[3],-1))}finally{Uu()}}function mg(n,t,e,r){const o=t[10],c=!Lu(),p=Fl(t);try{c&&!p&&o.begin&&o.begin(),p&&os(n,t,r),Zc(n,t,e,r)}finally{c&&!p&&o.end&&o.end()}}function la(n,t,e,r,o){const c=Ei(),p=2&r;try{ka(-1),p&&t.length>20&&np(n,t,20,Lu()),e(r,o)}finally{ka(c)}}function Wc(n,t,e){if(el(t)){const o=t.directiveEnd;for(let c=t.directiveStart;c<o;c++){const p=n.data[c];p.contentQueries&&p.contentQueries(1,e[c],c)}}}function cp(n,t,e){!Js()||(function(n,t,e,r){const o=e.directiveStart,c=e.directiveEnd;n.firstCreatePass||wt(e,t),ao(r,t);const p=e.initialInputs;for(let w=o;w<c;w++){const T=n.data[w],O=ns(T);O&&Ue(t,e,T);const V=Po(t,n,w,e);ao(V,t),null!==p&&pt(0,w-o,V,T,0,p),O&&(Io(e.index,t)[8]=V)}}(n,t,e,no(e,t)),128==(128&e.flags)&&function(n,t,e){const r=e.directiveStart,o=e.directiveEnd,p=e.index,w=ln.lFrame.currentDirectiveIndex;try{ka(p);for(let T=r;T<o;T++){const O=n.data[T],V=t[T];Nu(T),(null!==O.hostBindings||0!==O.hostVars||null!==O.hostAttrs)&&oe(O,V)}}finally{ka(-1),Nu(w)}}(n,t,e))}function up(n,t,e=no){const r=t.localNames;if(null!==r){let o=t.index+1;for(let c=0;c<r.length;c+=2){const p=r[c+1],w=-1===p?e(t,n):n[p];n[o++]=w}}}function TA(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=IA(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function IA(n,t,e,r,o,c,p,w,T,O){const V=20+r,W=V+o,K=function(n,t){const e=[];for(let r=0;r<t;r++)e.push(r<n?null:An);return e}(V,W),ie="function"==typeof O?O():O;return K[1]={type:n,blueprint:K,template:e,queries:null,viewQuery:w,declTNode:t,data:K.slice().fill(null,V),bindingStartIndex:V,expandoStartIndex:W,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof c?c():c,pipeRegistry:"function"==typeof p?p():p,firstChild:null,schemas:T,consts:ie,incompleteFirstPass:!1}}function hp(n,t,e,r){const o=zi(t);null===e?o.push(r):(o.push(e),n.firstCreatePass&&Xr(n).push(r,o.length-1))}function gg(n,t,e){for(let r in n)if(n.hasOwnProperty(r)){const o=n[r];(e=null===e?{}:e).hasOwnProperty(r)?e[r].push(t,o):e[r]=[t,o]}return e}function l(n,t,e,r,o,c,p,w){const T=no(t,e);let V,O=t.inputs;!w&&null!=O&&(V=O[r])?(Ar(n,e,V,r,o),Th(t)&&function(n,t){const e=Io(t,n);16&e[2]||(e[2]|=64)}(e,t.index)):3&t.type&&(r=function(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),o=null!=p?p(o,t.value||"",r):o,Qr(c)?c.setProperty(T,r,o):le(r)||(T.setProperty?T.setProperty(r,o):T[r]=o))}function N(n,t,e,r){let o=!1;if(Js()){const c=function(n,t,e){const r=n.directiveRegistry;let o=null;if(r)for(let c=0;c<r.length;c++){const p=r[c];$l(e,p.selectors,!1)&&(o||(o=[]),It(wt(e,t),n,p.type),ns(p)?(xe(n,e),o.unshift(p)):o.push(p))}return o}(n,t,e),p=null===r?null:{"":-1};if(null!==c){o=!0,Be(e,n.data.length,c.length);for(let V=0;V<c.length;V++){const W=c[V];W.providersResolver&&W.providersResolver(W)}let w=!1,T=!1,O=qc(n,t,c.length,null);for(let V=0;V<c.length;V++){const W=c[V];e.mergedAttrs=ce(e.mergedAttrs,W.hostAttrs),Ne(n,e,t,O,W),Le(O,W,p),null!==W.contentQueries&&(e.flags|=8),(null!==W.hostBindings||null!==W.hostAttrs||0!==W.hostVars)&&(e.flags|=128);const K=W.type.prototype;!w&&(K.ngOnChanges||K.ngOnInit||K.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),w=!0),!T&&(K.ngOnChanges||K.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),T=!0),O++}!function(n,t){const r=t.directiveEnd,o=n.data,c=t.attrs,p=[];let w=null,T=null;for(let O=t.directiveStart;O<r;O++){const V=o[O],W=V.inputs,K=null===c||h_(t)?null:gt(W,c);p.push(K),w=gg(W,O,w),T=gg(V.outputs,O,T)}null!==w&&(w.hasOwnProperty("class")&&(t.flags|=16),w.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=p,t.inputs=w,t.outputs=T}(n,e)}p&&function(n,t,e){if(t){const r=n.localNames=[];for(let o=0;o<t.length;o+=2){const c=e[t[o+1]];if(null==c)throw new ae("301",`Export of name '${t[o+1]}' not found!`);r.push(t[o],c)}}}(e,r,p)}return e.mergedAttrs=ce(e.mergedAttrs,e.attrs),o}function U(n,t,e,r,o,c){const p=c.hostBindings;if(p){let w=n.hostBindingOpCodes;null===w&&(w=n.hostBindingOpCodes=[]);const T=~t.index;(function(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(w)!=T&&w.push(T),w.push(r,o,p)}}function oe(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function xe(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function Le(n,t,e){if(e){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)e[t.exportAs[r]]=n;ns(t)&&(e[""]=n)}}function Be(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function Ne(n,t,e,r,o){n.data[r]=o;const c=o.factory||(o.factory=Rl(o.type)),p=new v(c,ns(o),null);n.blueprint[r]=p,e[r]=p,U(n,t,0,r,qc(n,e,o.hostVars,An),o)}function Ue(n,t,e){const r=no(t,n),o=TA(e),c=n[10],p=Tn(n,MA(n,o,null,e.onPush?64:16,r,t,c,c.createRenderer(r,e),null,null));n[t.index]=p}function pt(n,t,e,r,o,c){const p=c[t];if(null!==p){const w=r.setInput;for(let T=0;T<p.length;){const O=p[T++],V=p[T++],W=p[T++];null!==w?r.setInput(e,W,O,V):e[V]=W}}}function gt(n,t){let e=null,r=0;for(;r<t.length;){const o=t[r];if(0!==o)if(5!==o){if("number"==typeof o)break;n.hasOwnProperty(o)&&(null===e&&(e=[]),e.push(o,n[o],t[r+1])),r+=2}else r+=2;else r+=4}return e}function st(n,t,e,r){return new Array(n,!0,!1,t,null,0,r,e,null,null)}function Jt(n,t){const e=Io(t,n);if(Lh(e)){const r=e[1];80&e[2]?Zc(r,e,r.template,e[8]):e[5]>0&&Tt(e)}}function Tt(n){for(let r=Xh(n);null!==r;r=jc(r))for(let o=10;o<r.length;o++){const c=r[o];if(1024&c[2]){const p=c[1];Zc(p,c,p.template,c[8])}else c[5]>0&&Tt(c)}const e=n[1].components;if(null!==e)for(let r=0;r<e.length;r++){const o=Io(e[r],n);Lh(o)&&o[5]>0&&Tt(o)}}function nr(n,t){const e=Io(t,n),r=e[1];(function(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(r,e),os(r,e,e[8])}function Tn(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function Gt(n){for(;n;){n[2]|=64;const t=gA(n);if(cm(n)&&!t)return n;n=t}return null}function Si(n,t,e){const r=t[10];r.begin&&r.begin();try{Zc(n,t,n.template,e)}catch(o){throw Ti(t,o),o}finally{r.end&&r.end()}}function Hr(n){!function(n){for(let t=0;t<n.components.length;t++){const e=n.components[t],r=Fm(e),o=r[1];mg(o,r,o.template,e)}}(n[8])}function qr(n,t,e){zu(0),t(n,e)}const dr=(()=>Promise.resolve(null))();function zi(n){return n[7]||(n[7]=[])}function Xr(n){return n.cleanup||(n.cleanup=[])}function Ti(n,t){const e=n[9],r=e?e.get(Vc,null):null;r&&r.handleError(t)}function Ar(n,t,e,r,o){for(let c=0;c<e.length;){const p=e[c++],w=e[c++],T=t[p],O=n.data[p];null!==O.setInput?O.setInput(T,o,r,w):T[w]=o}}function ei(n,t,e){const r=Ec(t,n);!function(n,t,e){Qr(n)?n.setValue(t,e):t.textContent=e}(n[11],r,e)}function Ir(n,t,e){let r=e?n.styles:null,o=e?n.classes:null,c=0;if(null!==t)for(let p=0;p<t.length;p++){const w=t[p];"number"==typeof w?c=w:1==c?o=ba(o,w):2==c&&(r=ba(r,w+": "+t[++p]+";"))}e?n.styles=r:n.stylesWithoutHost=r,e?n.classes=o:n.classesWithoutHost=o}const ni=new on("INJECTOR",-1);class ri{get(t,e=Hu){if(e===Hu){const r=new Error(`NullInjectorError: No provider for ${un(t)}!`);throw r.name="NullInjectorError",r}return e}}const jn=new on("Set Injector scope."),Ui={},ss={};let Fs;function Os(){return void 0===Fs&&(Fs=new ri),Fs}function Na(n,t=null,e=null,r){return new xo(n,e,t||Os(),r)}class xo{constructor(t,e,r,o=null){this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const c=[];e&&Ss(e,w=>this.processProvider(w,t,e)),Ss([t],w=>this.processInjectorType(w,[],c)),this.records.set(ni,Qc(void 0,this));const p=this.records.get(jn);this.scope=null!=p?p.value:null,this.source=o||("object"==typeof t?null:un(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=Hu,r=Yt.Default){this.assertNotDestroyed();const o=Bc(this),c=wa(void 0);try{if(!(r&Yt.SkipSelf)){let w=this.records.get(t);if(void 0===w){const T=function(n){return"function"==typeof n||"object"==typeof n&&n instanceof on}(t)&&tr(t);w=T&&this.injectableDefInScope(T)?Qc(ca(t),Ui):null,this.records.set(t,w)}if(null!=w)return this.hydrate(t,w)}return(r&Yt.Self?Os():this.parent).get(t,e=r&Yt.Optional&&e===Hu?null:e)}catch(p){if("NullInjectorError"===p.name){if((p[ia]=p[ia]||[]).unshift(un(t)),o)throw p;return Zu(p,t,"R3InjectorError",this.source)}throw p}finally{wa(c),Bc(o)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((r,o)=>t.push(un(o))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,r){if(!(t=ne(t)))return!1;let o=mc(t);const c=null==o&&t.ngModule||void 0,p=void 0===c?t:c,w=-1!==r.indexOf(p);if(void 0!==c&&(o=mc(c)),null==o)return!1;if(null!=o.imports&&!w){let V;r.push(p);try{Ss(o.imports,W=>{this.processInjectorType(W,e,r)&&(void 0===V&&(V=[]),V.push(W))})}finally{}if(void 0!==V)for(let W=0;W<V.length;W++){const{ngModule:K,providers:ie}=V[W];Ss(ie,fe=>this.processProvider(fe,K,ie||Qn))}}this.injectorDefTypes.add(p);const T=Rl(p)||(()=>new p);this.records.set(p,Qc(T,Ui));const O=o.providers;if(null!=O&&!w){const V=t;Ss(O,W=>this.processProvider(W,V,O))}return void 0!==c&&void 0!==t.providers}processProvider(t,e,r){let o=td(t=ne(t))?t:ne(t&&t.provide);const c=function(n,t,e){return dp(n)?Qc(void 0,n.useValue):Qc(ed(n),Ui)}(t);if(td(t)||!0!==t.multi)this.records.get(o);else{let p=this.records.get(o);p||(p=Qc(void 0,Ui,!0),p.factory=()=>oa(p.multi),this.records.set(o,p)),o=t,p.multi.push(t)}this.records.set(o,c)}hydrate(t,e){return e.value===Ui&&(e.value=ss,e.value=e.factory()),"object"==typeof e.value&&e.value&&function(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=ne(t.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function ca(n){const t=tr(n),e=null!==t?t.factory:Rl(n);if(null!==e)return e;if(n instanceof on)throw new Error(`Token ${un(n)} is missing a \u0275prov definition.`);if(n instanceof Function)return function(n){const t=n.length;if(t>0){const r=Oc(t,"?");throw new Error(`Can't resolve all parameters for ${un(n)}: (${r.join(", ")}).`)}const e=function(n){const t=n&&(n[Xo]||n[dn]);if(t){const e=function(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new Error("unreachable")}function ed(n,t,e){let r;if(td(n)){const o=ne(n);return Rl(o)||ca(o)}if(dp(n))r=()=>ne(n.useValue);else if(function(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...oa(n.deps||[]));else if(function(n){return!(!n||!n.useExisting)}(n))r=()=>vt(ne(n.useExisting));else{const o=ne(n&&(n.useClass||n.provide));if(!function(n){return!!n.deps}(n))return Rl(o)||ca(o);r=()=>new o(...oa(n.deps))}return r}function Qc(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function dp(n){return null!==n&&"object"==typeof n&&Sf in n}function td(n){return"function"==typeof n}const _2=function(n,t,e){return function(n,t=null,e=null,r){const o=Na(n,t,e,r);return o._resolveInjectorDefTypes(),o}({name:e},t,n,e)};let Pr=(()=>{class n{static create(e,r){return Array.isArray(e)?_2(e,r,""):_2(e.providers,e.parent,e.name||"")}}return n.THROW_IF_NOT_FOUND=Hu,n.NULL=new ri,n.\u0275prov=Wt({token:n,providedIn:"any",factory:()=>vt(ni)}),n.__NG_ELEMENT_ID__=-1,n})();function AP(n,t){ta(Fm(n)[1],li())}function ui(n){let t=function(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const r=[n];for(;t;){let o;if(ns(n))o=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");o=t.\u0275dir}if(o){if(e){r.push(o);const p=n;p.inputs=O1(n.inputs),p.declaredInputs=O1(n.declaredInputs),p.outputs=O1(n.outputs);const w=o.hostBindings;w&&gP(n,w);const T=o.viewQuery,O=o.contentQueries;if(T&&pP(n,T),O&&mP(n,O),xa(n.inputs,o.inputs),xa(n.declaredInputs,o.declaredInputs),xa(n.outputs,o.outputs),ns(o)&&o.data.animation){const V=n.data;V.animation=(V.animation||[]).concat(o.data.animation)}}const c=o.features;if(c)for(let p=0;p<c.length;p++){const w=c[p];w&&w.ngInherit&&w(n),w===ui&&(e=!1)}}t=Object.getPrototypeOf(t)}!function(n){let t=0,e=null;for(let r=n.length-1;r>=0;r--){const o=n[r];o.hostVars=t+=o.hostVars,o.hostAttrs=ce(o.hostAttrs,e=ce(e,o.hostAttrs))}}(r)}function O1(n){return n===Ko?{}:n===Qn?[]:n}function pP(n,t){const e=n.viewQuery;n.viewQuery=e?(r,o)=>{t(r,o),e(r,o)}:t}function mP(n,t){const e=n.contentQueries;n.contentQueries=e?(r,o,c)=>{t(r,o,c),e(r,o,c)}:t}function gP(n,t){const e=n.hostBindings;n.hostBindings=e?(r,o)=>{t(r,o),e(r,o)}:t}let k_=null;function Ap(){if(!k_){const n=cr.Symbol;if(n&&n.iterator)k_=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const r=t[e];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(k_=r)}}}return k_}class Wl{constructor(t){this.wrapped=t}static wrap(t){return new Wl(t)}static unwrap(t){return Wl.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof Wl}}function xg(n){return!!L1(n)&&(Array.isArray(n)||!(n instanceof Map)&&Ap()in n)}function L1(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Yc(n,t,e){return n[t]=e}function cs(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function PA(n,t,e,r){const o=cs(n,t,e);return cs(n,t+1,r)||o}function Qi(n,t,e,r,o,c,p,w){const T=ht(),O=Xn(),V=n+20,W=O.firstCreatePass?function(n,t,e,r,o,c,p,w,T){const O=t.consts,V=La(t,n,4,p||null,Cs(O,w));N(t,e,V,Cs(O,T)),ta(t,V);const W=V.tViews=IA(2,V,r,o,c,t.directiveRegistry,t.pipeRegistry,null,t.schemas,O);return null!==t.queries&&(t.queries.template(t,V),W.queries=t.queries.embeddedTView(V)),V}(V,O,T,t,e,r,o,c,p):O.data[V];Es(W,!1);const K=T[11].createComment("");Gc(O,T,K,W),ao(K,T),Tn(T,T[V]=st(K,T,K,W)),Iu(W)&&cp(O,T,W),null!=p&&up(T,W,w)}function lt(n,t=Yt.Default){const e=ht();return null===e?vt(n,t):Cr(li(),e,ne(n),t)}function vn(n,t,e){const r=ht();return cs(r,Ll(),t)&&l(Xn(),Gr(),r,n,t,r[11],e,!1),vn}function U1(n,t,e,r,o){const p=o?"class":"style";Ar(n,e,t.inputs[p],p,r)}function We(n,t,e,r){const o=ht(),c=Xn(),p=20+n,w=o[11],T=o[p]=qf(w,t,ln.lFrame.currentNamespace),O=c.firstCreatePass?function(n,t,e,r,o,c,p){const w=t.consts,O=La(t,n,2,o,Cs(w,c));return N(t,e,O,Cs(w,p)),null!==O.attrs&&Ir(O,O.attrs,!1),null!==O.mergedAttrs&&Ir(O,O.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,O),O}(p,c,o,0,t,e,r):c.data[p];Es(O,!0);const V=O.mergedAttrs;null!==V&&J(w,T,V);const W=O.classes;null!==W&&tg(w,T,W);const K=O.styles;null!==K&&c_(w,T,K),64!=(64&O.flags)&&Gc(c,o,T,O),0===ln.lFrame.elementDepthCount&&ao(T,o),ln.lFrame.elementDepthCount++,Iu(O)&&(cp(c,o,O),Wc(c,O,o)),null!==r&&up(o,O)}function Qe(){let n=li();Bh()?Ol():(n=n.parent,Es(n,!1));const t=n;ln.lFrame.elementDepthCount--;const e=Xn();e.firstCreatePass&&(ta(e,n),el(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function(n){return 0!=(16&n.flags)}(t)&&U1(e,t,ht(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(n){return 0!=(32&n.flags)}(t)&&U1(e,t,ht(),t.stylesWithoutHost,!1)}function Bs(n,t,e,r){We(n,t,e,r),Qe()}function F_(n,t,e){const r=ht(),o=Xn(),c=n+20,p=o.firstCreatePass?function(n,t,e,r,o){const c=t.consts,p=Cs(c,r),w=La(t,n,8,"ng-container",p);return null!==p&&Ir(w,p,!0),N(t,e,w,Cs(c,o)),null!==t.queries&&t.queries.elementStart(t,w),w}(c,o,r,t,e):o.data[c];Es(p,!0);const w=r[c]=r[11].createComment("");Gc(o,r,w,p),ao(w,r),Iu(p)&&(cp(o,r,p),Wc(o,p,r)),null!=e&&up(r,p)}function O_(){let n=li();const t=Xn();Bh()?Ol():(n=n.parent,Es(n,!1)),t.firstCreatePass&&(ta(t,n),el(n)&&t.queries.elementEnd(n))}function L_(){return ht()}function wg(n){return!!n&&"function"==typeof n.then}const B_=function(n){return!!n&&"function"==typeof n.subscribe};function Er(n,t,e,r){const o=ht(),c=Xn(),p=li();return function(n,t,e,r,o,c,p,w){const T=Iu(r),V=n.firstCreatePass&&Xr(n),W=t[8],K=zi(t);let ie=!0;if(3&r.type||w){const Re=no(r,t),tt=w?w(Re):Re,He=K.length,Ot=w?Qt=>w(ai(Qt[r.index])):r.index;if(Qr(e)){let Qt=null;if(!w&&T&&(Qt=function(n,t,e,r){const o=n.cleanup;if(null!=o)for(let c=0;c<o.length-1;c+=2){const p=o[c];if(p===e&&o[c+1]===r){const w=t[7],T=o[c+2];return w.length>T?w[T]:null}"string"==typeof p&&(c+=2)}return null}(n,t,o,r.index)),null!==Qt)(Qt.__ngLastListenerFn__||Qt).__ngNextListenerFn__=c,Qt.__ngLastListenerFn__=c,ie=!1;else{c=j1(r,t,W,c,!1);const Fn=e.listen(tt,o,c);K.push(c,Fn),V&&V.push(o,Ot,He,He+1)}}else c=j1(r,t,W,c,!0),tt.addEventListener(o,c,p),K.push(c),V&&V.push(o,Ot,He,p)}else c=j1(r,t,W,c,!1);const fe=r.outputs;let Ve;if(ie&&null!==fe&&(Ve=fe[o])){const Re=Ve.length;if(Re)for(let tt=0;tt<Re;tt+=2){const Ki=t[Ve[tt]][Ve[tt+1]].subscribe(c),Ho=K.length;K.push(c,Ki),V&&V.push(o,r.index,Ho,-(Ho+1))}}}(c,o,o[11],p,n,t,!!e,r),Er}function oC(n,t,e,r){try{return!1!==e(r)}catch(o){return Ti(n,o),!1}}function j1(n,t,e,r,o){return function c(p){if(p===Function)return r;const w=2&n.flags?Io(n.index,t):t;0==(32&t[2])&&Gt(w);let T=oC(t,0,r,p),O=c.__ngNextListenerFn__;for(;O;)T=oC(t,0,O,p)&&T,O=O.__ngNextListenerFn__;return o&&!1===T&&(p.preventDefault(),p.returnValue=!1),T}}function Ur(n=1){return function(n){return(ln.lFrame.contextLView=function(n,t){for(;n>0;)t=t[15],n--;return t}(n,ln.lFrame.contextLView))[8]}(n)}function JP(n,t){let e=null;const r=function(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let o=0;o<t.length;o++){const c=t[o];if("*"!==c){if(null===r?$l(n,c,!0):rg(r,c))return o}else e=o}return e}function pC(n,t,e,r,o){const c=n[e+1],p=null===t;let w=r?co(c):aa(c),T=!1;for(;0!==w&&(!1===T||p);){const V=n[w+1];nR(n[w],t)&&(T=!0,n[w+1]=r?sg(V):rp(V)),w=r?co(V):aa(V)}T&&(n[e+1]=r?rp(c):sg(c))}function nR(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&ra(n,t)>=0}const bo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function mC(n){return n.substring(bo.key,bo.keyEnd)}function rR(n){return n.substring(bo.value,bo.valueEnd)}function _C(n,t){const e=bo.textEnd;let r=bo.key=Cp(n,t,e);return e===r?-1:(r=bo.keyEnd=function(n,t,e){let r;for(;t<e&&(45===(r=n.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(n,r,e),r=vC(n,r,e),r=bo.value=Cp(n,r,e),r=bo.valueEnd=function(n,t,e){let r=-1,o=-1,c=-1,p=t,w=p;for(;p<e;){const T=n.charCodeAt(p++);if(59===T)return w;34===T||39===T?w=p=xC(n,T,p,e):t===p-4&&85===c&&82===o&&76===r&&40===T?w=p=xC(n,41,p,e):T>32&&(w=p),c=o,o=r,r=-33&T}return w}(n,r,e),vC(n,r,e))}function Cp(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function vC(n,t,e,r){return(t=Cp(n,t,e))<e&&t++,t}function xC(n,t,e,r){let o=-1,c=e;for(;c<r;){const p=n.charCodeAt(c++);if(p==t&&92!==o)return c;o=92==p&&92===o?0:p}throw new Error}function RA(n,t,e){return Ql(n,t,e,!1),RA}function ua(n,t){return Ql(n,t,null,!0),ua}function ul(n){!function(n,t,e,r){const o=Xn(),c=ea(2);o.firstUpdatePass&&wC(o,null,c,r);const p=ht();if(e!==An&&cs(p,c,e)){const w=o.data[Ei()];if(MC(w,r)&&!bC(o,c)){let T=r?w.classesWithoutHost:w.stylesWithoutHost;null!==T&&(e=ba(T,e||"")),U1(o,w,p,e,r)}else!function(n,t,e,r,o,c,p,w){o===An&&(o=Qn);let T=0,O=0,V=0<o.length?o[0]:null,W=0<c.length?c[0]:null;for(;null!==V||null!==W;){const K=T<o.length?o[T+1]:void 0,ie=O<c.length?c[O+1]:void 0;let Ve,fe=null;V===W?(T+=2,O+=2,K!==ie&&(fe=W,Ve=ie)):null===W||null!==V&&V<W?(T+=2,fe=V):(O+=2,fe=W,Ve=ie),null!==fe&&EC(n,t,e,r,fe,Ve,p,w),V=T<o.length?o[T]:null,W=O<c.length?c[O]:null}}(o,w,p,p[11],p[c+1],p[c+1]=function(n,t,e){if(null==e||""===e)return Qn;const r=[],o=Is(e);if(Array.isArray(o))for(let c=0;c<o.length;c++)n(r,o[c],!0);else if("object"==typeof o)for(const c in o)o.hasOwnProperty(c)&&n(r,c,o[c]);else"string"==typeof o&&t(r,o);return r}(n,t,e),r,c)}}(CC,cR,n,!1)}function cR(n,t){for(let e=function(n){return function(n){bo.key=0,bo.keyEnd=0,bo.value=0,bo.valueEnd=0,bo.textEnd=n.length}(n),_C(n,Cp(n,0,bo.textEnd))}(t);e>=0;e=_C(t,e))CC(n,mC(t),rR(t))}function Ql(n,t,e,r){const o=ht(),c=Xn(),p=ea(2);c.firstUpdatePass&&wC(c,n,p,r),t!==An&&cs(o,p,t)&&EC(c,c.data[Ei()],o,o[11],n,o[p+1]=function(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=un(Is(n)))),n}(t,e),r,p)}function bC(n,t){return t>=n.expandoStartIndex}function wC(n,t,e,r){const o=n.data;if(null===o[e+1]){const c=o[Ei()],p=bC(n,e);MC(c,r)&&null===t&&!p&&(t=!1),t=function(n,t,e,r){const o=function(n){const t=ln.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let c=r?t.residualClasses:t.residualStyles;if(null===o)0===(r?t.classBindings:t.styleBindings)&&(e=Cg(e=q1(null,n,t,e,r),t.attrs,r),c=null);else{const p=t.directiveStylingLast;if(-1===p||n[p]!==o)if(e=q1(o,n,t,e,r),null===c){let T=function(n,t,e){const r=e?t.classBindings:t.styleBindings;if(0!==aa(r))return n[co(r)]}(n,t,r);void 0!==T&&Array.isArray(T)&&(T=q1(null,n,t,T[1],r),T=Cg(T,t.attrs,r),function(n,t,e,r){n[co(e?t.classBindings:t.styleBindings)]=r}(n,t,r,T))}else c=function(n,t,e){let r;const o=t.directiveEnd;for(let c=1+t.directiveStylingLast;c<o;c++)r=Cg(r,n[c].hostAttrs,e);return Cg(r,t.attrs,e)}(n,t,r)}return void 0!==c&&(r?t.residualClasses=c:t.residualStyles=c),e}(o,c,t,r),function(n,t,e,r,o,c){let p=c?t.classBindings:t.styleBindings,w=co(p),T=aa(p);n[r]=e;let V,O=!1;if(Array.isArray(e)){const W=e;V=W[1],(null===V||ra(W,V)>0)&&(O=!0)}else V=e;if(o)if(0!==T){const K=co(n[w+1]);n[r+1]=Jh(K,w),0!==K&&(n[K+1]=og(n[K+1],r)),n[w+1]=function(n,t){return 131071&n|t<<17}(n[w+1],r)}else n[r+1]=Jh(w,0),0!==w&&(n[w+1]=og(n[w+1],r)),w=r;else n[r+1]=Jh(T,0),0===w?w=r:n[T+1]=og(n[T+1],r),T=r;O&&(n[r+1]=rp(n[r+1])),pC(n,V,r,!0),pC(n,V,r,!1),function(n,t,e,r,o){const c=o?n.residualClasses:n.residualStyles;null!=c&&"string"==typeof t&&ra(c,t)>=0&&(e[r+1]=sg(e[r+1]))}(t,V,n,r,c),p=Jh(w,T),c?t.classBindings=p:t.styleBindings=p}(o,c,t,e,p,r)}}function q1(n,t,e,r,o){let c=null;const p=e.directiveEnd;let w=e.directiveStylingLast;for(-1===w?w=e.directiveStart:w++;w<p&&(c=t[w],r=Cg(r,c.hostAttrs,o),c!==n);)w++;return null!==n&&(e.directiveStylingLast=w),r}function Cg(n,t,e){const r=e?1:2;let o=-1;if(null!==t)for(let c=0;c<t.length;c++){const p=t[c];"number"==typeof p?o=p:o===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Oi(n,p,!!e||t[++c]))}return void 0===n?null:n}function CC(n,t,e){Oi(n,t,Is(e))}function EC(n,t,e,r,o,c,p,w){if(!(3&t.type))return;const T=n.data,O=T[w+1];N_(function(n){return 1==(1&n)}(O)?DC(T,t,e,o,aa(O),p):void 0)||(N_(c)||function(n){return 2==(2&n)}(O)&&(c=DC(T,null,e,o,w,p)),function(n,t,e,r,o){const c=Qr(n);if(t)o?c?n.addClass(e,r):e.classList.add(r):c?n.removeClass(e,r):e.classList.remove(r);else{let p=-1===r.indexOf("-")?void 0:ks.DashCase;if(null==o)c?n.removeStyle(e,r,p):e.style.removeProperty(r);else{const w="string"==typeof o&&o.endsWith("!important");w&&(o=o.slice(0,-10),p|=ks.Important),c?n.setStyle(e,r,o,p):e.style.setProperty(r,o,w?"important":"")}}}(r,p,Ec(Ei(),e),o,c))}function DC(n,t,e,r,o,c){const p=null===t;let w;for(;o>0;){const T=n[o],O=Array.isArray(T),V=O?T[1]:T,W=null===V;let K=e[o+1];K===An&&(K=W?Qn:void 0);let ie=W?Pa(K,r):V===r?K:void 0;if(O&&!N_(ie)&&(ie=Pa(T,r)),N_(ie)&&(w=ie,p))return w;const fe=n[o+1];o=p?co(fe):aa(fe)}if(null!==t){let T=c?t.residualClasses:t.residualStyles;null!=T&&(w=Pa(T,r))}return w}function N_(n){return void 0!==n}function MC(n,t){return 0!=(n.flags&(t?16:32))}function Zt(n,t=""){const e=ht(),r=Xn(),o=n+20,c=r.firstCreatePass?La(r,o,1,t,null):r.data[o],p=e[o]=function(n,t){return Qr(n)?n.createText(t):n.createTextNode(t)}(e[11],t);Gc(r,e,p,c),Es(c,!1)}function Z1(n){return za("",n,""),Z1}function za(n,t,e){const r=ht(),o=function(n,t,e,r){return cs(n,Ll(),e)?t+we(e)+r:An}(r,n,t,e);return o!==An&&ei(r,Ei(),o),za}function FA(n,t,e,r,o){const c=ht(),p=function(n,t,e,r,o,c){const w=PA(n,Ds(),e,o);return ea(2),w?t+we(e)+r+we(o)+c:An}(c,n,t,e,r,o);return p!==An&&ei(c,Ei(),p),FA}function z_(n,t,e){const r=ht();return cs(r,Ll(),t)&&l(Xn(),Gr(),r,n,t,r[11],e,!0),z_}const OA=void 0;var BR=["en",[["a","p"],["AM","PM"],OA],[["AM","PM"],OA,OA],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],OA,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],OA,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",OA,"{1} 'at' {0}",OA],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(n){const t=Math.floor(Math.abs(n)),e=n.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===e?1:5}];let Ep={};function Ns(n){const t=function(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=qC(t);if(e)return e;const r=t.split("-")[0];if(e=qC(r),e)return e;if("en"===r)return BR;throw new Error(`Missing locale data for the locale "${n}".`)}function qC(n){return n in Ep||(Ep[n]=cr.ng&&cr.ng.common&&cr.ng.common.locales&&cr.ng.common.locales[n]),Ep[n]}var zt=(()=>((zt=zt||{})[zt.LocaleId=0]="LocaleId",zt[zt.DayPeriodsFormat=1]="DayPeriodsFormat",zt[zt.DayPeriodsStandalone=2]="DayPeriodsStandalone",zt[zt.DaysFormat=3]="DaysFormat",zt[zt.DaysStandalone=4]="DaysStandalone",zt[zt.MonthsFormat=5]="MonthsFormat",zt[zt.MonthsStandalone=6]="MonthsStandalone",zt[zt.Eras=7]="Eras",zt[zt.FirstDayOfWeek=8]="FirstDayOfWeek",zt[zt.WeekendRange=9]="WeekendRange",zt[zt.DateFormat=10]="DateFormat",zt[zt.TimeFormat=11]="TimeFormat",zt[zt.DateTimeFormat=12]="DateTimeFormat",zt[zt.NumberSymbols=13]="NumberSymbols",zt[zt.NumberFormats=14]="NumberFormats",zt[zt.CurrencyCode=15]="CurrencyCode",zt[zt.CurrencySymbol=16]="CurrencySymbol",zt[zt.CurrencyName=17]="CurrencyName",zt[zt.Currencies=18]="Currencies",zt[zt.Directionality=19]="Directionality",zt[zt.PluralCase=20]="PluralCase",zt[zt.ExtraData=21]="ExtraData",zt))();const V_="en-US";let ZC=V_;function W1(n){Xt(n,"Expected localeId to be defined"),"string"==typeof n&&(ZC=n.toLowerCase().replace(/_/g,"-"))}function Y1(n,t,e,r,o){if(n=ne(n),Array.isArray(n))for(let c=0;c<n.length;c++)Y1(n[c],t,e,r,o);else{const c=Xn(),p=ht();let w=td(n)?n:ne(n.provide),T=ed(n);const O=li(),V=1048575&O.providerIndexes,W=O.directiveStart,K=O.providerIndexes>>20;if(td(n)||!n.multi){const ie=new v(T,o,lt),fe=J1(w,t,o?V:V+K,W);-1===fe?(It(wt(O,p),c,w),K1(c,n,t.length),t.push(w),O.directiveStart++,O.directiveEnd++,o&&(O.providerIndexes+=1048576),e.push(ie),p.push(ie)):(e[fe]=ie,p[fe]=ie)}else{const ie=J1(w,t,V+K,W),fe=J1(w,t,V,V+K),Ve=ie>=0&&e[ie],Re=fe>=0&&e[fe];if(o&&!Re||!o&&!Ve){It(wt(O,p),c,w);const tt=function(n,t,e,r,o){const c=new v(n,e,lt);return c.multi=[],c.index=t,c.componentProviders=0,gE(c,o,r&&!e),c}(o?F3:R3,e.length,o,r,T);!o&&Re&&(e[fe].providerFactory=tt),K1(c,n,t.length,0),t.push(w),O.directiveStart++,O.directiveEnd++,o&&(O.providerIndexes+=1048576),e.push(tt),p.push(tt)}else K1(c,n,ie>-1?ie:fe,gE(e[o?fe:ie],T,!o&&r));!o&&r&&Re&&e[fe].componentProviders++}}}function K1(n,t,e,r){const o=td(t);if(o||function(n){return!!n.useClass}(t)){const p=(t.useClass||t).prototype.ngOnDestroy;if(p){const w=n.destroyHooks||(n.destroyHooks=[]);if(!o&&t.multi){const T=w.indexOf(e);-1===T?w.push(e,[r,p]):w[T+1].push(r,p)}else w.push(e,p)}}}function gE(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function J1(n,t,e,r){for(let o=e;o<r;o++)if(t[o]===n)return o;return-1}function R3(n,t,e,r){return ex(this.multi,[])}function F3(n,t,e,r){const o=this.multi;let c;if(this.providerFactory){const p=this.providerFactory.componentProviders,w=Po(e,e[1],this.providerFactory.index,r);c=w.slice(0,p),ex(o,c);for(let T=p;T<w.length;T++)c.push(w[T])}else c=[],ex(o,c);return c}function ex(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function hi(n,t=[]){return e=>{e.providersResolver=(r,o)=>function(n,t,e){const r=Xn();if(r.firstCreatePass){const o=ns(n);Y1(e,r.data,r.blueprint,o,!0),Y1(t,r.data,r.blueprint,o,!1)}}(r,o?o(n):n,t)}}class _E{}const vE="ngComponent";class B3{resolveComponentFactory(t){throw function(n){const t=Error(`No component factory found for ${un(n)}. Did you add it to @NgModule.entryComponents?`);return t[vE]=n,t}(t)}}let LA=(()=>{class n{}return n.NULL=new B3,n})();function H_(...n){}function Mp(n,t){return new Xi(no(n,t))}const V3=function(){return Mp(li(),ht())};let Xi=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=V3,n})();function xE(n){return n instanceof Xi?n.nativeElement:n}class q_{}let ah=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>j3(),n})();const j3=function(){const n=ht(),e=Io(li().index,n);return function(n){return n[11]}(ws(e)?e:n)};let nx=(()=>{class n{}return n.\u0275prov=Wt({token:n,providedIn:"root",factory:()=>null}),n})();class Tg{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const bE=new Tg("12.2.12");class wE{constructor(){}supports(t){return xg(t)}create(t){return new q3(t)}}const H3=(n,t)=>t;class q3{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||H3}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,r=this._removalsHead,o=0,c=null;for(;e||r;){const p=!r||e&&e.currentIndex<EE(r,o,c)?e:r,w=EE(p,o,c),T=p.currentIndex;if(p===r)o--,r=r._nextRemoved;else if(e=e._next,null==p.previousIndex)o++;else{c||(c=[]);const O=w-o,V=T-o;if(O!=V){for(let K=0;K<O;K++){const ie=K<c.length?c[K]:c[K]=0,fe=ie+K;V<=fe&&fe<O&&(c[K]=ie+1)}c[p.previousIndex]=V-O}}w!==T&&t(p,w,T)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!xg(t))throw new Error(`Error trying to diff '${un(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let o,c,p,e=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let w=0;w<this.length;w++)c=t[w],p=this._trackByFn(w,c),null!==e&&Object.is(e.trackById,p)?(r&&(e=this._verifyReinsertion(e,c,p,w)),Object.is(e.item,c)||this._addIdentityChange(e,c)):(e=this._mismatch(e,c,p,w),r=!0),e=e._next}else o=0,function(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[Ap()]();let r;for(;!(r=e.next()).done;)t(r.value)}}(t,w=>{p=this._trackByFn(o,w),null!==e&&Object.is(e.trackById,p)?(r&&(e=this._verifyReinsertion(e,w,p,o)),Object.is(e.item,w)||this._addIdentityChange(e,w)):(e=this._mismatch(e,w,p,o),r=!0),e=e._next,o++}),this.length=o;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,r,o){let c;return null===t?c=this._itTail:(c=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,c,o)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,o))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,c,o)):t=this._addAfter(new Z3(e,r),c,o),t}_verifyReinsertion(t,e,r,o){let c=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==c?t=this._reinsertAfter(c,t._prev,o):t.currentIndex!=o&&(t.currentIndex=o,this._addToMoves(t,o)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const o=t._prevRemoved,c=t._nextRemoved;return null===o?this._removalsHead=c:o._nextRemoved=c,null===c?this._removalsTail=o:c._prevRemoved=o,this._insertAfter(t,e,r),this._addToMoves(t,r),t}_moveAfter(t,e,r){return this._unlink(t),this._insertAfter(t,e,r),this._addToMoves(t,r),t}_addAfter(t,e,r){return this._insertAfter(t,e,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,r){const o=null===e?this._itHead:e._next;return t._next=o,t._prev=e,null===o?this._itTail=t:o._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new CE),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,r=t._next;return null===e?this._itHead=r:e._next=r,null===r?this._itTail=e:r._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new CE),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Z3{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class W3{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===e||e<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const e=t._prevDup,r=t._nextDup;return null===e?this._head=r:e._nextDup=r,null===r?this._tail=e:r._prevDup=e,null===this._head}}class CE{constructor(){this.map=new Map}put(t){const e=t.trackById;let r=this.map.get(e);r||(r=new W3,this.map.set(e,r)),r.add(t)}get(t,e){const o=this.map.get(t);return o?o.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function EE(n,t,e){const r=n.previousIndex;if(null===r)return r;let o=0;return e&&r<e.length&&(o=e[r]),r+t+o}class DE{constructor(){}supports(t){return t instanceof Map||L1(t)}create(){return new Q3}}class Q3{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||L1(t)))throw new Error(`Error trying to diff '${un(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,o)=>{if(e&&e.key===o)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{const c=this._getOrCreateRecordForKey(o,r);e=this._insertBeforeOrAppend(e,c)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const r=t._prev;return e._next=t,e._prev=r,t._prev=e,r&&(r._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const o=this._records.get(t);this._maybeAddToChanges(o,e);const c=o._prev,p=o._next;return c&&(c._next=p),p&&(p._prev=c),o._next=null,o._prev=null,o}const r=new X3(t);return this._records.set(t,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(r=>e(t[r],r))}}class X3{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function ME(){return new Ig([new wE])}let Ig=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(null!=r){const o=r.factories.slice();e=e.concat(o)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||ME()),deps:[[n,new Mi,new is]]}}find(e){const r=this.factories.find(o=>o.supports(e));if(null!=r)return r;throw new Error(`Cannot find a differ supporting object '${e}' of type '${function(n){return n.name||typeof n}(e)}'`)}}return n.\u0275prov=Wt({token:n,providedIn:"root",factory:ME}),n})();function SE(){return new Sp([new DE])}let Sp=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(r){const o=r.factories.slice();e=e.concat(o)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||SE()),deps:[[n,new Mi,new is]]}}find(e){const r=this.factories.find(o=>o.supports(e));if(r)return r;throw new Error(`Cannot find a differ supporting object '${e}'`)}}return n.\u0275prov=Wt({token:n,providedIn:"root",factory:SE}),n})();function Z_(n,t,e,r,o=!1){for(;null!==e;){const c=t[e.index];if(null!==c&&r.push(ai(c)),Vo(c))for(let w=10;w<c.length;w++){const T=c[w],O=T[1].firstChild;null!==O&&Z_(T[1],T,O,r)}const p=e.type;if(8&p)Z_(n,t,e.child,r);else if(32&p){const w=Gm(e,t);let T;for(;T=w();)r.push(T)}else if(16&p){const w=eg(t,e);if(Array.isArray(w))r.push(...w);else{const T=gA(t[16]);Z_(T[1],T,w,r,!0)}}e=o?e.projectionNext:e.next}return r}class kg{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return Z_(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Vo(t)){const e=t[8],r=e?e.indexOf(this):-1;r>-1&&(Wf(t,r),Fc(e,r))}this._attachedToViewContainer=!1}n_(this._lView[1],this._lView)}onDestroy(t){hp(this._lView[1],this._lView,null,t)}markForCheck(){Gt(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Si(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(n,t,e){il(!0);try{Si(n,t,e)}finally{il(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(n,t){$c(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class K3 extends kg{constructor(t){super(t),this._view=t}detectChanges(){Hr(this._view)}checkNoChanges(){!function(n){il(!0);try{Hr(n)}finally{il(!1)}}(this._view)}get context(){return null}}const eF=function(n){return function(n,t,e){if(Th(n)&&!e){const r=Io(n.index,t);return new kg(r,r)}return 47&n.type?new kg(t[16],t):null}(li(),ht(),16==(16&n))};let rx=(()=>{class n{}return n.__NG_ELEMENT_ID__=eF,n})();const rF=[new DE],oF=new Ig([new wE]),sF=new Sp(rF),lF=function(){return W_(li(),ht())};let lh=(()=>{class n{}return n.__NG_ELEMENT_ID__=lF,n})();const cF=lh,uF=class extends cF{constructor(t,e,r){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=r}createEmbeddedView(t){const e=this._declarationTContainer.tViews,r=MA(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);r[17]=this._declarationLView[this._declarationTContainer.index];const c=this._declarationLView[19];return null!==c&&(r[19]=c.createEmbeddedView(e)),os(e,r,t),new kg(r)}};function W_(n,t){return 4&n.type?new uF(t,n,Mp(n,t)):null}class eu{}class TE{}const AF=function(){return PE(li(),ht())};let Yl=(()=>{class n{}return n.__NG_ELEMENT_ID__=AF,n})();const pF=Yl,IE=class extends pF{constructor(t,e,r){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=r}get element(){return Mp(this._hostTNode,this._hostLView)}get injector(){return new Ro(this._hostTNode,this._hostLView)}get parentInjector(){const t=ft(this._hostTNode,this._hostLView);if(se(t)){const e=ve(t,this._hostLView),r=ue(t);return new Ro(e[1].data[r+8],e)}return new Ro(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=kE(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,r){const o=t.createEmbeddedView(e||{});return this.insert(o,r),o}createComponent(t,e,r,o,c){const p=r||this.parentInjector;if(!c&&null==t.ngModule&&p){const T=p.get(eu,null);T&&(c=T)}const w=t.create(p,o,void 0,c);return this.insert(w.hostView,e),w}insert(t,e){const r=t._lView,o=r[1];if(function(n){return Vo(n[3])}(r)){const V=this.indexOf(t);if(-1!==V)this.detach(V);else{const W=r[3],K=new IE(W,W[6],W[3]);K.detach(K.indexOf(t))}}const c=this._adjustIndex(e),p=this._lContainer;!function(n,t,e,r){const o=10+r,c=e.length;r>0&&(e[o-1][4]=t),r<c-10?(t[4]=e[o],Kd(e,10+r,t)):(e.push(t),t[4]=null),t[3]=e;const p=t[17];null!==p&&e!==p&&function(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(p,t);const w=t[19];null!==w&&w.insertView(n),t[2]|=128}(o,r,p,c);const w=xA(c,p),T=r[11],O=yA(T,p[7]);return null!==O&&function(n,t,e,r,o,c){r[0]=o,r[6]=t,$c(n,r,e,1,o,c)}(o,p[6],T,r,O,w),t.attachToViewContainerRef(),Kd(ix(p),c,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=kE(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),r=Wf(this._lContainer,e);r&&(Fc(ix(this._lContainer),e),n_(r[1],r))}detach(t){const e=this._adjustIndex(t,-1),r=Wf(this._lContainer,e);return r&&null!=Fc(ix(this._lContainer),e)?new kg(r):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function kE(n){return n[8]}function ix(n){return n[8]||(n[8]=[])}function PE(n,t){let e;const r=t[n.index];if(Vo(r))e=r;else{let o;if(8&n.type)o=ai(r);else{const c=t[11];o=c.createComment("");const p=no(n,t);eh(c,yA(c,p),o,function(n,t){return Qr(n)?n.nextSibling(t):t.nextSibling}(c,p),!1)}t[n.index]=e=st(r,t,o,n),Tn(t,e)}return new IE(e,n,t)}const Pp={};class KE extends LA{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=Fi(t);return new eD(e,this.ngModule)}}function JE(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}const hO=new on("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>zm});class eD extends _E{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function(n){return n.map(v1).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return JE(this.componentDef.inputs)}get outputs(){return JE(this.componentDef.outputs)}create(t,e,r,o){const c=(o=o||this.ngModule)?function(n,t){return{get:(e,r,o)=>{const c=n.get(e,Pp,o);return c!==Pp||r===Pp?c:t.get(e,r,o)}}}(t,o.injector):t,p=c.get(q_,rl),w=c.get(nx,null),T=p.createRenderer(null,this.componentDef),O=this.componentDef.selectors[0][0]||"div",V=r?function(n,t,e){if(Qr(n))return n.selectRootElement(t,e===_r.ShadowDom);let r="string"==typeof t?n.querySelector(t):t;return r.textContent="",r}(T,r,this.componentDef.encapsulation):qf(p.createRenderer(null,this.componentDef),O,function(n){const t=n.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(O)),W=this.componentDef.onPush?576:528,K=function(n,t){return{components:[],scheduler:n||zm,clean:dr,playerHandler:t||null,flags:0}}(),ie=IA(0,null,null,1,0,null,null,null,null,null),fe=MA(null,ie,K,W,null,null,p,T,w,c);let Ve,Re;Nl(fe);try{const tt=function(n,t,e,r,o,c){const p=e[1];e[20]=n;const T=La(p,20,2,"#host",null),O=T.mergedAttrs=t.hostAttrs;null!==O&&(Ir(T,O,!0),null!==n&&(J(o,n,O),null!==T.classes&&tg(o,n,T.classes),null!==T.styles&&c_(o,n,T.styles)));const V=r.createRenderer(n,t),W=MA(e,TA(t),null,t.onPush?64:16,e[20],T,r,V,c||null,null);return p.firstCreatePass&&(It(wt(T,e),p,t.type),xe(p,T),Be(T,e.length,1)),Tn(e,W),e[20]=W}(V,this.componentDef,fe,p,T);if(V)if(r)J(T,V,["ng-version",bE.full]);else{const{attrs:He,classes:Ot}=function(n){const t=[],e=[];let r=1,o=2;for(;r<n.length;){let c=n[r];if("string"==typeof c)2===o?""!==c&&t.push(c,n[++r]):8===o&&e.push(c);else{if(!Rs(o))break;o=c}r++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);He&&J(T,V,He),Ot&&Ot.length>0&&tg(T,V,Ot.join(" "))}if(Re=ro(ie,20),void 0!==e){const He=Re.projection=[];for(let Ot=0;Ot<this.ngContentSelectors.length;Ot++){const Qt=e[Ot];He.push(null!=Qt?Array.from(Qt):null)}}Ve=function(n,t,e,r,o){const c=e[1],p=function(n,t,e){const r=li();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),Ne(n,r,t,qc(n,t,1,null),e));const o=Po(t,n,r.directiveStart,r);ao(o,t);const c=no(r,t);return c&&ao(c,t),o}(c,e,t);if(r.components.push(p),n[8]=p,o&&o.forEach(T=>T(p,t)),t.contentQueries){const T=li();t.contentQueries(1,p,T.directiveStart)}const w=li();return!c.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(ka(w.index),U(e[1],w,0,w.directiveStart,w.directiveEnd,t),oe(t,p)),p}(tt,this.componentDef,fe,K,[AP]),os(ie,fe,null)}finally{Uu()}return new fO(this.componentType,Ve,Mp(Re,fe),fe,Re)}}class fO extends class{}{constructor(t,e,r,o,c){super(),this.location=r,this._rootLView=o,this._tNode=c,this.instance=e,this.hostView=this.changeDetectorRef=new K3(o),this.componentType=t}get injector(){return new Ro(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}const Rp=new Map;class gO extends eu{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new KE(this);const r=So(t),o=function(n){return n[kd]||null}(t);o&&W1(o),this._bootstrapComponents=Oa(r.bootstrap),this._r3Injector=Na(t,e,[{provide:eu,useValue:this},{provide:LA,useValue:this.componentFactoryResolver}],un(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=Pr.THROW_IF_NOT_FOUND,r=Yt.Default){return t===Pr||t===eu||t===ni?this:this._r3Injector.get(t,e,r)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class gx extends TE{constructor(t){super(),this.moduleType=t,null!==So(t)&&function(n){const t=new Set;!function e(r){const o=So(r,!0),c=o.id;null!==c&&(function(n,t,e){if(t&&t!==e)throw new Error(`Duplicate module registered for ${n} - ${un(t)} vs ${un(t.name)}`)}(c,Rp.get(c),r),Rp.set(c,r));const p=Oa(o.imports);for(const w of p)t.has(w)||(t.add(w),e(w))}(n)}(t)}create(t){return new gO(this.moduleType,t)}}function _x(n,t,e,r){return function(n,t,e,r,o,c){const p=t+e;return cs(n,p,o)?Yc(n,p+1,c?r.call(c,o):r(o)):zg(n,p+1)}(ht(),Ci(),n,t,e,r)}function zg(n,t){const e=n[t];return e===An?void 0:e}function yx(n,t){const e=Xn();let r;const o=n+20;e.firstCreatePass?(r=function(n,t){if(t)for(let e=t.length-1;e>=0;e--){const r=t[e];if(n===r.name)return r}throw new ae("302",`The pipe '${n}' could not be found!`)}(t,e.pipeRegistry),e.data[o]=r,r.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(o,r.onDestroy)):r=e.data[o];const c=r.factory||(r.factory=Rl(r.type)),p=wa(lt);try{const w=de(!1),T=c();return de(w),function(n,t,e,r){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=r}(e,ht(),o,T),T}finally{wa(p)}}function vx(n,t,e,r){const o=n+20,c=ht(),p=function(n,t){return n[t]}(c,o);return function(n,t){Wl.isWrapped(t)&&(t=Wl.unwrap(t),n[Ds()]=An);return t}(c,function(n,t){return n[1].data[t].pure}(c,o)?function(n,t,e,r,o,c,p){const w=t+e;return PA(n,w,o,c)?Yc(n,w+2,p?r.call(p,o,c):r(o,c)):zg(n,w+2)}(c,Ci(),t,p.transform,e,r,p):p.transform(e,r))}function xx(n){return t=>{setTimeout(n,void 0,t)}}const rt=class extends vi{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,r){var o,c,p;let w=t,T=e||(()=>null),O=r;if(t&&"object"==typeof t){const W=t;w=null===(o=W.next)||void 0===o?void 0:o.bind(W),T=null===(c=W.error)||void 0===c?void 0:c.bind(W),O=null===(p=W.complete)||void 0===p?void 0:p.bind(W)}this.__isAsync&&(T=xx(T),w&&(w=xx(w)),O&&(O=xx(O)));const V=super.subscribe({next:w,error:T,complete:O});return t instanceof Et&&t.add(V),V}};function PO(){return this._results[Ap()]()}class J_{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Ap(),r=J_.prototype;r[e]||(r[e]=PO)}get changes(){return this._changes||(this._changes=new rt)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const r=this;r.dirty=!1;const o=Wi(t);(this._changesDetected=!function(n,t,e){if(n.length!==t.length)return!1;for(let r=0;r<n.length;r++){let o=n[r],c=t[r];if(e&&(o=e(o),c=e(c)),c!==o)return!1}return!0}(r._results,o,e))&&(r._results=o,r.length=o.length,r.last=o[this.length-1],r.first=o[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class bx{constructor(t){this.queryList=t,this.matches=null}clone(){return new bx(this.queryList)}setDirty(){this.queryList.setDirty()}}class wx{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const r=null!==t.contentQueries?t.contentQueries[0]:e.length,o=[];for(let c=0;c<r;c++){const p=e.getByIndex(c);o.push(this.queries[p.indexInDeclarationView].clone())}return new wx(o)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==AD(t,e).matches&&this.queries[e].setDirty()}}class cD{constructor(t,e,r=null){this.predicate=t,this.flags=e,this.read=r}}class Cx{constructor(t=[]){this.queries=t}elementStart(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let r=0;r<this.length;r++){const o=null!==e?e.length:0,c=this.getByIndex(r).embeddedTView(t,o);c&&(c.indexInDeclarationView=r,null!==e?e.push(c):e=[c])}return null!==e?new Cx(e):null}template(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Ex{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new Ex(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let o=0;o<r.length;o++){const c=r[o];this.matchTNodeWithReadOption(t,e,OO(e,c)),this.matchTNodeWithReadOption(t,e,yo(e,t,c,!1,!1))}else r===lh?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,yo(e,t,r,!1,!1))}matchTNodeWithReadOption(t,e,r){if(null!==r){const o=this.metadata.read;if(null!==o)if(o===Xi||o===Yl||o===lh&&4&e.type)this.addMatch(e.index,-2);else{const c=yo(e,t,o,!1,!1);null!==c&&this.addMatch(e.index,c)}else this.addMatch(e.index,r)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function OO(n,t){const e=n.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===t)return e[r+1];return null}function BO(n,t,e,r){return-1===e?function(n,t){return 11&n.type?Mp(n,t):4&n.type?W_(n,t):null}(t,n):-2===e?function(n,t,e){return e===Xi?Mp(t,n):e===lh?W_(t,n):e===Yl?PE(t,n):void 0}(n,t,r):Po(n,n[1],e,t)}function uD(n,t,e,r){const o=t[19].queries[r];if(null===o.matches){const c=n.data,p=e.matches,w=[];for(let T=0;T<p.length;T+=2){const O=p[T];w.push(O<0?null:BO(t,c[O],p[T+1],e.metadata.read))}o.matches=w}return o.matches}function Dx(n,t,e,r){const o=n.queries.getByIndex(e),c=o.matches;if(null!==c){const p=uD(n,t,o,e);for(let w=0;w<c.length;w+=2){const T=c[w];if(T>0)r.push(p[w/2]);else{const O=c[w+1],V=t[-T];for(let W=10;W<V.length;W++){const K=V[W];K[17]===K[3]&&Dx(K[1],K,O,r)}if(null!==V[9]){const W=V[9];for(let K=0;K<W.length;K++){const ie=W[K];Dx(ie[1],ie,O,r)}}}}}return r}function Fp(n){const t=ht(),e=Xn(),r=Nh();zu(r+1);const o=AD(e,r);if(n.dirty&&Fl(t)===(2==(2&o.metadata.flags))){if(null===o.matches)n.reset([]);else{const c=o.crossesNgTemplate?Dx(e,t,r,[]):uD(e,t,o,r);n.reset(c,xE),n.notifyOnChanges()}return!0}return!1}function Mx(n,t,e){const r=Xn();r.firstCreatePass&&(dD(r,new cD(n,t,e),-1),2==(2&t)&&(r.staticViewQueries=!0)),hD(r,ht(),t)}function Op(){return function(n,t){return n[19].queries[t].queryList}(ht(),Nh())}function hD(n,t,e){const r=new J_(4==(4&e));hp(n,t,r,r.destroy),null===t[19]&&(t[19]=new wx),t[19].queries.push(new bx(r))}function dD(n,t,e){null===n.queries&&(n.queries=new Cx),n.queries.track(new Ex(t,e))}function AD(n,t){return n.queries.getByIndex(t)}const Gg=new on("Application Initializer");let Bp=(()=>{class n{constructor(e){this.appInits=e,this.resolve=H_,this.reject=H_,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,o)=>{this.resolve=r,this.reject=o})}runInitializers(){if(this.initialized)return;const e=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let o=0;o<this.appInits.length;o++){const c=this.appInits[o]();if(wg(c))e.push(c);else if(B_(c)){const p=new Promise((w,T)=>{c.subscribe({complete:w,error:T})});e.push(p)}}Promise.all(e).then(()=>{r()}).catch(o=>{this.reject(o)}),0===e.length&&r(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(vt(Gg,8))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();const $g=new on("AppId"),p4={provide:$g,useFactory:function(){return`${Rx()}${Rx()}${Rx()}`},deps:[]};function Rx(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const kD=new on("Platform Initializer"),ry=new on("Platform ID"),PD=new on("appBootstrapListener");let iy=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();const ch=new on("LocaleId"),RD=new on("DefaultCurrencyCode");class g4{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const Fx=function(n){return new gx(n)},_4=Fx,y4=function(n){return Promise.resolve(Fx(n))},FD=function(n){const t=Fx(n),r=Oa(So(n).declarations).reduce((o,c)=>{const p=Fi(c);return p&&o.push(new eD(p)),o},[]);return new g4(t,r)},v4=FD,x4=function(n){return Promise.resolve(FD(n))};let zA=(()=>{class n{constructor(){this.compileModuleSync=_4,this.compileModuleAsync=y4,this.compileModuleAndAllComponentsSync=v4,this.compileModuleAndAllComponentsAsync=x4}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();const C4=(()=>Promise.resolve(0))();function Ox(n){"undefined"==typeof Zone?C4.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class _i{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new rt(!1),this.onMicrotaskEmpty=new rt(!1),this.onStable=new rt(!1),this.onError=new rt(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&e,o.shouldCoalesceRunChangeDetection=r,o.lastRequestAnimationFrameId=-1,o.nativeRequestAnimationFrame=function(){let n=cr.requestAnimationFrame,t=cr.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(n){const t=()=>{!function(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(cr,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Bx(n),n.isCheckStableRunning=!0,Lx(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Bx(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,r,o,c,p,w)=>{try{return OD(n),e.invokeTask(o,c,p,w)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===c.type||n.shouldCoalesceRunChangeDetection)&&t(),LD(n)}},onInvoke:(e,r,o,c,p,w,T)=>{try{return OD(n),e.invoke(o,c,p,w,T)}finally{n.shouldCoalesceRunChangeDetection&&t(),LD(n)}},onHasTask:(e,r,o,c)=>{e.hasTask(o,c),r===o&&("microTask"==c.change?(n._hasPendingMicrotasks=c.microTask,Bx(n),Lx(n)):"macroTask"==c.change&&(n.hasPendingMacrotasks=c.macroTask))},onHandleError:(e,r,o,c)=>(e.handleError(o,c),n.runOutsideAngular(()=>n.onError.emit(c)),!1)})}(o)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!_i.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(_i.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,r){return this._inner.run(t,e,r)}runTask(t,e,r,o){const c=this._inner,p=c.scheduleEventTask("NgZoneEvent: "+o,t,D4,H_,H_);try{return c.runTask(p,e,r)}finally{c.cancelTask(p)}}runGuarded(t,e,r){return this._inner.runGuarded(t,e,r)}runOutsideAngular(t){return this._outer.run(t)}}const D4={};function Lx(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Bx(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function OD(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function LD(n){n._nesting--,Lx(n)}class T4{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new rt,this.onMicrotaskEmpty=new rt,this.onStable=new rt,this.onError=new rt}run(t,e,r){return t.apply(e,r)}runGuarded(t,e,r){return t.apply(e,r)}runOutsideAngular(t){return t()}runTask(t,e,r,o){return t.apply(e,r)}}let Nx=(()=>{class n{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{_i.assertNotInAngularZone(),Ox(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Ox(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(e)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,o){let c=-1;r&&r>0&&(c=setTimeout(()=>{this._callbacks=this._callbacks.filter(p=>p.timeoutId!==c),e(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:e,timeoutId:c,updateCb:o})}whenStable(e,r,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,o),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,r,o){return[]}}return n.\u0275fac=function(e){return new(e||n)(vt(_i))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})(),BD=(()=>{class n{constructor(){this._applications=new Map,zx.addToWindow(this)}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return zx.findTestabilityInTree(this,e,r)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();class I4{addToWindow(t){}findTestabilityInTree(t,e,r){return null}}let zx=new I4,ND=!0,zD=!1;let ec;const UD=new on("AllowMultipleToken");class Vx{constructor(t,e){this.name=t,this.token=e}}function jD(n,t,e=[]){const r=`Platform: ${t}`,o=new on(r);return(c=[])=>{let p=GD();if(!p||p.injector.get(UD,!1))if(n)n(e.concat(c).concat({provide:o,useValue:!0}));else{const w=e.concat(c).concat({provide:o,useValue:!0},{provide:jn,useValue:"platform"});!function(n){if(ec&&!ec.destroyed&&!ec.injector.get(UD,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");ec=n.get($D);const t=n.get(kD,null);t&&t.forEach(e=>e())}(Pr.create({providers:w,name:r}))}return function(n){const t=GD();if(!t)throw new Error("No platform exists!");if(!t.injector.get(n,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(o)}}function GD(){return ec&&!ec.destroyed?ec:null}let $D=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){const w=function(n,t){let e;return e="noop"===n?new T4:("zone.js"===n?void 0:n)||new _i({enableLongStackTrace:(zD=!0,ND),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),e}(r?r.ngZone:void 0,{ngZoneEventCoalescing:r&&r.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:r&&r.ngZoneRunCoalescing||!1}),T=[{provide:_i,useValue:w}];return w.run(()=>{const O=Pr.create({providers:T,parent:this.injector,name:e.moduleType.name}),V=e.create(O),W=V.injector.get(Vc,null);if(!W)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return w.runOutsideAngular(()=>{const K=w.onError.subscribe({next:ie=>{W.handleError(ie)}});V.onDestroy(()=>{Ux(this._modules,V),K.unsubscribe()})}),function(n,t,e){try{const r=e();return wg(r)?r.catch(o=>{throw t.runOutsideAngular(()=>n.handleError(o)),o}):r}catch(r){throw t.runOutsideAngular(()=>n.handleError(r)),r}}(W,w,()=>{const K=V.injector.get(Bp);return K.runInitializers(),K.donePromise.then(()=>(W1(V.injector.get(ch,V_)||V_),this._moduleDoBootstrap(V),V))})})}bootstrapModule(e,r=[]){const o=HD({},r);return function(n,t,e){const r=new gx(e);return Promise.resolve(r)}(0,0,e).then(c=>this.bootstrapModuleFactory(c,o))}_moduleDoBootstrap(e){const r=e.injector.get(Np);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(o=>r.bootstrap(o));else{if(!e.instance.ngDoBootstrap)throw new Error(`The module ${un(e.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);e.instance.ngDoBootstrap(r)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(vt(Pr))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();function HD(n,t){return Array.isArray(t)?t.reduce(HD,n):Object.assign(Object.assign({},n),t)}let Np=(()=>{class n{constructor(e,r,o,c,p){this._zone=e,this._injector=r,this._exceptionHandler=o,this._componentFactoryResolver=c,this._initStatus=p,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const w=new Hn(O=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{O.next(this._stable),O.complete()})}),T=new Hn(O=>{let V;this._zone.runOutsideAngular(()=>{V=this._zone.onStable.subscribe(()=>{_i.assertNotInAngularZone(),Ox(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,O.next(!0))})})});const W=this._zone.onUnstable.subscribe(()=>{_i.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{O.next(!1)}))});return()=>{V.unsubscribe(),W.unsubscribe()}});this.isStable=function(...n){let t=Number.POSITIVE_INFINITY,e=null,r=n[n.length-1];return ys(r)?(e=n.pop(),n.length>1&&"number"==typeof n[n.length-1]&&(t=n.pop())):"number"==typeof r&&(t=n.pop()),null===e&&1===n.length&&n[0]instanceof Hn?n[0]:Wo(t)(Mo(n,e))}(w,T.pipe(n=>Dl()(function(n,t){return function(r){let o;o="function"==typeof n?n:function(){return n};const c=Object.create(r,bh);return c.source=r,c.subjectFactory=o,c}}(wh)(n))))}bootstrap(e,r){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let o;o=e instanceof _E?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(o.componentType);const c=function(n){return n.isBoundToModule}(o)?void 0:this._injector.get(eu),w=o.create(Pr.NULL,[],r||o.selector,c),T=w.location.nativeElement,O=w.injector.get(Nx,null),V=O&&w.injector.get(BD);return O&&V&&V.registerApplication(T,O),w.onDestroy(()=>{this.detachView(w.hostView),Ux(this.components,w),V&&V.unregisterApplication(T)}),this._loadComponent(w),w}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;Ux(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(PD,[]).concat(this._bootstrapListeners).forEach(o=>o(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(e){return new(e||n)(vt(_i),vt(Pr),vt(Vc),vt(LA),vt(Bp))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();function Ux(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}class sy{}class H4{}const q4={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let Z4=(()=>{class n{constructor(e,r){this._compiler=e,this._config=r||q4}load(e){return this.loadAndCompile(e)}loadAndCompile(e){let[r,o]=e.split("#");return void 0===o&&(o="default"),Ua(255)(r).then(c=>c[o]).then(c=>QD(c,r,o)).then(c=>this._compiler.compileModuleAsync(c))}loadFactory(e){let[r,o]=e.split("#"),c="NgFactory";return void 0===o&&(o="default",c=""),Ua(255)(this._config.factoryPathPrefix+r+this._config.factoryPathSuffix).then(p=>p[o+c]).then(p=>QD(p,r,o))}}return n.\u0275fac=function(e){return new(e||n)(vt(zA),vt(H4,8))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();function QD(n,t,e){if(!n)throw new Error(`Cannot find '${e}' in '${t}'`);return n}const rL=jD(null,"core",[{provide:ry,useValue:"unknown"},{provide:$D,deps:[Pr]},{provide:BD,deps:[]},{provide:iy,deps:[]}]),lL=[{provide:Np,useClass:Np,deps:[_i,Pr,Vc,LA,Bp]},{provide:hO,deps:[_i],useFactory:function(n){let t=[];return n.onStable.subscribe(()=>{for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:Bp,useClass:Bp,deps:[[new is,Gg]]},{provide:zA,useClass:zA,deps:[]},p4,{provide:Ig,useFactory:function(){return oF},deps:[]},{provide:Sp,useFactory:function(){return sF},deps:[]},{provide:ch,useFactory:function(n){return W1(n=n||"undefined"!=typeof $localize&&$localize.locale||V_),n},deps:[[new Wu(ch),new is,new Mi]]},{provide:RD,useValue:"USD"}];let uL=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(vt(Np))},n.\u0275mod=Gi({type:n}),n.\u0275inj=gr({providers:lL}),n})(),my=null;function tu(){return my}const uo=new on("DocumentToken");let jA=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Wt({factory:cB,token:n,providedIn:"platform"}),n})();function cB(){return vt(yM)}const uB=new on("Location Initialized");let yM=(()=>{class n extends jA{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return tu().getBaseHref(this._doc)}onPopState(e){const r=tu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=tu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,r,o){vM()?this._history.pushState(e,r,o):this.location.hash=o}replaceState(e,r,o){vM()?this._history.replaceState(e,r,o):this.location.hash=o}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(vt(uo))},n.\u0275prov=Wt({factory:hB,token:n,providedIn:"platform"}),n})();function vM(){return!!window.history.pushState}function hB(){return new yM(vt(uo))}function nb(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function xM(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function hh(n){return n&&"?"!==n[0]?"?"+n:n}let Up=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Wt({factory:dB,token:n,providedIn:"root"}),n})();function dB(n){const t=vt(uo).location;return new bM(vt(jA),t&&t.origin||"")}const rb=new on("appBaseHref");let bM=(()=>{class n extends Up{constructor(e,r){if(super(),this._platformLocation=e,this._removeListenerFns=[],null==r&&(r=this._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=r}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return nb(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+hh(this._platformLocation.search),o=this._platformLocation.hash;return o&&e?`${r}${o}`:r}pushState(e,r,o,c){const p=this.prepareExternalUrl(o+hh(c));this._platformLocation.pushState(e,r,p)}replaceState(e,r,o,c){const p=this.prepareExternalUrl(o+hh(c));this._platformLocation.replaceState(e,r,p)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var r,o;null===(o=(r=this._platformLocation).historyGo)||void 0===o||o.call(r,e)}}return n.\u0275fac=function(e){return new(e||n)(vt(jA),vt(rb,8))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})(),AB=(()=>{class n extends Up{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=nb(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,o,c){let p=this.prepareExternalUrl(o+hh(c));0==p.length&&(p=this._platformLocation.pathname),this._platformLocation.pushState(e,r,p)}replaceState(e,r,o,c){let p=this.prepareExternalUrl(o+hh(c));0==p.length&&(p=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,p)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var r,o;null===(o=(r=this._platformLocation).historyGo)||void 0===o||o.call(r,e)}}return n.\u0275fac=function(e){return new(e||n)(vt(jA),vt(rb,8))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})(),gy=(()=>{class n{constructor(e,r){this._subject=new rt,this._urlChangeListeners=[],this._platformStrategy=e;const o=this._platformStrategy.getBaseHref();this._platformLocation=r,this._baseHref=xM(wM(o)),this._platformStrategy.onPopState(c=>{this._subject.emit({url:this.path(!0),pop:!0,state:c.state,type:c.type})})}path(e=!1){return this.normalize(this._platformStrategy.path(e))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+hh(r))}normalize(e){return n.stripTrailingSlash(function(n,t){return n&&t.startsWith(n)?t.substring(n.length):t}(this._baseHref,wM(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}go(e,r="",o=null){this._platformStrategy.pushState(o,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+hh(r)),o)}replaceState(e,r="",o=null){this._platformStrategy.replaceState(o,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+hh(r)),o)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(e=0){var r,o;null===(o=(r=this._platformStrategy).historyGo)||void 0===o||o.call(r,e)}onUrlChange(e){this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}))}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(o=>o(e,r))}subscribe(e,r,o){return this._subject.subscribe({next:e,error:r,complete:o})}}return n.\u0275fac=function(e){return new(e||n)(vt(Up),vt(jA))},n.normalizeQueryParams=hh,n.joinWithSlash=nb,n.stripTrailingSlash=xM,n.\u0275prov=Wt({factory:fB,token:n,providedIn:"root"}),n})();function fB(){return new gy(vt(Up),vt(jA))}function wM(n){return n.replace(/\/index.html$/,"")}var ha=(()=>((ha=ha||{})[ha.Decimal=0]="Decimal",ha[ha.Percent=1]="Percent",ha[ha.Currency=2]="Currency",ha[ha.Scientific=3]="Scientific",ha))(),ho=(()=>((ho=ho||{})[ho.Zero=0]="Zero",ho[ho.One=1]="One",ho[ho.Two=2]="Two",ho[ho.Few=3]="Few",ho[ho.Many=4]="Many",ho[ho.Other=5]="Other",ho))(),cn=(()=>((cn=cn||{})[cn.Decimal=0]="Decimal",cn[cn.Group=1]="Group",cn[cn.List=2]="List",cn[cn.PercentSign=3]="PercentSign",cn[cn.PlusSign=4]="PlusSign",cn[cn.MinusSign=5]="MinusSign",cn[cn.Exponential=6]="Exponential",cn[cn.SuperscriptingExponent=7]="SuperscriptingExponent",cn[cn.PerMille=8]="PerMille",cn[cn.Infinity=9]="Infinity",cn[cn.NaN=10]="NaN",cn[cn.TimeSeparator=11]="TimeSeparator",cn[cn.CurrencyDecimal=12]="CurrencyDecimal",cn[cn.CurrencyGroup=13]="CurrencyGroup",cn))();function Al(n,t){const e=Ns(n),r=e[zt.NumberSymbols][t];if(void 0===r){if(t===cn.CurrencyDecimal)return e[zt.NumberSymbols][cn.Decimal];if(t===cn.CurrencyGroup)return e[zt.NumberSymbols][cn.Group]}return r}const bB=function(n){return Ns(n)[zt.PluralCase]},UB=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function hb(n){const t=parseInt(n);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+n);return t}class My{}let YB=(()=>{class n extends My{constructor(e){super(),this.locale=e}getPluralCategory(e,r){switch(bB(r||this.locale)(e)){case ho.Zero:return"zero";case ho.One:return"one";case ho.Two:return"two";case ho.Few:return"few";case ho.Many:return"many";default:return"other"}}}return n.\u0275fac=function(e){return new(e||n)(vt(ch))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();function PM(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const r=e.indexOf("="),[o,c]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(o.trim()===t)return decodeURIComponent(c)}return null}let RM=(()=>{class n{constructor(e,r,o,c){this._iterableDiffers=e,this._keyValueDiffers=r,this._ngEl=o,this._renderer=c,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(xg(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${un(r.item)}`);this._toggleClass(r.item,!0)}),e.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!0)):Object.keys(e).forEach(r=>this._toggleClass(r,!!e[r])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!1)):Object.keys(e).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(e,r){(e=e.trim())&&e.split(/\s+/g).forEach(o=>{r?this._renderer.addClass(this._ngEl.nativeElement,o):this._renderer.removeClass(this._ngEl.nativeElement,o)})}}return n.\u0275fac=function(e){return new(e||n)(lt(Ig),lt(Sp),lt(Xi),lt(ah))},n.\u0275dir=Kt({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),n})();class JB{constructor(t,e,r,o){this.$implicit=t,this.ngForOf=e,this.index=r,this.count=o}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let FM=(()=>{class n{constructor(e,r,o){this._viewContainer=e,this._template=r,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(r){throw new Error(`Cannot find a differ supporting object '${e}' of type '${function(n){return n.name||typeof n}(e)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const r=[];e.forEachOperation((o,c,p)=>{if(null==o.previousIndex){const w=this._viewContainer.createEmbeddedView(this._template,new JB(null,this._ngForOf,-1,-1),null===p?void 0:p),T=new OM(o,w);r.push(T)}else if(null==p)this._viewContainer.remove(null===c?void 0:c);else if(null!==c){const w=this._viewContainer.get(c);this._viewContainer.move(w,p);const T=new OM(o,w);r.push(T)}});for(let o=0;o<r.length;o++)this._perViewChange(r[o].view,r[o].record);for(let o=0,c=this._viewContainer.length;o<c;o++){const p=this._viewContainer.get(o);p.context.index=o,p.context.count=c,p.context.ngForOf=this._ngForOf}e.forEachIdentityChange(o=>{this._viewContainer.get(o.currentIndex).context.$implicit=o.item})}_perViewChange(e,r){e.context.$implicit=r.item}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(lt(Yl),lt(lh),lt(Ig))},n.\u0275dir=Kt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();class OM{constructor(t,e){this.record=t,this.view=e}}let LM=(()=>{class n{constructor(e,r){this._viewContainer=e,this._context=new tN,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){BM("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){BM("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(lt(Yl),lt(lh))},n.\u0275dir=Kt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class tN{constructor(){this.$implicit=null,this.ngIf=null}}function BM(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${un(t)}'.`)}let VM=(()=>{class n{constructor(e){this._locale=e}transform(e,r,o){if(!function(n){return!(null==n||""===n||n!=n)}(e))return null;o=o||this._locale;try{return function(n,t,e){return function(n,t,e,r,o,c,p=!1){let w="",T=!1;if(isFinite(n)){let O=function(n){let r,o,c,p,w,t=Math.abs(n)+"",e=0;for((o=t.indexOf("."))>-1&&(t=t.replace(".","")),(c=t.search(/e/i))>0?(o<0&&(o=c),o+=+t.slice(c+1),t=t.substring(0,c)):o<0&&(o=t.length),c=0;"0"===t.charAt(c);c++);if(c===(w=t.length))r=[0],o=1;else{for(w--;"0"===t.charAt(w);)w--;for(o-=c,r=[],p=0;c<=w;c++,p++)r[p]=Number(t.charAt(c))}return o>22&&(r=r.splice(0,21),e=o-1,o=1),{digits:r,exponent:e,integerLen:o}}(n);p&&(O=function(n){if(0===n.digits[0])return n;const t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===t?n.digits.push(0,0):1===t&&n.digits.push(0),n.integerLen+=2),n}(O));let V=t.minInt,W=t.minFrac,K=t.maxFrac;if(c){const He=c.match(UB);if(null===He)throw new Error(`${c} is not a valid digit info`);const Ot=He[1],Qt=He[3],Fn=He[5];null!=Ot&&(V=hb(Ot)),null!=Qt&&(W=hb(Qt)),null!=Fn?K=hb(Fn):null!=Qt&&W>K&&(K=W)}!function(n,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let r=n.digits,o=r.length-n.integerLen;const c=Math.min(Math.max(t,o),e);let p=c+n.integerLen,w=r[p];if(p>0){r.splice(Math.max(n.integerLen,p));for(let W=p;W<r.length;W++)r[W]=0}else{o=Math.max(0,o),n.integerLen=1,r.length=Math.max(1,p=c+1),r[0]=0;for(let W=1;W<p;W++)r[W]=0}if(w>=5)if(p-1<0){for(let W=0;W>p;W--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[p-1]++;for(;o<Math.max(0,c);o++)r.push(0);let T=0!==c;const O=t+n.integerLen,V=r.reduceRight(function(W,K,ie,fe){return fe[ie]=(K+=W)<10?K:K-10,T&&(0===fe[ie]&&ie>=O?fe.pop():T=!1),K>=10?1:0},0);V&&(r.unshift(V),n.integerLen++)}(O,W,K);let ie=O.digits,fe=O.integerLen;const Ve=O.exponent;let Re=[];for(T=ie.every(He=>!He);fe<V;fe++)ie.unshift(0);for(;fe<0;fe++)ie.unshift(0);fe>0?Re=ie.splice(fe,ie.length):(Re=ie,ie=[0]);const tt=[];for(ie.length>=t.lgSize&&tt.unshift(ie.splice(-t.lgSize,ie.length).join(""));ie.length>t.gSize;)tt.unshift(ie.splice(-t.gSize,ie.length).join(""));ie.length&&tt.unshift(ie.join("")),w=tt.join(Al(e,r)),Re.length&&(w+=Al(e,o)+Re.join("")),Ve&&(w+=Al(e,cn.Exponential)+"+"+Ve)}else w=Al(e,cn.Infinity);return w=n<0&&!T?t.negPre+w+t.negSuf:t.posPre+w+t.posSuf,w}(n,function(n,t="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(";"),o=r[0],c=r[1],p=-1!==o.indexOf(".")?o.split("."):[o.substring(0,o.lastIndexOf("0")+1),o.substring(o.lastIndexOf("0")+1)],w=p[0],T=p[1]||"";e.posPre=w.substr(0,w.indexOf("#"));for(let V=0;V<T.length;V++){const W=T.charAt(V);"0"===W?e.minFrac=e.maxFrac=V+1:"#"===W?e.maxFrac=V+1:e.posSuf+=W}const O=w.split(",");if(e.gSize=O[1]?O[1].length:0,e.lgSize=O[2]||O[1]?(O[2]||O[1]).length:0,c){const V=o.length-e.posPre.length-e.posSuf.length,W=c.indexOf("#");e.negPre=c.substr(0,W).replace(/'/g,""),e.negSuf=c.substr(W+V).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}(function(n,t){return Ns(n)[zt.NumberFormats][t]}(t,ha.Decimal),Al(t,cn.MinusSign)),t,cn.Group,cn.Decimal,e)}(function(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(e),o,r)}catch(c){throw function(n,t){return Error(`InvalidPipeArgument: '${t}' for pipe '${un(n)}'`)}(n,c.message)}}}return n.\u0275fac=function(e){return new(e||n)(lt(ch,16))},n.\u0275pipe=bi({name:"number",type:n,pure:!0}),n})();let UM=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Gi({type:n}),n.\u0275inj=gr({providers:[{provide:My,useClass:YB}]}),n})();let GM=(()=>{class n{}return n.\u0275prov=Wt({token:n,providedIn:"root",factory:()=>new TN(vt(uo),window)}),n})();class TN{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let o=r.currentNode;for(;o;){const c=o.shadowRoot;if(c){const p=c.getElementById(t)||c.querySelector(`[name="${t}"]`);if(p)return p}o=r.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),this.attemptFocus(e))}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),r=e.left+this.window.pageXOffset,o=e.top+this.window.pageYOffset,c=this.offset();this.window.scrollTo(r-c[0],o-c[1])}attemptFocus(t){return t.focus(),this.document.activeElement===t}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=$M(this.window.history)||$M(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function $M(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class HM{}class mb extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(n){my||(my=n)}(new mb)}onAndCancel(t,e,r){return t.addEventListener(e,r,!1),()=>{t.removeEventListener(e,r,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=(Yg=Yg||document.querySelector("base"),Yg?Yg.getAttribute("href"):null);return null==e?null:function(n){Sy=Sy||document.createElement("a"),Sy.setAttribute("href",n);const t=Sy.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){Yg=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return PM(document.cookie,t)}}let Sy,Yg=null;const qM=new on("TRANSITION_ID"),ON=[{provide:Gg,useFactory:function(n,t,e){return()=>{e.get(Bp).donePromise.then(()=>{const r=tu(),o=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let c=0;c<o.length;c++)r.remove(o[c])})}},deps:[qM,uo,Pr],multi:!0}];class gb{static init(){!function(n){zx=n}(new gb)}addToWindow(t){cr.getAngularTestability=(r,o=!0)=>{const c=t.findTestabilityInTree(r,o);if(null==c)throw new Error("Could not find testability for element.");return c},cr.getAllAngularTestabilities=()=>t.getAllTestabilities(),cr.getAllAngularRootElements=()=>t.getAllRootElements(),cr.frameworkStabilizers||(cr.frameworkStabilizers=[]),cr.frameworkStabilizers.push(r=>{const o=cr.getAllAngularTestabilities();let c=o.length,p=!1;const w=function(T){p=p||T,c--,0==c&&r(p)};o.forEach(function(T){T.whenStable(w)})})}findTestabilityInTree(t,e,r){if(null==e)return null;const o=t.getTestability(e);return null!=o?o:r?tu().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}let LN=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();const Kg=new on("EventManagerPlugins");let Iy=(()=>{class n{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(o=>o.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,r,o){return this._findPluginFor(r).addEventListener(e,r,o)}addGlobalEventListener(e,r,o){return this._findPluginFor(r).addGlobalEventListener(e,r,o)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const o=this._plugins;for(let c=0;c<o.length;c++){const p=o[c];if(p.supports(e))return this._eventNameToPlugin.set(e,p),p}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(vt(Kg),vt(_i))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();class _b{constructor(t){this._doc=t}addGlobalEventListener(t,e,r){const o=tu().getGlobalEventTarget(this._doc,t);if(!o)throw new Error(`Unsupported event target ${o} for event ${e}`);return this.addEventListener(o,e,r)}}let WM=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const r=new Set;e.forEach(o=>{this._stylesSet.has(o)||(this._stylesSet.add(o),r.add(o))}),this.onStylesAdded(r)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})(),Jg=(()=>{class n extends WM{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,r,o){e.forEach(c=>{const p=this._doc.createElement("style");p.textContent=c,o.push(r.appendChild(p))})}addHost(e){const r=[];this._addStylesToHost(this._stylesSet,e,r),this._hostNodes.set(e,r)}removeHost(e){const r=this._hostNodes.get(e);r&&r.forEach(QM),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((r,o)=>{this._addStylesToHost(e,o,r)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(QM))}}return n.\u0275fac=function(e){return new(e||n)(vt(uo))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();function QM(n){tu().remove(n)}const yb={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},vb=/%COMP%/g;function ky(n,t,e){for(let r=0;r<t.length;r++){let o=t[r];Array.isArray(o)?ky(n,o,e):(o=o.replace(vb,n),e.push(o))}return e}function KM(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let xb=(()=>{class n{constructor(e,r,o){this.eventManager=e,this.sharedStylesHost=r,this.appId=o,this.rendererByCompId=new Map,this.defaultRenderer=new bb(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;switch(r.encapsulation){case _r.Emulated:{let o=this.rendererByCompId.get(r.id);return o||(o=new YN(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,o)),o.applyToHost(e),o}case 1:case _r.ShadowDom:return new KN(this.eventManager,this.sharedStylesHost,e,r);default:if(!this.rendererByCompId.has(r.id)){const o=ky(r.id,r.styles,[]);this.sharedStylesHost.addStyles(o),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(vt(Iy),vt(Jg),vt($g))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();class bb{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(yb[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,r){t&&t.insertBefore(e,r)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,o){if(o){e=o+":"+e;const c=yb[o];c?t.setAttributeNS(c,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){const o=yb[r];o?t.removeAttributeNS(o,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,o){o&(ks.DashCase|ks.Important)?t.style.setProperty(e,r,o&ks.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&ks.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t[e]=r}setValue(t,e){t.nodeValue=e}listen(t,e,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,KM(r)):this.eventManager.addEventListener(t,e,KM(r))}}class YN extends bb{constructor(t,e,r,o){super(t),this.component=r;const c=ky(o+"-"+r.id,r.styles,[]);e.addStyles(c),this.contentAttr=function(n){return"_ngcontent-%COMP%".replace(vb,n)}(o+"-"+r.id),this.hostAttr=function(n){return"_nghost-%COMP%".replace(vb,n)}(o+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}}class KN extends bb{constructor(t,e,r,o){super(t),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=ky(o.id,o.styles,[]);for(let p=0;p<c.length;p++){const w=document.createElement("style");w.textContent=c[p],this.shadowRoot.appendChild(w)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let JN=(()=>{class n extends _b{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,o){return e.addEventListener(r,o,!1),()=>this.removeEventListener(e,r,o)}removeEventListener(e,r,o){return e.removeEventListener(r,o)}}return n.\u0275fac=function(e){return new(e||n)(vt(uo))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();const tS=["alt","control","meta","shift"],s5={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},nS={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},a5={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let l5=(()=>{class n extends _b{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,r,o){const c=n.parseEventName(r),p=n.eventCallback(c.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>tu().onAndCancel(e,c.domEventName,p))}static parseEventName(e){const r=e.toLowerCase().split("."),o=r.shift();if(0===r.length||"keydown"!==o&&"keyup"!==o)return null;const c=n._normalizeKey(r.pop());let p="";if(tS.forEach(T=>{const O=r.indexOf(T);O>-1&&(r.splice(O,1),p+=T+".")}),p+=c,0!=r.length||0===c.length)return null;const w={};return w.domEventName=o,w.fullKey=p,w}static getEventFullKey(e){let r="",o=function(n){let t=n.key;if(null==t){if(t=n.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===n.location&&nS.hasOwnProperty(t)&&(t=nS[t]))}return s5[t]||t}(e);return o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),tS.forEach(c=>{c!=o&&a5[c](e)&&(r+=c+".")}),r+=o,r}static eventCallback(e,r,o){return c=>{n.getEventFullKey(c)===e&&o.runGuarded(()=>r(c))}}static _normalizeKey(e){switch(e){case"esc":return"escape";default:return e}}}return n.\u0275fac=function(e){return new(e||n)(vt(uo))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})(),Py=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Wt({factory:function(){return vt(Cb)},token:n,providedIn:"root"}),n})(),Cb=(()=>{class n extends Py{constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case Vr.NONE:return r;case Vr.HTML:return sl(r,"HTML")?Is(r):Uf(this._doc,String(r)).toString();case Vr.STYLE:return sl(r,"Style")?Is(r):r;case Vr.SCRIPT:if(sl(r,"Script"))return Is(r);throw new Error("unsafe value used in a script context");case Vr.URL:return Lf(r),sl(r,"URL")?Is(r):Yu(String(r));case Vr.RESOURCE_URL:if(sl(r,"ResourceURL"))return Is(r);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function(n){return new Nc(n)}(e)}bypassSecurityTrustStyle(e){return function(n){return new Ts(n)}(e)}bypassSecurityTrustScript(e){return function(n){return new $v(n)}(e)}bypassSecurityTrustUrl(e){return function(n){return new Em(n)}(e)}bypassSecurityTrustResourceUrl(e){return function(n){return new Hv(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(vt(uo))},n.\u0275prov=Wt({factory:function(){return function(n){return new Cb(n.get(uo))}(vt(ni))},token:n,providedIn:"root"}),n})();const m5=jD(rL,"browser",[{provide:ry,useValue:"browser"},{provide:kD,useValue:function(){mb.makeCurrent(),gb.init()},multi:!0},{provide:uo,useFactory:function(){return function(n){nl=n}(document),document},deps:[]}]),g5=[[],{provide:jn,useValue:"root"},{provide:Vc,useFactory:function(){return new Vc},deps:[]},{provide:Kg,useClass:JN,multi:!0,deps:[uo,_i,ry]},{provide:Kg,useClass:l5,multi:!0,deps:[uo]},[],{provide:xb,useClass:xb,deps:[Iy,Jg,$g]},{provide:q_,useExisting:xb},{provide:WM,useExisting:Jg},{provide:Jg,useClass:Jg,deps:[uo]},{provide:Nx,useClass:Nx,deps:[_i]},{provide:Iy,useClass:Iy,deps:[Kg,_i]},{provide:HM,useClass:LN,deps:[]},[]];let _5=(()=>{class n{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:n,providers:[{provide:$g,useValue:e.appId},{provide:qM,useExisting:$g},ON]}}}return n.\u0275fac=function(e){return new(e||n)(vt(n,12))},n.\u0275mod=Gi({type:n}),n.\u0275inj=gr({providers:g5,imports:[UM,uL]}),n})();function v5(){return new rS(vt(uo))}let rS=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(vt(uo))},n.\u0275prov=Wt({factory:v5,token:n,providedIn:"root"}),n})();function gn(...n){let t=n[n.length-1];return ys(t)?(n.pop(),go(n,t)):Mo(n)}"undefined"!=typeof window&&window;class pl extends vi{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new _s;return this._value}next(t){super.next(this._value=t)}}class D5 extends qn{notifyNext(t,e,r,o,c){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}class M5 extends qn{constructor(t,e,r){super(),this.parent=t,this.outerValue=e,this.outerIndex=r,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function S5(n,t,e,r,o=new M5(n,e,r)){if(!o.closed)return t instanceof Hn?t.subscribe(o):El(t)(o)}const oS={};function Db(...n){let t,e;return ys(n[n.length-1])&&(e=n.pop()),"function"==typeof n[n.length-1]&&(t=n.pop()),1===n.length&&qo(n[0])&&(n=n[0]),Mo(n,e).lift(new T5(t))}class T5{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new I5(t,this.resultSelector))}}class I5 extends D5{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(oS),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let r=0;r<e;r++)this.add(S5(this,t[r],void 0,r))}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,r){const o=this.values,p=this.toRespond?o[r]===oS?--this.toRespond:this.toRespond:0;o[r]=e,0===p&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(r){return void this.destination.error(r)}this.destination.next(e)}}const Ry=(()=>{function n(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return n.prototype=Object.create(Error.prototype),n})();function Mb(...n){return Wo(1)(gn(...n))}const jp=new Hn(n=>n.complete());function Fy(n){return n?function(n){return new Hn(t=>n.schedule(()=>t.complete()))}(n):jp}function sS(n){return new Hn(t=>{let e;try{e=n()}catch(o){return void t.error(o)}return(e?Nr(e):Fy()).subscribe(t)})}function nu(n,t){return"function"==typeof t?e=>e.pipe(nu((r,o)=>Nr(n(r,o)).pipe(pn((c,p)=>t(r,c,o,p))))):e=>e.lift(new R5(n))}class R5{constructor(t){this.project=t}call(t,e){return e.subscribe(new F5(t,this.project))}}class F5 extends Zs{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const r=this.index++;try{e=this.project(t,r)}catch(o){return void this.destination.error(o)}this._innerSub(e)}_innerSub(t){const e=this.innerSubscription;e&&e.unsubscribe();const r=new ya(this),o=this.destination;o.add(r),this.innerSubscription=va(t,r),this.innerSubscription!==r&&o.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;(!t||t.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(t){this.destination.next(t)}}const aS=(()=>{function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n})();function Sb(n){return t=>0===n?Fy():t.lift(new O5(n))}class O5{constructor(t){if(this.total=t,this.total<0)throw new aS}call(t,e){return e.subscribe(new L5(t,this.total))}}class L5 extends qn{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))}}function lS(...n){const t=n[n.length-1];return ys(t)?(n.pop(),e=>Mb(n,e,t)):e=>Mb(n,e)}function cS(n,t){let e=!1;return arguments.length>=2&&(e=!0),function(o){return o.lift(new B5(n,t,e))}}class B5{constructor(t,e,r=!1){this.accumulator=t,this.seed=e,this.hasSeed=r}call(t,e){return e.subscribe(new N5(t,this.accumulator,this.seed,this.hasSeed))}}class N5 extends qn{constructor(t,e,r,o){super(t),this.accumulator=e,this._seed=r,this.hasSeed=o,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let r;try{r=this.accumulator(this.seed,t,e)}catch(o){this.destination.error(o)}this.seed=r,this.destination.next(r)}}function ru(n,t){return function(r){return r.lift(new z5(n,t))}}class z5{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new V5(t,this.predicate,this.thisArg))}}class V5 extends qn{constructor(t,e,r){super(t),this.predicate=e,this.thisArg=r,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(r){return void this.destination.error(r)}e&&this.destination.next(t)}}function od(n){return function(e){const r=new U5(n),o=e.lift(r);return r.caught=o}}class U5{constructor(t){this.selector=t}call(t,e){return e.subscribe(new j5(t,this.selector,this.caught))}}class j5 extends Zs{constructor(t,e,r){super(t),this.selector=e,this.caught=r}error(t){if(!this.isStopped){let e;try{e=this.selector(t,this.caught)}catch(c){return void super.error(c)}this._unsubscribeAndRecycle();const r=new ya(this);this.add(r);const o=va(e,r);o!==r&&this.add(o)}}}function Gp(n,t){return mr(n,t,1)}function Tb(n){return function(e){return 0===n?Fy():e.lift(new G5(n))}}class G5{constructor(t){if(this.total=t,this.total<0)throw new aS}call(t,e){return e.subscribe(new $5(t,this.total))}}class $5 extends qn{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,r=this.total,o=this.count++;e.length<r?e.push(t):e[o%r]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const r=this.count>=this.total?this.total:this.count,o=this.ring;for(let c=0;c<r;c++){const p=e++%r;t.next(o[p])}}t.complete()}}function uS(n=Z5){return t=>t.lift(new H5(n))}class H5{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new q5(t,this.errorFactory))}}class q5 extends qn{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let t;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)}}}function Z5(){return new Ry}function hS(n=null){return t=>t.lift(new W5(n))}class W5{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new Q5(t,this.defaultValue))}}class Q5 extends qn{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function GA(n,t){const e=arguments.length>=2;return r=>r.pipe(n?ru((o,c)=>n(o,c,r)):di,Sb(1),e?hS(t):uS(()=>new Ry))}function sd(){}function Co(n,t,e){return function(o){return o.lift(new Y5(n,t,e))}}class Y5{constructor(t,e,r){this.nextOrObserver=t,this.error=e,this.complete=r}call(t,e){return e.subscribe(new K5(t,this.nextOrObserver,this.error,this.complete))}}class K5 extends qn{constructor(t,e,r,o){super(t),this._tapNext=sd,this._tapError=sd,this._tapComplete=sd,this._tapError=r||sd,this._tapComplete=o||sd,Hs(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||sd,this._tapError=e.error||sd,this._tapComplete=e.complete||sd)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}class ez{constructor(t){this.callback=t}call(t,e){return e.subscribe(new tz(t,this.callback))}}class tz extends qn{constructor(t,e){super(t),this.add(new Et(e))}}class Ah{constructor(t,e){this.id=t,this.url=e}}class Ib extends Ah{constructor(t,e,r="imperative",o=null){super(t,e),this.navigationTrigger=r,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class e0 extends Ah{constructor(t,e,r){super(t,e),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class dS extends Ah{constructor(t,e,r){super(t,e),this.reason=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class nz extends Ah{constructor(t,e,r){super(t,e),this.error=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class rz extends Ah{constructor(t,e,r,o){super(t,e),this.urlAfterRedirects=r,this.state=o}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class iz extends Ah{constructor(t,e,r,o){super(t,e),this.urlAfterRedirects=r,this.state=o}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class oz extends Ah{constructor(t,e,r,o,c){super(t,e),this.urlAfterRedirects=r,this.state=o,this.shouldActivate=c}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class sz extends Ah{constructor(t,e,r,o){super(t,e),this.urlAfterRedirects=r,this.state=o}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class az extends Ah{constructor(t,e,r,o){super(t,e),this.urlAfterRedirects=r,this.state=o}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class AS{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class fS{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class lz{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class cz{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class uz{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hz{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class pS{constructor(t,e,r){this.routerEvent=t,this.position=e,this.anchor=r}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Jn="primary";class dz{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function $p(n){return new dz(n)}const mS="ngNavigationCancelingError";function kb(n){const t=Error("NavigationCancelingError: "+n);return t[mS]=!0,t}function fz(n,t,e){const r=e.path.split("/");if(r.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||r.length<n.length))return null;const o={};for(let c=0;c<r.length;c++){const p=r[c],w=n[c];if(p.startsWith(":"))o[p.substring(1)]=w;else if(p!==w.path)return null}return{consumed:n.slice(0,r.length),posParams:o}}function iu(n,t){const e=n?Object.keys(n):void 0,r=t?Object.keys(t):void 0;if(!e||!r||e.length!=r.length)return!1;let o;for(let c=0;c<e.length;c++)if(o=e[c],!gS(n[o],t[o]))return!1;return!0}function gS(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),r=[...t].sort();return e.every((o,c)=>r[c]===o)}return n===t}function _S(n){return Array.prototype.concat.apply([],n)}function yS(n){return n.length>0?n[n.length-1]:null}function $o(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function ou(n){return B_(n)?n:wg(n)?Nr(Promise.resolve(n)):gn(n)}const gz={exact:function bS(n,t,e){if(!HA(n.segments,t.segments)||!Oy(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!n.children[r]||!bS(n.children[r],t.children[r],e))return!1;return!0},subset:wS},vS={exact:function(n,t){return iu(n,t)},subset:function(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>gS(n[e],t[e]))},ignored:()=>!0};function xS(n,t,e){return gz[e.paths](n.root,t.root,e.matrixParams)&&vS[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function wS(n,t,e){return CS(n,t,t.segments,e)}function CS(n,t,e,r){if(n.segments.length>e.length){const o=n.segments.slice(0,e.length);return!(!HA(o,e)||t.hasChildren()||!Oy(o,e,r))}if(n.segments.length===e.length){if(!HA(n.segments,e)||!Oy(n.segments,e,r))return!1;for(const o in t.children)if(!n.children[o]||!wS(n.children[o],t.children[o],r))return!1;return!0}{const o=e.slice(0,n.segments.length),c=e.slice(n.segments.length);return!!(HA(n.segments,o)&&Oy(n.segments,o,r)&&n.children[Jn])&&CS(n.children[Jn],t,c,r)}}function Oy(n,t,e){return t.every((r,o)=>vS[e](n[o].parameters,r.parameters))}class $A{constructor(t,e,r){this.root=t,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=$p(this.queryParams)),this._queryParamMap}toString(){return bz.serialize(this)}}class ar{constructor(t,e){this.segments=t,this.children=e,this.parent=null,$o(e,(r,o)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ly(this)}}class t0{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=$p(this.parameters)),this._parameterMap}toString(){return SS(this)}}function HA(n,t){return n.length===t.length&&n.every((e,r)=>e.path===t[r].path)}class Pb{}class ES{parse(t){const e=new kz(t);return new $A(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){return`${`/${n0(t.root,!0)}`}${function(n){const t=Object.keys(n).map(e=>{const r=n[e];return Array.isArray(r)?r.map(o=>`${By(e)}=${By(o)}`).join("&"):`${By(e)}=${By(r)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams)}${"string"==typeof t.fragment?`#${function(n){return encodeURI(n)}(t.fragment)}`:""}`}}const bz=new ES;function Ly(n){return n.segments.map(t=>SS(t)).join("/")}function n0(n,t){if(!n.hasChildren())return Ly(n);if(t){const e=n.children[Jn]?n0(n.children[Jn],!1):"",r=[];return $o(n.children,(o,c)=>{c!==Jn&&r.push(`${c}:${n0(o,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function(n,t){let e=[];return $o(n.children,(r,o)=>{o===Jn&&(e=e.concat(t(r,o)))}),$o(n.children,(r,o)=>{o!==Jn&&(e=e.concat(t(r,o)))}),e}(n,(r,o)=>o===Jn?[n0(n.children[Jn],!1)]:[`${o}:${n0(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Jn]?`${Ly(n)}/${e[0]}`:`${Ly(n)}/(${e.join("//")})`}}function DS(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function By(n){return DS(n).replace(/%3B/gi,";")}function Rb(n){return DS(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ny(n){return decodeURIComponent(n)}function MS(n){return Ny(n.replace(/\+/g,"%20"))}function SS(n){return`${Rb(n.path)}${function(n){return Object.keys(n).map(t=>`;${Rb(t)}=${Rb(n[t])}`).join("")}(n.parameters)}`}const Dz=/^[^\/()?;=#]+/;function zy(n){const t=n.match(Dz);return t?t[0]:""}const Mz=/^[^=?&#]+/,Tz=/^[^?&#]+/;class kz{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ar([],{}):new ar([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(r[Jn]=new ar(t,e)),r}parseSegment(){const t=zy(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new t0(Ny(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=zy(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const o=zy(this.remaining);o&&(r=o,this.capture(r))}t[Ny(e)]=Ny(r)}parseQueryParam(t){const e=function(n){const t=n.match(Mz);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const p=function(n){const t=n.match(Tz);return t?t[0]:""}(this.remaining);p&&(r=p,this.capture(r))}const o=MS(e),c=MS(r);if(t.hasOwnProperty(o)){let p=t[o];Array.isArray(p)||(p=[p],t[o]=p),p.push(c)}else t[o]=c}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=zy(this.remaining),o=this.remaining[r.length];if("/"!==o&&")"!==o&&";"!==o)throw new Error(`Cannot parse url '${this.url}'`);let c;r.indexOf(":")>-1?(c=r.substr(0,r.indexOf(":")),this.capture(c),this.capture(":")):t&&(c=Jn);const p=this.parseChildren();e[c]=1===Object.keys(p).length?p[Jn]:new ar([],p),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class TS{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=Fb(t,this._root);return e?e.children.map(r=>r.value):[]}firstChild(t){const e=Fb(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=Ob(t,this._root);return e.length<2?[]:e[e.length-2].children.map(o=>o.value).filter(o=>o!==t)}pathFromRoot(t){return Ob(t,this._root).map(e=>e.value)}}function Fb(n,t){if(n===t.value)return t;for(const e of t.children){const r=Fb(n,e);if(r)return r}return null}function Ob(n,t){if(n===t.value)return[t];for(const e of t.children){const r=Ob(n,e);if(r.length)return r.unshift(t),r}return[]}class fh{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function r0(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class IS extends TS{constructor(t,e){super(t),this.snapshot=e,Lb(this,t)}toString(){return this.snapshot.toString()}}function kS(n,t){const e=function(n,t){const p=new Vy([],{},{},"",{},Jn,t,null,n.root,-1,{});return new RS("",new fh(p,[]))}(n,t),r=new pl([new t0("",{})]),o=new pl({}),c=new pl({}),p=new pl({}),w=new pl(""),T=new Hp(r,o,p,w,c,Jn,t,e.root);return T.snapshot=e.root,new IS(new fh(T,[]),e)}class Hp{constructor(t,e,r,o,c,p,w,T){this.url=t,this.params=e,this.queryParams=r,this.fragment=o,this.data=c,this.outlet=p,this.component=w,this._futureSnapshot=T}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(pn(t=>$p(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(pn(t=>$p(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function PS(n,t="emptyOnly"){const e=n.pathFromRoot;let r=0;if("always"!==t)for(r=e.length-1;r>=1;){const o=e[r],c=e[r-1];if(o.routeConfig&&""===o.routeConfig.path)r--;else{if(c.component)break;r--}}return function(n){return n.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(e.slice(r))}class Vy{constructor(t,e,r,o,c,p,w,T,O,V,W){this.url=t,this.params=e,this.queryParams=r,this.fragment=o,this.data=c,this.outlet=p,this.component=w,this.routeConfig=T,this._urlSegment=O,this._lastPathIndex=V,this._resolve=W}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=$p(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=$p(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class RS extends TS{constructor(t,e){super(e),this.url=t,Lb(this,e)}toString(){return FS(this._root)}}function Lb(n,t){t.value._routerState=n,t.children.forEach(e=>Lb(n,e))}function FS(n){const t=n.children.length>0?` { ${n.children.map(FS).join(", ")} } `:"";return`${n.value}${t}`}function Bb(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,iu(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),iu(t.params,e.params)||n.params.next(e.params),function(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!iu(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),iu(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function Nb(n,t){return iu(n.params,t.params)&&function(n,t){return HA(n,t)&&n.every((e,r)=>iu(e.parameters,t[r].parameters))}(n.url,t.url)&&!(!n.parent!=!t.parent)&&(!n.parent||Nb(n.parent,t.parent))}function Uy(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=t.value;const o=function(n,t,e){return t.children.map(r=>{for(const o of e.children)if(n.shouldReuseRoute(r.value,o.value.snapshot))return Uy(n,r,o);return Uy(n,r)})}(n,t,e);return new fh(r,o)}{if(n.shouldAttach(t.value)){const c=n.retrieve(t.value);if(null!==c){const p=c.route;return OS(t,p),p}}const r=function(n){return new Hp(new pl(n.url),new pl(n.params),new pl(n.queryParams),new pl(n.fragment),new pl(n.data),n.outlet,n.component,n)}(t.value),o=t.children.map(c=>Uy(n,c));return new fh(r,o)}}function OS(n,t){if(n.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(n.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=n.value;for(let e=0;e<n.children.length;++e)OS(n.children[e],t.children[e])}function jy(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function o0(n){return"object"==typeof n&&null!=n&&n.outlets}function zb(n,t,e,r,o){let c={};return r&&$o(r,(p,w)=>{c[w]=Array.isArray(p)?p.map(T=>`${T}`):`${p}`}),new $A(e.root===n?t:LS(e.root,n,t),c,o)}function LS(n,t,e){const r={};return $o(n.children,(o,c)=>{r[c]=o===t?e:LS(o,t,e)}),new ar(n.segments,r)}class BS{constructor(t,e,r){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=r,t&&r.length>0&&jy(r[0]))throw new Error("Root segment cannot have matrix parameters");const o=r.find(o0);if(o&&o!==yS(r))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Vb{constructor(t,e,r){this.segmentGroup=t,this.processChildren=e,this.index=r}}function NS(n,t,e){if(n||(n=new ar([],{})),0===n.segments.length&&n.hasChildren())return Gy(n,t,e);const r=function(n,t,e){let r=0,o=t;const c={match:!1,pathIndex:0,commandIndex:0};for(;o<n.segments.length;){if(r>=e.length)return c;const p=n.segments[o],w=e[r];if(o0(w))break;const T=`${w}`,O=r<e.length-1?e[r+1]:null;if(o>0&&void 0===T)break;if(T&&O&&"object"==typeof O&&void 0===O.outlets){if(!VS(T,O,p))return c;r+=2}else{if(!VS(T,{},p))return c;r++}o++}return{match:!0,pathIndex:o,commandIndex:r}}(n,t,e),o=e.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const c=new ar(n.segments.slice(0,r.pathIndex),{});return c.children[Jn]=new ar(n.segments.slice(r.pathIndex),n.children),Gy(c,0,o)}return r.match&&0===o.length?new ar(n.segments,{}):r.match&&!n.hasChildren()?Ub(n,t,e):r.match?Gy(n,0,o):Ub(n,t,e)}function Gy(n,t,e){if(0===e.length)return new ar(n.segments,{});{const r=function(n){return o0(n[0])?n[0].outlets:{[Jn]:n}}(e),o={};return $o(r,(c,p)=>{"string"==typeof c&&(c=[c]),null!==c&&(o[p]=NS(n.children[p],t,c))}),$o(n.children,(c,p)=>{void 0===r[p]&&(o[p]=c)}),new ar(n.segments,o)}}function Ub(n,t,e){const r=n.segments.slice(0,t);let o=0;for(;o<e.length;){const c=e[o];if(o0(c)){const T=Gz(c.outlets);return new ar(r,T)}if(0===o&&jy(e[0])){r.push(new t0(n.segments[t].path,zS(e[0]))),o++;continue}const p=o0(c)?c.outlets[Jn]:`${c}`,w=o<e.length-1?e[o+1]:null;p&&w&&jy(w)?(r.push(new t0(p,zS(w))),o+=2):(r.push(new t0(p,{})),o++)}return new ar(r,{})}function Gz(n){const t={};return $o(n,(e,r)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[r]=Ub(new ar([],{}),0,e))}),t}function zS(n){const t={};return $o(n,(e,r)=>t[r]=`${e}`),t}function VS(n,t,e){return n==e.path&&iu(t,e.parameters)}class Hz{constructor(t,e,r,o){this.routeReuseStrategy=t,this.futureState=e,this.currState=r,this.forwardEvent=o}activate(t){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,t),Bb(this.futureState.root),this.activateChildRoutes(e,r,t)}deactivateChildRoutes(t,e,r){const o=r0(e);t.children.forEach(c=>{const p=c.value.outlet;this.deactivateRoutes(c,o[p],r),delete o[p]}),$o(o,(c,p)=>{this.deactivateRouteAndItsChildren(c,r)})}deactivateRoutes(t,e,r){const o=t.value,c=e?e.value:null;if(o===c)if(o.component){const p=r.getContext(o.outlet);p&&this.deactivateChildRoutes(t,e,p.children)}else this.deactivateChildRoutes(t,e,r);else c&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const r=e.getContext(t.value.outlet);if(r&&r.outlet){const o=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:c})}}deactivateRouteAndOutlet(t,e){const r=e.getContext(t.value.outlet),o=r&&t.value.component?r.children:e,c=r0(t);for(const p of Object.keys(c))this.deactivateRouteAndItsChildren(c[p],o);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(t,e,r){const o=r0(e);t.children.forEach(c=>{this.activateRoutes(c,o[c.value.outlet],r),this.forwardEvent(new hz(c.value.snapshot))}),t.children.length&&this.forwardEvent(new cz(t.value.snapshot))}activateRoutes(t,e,r){const o=t.value,c=e?e.value:null;if(Bb(o),o===c)if(o.component){const p=r.getOrCreateContext(o.outlet);this.activateChildRoutes(t,e,p.children)}else this.activateChildRoutes(t,e,r);else if(o.component){const p=r.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){const w=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),p.children.onOutletReAttached(w.contexts),p.attachRef=w.componentRef,p.route=w.route.value,p.outlet&&p.outlet.attach(w.componentRef,w.route.value),US(w.route)}else{const w=function(n){for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig;if(e&&e.component)return null}return null}(o.snapshot),T=w?w.module.componentFactoryResolver:null;p.attachRef=null,p.route=o,p.resolver=T,p.outlet&&p.outlet.activateWith(o,T),this.activateChildRoutes(t,null,p.children)}}else this.activateChildRoutes(t,null,r)}}function US(n){Bb(n.value),n.children.forEach(US)}class jb{constructor(t,e){this.routes=t,this.module=e}}function ad(n){return"function"==typeof n}function qA(n){return n instanceof $A}const s0=Symbol("INITIAL_VALUE");function a0(){return nu(n=>Db(n.map(t=>t.pipe(Sb(1),lS(s0)))).pipe(cS((t,e)=>{let r=!1;return e.reduce((o,c,p)=>o!==s0?o:(c===s0&&(r=!0),r||!1!==c&&p!==e.length-1&&!qA(c)?o:c),t)},s0),ru(t=>t!==s0),pn(t=>qA(t)?t:!0===t),Sb(1)))}let jS=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=zo({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,r){1&e&&Bs(0,"router-outlet")},directives:function(){return[oT]},encapsulation:2}),n})();function GS(n,t=""){for(let e=0;e<n.length;e++){const r=n[e];Kz(r,Jz(t,r))}}function Kz(n,t){n.children&&GS(n.children,t)}function Jz(n,t){return t?n||t.path?n&&!t.path?`${n}/`:!n&&t.path?t.path:`${n}/${t.path}`:"":n}function Gb(n){const t=n.children&&n.children.map(Gb),e=t?Object.assign(Object.assign({},n),{children:t}):Object.assign({},n);return!e.component&&(t||e.loadChildren)&&e.outlet&&e.outlet!==Jn&&(e.component=jS),e}function ml(n){return n.outlet||Jn}function $S(n,t){const e=n.filter(r=>ml(r)===t);return e.push(...n.filter(r=>ml(r)!==t)),e}const HS={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function $y(n,t,e){var r;if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?Object.assign({},HS):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const c=(t.matcher||fz)(e,n,t);if(!c)return Object.assign({},HS);const p={};$o(c.posParams,(T,O)=>{p[O]=T.path});const w=c.consumed.length>0?Object.assign(Object.assign({},p),c.consumed[c.consumed.length-1].parameters):p;return{matched:!0,consumedSegments:c.consumed,lastChild:c.consumed.length,parameters:w,positionalParamSegments:null!==(r=c.posParams)&&void 0!==r?r:{}}}function Hy(n,t,e,r,o="corrected"){if(e.length>0&&function(n,t,e){return e.some(r=>qy(n,t,r)&&ml(r)!==Jn)}(n,e,r)){const p=new ar(t,function(n,t,e,r){const o={};o[Jn]=r,r._sourceSegment=n,r._segmentIndexShift=t.length;for(const c of e)if(""===c.path&&ml(c)!==Jn){const p=new ar([],{});p._sourceSegment=n,p._segmentIndexShift=t.length,o[ml(c)]=p}return o}(n,t,r,new ar(e,n.children)));return p._sourceSegment=n,p._segmentIndexShift=t.length,{segmentGroup:p,slicedSegments:[]}}if(0===e.length&&function(n,t,e){return e.some(r=>qy(n,t,r))}(n,e,r)){const p=new ar(n.segments,function(n,t,e,r,o,c){const p={};for(const w of r)if(qy(n,e,w)&&!o[ml(w)]){const T=new ar([],{});T._sourceSegment=n,T._segmentIndexShift="legacy"===c?n.segments.length:t.length,p[ml(w)]=T}return Object.assign(Object.assign({},o),p)}(n,t,e,r,n.children,o));return p._sourceSegment=n,p._segmentIndexShift=t.length,{segmentGroup:p,slicedSegments:e}}const c=new ar(n.segments,n.children);return c._sourceSegment=n,c._segmentIndexShift=t.length,{segmentGroup:c,slicedSegments:e}}function qy(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function qS(n,t,e,r){return!!(ml(n)===r||r!==Jn&&qy(t,e,n))&&("**"===n.path||$y(t,n,e).matched)}function ZS(n,t,e){return 0===t.length&&!n.children[e]}class l0{constructor(t){this.segmentGroup=t||null}}class WS{constructor(t){this.urlTree=t}}function Zy(n){return new Hn(t=>t.error(new l0(n)))}function QS(n){return new Hn(t=>t.error(new WS(n)))}function iV(n){return new Hn(t=>t.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${n}'`)))}class aV{constructor(t,e,r,o,c){this.configLoader=e,this.urlSerializer=r,this.urlTree=o,this.config=c,this.allowRedirects=!0,this.ngModule=t.get(eu)}apply(){const t=Hy(this.urlTree.root,[],[],this.config).segmentGroup,e=new ar(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,e,Jn).pipe(pn(c=>this.createUrlTree($b(c),this.urlTree.queryParams,this.urlTree.fragment))).pipe(od(c=>{if(c instanceof WS)return this.allowRedirects=!1,this.match(c.urlTree);throw c instanceof l0?this.noMatchError(c):c}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,Jn).pipe(pn(o=>this.createUrlTree($b(o),t.queryParams,t.fragment))).pipe(od(o=>{throw o instanceof l0?this.noMatchError(o):o}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,r){const o=t.segments.length>0?new ar([],{[Jn]:t}):t;return new $A(o,e,r)}expandSegmentGroup(t,e,r,o){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(t,e,r).pipe(pn(c=>new ar([],c))):this.expandSegment(t,r,e,r.segments,o,!0)}expandChildren(t,e,r){const o=[];for(const c of Object.keys(r.children))"primary"===c?o.unshift(c):o.push(c);return Nr(o).pipe(Gp(c=>{const p=r.children[c],w=$S(e,c);return this.expandSegmentGroup(t,w,p,c).pipe(pn(T=>({segment:T,outlet:c})))}),cS((c,p)=>(c[p.outlet]=p.segment,c),{}),function(n,t){const e=arguments.length>=2;return r=>r.pipe(n?ru((o,c)=>n(o,c,r)):di,Tb(1),e?hS(t):uS(()=>new Ry))}())}expandSegment(t,e,r,o,c,p){return Nr(r).pipe(Gp(w=>this.expandSegmentAgainstRoute(t,e,r,w,o,c,p).pipe(od(O=>{if(O instanceof l0)return gn(null);throw O}))),GA(w=>!!w),od((w,T)=>{if(w instanceof Ry||"EmptyError"===w.name){if(ZS(e,o,c))return gn(new ar([],{}));throw new l0(e)}throw w}))}expandSegmentAgainstRoute(t,e,r,o,c,p,w){return qS(o,e,c,p)?void 0===o.redirectTo?this.matchSegmentAgainstRoute(t,e,o,c,p):w&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,r,o,c,p):Zy(e):Zy(e)}expandSegmentAgainstRouteUsingRedirect(t,e,r,o,c,p){return"**"===o.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,o,p):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,o,c,p)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,r,o){const c=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?QS(c):this.lineralizeSegments(r,c).pipe(mr(p=>{const w=new ar(p,{});return this.expandSegment(t,w,e,p,o,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,o,c,p){const{matched:w,consumedSegments:T,lastChild:O,positionalParamSegments:V}=$y(e,o,c);if(!w)return Zy(e);const W=this.applyRedirectCommands(T,o.redirectTo,V);return o.redirectTo.startsWith("/")?QS(W):this.lineralizeSegments(o,W).pipe(mr(K=>this.expandSegment(t,e,r,K.concat(c.slice(O)),p,!1)))}matchSegmentAgainstRoute(t,e,r,o,c){if("**"===r.path)return r.loadChildren?(r._loadedConfig?gn(r._loadedConfig):this.configLoader.load(t.injector,r)).pipe(pn(K=>(r._loadedConfig=K,new ar(o,{})))):gn(new ar(o,{}));const{matched:p,consumedSegments:w,lastChild:T}=$y(e,r,o);if(!p)return Zy(e);const O=o.slice(T);return this.getChildConfig(t,r,o).pipe(mr(W=>{const K=W.module,ie=W.routes,{segmentGroup:fe,slicedSegments:Ve}=Hy(e,w,O,ie),Re=new ar(fe.segments,fe.children);if(0===Ve.length&&Re.hasChildren())return this.expandChildren(K,ie,Re).pipe(pn(Qt=>new ar(w,Qt)));if(0===ie.length&&0===Ve.length)return gn(new ar(w,{}));const tt=ml(r)===c;return this.expandSegment(K,Re,ie,Ve,tt?Jn:c,!0).pipe(pn(Ot=>new ar(w.concat(Ot.segments),Ot.children)))}))}getChildConfig(t,e,r){return e.children?gn(new jb(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?gn(e._loadedConfig):this.runCanLoadGuards(t.injector,e,r).pipe(mr(o=>o?this.configLoader.load(t.injector,e).pipe(pn(c=>(e._loadedConfig=c,c))):function(n){return new Hn(t=>t.error(kb(`Cannot load children because the guard of the route "path: '${n.path}'" returned false`)))}(e))):gn(new jb([],t))}runCanLoadGuards(t,e,r){const o=e.canLoad;return o&&0!==o.length?gn(o.map(p=>{const w=t.get(p);let T;if(function(n){return n&&ad(n.canLoad)}(w))T=w.canLoad(e,r);else{if(!ad(w))throw new Error("Invalid CanLoad guard");T=w(e,r)}return ou(T)})).pipe(a0(),Co(p=>{if(!qA(p))return;const w=kb(`Redirecting to "${this.urlSerializer.serialize(p)}"`);throw w.url=p,w}),pn(p=>!0===p)):gn(!0)}lineralizeSegments(t,e){let r=[],o=e.root;for(;;){if(r=r.concat(o.segments),0===o.numberOfChildren)return gn(r);if(o.numberOfChildren>1||!o.children[Jn])return iV(t.redirectTo);o=o.children[Jn]}}applyRedirectCommands(t,e,r){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,r)}applyRedirectCreatreUrlTree(t,e,r,o){const c=this.createSegmentGroup(t,e.root,r,o);return new $A(c,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const r={};return $o(t,(o,c)=>{if("string"==typeof o&&o.startsWith(":")){const w=o.substring(1);r[c]=e[w]}else r[c]=o}),r}createSegmentGroup(t,e,r,o){const c=this.createSegments(t,e.segments,r,o);let p={};return $o(e.children,(w,T)=>{p[T]=this.createSegmentGroup(t,w,r,o)}),new ar(c,p)}createSegments(t,e,r,o){return e.map(c=>c.path.startsWith(":")?this.findPosParam(t,c,o):this.findOrReturn(c,r))}findPosParam(t,e,r){const o=r[e.path.substring(1)];if(!o)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return o}findOrReturn(t,e){let r=0;for(const o of e){if(o.path===t.path)return e.splice(r),o;r++}return t}}function $b(n){const t={};for(const r of Object.keys(n.children)){const c=$b(n.children[r]);(c.segments.length>0||c.hasChildren())&&(t[r]=c)}return function(n){if(1===n.numberOfChildren&&n.children[Jn]){const t=n.children[Jn];return new ar(n.segments.concat(t.segments),t.children)}return n}(new ar(n.segments,t))}class XS{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Wy{constructor(t,e){this.component=t,this.route=e}}function uV(n,t,e){const r=n._root;return c0(r,t?t._root:null,e,[r.value])}function Qy(n,t,e){const r=function(n){if(!n)return null;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig}return null}(t);return(r?r.module.injector:e).get(n)}function c0(n,t,e,r,o={canDeactivateChecks:[],canActivateChecks:[]}){const c=r0(t);return n.children.forEach(p=>{(function(n,t,e,r,o={canDeactivateChecks:[],canActivateChecks:[]}){const c=n.value,p=t?t.value:null,w=e?e.getContext(n.value.outlet):null;if(p&&c.routeConfig===p.routeConfig){const T=function(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!HA(n.url,t.url);case"pathParamsOrQueryParamsChange":return!HA(n.url,t.url)||!iu(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Nb(n,t)||!iu(n.queryParams,t.queryParams);case"paramsChange":default:return!Nb(n,t)}}(p,c,c.routeConfig.runGuardsAndResolvers);T?o.canActivateChecks.push(new XS(r)):(c.data=p.data,c._resolvedData=p._resolvedData),c0(n,t,c.component?w?w.children:null:e,r,o),T&&w&&w.outlet&&w.outlet.isActivated&&o.canDeactivateChecks.push(new Wy(w.outlet.component,p))}else p&&u0(t,w,o),o.canActivateChecks.push(new XS(r)),c0(n,null,c.component?w?w.children:null:e,r,o)})(p,c[p.value.outlet],e,r.concat([p.value]),o),delete c[p.value.outlet]}),$o(c,(p,w)=>u0(p,e.getContext(w),o)),o}function u0(n,t,e){const r=r0(n),o=n.value;$o(r,(c,p)=>{u0(c,o.component?t?t.children.getContext(p):null:t,e)}),e.canDeactivateChecks.push(new Wy(o.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,o))}class wV{}function YS(n){return new Hn(t=>t.error(n))}class EV{constructor(t,e,r,o,c,p){this.rootComponentType=t,this.config=e,this.urlTree=r,this.url=o,this.paramsInheritanceStrategy=c,this.relativeLinkResolution=p}recognize(){const t=Hy(this.urlTree.root,[],[],this.config.filter(p=>void 0===p.redirectTo),this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,Jn);if(null===e)return null;const r=new Vy([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Jn,this.rootComponentType,null,this.urlTree.root,-1,{}),o=new fh(r,e),c=new RS(this.url,o);return this.inheritParamsAndData(c._root),c}inheritParamsAndData(t){const e=t.value,r=PS(e,this.paramsInheritanceStrategy);e.params=Object.freeze(r.params),e.data=Object.freeze(r.data),t.children.forEach(o=>this.inheritParamsAndData(o))}processSegmentGroup(t,e,r){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,r)}processChildren(t,e){const r=[];for(const c of Object.keys(e.children)){const p=e.children[c],w=$S(t,c),T=this.processSegmentGroup(w,p,c);if(null===T)return null;r.push(...T)}const o=KS(r);return function(n){n.sort((t,e)=>t.value.outlet===Jn?-1:e.value.outlet===Jn?1:t.value.outlet.localeCompare(e.value.outlet))}(o),o}processSegment(t,e,r,o){for(const c of t){const p=this.processSegmentAgainstRoute(c,e,r,o);if(null!==p)return p}return ZS(e,r,o)?[]:null}processSegmentAgainstRoute(t,e,r,o){if(t.redirectTo||!qS(t,e,r,o))return null;let c,p=[],w=[];if("**"===t.path){const ie=r.length>0?yS(r).parameters:{};c=new Vy(r,ie,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,tT(t),ml(t),t.component,t,JS(e),eT(e)+r.length,nT(t))}else{const ie=$y(e,t,r);if(!ie.matched)return null;p=ie.consumedSegments,w=r.slice(ie.lastChild),c=new Vy(p,ie.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,tT(t),ml(t),t.component,t,JS(e),eT(e)+p.length,nT(t))}const T=function(n){return n.children?n.children:n.loadChildren?n._loadedConfig.routes:[]}(t),{segmentGroup:O,slicedSegments:V}=Hy(e,p,w,T.filter(ie=>void 0===ie.redirectTo),this.relativeLinkResolution);if(0===V.length&&O.hasChildren()){const ie=this.processChildren(T,O);return null===ie?null:[new fh(c,ie)]}if(0===T.length&&0===V.length)return[new fh(c,[])];const W=ml(t)===o,K=this.processSegment(T,O,V,W?Jn:o);return null===K?null:[new fh(c,K)]}}function SV(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function KS(n){const t=[],e=new Set;for(const r of n){if(!SV(r)){t.push(r);continue}const o=t.find(c=>r.value.routeConfig===c.value.routeConfig);void 0!==o?(o.children.push(...r.children),e.add(o)):t.push(r)}for(const r of e){const o=KS(r.children);t.push(new fh(r.value,o))}return t.filter(r=>!e.has(r))}function JS(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function eT(n){let t=n,e=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift?t._segmentIndexShift:0;return e-1}function tT(n){return n.data||{}}function nT(n){return n.resolve||{}}function Hb(n){return nu(t=>{const e=n(t);return e?Nr(e).pipe(pn(()=>t)):gn(t)})}class LV extends class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const qb=new on("ROUTES");class rT{constructor(t,e,r,o){this.loader=t,this.compiler=e,this.onLoadStartListener=r,this.onLoadEndListener=o}load(t,e){if(e._loader$)return e._loader$;this.onLoadStartListener&&this.onLoadStartListener(e);const o=this.loadModuleFactory(e.loadChildren).pipe(pn(c=>{this.onLoadEndListener&&this.onLoadEndListener(e);const p=c.create(t);return new jb(_S(p.injector.get(qb,void 0,Yt.Self|Yt.Optional)).map(Gb),p)}),od(c=>{throw e._loader$=void 0,c}));return e._loader$=new uc(o,()=>new vi).pipe(Dl()),e._loader$}loadModuleFactory(t){return"string"==typeof t?Nr(this.loader.load(t)):ou(t()).pipe(mr(e=>e instanceof TE?gn(e):Nr(this.compiler.compileModuleAsync(e))))}}class BV{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new qp,this.attachRef=null}}class qp{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const r=this.getOrCreateContext(t);r.outlet=e,this.contexts.set(t,r)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null,e.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new BV,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class zV{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function VV(n){throw n}function UV(n,t,e){return t.parse("/")}function iT(n,t){return gn(null)}const jV={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},GV={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let da=(()=>{class n{constructor(e,r,o,c,p,w,T,O){this.rootComponentType=e,this.urlSerializer=r,this.rootContexts=o,this.location=c,this.config=O,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new vi,this.errorHandler=VV,this.malformedUriErrorHandler=UV,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:iT,afterPreactivation:iT},this.urlHandlingStrategy=new zV,this.routeReuseStrategy=new LV,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=p.get(eu),this.console=p.get(iy);const K=p.get(_i);this.isNgZoneEnabled=K instanceof _i&&_i.isInAngularZone(),this.resetConfig(O),this.currentUrlTree=new $A(new ar([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new rT(w,T,ie=>this.triggerEvent(new AS(ie)),ie=>this.triggerEvent(new fS(ie))),this.routerState=kS(this.currentUrlTree,this.rootComponentType),this.transitions=new pl({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}setupNavigations(e){const r=this.events;return e.pipe(ru(o=>0!==o.id),pn(o=>Object.assign(Object.assign({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),nu(o=>{let c=!1,p=!1;return gn(o).pipe(Co(w=>{this.currentNavigation={id:w.id,initialUrl:w.currentRawUrl,extractedUrl:w.extractedUrl,trigger:w.source,extras:w.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),nu(w=>{const T=this.browserUrlTree.toString(),O=!this.navigated||w.extractedUrl.toString()!==T||T!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||O)&&this.urlHandlingStrategy.shouldProcessUrl(w.rawUrl))return Xy(w.source)&&(this.browserUrlTree=w.extractedUrl),gn(w).pipe(nu(W=>{const K=this.transitions.getValue();return r.next(new Ib(W.id,this.serializeUrl(W.extractedUrl),W.source,W.restoredState)),K!==this.transitions.getValue()?jp:Promise.resolve(W)}),function(n,t,e,r){return nu(o=>function(n,t,e,r,o){return new aV(n,t,e,r,o).apply()}(n,t,e,o.extractedUrl,r).pipe(pn(c=>Object.assign(Object.assign({},o),{urlAfterRedirects:c}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Co(W=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:W.urlAfterRedirects})}),function(n,t,e,r,o){return mr(c=>function(n,t,e,r,o="emptyOnly",c="legacy"){try{const p=new EV(n,t,e,r,o,c).recognize();return null===p?YS(new wV):gn(p)}catch(p){return YS(p)}}(n,t,c.urlAfterRedirects,e(c.urlAfterRedirects),r,o).pipe(pn(p=>Object.assign(Object.assign({},c),{targetSnapshot:p}))))}(this.rootComponentType,this.config,W=>this.serializeUrl(W),this.paramsInheritanceStrategy,this.relativeLinkResolution),Co(W=>{"eager"===this.urlUpdateStrategy&&(W.extras.skipLocationChange||this.setBrowserUrl(W.urlAfterRedirects,W),this.browserUrlTree=W.urlAfterRedirects);const K=new rz(W.id,this.serializeUrl(W.extractedUrl),this.serializeUrl(W.urlAfterRedirects),W.targetSnapshot);r.next(K)}));if(O&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:K,extractedUrl:ie,source:fe,restoredState:Ve,extras:Re}=w,tt=new Ib(K,this.serializeUrl(ie),fe,Ve);r.next(tt);const He=kS(ie,this.rootComponentType).snapshot;return gn(Object.assign(Object.assign({},w),{targetSnapshot:He,urlAfterRedirects:ie,extras:Object.assign(Object.assign({},Re),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=w.rawUrl,this.browserUrlTree=w.urlAfterRedirects,w.resolve(null),jp}),Hb(w=>{const{targetSnapshot:T,id:O,extractedUrl:V,rawUrl:W,extras:{skipLocationChange:K,replaceUrl:ie}}=w;return this.hooks.beforePreactivation(T,{navigationId:O,appliedUrlTree:V,rawUrlTree:W,skipLocationChange:!!K,replaceUrl:!!ie})}),Co(w=>{const T=new iz(w.id,this.serializeUrl(w.extractedUrl),this.serializeUrl(w.urlAfterRedirects),w.targetSnapshot);this.triggerEvent(T)}),pn(w=>Object.assign(Object.assign({},w),{guards:uV(w.targetSnapshot,w.currentSnapshot,this.rootContexts)})),function(n,t){return mr(e=>{const{targetSnapshot:r,currentSnapshot:o,guards:{canActivateChecks:c,canDeactivateChecks:p}}=e;return 0===p.length&&0===c.length?gn(Object.assign(Object.assign({},e),{guardsResult:!0})):function(n,t,e,r){return Nr(n).pipe(mr(o=>function(n,t,e,r,o){const c=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return c&&0!==c.length?gn(c.map(w=>{const T=Qy(w,t,o);let O;if(function(n){return n&&ad(n.canDeactivate)}(T))O=ou(T.canDeactivate(n,t,e,r));else{if(!ad(T))throw new Error("Invalid CanDeactivate guard");O=ou(T(n,t,e,r))}return O.pipe(GA())})).pipe(a0()):gn(!0)}(o.component,o.route,e,t,r)),GA(o=>!0!==o,!0))}(p,r,o,n).pipe(mr(w=>w&&function(n){return"boolean"==typeof n}(w)?function(n,t,e,r){return Nr(t).pipe(Gp(o=>Mb(function(n,t){return null!==n&&t&&t(new lz(n)),gn(!0)}(o.route.parent,r),function(n,t){return null!==n&&t&&t(new uz(n)),gn(!0)}(o.route,r),function(n,t,e){const r=t[t.length-1],c=t.slice(0,t.length-1).reverse().map(p=>function(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(p)).filter(p=>null!==p).map(p=>sS(()=>gn(p.guards.map(T=>{const O=Qy(T,p.node,e);let V;if(function(n){return n&&ad(n.canActivateChild)}(O))V=ou(O.canActivateChild(r,n));else{if(!ad(O))throw new Error("Invalid CanActivateChild guard");V=ou(O(r,n))}return V.pipe(GA())})).pipe(a0())));return gn(c).pipe(a0())}(n,o.path,e),function(n,t,e){const r=t.routeConfig?t.routeConfig.canActivate:null;return r&&0!==r.length?gn(r.map(c=>sS(()=>{const p=Qy(c,t,e);let w;if(function(n){return n&&ad(n.canActivate)}(p))w=ou(p.canActivate(t,n));else{if(!ad(p))throw new Error("Invalid CanActivate guard");w=ou(p(t,n))}return w.pipe(GA())}))).pipe(a0()):gn(!0)}(n,o.route,e))),GA(o=>!0!==o,!0))}(r,c,n,t):gn(w)),pn(w=>Object.assign(Object.assign({},e),{guardsResult:w})))})}(this.ngModule.injector,w=>this.triggerEvent(w)),Co(w=>{if(qA(w.guardsResult)){const O=kb(`Redirecting to "${this.serializeUrl(w.guardsResult)}"`);throw O.url=w.guardsResult,O}const T=new oz(w.id,this.serializeUrl(w.extractedUrl),this.serializeUrl(w.urlAfterRedirects),w.targetSnapshot,!!w.guardsResult);this.triggerEvent(T)}),ru(w=>!!w.guardsResult||(this.restoreHistory(w),this.cancelNavigationTransition(w,""),!1)),Hb(w=>{if(w.guards.canActivateChecks.length)return gn(w).pipe(Co(T=>{const O=new sz(T.id,this.serializeUrl(T.extractedUrl),this.serializeUrl(T.urlAfterRedirects),T.targetSnapshot);this.triggerEvent(O)}),nu(T=>{let O=!1;return gn(T).pipe(function(n,t){return mr(e=>{const{targetSnapshot:r,guards:{canActivateChecks:o}}=e;if(!o.length)return gn(e);let c=0;return Nr(o).pipe(Gp(p=>function(n,t,e,r){return function(n,t,e,r){const o=Object.keys(n);if(0===o.length)return gn({});const c={};return Nr(o).pipe(mr(p=>function(n,t,e,r){const o=Qy(n,t,r);return ou(o.resolve?o.resolve(t,e):o(t,e))}(n[p],t,e,r).pipe(Co(w=>{c[p]=w}))),Tb(1),mr(()=>Object.keys(c).length===o.length?gn(c):jp))}(n._resolve,n,t,r).pipe(pn(c=>(n._resolvedData=c,n.data=Object.assign(Object.assign({},n.data),PS(n,e).resolve),null)))}(p.route,r,n,t)),Co(()=>c++),Tb(1),mr(p=>c===o.length?gn(e):jp))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Co({next:()=>O=!0,complete:()=>{O||(this.restoreHistory(T),this.cancelNavigationTransition(T,"At least one route resolver didn't emit any value."))}}))}),Co(T=>{const O=new az(T.id,this.serializeUrl(T.extractedUrl),this.serializeUrl(T.urlAfterRedirects),T.targetSnapshot);this.triggerEvent(O)}))}),Hb(w=>{const{targetSnapshot:T,id:O,extractedUrl:V,rawUrl:W,extras:{skipLocationChange:K,replaceUrl:ie}}=w;return this.hooks.afterPreactivation(T,{navigationId:O,appliedUrlTree:V,rawUrlTree:W,skipLocationChange:!!K,replaceUrl:!!ie})}),pn(w=>{const T=function(n,t,e){const r=Uy(n,t._root,e?e._root:void 0);return new IS(r,t)}(this.routeReuseStrategy,w.targetSnapshot,w.currentRouterState);return Object.assign(Object.assign({},w),{targetRouterState:T})}),Co(w=>{this.currentUrlTree=w.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(w.urlAfterRedirects,w.rawUrl),this.routerState=w.targetRouterState,"deferred"===this.urlUpdateStrategy&&(w.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,w),this.browserUrlTree=w.urlAfterRedirects)}),((n,t,e)=>pn(r=>(new Hz(t,r.targetRouterState,r.currentRouterState,e).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,w=>this.triggerEvent(w)),Co({next(){c=!0},complete(){c=!0}}),function(n){return t=>t.lift(new ez(n))}(()=>{var w;if(!c&&!p){const T=`Navigation ID ${o.id} is not equal to the current navigation id ${this.navigationId}`;"replace"===this.canceledNavigationResolution?(this.restoreHistory(o),this.cancelNavigationTransition(o,T)):this.cancelNavigationTransition(o,T)}(null===(w=this.currentNavigation)||void 0===w?void 0:w.id)===o.id&&(this.currentNavigation=null)}),od(w=>{if(p=!0,function(n){return n&&n[mS]}(w)){const T=qA(w.url);T||(this.navigated=!0,this.restoreHistory(o,!0));const O=new dS(o.id,this.serializeUrl(o.extractedUrl),w.message);r.next(O),T?setTimeout(()=>{const V=this.urlHandlingStrategy.merge(w.url,this.rawUrlTree),W={skipLocationChange:o.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Xy(o.source)};this.scheduleNavigation(V,"imperative",null,W,{resolve:o.resolve,reject:o.reject,promise:o.promise})},0):o.resolve(!1)}else{this.restoreHistory(o,!0);const T=new nz(o.id,this.serializeUrl(o.extractedUrl),w);r.next(T);try{o.resolve(this.errorHandler(w))}catch(O){o.reject(O)}}return jp}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}getTransition(){const e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}setTransition(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const r=this.extractLocationChangeInfoFromEvent(e);this.shouldScheduleNavigation(this.lastLocationChangeInfo,r)&&setTimeout(()=>{const{source:o,state:c,urlTree:p}=r,w={replaceUrl:!0};if(c){const T=Object.assign({},c);delete T.navigationId,delete T.\u0275routerPageId,0!==Object.keys(T).length&&(w.state=T)}this.scheduleNavigation(p,o,c,w)},0),this.lastLocationChangeInfo=r}))}extractLocationChangeInfoFromEvent(e){var r;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(r=e.state)||void 0===r?void 0:r.navigationId)?e.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(e,r){if(!e)return!0;const o=r.urlTree.toString()===e.urlTree.toString();return r.transitionId!==e.transitionId||!o||!("hashchange"===r.source&&"popstate"===e.source||"popstate"===r.source&&"hashchange"===e.source)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){GS(e),this.config=e.map(Gb),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,r={}){const{relativeTo:o,queryParams:c,fragment:p,queryParamsHandling:w,preserveFragment:T}=r,O=o||this.routerState.root,V=T?this.currentUrlTree.fragment:p;let W=null;switch(w){case"merge":W=Object.assign(Object.assign({},this.currentUrlTree.queryParams),c);break;case"preserve":W=this.currentUrlTree.queryParams;break;default:W=c||null}return null!==W&&(W=this.removeEmptyProps(W)),function(n,t,e,r,o){if(0===e.length)return zb(t.root,t.root,t,r,o);const c=function(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new BS(!0,0,n);let t=0,e=!1;const r=n.reduce((o,c,p)=>{if("object"==typeof c&&null!=c){if(c.outlets){const w={};return $o(c.outlets,(T,O)=>{w[O]="string"==typeof T?T.split("/"):T}),[...o,{outlets:w}]}if(c.segmentPath)return[...o,c.segmentPath]}return"string"!=typeof c?[...o,c]:0===p?(c.split("/").forEach((w,T)=>{0==T&&"."===w||(0==T&&""===w?e=!0:".."===w?t++:""!=w&&o.push(w))}),o):[...o,c]},[]);return new BS(e,t,r)}(e);if(c.toRoot())return zb(t.root,new ar([],{}),t,r,o);const p=function(n,t,e){if(n.isAbsolute)return new Vb(t.root,!0,0);if(-1===e.snapshot._lastPathIndex){const c=e.snapshot._urlSegment;return new Vb(c,c===t.root,0)}const r=jy(n.commands[0])?0:1;return function(n,t,e){let r=n,o=t,c=e;for(;c>o;){if(c-=o,r=r.parent,!r)throw new Error("Invalid number of '../'");o=r.segments.length}return new Vb(r,!1,o-c)}(e.snapshot._urlSegment,e.snapshot._lastPathIndex+r,n.numberOfDoubleDots)}(c,t,n),w=p.processChildren?Gy(p.segmentGroup,p.index,c.commands):NS(p.segmentGroup,p.index,c.commands);return zb(p.segmentGroup,w,t,r,o)}(O,this.currentUrlTree,e,W,null!=V?V:null)}navigateByUrl(e,r={skipLocationChange:!1}){const o=qA(e)?e:this.parseUrl(e),c=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(c,"imperative",null,r)}navigate(e,r={skipLocationChange:!1}){return function(n){for(let t=0;t<n.length;t++){const e=n[t];if(null==e)throw new Error(`The requested path contains ${e} segment at index ${t}`)}}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let r;try{r=this.urlSerializer.parse(e)}catch(o){r=this.malformedUriErrorHandler(o,this.urlSerializer,e)}return r}isActive(e,r){let o;if(o=!0===r?Object.assign({},jV):!1===r?Object.assign({},GV):r,qA(e))return xS(this.currentUrlTree,e,o);const c=this.parseUrl(e);return xS(this.currentUrlTree,c,o)}removeEmptyProps(e){return Object.keys(e).reduce((r,o)=>{const c=e[o];return null!=c&&(r[o]=c),r},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new e0(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,r,o,c,p){var w,T;if(this.disposed)return Promise.resolve(!1);const O=this.getTransition(),V=Xy(r)&&O&&!Xy(O.source),ie=(this.lastSuccessfulId===O.id||this.currentNavigation?O.rawUrl:O.urlAfterRedirects).toString()===e.toString();if(V&&ie)return Promise.resolve(!0);let fe,Ve,Re;p?(fe=p.resolve,Ve=p.reject,Re=p.promise):Re=new Promise((Ot,Qt)=>{fe=Ot,Ve=Qt});const tt=++this.navigationId;let He;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(o=this.location.getState()),He=o&&o.\u0275routerPageId?o.\u0275routerPageId:c.replaceUrl||c.skipLocationChange?null!==(w=this.browserPageId)&&void 0!==w?w:0:(null!==(T=this.browserPageId)&&void 0!==T?T:0)+1):He=0,this.setTransition({id:tt,targetPageId:He,source:r,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:c,resolve:fe,reject:Ve,promise:Re,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Re.catch(Ot=>Promise.reject(Ot))}setBrowserUrl(e,r){const o=this.urlSerializer.serialize(e),c=Object.assign(Object.assign({},r.extras.state),this.generateNgRouterState(r.id,r.targetPageId));this.location.isCurrentPathEqualTo(o)||r.extras.replaceUrl?this.location.replaceState(o,"",c):this.location.go(o,"",c)}restoreHistory(e,r=!1){var o,c;if("computed"===this.canceledNavigationResolution){const p=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(o=this.currentNavigation)||void 0===o?void 0:o.finalUrl)||0===p?this.currentUrlTree===(null===(c=this.currentNavigation)||void 0===c?void 0:c.finalUrl)&&0===p&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(p)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,r){const o=new dS(e.id,this.serializeUrl(e.extractedUrl),r);this.triggerEvent(o),e.resolve(!1)}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}}return n.\u0275fac=function(e){return new(e||n)(vt($u),vt(Pb),vt(qp),vt(gy),vt(Pr),vt(sy),vt(zA),vt(void 0))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();function Xy(n){return"imperative"!==n}let oT=(()=>{class n{constructor(e,r,o,c,p){this.parentContexts=e,this.location=r,this.resolver=o,this.changeDetector=p,this.activated=null,this._activatedRoute=null,this.activateEvents=new rt,this.deactivateEvents=new rt,this.name=c||Jn,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;const p=(r=r||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),w=this.parentContexts.getOrCreateContext(this.name).children,T=new ZV(e,w,this.location.injector);this.activated=this.location.createComponent(p,this.location.length,T),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)(lt(qp),lt(Yl),lt(LA),function(n){return function(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const r=e.length;let o=0;for(;o<r;){const c=e[o];if(te(c))break;if(0===c)o+=2;else if("number"==typeof c)for(o++;o<r&&"string"==typeof e[o];)o++;else{if(c===t)return e[o+1];o+=2}}}return null}(li(),n)}("name"),lt(rx))},n.\u0275dir=Kt({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),n})();class ZV{constructor(t,e,r){this.route=t,this.childContexts=e,this.parent=r}get(t,e){return t===Hp?this.route:t===qp?this.childContexts:this.parent.get(t,e)}}class sT{}class aT{preload(t,e){return gn(null)}}let lT=(()=>{class n{constructor(e,r,o,c,p){this.router=e,this.injector=c,this.preloadingStrategy=p,this.loader=new rT(r,o,O=>e.triggerEvent(new AS(O)),O=>e.triggerEvent(new fS(O)))}setUpPreloading(){this.subscription=this.router.events.pipe(ru(e=>e instanceof e0),Gp(()=>this.preload())).subscribe(()=>{})}preload(){const e=this.injector.get(eu);return this.processRoutes(e,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){const o=[];for(const c of r)if(c.loadChildren&&!c.canLoad&&c._loadedConfig){const p=c._loadedConfig;o.push(this.processRoutes(p.module,p.routes))}else c.loadChildren&&!c.canLoad?o.push(this.preloadConfig(e,c)):c.children&&o.push(this.processRoutes(e,c.children));return Nr(o).pipe(Wo(),pn(c=>{}))}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>(r._loadedConfig?gn(r._loadedConfig):this.loader.load(e.injector,r)).pipe(mr(c=>(r._loadedConfig=c,this.processRoutes(c.module,c.routes)))))}}return n.\u0275fac=function(e){return new(e||n)(vt(da),vt(sy),vt(zA),vt(Pr),vt(sT))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})(),Qb=(()=>{class n{constructor(e,r,o={}){this.router=e,this.viewportScroller=r,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Ib?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof e0&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof pS&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.router.triggerEvent(new pS(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(vt(da),vt(GM),vt(void 0))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();const ZA=new on("ROUTER_CONFIGURATION"),cT=new on("ROUTER_FORROOT_GUARD"),QV=[gy,{provide:Pb,useClass:ES},{provide:da,useFactory:function(n,t,e,r,o,c,p,w={},T,O){const V=new da(null,n,t,e,r,o,c,_S(p));return T&&(V.urlHandlingStrategy=T),O&&(V.routeReuseStrategy=O),function(n,t){n.errorHandler&&(t.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(t.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(t.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(t.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(t.urlUpdateStrategy=n.urlUpdateStrategy)}(w,V),w.enableTracing&&V.events.subscribe(W=>{var K,ie;null===(K=console.group)||void 0===K||K.call(console,`Router Event: ${W.constructor.name}`),console.log(W.toString()),console.log(W),null===(ie=console.groupEnd)||void 0===ie||ie.call(console)}),V},deps:[Pb,qp,gy,Pr,sy,zA,qb,ZA,[class{},new is],[class{},new is]]},qp,{provide:Hp,useFactory:function(n){return n.routerState.root},deps:[da]},{provide:sy,useClass:Z4},lT,aT,class{preload(t,e){return e().pipe(od(()=>gn(null)))}},{provide:ZA,useValue:{enableTracing:!1}}];function XV(){return new Vx("Router",da)}let uT=(()=>{class n{constructor(e,r){}static forRoot(e,r){return{ngModule:n,providers:[QV,hT(e),{provide:cT,useFactory:JV,deps:[[da,new is,new Mi]]},{provide:ZA,useValue:r||{}},{provide:Up,useFactory:KV,deps:[jA,[new Wu(rb),new is],ZA]},{provide:Qb,useFactory:YV,deps:[da,GM,ZA]},{provide:sT,useExisting:r&&r.preloadingStrategy?r.preloadingStrategy:aT},{provide:Vx,multi:!0,useFactory:XV},[Xb,{provide:Gg,multi:!0,useFactory:r8,deps:[Xb]},{provide:dT,useFactory:i8,deps:[Xb]},{provide:PD,multi:!0,useExisting:dT}]]}}static forChild(e){return{ngModule:n,providers:[hT(e)]}}}return n.\u0275fac=function(e){return new(e||n)(vt(cT,8),vt(da,8))},n.\u0275mod=Gi({type:n}),n.\u0275inj=gr({}),n})();function YV(n,t,e){return e.scrollOffset&&t.setOffset(e.scrollOffset),new Qb(n,t,e)}function KV(n,t,e={}){return e.useHash?new AB(n,t):new bM(n,t)}function JV(n){return"guarded"}function hT(n){return[{provide:jh,multi:!0,useValue:n},{provide:qb,multi:!0,useValue:n}]}let Xb=(()=>{class n{constructor(e){this.injector=e,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new vi}appInitializer(){return this.injector.get(uB,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let r=null;const o=new Promise(w=>r=w),c=this.injector.get(da),p=this.injector.get(ZA);return"disabled"===p.initialNavigation?(c.setUpLocationChangeListener(),r(!0)):"enabled"===p.initialNavigation||"enabledBlocking"===p.initialNavigation?(c.hooks.afterPreactivation=()=>this.initNavigation?gn(null):(this.initNavigation=!0,r(!0),this.resultOfPreactivationDone),c.initialNavigation()):r(!0),o})}bootstrapListener(e){const r=this.injector.get(ZA),o=this.injector.get(lT),c=this.injector.get(Qb),p=this.injector.get(da),w=this.injector.get(Np);e===w.components[0]&&(("enabledNonBlocking"===r.initialNavigation||void 0===r.initialNavigation)&&p.initialNavigation(),o.setUpPreloading(),c.init(),p.resetRootComponentType(w.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return n.\u0275fac=function(e){return new(e||n)(vt(Pr))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();function r8(n){return n.appInitializer.bind(n)}function i8(n){return n.bootstrapListener.bind(n)}const dT=new on("Router Initializer"),s8=[];let a8=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Gi({type:n}),n.\u0275inj=gr({imports:[[uT.forRoot(s8)],uT]}),n})();class l8 extends Et{constructor(t,e){super()}schedule(t,e=0){return this}}class AT extends l8{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(o,this.id,e),this}requestAsyncId(t,e,r=0){return setInterval(t.flush.bind(t,this),r)}recycleAsyncId(t,e,r=0){if(null!==r&&this.delay===r&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let o,r=!1;try{this.work(t)}catch(c){r=!0,o=!!c&&c||new Error(c)}if(r)return this.unsubscribe(),o}_unsubscribe(){const t=this.id,e=this.scheduler,r=e.actions,o=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==o&&r.splice(o,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}let fT=(()=>{class n{constructor(e,r=n.now){this.SchedulerAction=e,this.now=r}schedule(e,r=0,o){return new this.SchedulerAction(this,e).schedule(o,r)}}return n.now=()=>Date.now(),n})();class ph extends fT{constructor(t,e=fT.now){super(t,()=>ph.delegate&&ph.delegate!==this?ph.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,r){return ph.delegate&&ph.delegate!==this?ph.delegate.schedule(t,e,r):super.schedule(t,e,r)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let r;this.active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}}const h8=new class extends ph{}(class extends AT{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,r=0){return null!==r&&r>0||null===r&&this.delay>0?super.requestAsyncId(t,e,r):t.flush(this)}});function pT(n,t){return new Hn(t?e=>t.schedule(d8,0,{error:n,subscriber:e}):e=>e.error(n))}function d8({error:n,subscriber:t}){t.error(n)}class gl{constructor(t,e,r){this.kind=t,this.value=e,this.error=r,this.hasValue="N"===t}observe(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}do(t,e,r){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return r&&r()}}accept(t,e,r){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,r)}toObservable(){switch(this.kind){case"N":return gn(this.value);case"E":return pT(this.error);case"C":return Fy()}throw new Error("unexpected notification kind value")}static createNext(t){return void 0!==t?new gl("N",t):gl.undefinedValueNotification}static createError(t){return new gl("E",void 0,t)}static createComplete(){return gl.completeNotification}}gl.completeNotification=new gl("C"),gl.undefinedValueNotification=new gl("N",void 0);class Yy extends qn{constructor(t,e,r=0){super(t),this.scheduler=e,this.delay=r}static dispatch(t){const{notification:e,destination:r}=t;e.observe(r),this.unsubscribe()}scheduleMessage(t){this.destination.add(this.scheduler.schedule(Yy.dispatch,this.delay,new f8(t,this.destination)))}_next(t){this.scheduleMessage(gl.createNext(t))}_error(t){this.scheduleMessage(gl.createError(t)),this.unsubscribe()}_complete(){this.scheduleMessage(gl.createComplete()),this.unsubscribe()}}class f8{constructor(t,e){this.notification=t,this.destination=e}}class Yb extends vi{constructor(t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,r){super(),this.scheduler=r,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=t<1?1:t,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(t){if(!this.isStopped){const e=this._events;e.push(t),e.length>this._bufferSize&&e.shift()}super.next(t)}nextTimeWindow(t){this.isStopped||(this._events.push(new p8(this._getNow(),t)),this._trimBufferThenGetEvents()),super.next(t)}_subscribe(t){const e=this._infiniteTimeWindow,r=e?this._events:this._trimBufferThenGetEvents(),o=this.scheduler,c=r.length;let p;if(this.closed)throw new _s;if(this.isStopped||this.hasError?p=Et.EMPTY:(this.observers.push(t),p=new xl(this,t)),o&&t.add(t=new Yy(t,o)),e)for(let w=0;w<c&&!t.closed;w++)t.next(r[w]);else for(let w=0;w<c&&!t.closed;w++)t.next(r[w].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),p}_getNow(){return(this.scheduler||h8).now()}_trimBufferThenGetEvents(){const t=this._getNow(),e=this._bufferSize,r=this._windowTime,o=this._events,c=o.length;let p=0;for(;p<c&&!(t-o[p].time<r);)p++;return c>e&&(p=Math.max(p,c-e)),p>0&&o.splice(0,p),o}}class p8{constructor(t,e){this.time=t,this.value=e}}function Ky(n,t,e,r){return Hs(e)&&(r=e,e=void 0),r?Ky(n,t,e).pipe(pn(o=>qo(o)?r(...o):r(o))):new Hn(o=>{mT(n,t,function(p){o.next(arguments.length>1?Array.prototype.slice.call(arguments):p)},o,e)})}function mT(n,t,e,r,o){let c;if(function(n){return n&&"function"==typeof n.addEventListener&&"function"==typeof n.removeEventListener}(n)){const p=n;n.addEventListener(t,e,o),c=()=>p.removeEventListener(t,e,o)}else if(function(n){return n&&"function"==typeof n.on&&"function"==typeof n.off}(n)){const p=n;n.on(t,e),c=()=>p.off(t,e)}else if(function(n){return n&&"function"==typeof n.addListener&&"function"==typeof n.removeListener}(n)){const p=n;n.addListener(t,e),c=()=>p.removeListener(t,e)}else{if(!n||!n.length)throw new TypeError("Invalid event target");for(let p=0,w=n.length;p<w;p++)mT(n[p],t,e,r,o)}r.add(c)}const y8=new ph(AT);function gT(n,t=y8){return e=>e.lift(new v8(n,t))}class v8{constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new x8(t,this.dueTime,this.scheduler))}}class x8 extends qn{constructor(t,e,r){super(t),this.dueTime=e,this.scheduler=r,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(b8,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function b8(n){n.debouncedNext()}function ld(n,t,e,r){return new(e||(e=Promise))(function(c,p){function w(V){try{O(r.next(V))}catch(W){p(W)}}function T(V){try{O(r.throw(V))}catch(W){p(W)}}function O(V){V.done?c(V.value):function(c){return c instanceof e?c:new e(function(p){p(c)})}(V.value).then(w,T)}O((r=r.apply(n,t||[])).next())})}const xT=["*"];var Fr=(()=>(function(n){n.AnnotationChart="AnnotationChart",n.AreaChart="AreaChart",n.Bar="Bar",n.BarChart="BarChart",n.BubbleChart="BubbleChart",n.Calendar="Calendar",n.CandlestickChart="CandlestickChart",n.ColumnChart="ColumnChart",n.ComboChart="ComboChart",n.PieChart="PieChart",n.Gantt="Gantt",n.Gauge="Gauge",n.GeoChart="GeoChart",n.Histogram="Histogram",n.Line="Line",n.LineChart="LineChart",n.Map="Map",n.OrgChart="OrgChart",n.Sankey="Sankey",n.Scatter="Scatter",n.ScatterChart="ScatterChart",n.SteppedAreaChart="SteppedAreaChart",n.Table="Table",n.Timeline="Timeline",n.TreeMap="TreeMap",n.WordTree="wordtree"}(Fr||(Fr={})),Fr))();const M8={[Fr.AnnotationChart]:"annotationchart",[Fr.AreaChart]:"corechart",[Fr.Bar]:"bar",[Fr.BarChart]:"corechart",[Fr.BubbleChart]:"corechart",[Fr.Calendar]:"calendar",[Fr.CandlestickChart]:"corechart",[Fr.ColumnChart]:"corechart",[Fr.ComboChart]:"corechart",[Fr.PieChart]:"corechart",[Fr.Gantt]:"gantt",[Fr.Gauge]:"gauge",[Fr.GeoChart]:"geochart",[Fr.Histogram]:"corechart",[Fr.Line]:"line",[Fr.LineChart]:"corechart",[Fr.Map]:"map",[Fr.OrgChart]:"orgchart",[Fr.Sankey]:"sankey",[Fr.Scatter]:"scatter",[Fr.ScatterChart]:"corechart",[Fr.SteppedAreaChart]:"corechart",[Fr.Table]:"table",[Fr.Timeline]:"timeline",[Fr.TreeMap]:"treemap",[Fr.WordTree]:"wordtree"},CT=new on("GOOGLE_CHARTS_CONFIG"),T8=new on("GOOGLE_CHARTS_LAZY_CONFIG",{providedIn:"root",factory:()=>{const n=k0(CT,Yt.Optional);return gn(Object.assign(Object.assign({},{version:"current",safeMode:!1}),n||{}))}});let Wp=(()=>{class n{constructor(e,r,o){this.zone=e,this.localeId=r,this.config$=o,this.scriptSource="https://www.gstatic.com/charts/loader.js",this.scriptLoadSubject=new vi}isGoogleChartsAvailable(){return!("undefined"==typeof google||void 0===google.charts)}loadChartPackages(...e){return this.loadGoogleCharts().pipe(mr(()=>this.config$),pn(r=>Object.assign(Object.assign({},{version:"current",safeMode:!1}),r||{})),nu(r=>new Hn(o=>{google.charts.load(r.version,{packages:e,language:this.localeId,mapsApiKey:r.mapsApiKey,safeMode:r.safeMode}),google.charts.setOnLoadCallback(()=>{this.zone.run(()=>{o.next(),o.complete()})})})))}loadGoogleCharts(){if(this.isGoogleChartsAvailable())return gn(null);if(!this.isLoadingGoogleCharts()){const e=this.createGoogleChartsScript();e.onload=()=>{this.zone.run(()=>{this.scriptLoadSubject.next(),this.scriptLoadSubject.complete()})},e.onerror=()=>{this.zone.run(()=>{console.error("Failed to load the google charts script!"),this.scriptLoadSubject.error(new Error("Failed to load the google charts script!"))})}}return this.scriptLoadSubject.asObservable()}isLoadingGoogleCharts(){return null!=this.getGoogleChartsScript()}getGoogleChartsScript(){return Array.from(document.getElementsByTagName("script")).find(r=>r.src===this.scriptSource)}createGoogleChartsScript(){const e=document.createElement("script");return e.type="text/javascript",e.src=this.scriptSource,e.async=!0,document.getElementsByTagName("head")[0].appendChild(e),e}}return n.\u0275fac=function(e){return new(e||n)(vt(_i),vt(ch),vt(T8))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})(),ET=(()=>{class n{create(e,r,o){if(null==e)return;let c=!0;null!=r&&(c=!1);const p=google.visualization.arrayToDataTable(this.getDataAsTable(e,r),c);return o&&this.applyFormatters(p,o),p}getDataAsTable(e,r){return r?[r,...e]:e}applyFormatters(e,r){for(const o of r)o.formatter.format(e,o.colIndex)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Wt({factory:function(){return new n},token:n,providedIn:"root"}),n})(),k8=(()=>{class n{constructor(e){this.loaderService=e,this.error=new rt,this.ready=new rt,this.stateChange=new rt,this.id="_"+Math.random().toString(36).substr(2,9),this.wrapperReadySubject=new Yb(1)}get wrapperReady$(){return this.wrapperReadySubject.asObservable()}get controlWrapper(){if(!this._controlWrapper)throw new Error("Cannot access the control wrapper before it being initialized.");return this._controlWrapper}ngOnInit(){this.loaderService.loadChartPackages("controls").subscribe(()=>{this.createControlWrapper()})}ngOnChanges(e){!this._controlWrapper||(e.type&&this._controlWrapper.setControlType(this.type),e.options&&this._controlWrapper.setOptions(this.options||{}),e.state&&this._controlWrapper.setState(this.state||{}))}createControlWrapper(){this._controlWrapper=new google.visualization.ControlWrapper({containerId:this.id,controlType:this.type,state:this.state,options:this.options}),this.addEventListeners(),this.wrapperReadySubject.next(this._controlWrapper)}addEventListeners(){google.visualization.events.removeAllListeners(this._controlWrapper),google.visualization.events.addListener(this._controlWrapper,"ready",e=>this.ready.emit(e)),google.visualization.events.addListener(this._controlWrapper,"error",e=>this.error.emit(e)),google.visualization.events.addListener(this._controlWrapper,"statechange",e=>this.stateChange.emit(e))}}return n.\u0275fac=function(e){return new(e||n)(lt(Wp))},n.\u0275cmp=zo({type:n,selectors:[["control-wrapper"]],hostAttrs:[1,"control-wrapper"],hostVars:1,hostBindings:function(e,r){2&e&&z_("id",r.id)},inputs:{for:"for",type:"type",options:"options",state:"state"},outputs:{error:"error",ready:"ready",stateChange:"stateChange"},exportAs:["controlWrapper"],features:[Sr],decls:0,vars:0,template:function(e,r){},encapsulation:2,changeDetection:0}),n})(),P8=(()=>{class n{constructor(e,r,o){this.element=e,this.loaderService=r,this.dataTableService=o,this.ready=new rt,this.error=new rt,this.initialized=!1}ngOnInit(){this.loaderService.loadChartPackages("controls").subscribe(()=>{this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.createDashboard(),this.initialized=!0})}ngOnChanges(e){!this.initialized||(e.data||e.columns||e.formatters)&&(this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.dashboard.draw(this.dataTable))}createDashboard(){const e=this.controlWrappers.map(o=>o.wrapperReady$),r=this.controlWrappers.map(o=>o.for).map(o=>Array.isArray(o)?Db(o.map(c=>c.wrapperReady$)):o.wrapperReady$);Db([...e,...r]).subscribe(()=>{this.dashboard=new google.visualization.Dashboard(this.element.nativeElement),this.initializeBindings(),this.registerEvents(),this.dashboard.draw(this.dataTable)})}registerEvents(){google.visualization.events.removeAllListeners(this.dashboard);const e=(r,o,c)=>{google.visualization.events.addListener(r,o,c)};e(this.dashboard,"ready",()=>this.ready.emit()),e(this.dashboard,"error",r=>this.error.emit(r))}initializeBindings(){this.controlWrappers.forEach(e=>{if(Array.isArray(e.for)){const r=e.for.map(o=>o.chartWrapper);this.dashboard.bind(e.controlWrapper,r)}else this.dashboard.bind(e.controlWrapper,e.for.chartWrapper)})}}return n.\u0275fac=function(e){return new(e||n)(lt(Xi),lt(Wp),lt(ET))},n.\u0275cmp=zo({type:n,selectors:[["dashboard"]],contentQueries:function(e,r,o){if(1&e&&function(n,t,e,r){const o=Xn();if(o.firstCreatePass){const c=li();dD(o,new cD(t,e,r),c.index),function(n,t){const e=n.contentQueries||(n.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(n.queries.length-1,t)}(o,n),2==(2&e)&&(o.staticContentQueries=!0)}hD(o,ht(),e)}(o,k8,4),2&e){let c;Fp(c=Op())&&(r.controlWrappers=c)}},hostAttrs:[1,"dashboard"],inputs:{data:"data",columns:"columns",formatters:"formatters"},outputs:{ready:"ready",error:"error"},exportAs:["dashboard"],features:[Sr],ngContentSelectors:xT,decls:1,vars:0,template:function(e,r){1&e&&(function(n){const t=ht()[16][6];if(!t.projection){const r=t.projection=Oc(n?n.length:1,null),o=r.slice();let c=t.child;for(;null!==c;){const p=n?JP(c,n):0;null!==p&&(o[p]?o[p].projectionNext=c:r[p]=c,o[p]=c),c=c.next}}}(),function(n,t=0,e){const r=ht(),o=Xn(),c=La(o,20+n,16,null,e||null);null===c.projection&&(c.projection=t),Ol(),64!=(64&c.flags)&&function(n,t,e){bA(t[11],0,t,e,Xf(n,e,t),Km(e.parent||t[6],e,t))}(o,r,c)}(0))},encapsulation:2,changeDetection:0}),n})(),R8=(()=>{class n{constructor(e,r,o,c){this.element=e,this.scriptLoaderService=r,this.dataTableService=o,this.dashboard=c,this.options={},this.dynamicResize=!1,this.ready=new rt,this.error=new rt,this.select=new rt,this.mouseover=new rt,this.mouseleave=new rt,this.wrapperReadySubject=new Yb(1),this.initialized=!1,this.eventListeners=new Map}get chart(){return this.chartWrapper.getChart()}get wrapperReady$(){return this.wrapperReadySubject.asObservable()}get chartWrapper(){if(!this.wrapper)throw new Error("Trying to access the chart wrapper before it was fully initialized");return this.wrapper}set chartWrapper(e){this.wrapper=e,this.drawChart()}ngOnInit(){this.scriptLoaderService.loadChartPackages(function(n){return M8[n]}(this.type)).subscribe(()=>{this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.wrapper=new google.visualization.ChartWrapper({container:this.element.nativeElement,chartType:this.type,dataTable:this.dataTable,options:this.mergeOptions()}),this.registerChartEvents(),this.wrapperReadySubject.next(this.wrapper),this.initialized=!0,this.drawChart()})}ngOnChanges(e){if(e.dynamicResize&&this.updateResizeListener(),this.initialized){let r=!1;(e.data||e.columns||e.formatters)&&(this.dataTable=this.dataTableService.create(this.data,this.columns,this.formatters),this.wrapper.setDataTable(this.dataTable),r=!0),e.type&&(this.wrapper.setChartType(this.type),r=!0),(e.options||e.width||e.height||e.title)&&(this.wrapper.setOptions(this.mergeOptions()),r=!0),r&&this.drawChart()}}ngOnDestroy(){this.unsubscribeToResizeIfSubscribed()}addEventListener(e,r){const o=this.registerChartEvent(this.chart,e,r);return this.eventListeners.set(o,{eventName:e,callback:r,handle:o}),o}removeEventListener(e){const r=this.eventListeners.get(e);r&&(google.visualization.events.removeListener(r.handle),this.eventListeners.delete(e))}updateResizeListener(){this.unsubscribeToResizeIfSubscribed(),this.dynamicResize&&(this.resizeSubscription=Ky(window,"resize",{passive:!0}).pipe(gT(100)).subscribe(()=>{this.initialized&&this.drawChart()}))}unsubscribeToResizeIfSubscribed(){null!=this.resizeSubscription&&(this.resizeSubscription.unsubscribe(),this.resizeSubscription=void 0)}mergeOptions(){return Object.assign({title:this.title,width:this.width,height:this.height},this.options)}registerChartEvents(){google.visualization.events.removeAllListeners(this.wrapper),this.registerChartEvent(this.wrapper,"ready",()=>{google.visualization.events.removeAllListeners(this.chart),this.registerChartEvent(this.chart,"onmouseover",e=>this.mouseover.emit(e)),this.registerChartEvent(this.chart,"onmouseout",e=>this.mouseleave.emit(e)),this.registerChartEvent(this.chart,"select",()=>{const e=this.chart.getSelection();this.select.emit({selection:e})}),this.eventListeners.forEach(e=>e.handle=this.registerChartEvent(this.chart,e.eventName,e.callback)),this.ready.emit({chart:this.chart})}),this.registerChartEvent(this.wrapper,"error",e=>this.error.emit(e))}registerChartEvent(e,r,o){return google.visualization.events.addListener(e,r,o)}drawChart(){null==this.dashboard&&this.wrapper.draw()}}return n.\u0275fac=function(e){return new(e||n)(lt(Xi),lt(Wp),lt(ET),lt(P8,8))},n.\u0275cmp=zo({type:n,selectors:[["google-chart"]],hostAttrs:[1,"google-chart"],inputs:{options:"options",dynamicResize:"dynamicResize",type:"type",data:"data",columns:"columns",title:"title",width:"width",height:"height",formatters:"formatters"},outputs:{ready:"ready",error:"error",select:"select",mouseover:"mouseover",mouseleave:"mouseleave"},exportAs:["googleChart"],features:[Sr],decls:0,vars:0,template:function(e,r){},styles:["[_nghost-%COMP%] { width: fit-content; display: block; }"],changeDetection:0}),n})(),F8=(()=>{class n{static forRoot(e={}){return{ngModule:n,providers:[{provide:CT,useValue:e}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Gi({type:n}),n.\u0275inj=gr({providers:[Wp]}),n})();var Qp=Ua(958);class DT extends vi{constructor(){super(...arguments),this.value=null,this.hasNext=!1,this.hasCompleted=!1}_subscribe(t){return this.hasError?(t.error(this.thrownError),Et.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),Et.EMPTY):super._subscribe(t)}next(t){this.hasCompleted||(this.value=t,this.hasNext=!0)}error(t){this.hasCompleted||super.error(t)}complete(){this.hasCompleted=!0,this.hasNext&&super.next(this.value),super.complete()}}class L8{constructor(t){this.value=t}call(t,e){return e.subscribe(new B8(t,this.value))}}class B8 extends qn{constructor(t,e){super(t),this.value=e}_next(t){this.destination.next(this.value)}}const N8=["container"],ST=new on("MapboxApiKey");let ev=(()=>{class n{constructor(e,r){this.zone=e,this.MAPBOX_API_KEY=r,this.mapCreated=new DT,this.mapLoaded=new DT,this.markersToRemove=[],this.popupsToRemove=[],this.imageIdsToRemove=[],this.subscription=new Et,this.mapCreated$=this.mapCreated.asObservable(),this.mapLoaded$=this.mapLoaded.asObservable()}setup(e){this.zone.onStable.pipe(GA()).subscribe(()=>{this.assign(Qp,"accessToken",e.accessToken||this.MAPBOX_API_KEY),e.customMapboxApiUrl&&this.assign(Qp,"config.API_URL",e.customMapboxApiUrl),this.createMap(e.mapOptions),this.hookEvents(e.mapEvents),this.mapEvents=e.mapEvents,this.mapCreated.next(void 0),this.mapCreated.complete()})}destroyMap(){this.mapInstance&&(this.subscription.unsubscribe(),this.mapInstance.remove())}updateMinZoom(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinZoom(e)})}updateMaxZoom(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxZoom(e)})}updateMinPitch(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinPitch(e)})}updateMaxPitch(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxPitch(e)})}updateRenderWorldCopies(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setRenderWorldCopies(e)})}updateScrollZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.scrollZoom.enable():this.mapInstance.scrollZoom.disable()})}updateDragRotate(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.dragRotate.enable():this.mapInstance.dragRotate.disable()})}updateTouchPitch(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.touchPitch.enable():this.mapInstance.touchPitch.disable()})}updateTouchZoomRotate(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.touchZoomRotate.enable():this.mapInstance.touchZoomRotate.disable()})}updateDoubleClickZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.doubleClickZoom.enable():this.mapInstance.doubleClickZoom.disable()})}updateKeyboard(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.keyboard.enable():this.mapInstance.keyboard.disable()})}updateDragPan(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.dragPan.enable():this.mapInstance.dragPan.disable()})}updateBoxZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.boxZoom.enable():this.mapInstance.boxZoom.disable()})}updateStyle(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setStyle(e)})}updateMaxBounds(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxBounds(e)})}changeCanvasCursor(e){this.mapInstance.getCanvasContainer().style.cursor=e}queryRenderedFeatures(e,r){return this.mapInstance.queryRenderedFeatures(e,r)}panTo(e,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.panTo(e,r)})}move(e,r,o,c,p,w){return this.zone.runOutsideAngular(()=>{this.mapInstance[e](Object.assign(Object.assign({},r),{zoom:null!=o?o:this.mapInstance.getZoom(),center:null!=c?c:this.mapInstance.getCenter(),bearing:null!=p?p:this.mapInstance.getBearing(),pitch:null!=w?w:this.mapInstance.getPitch()}))})}addLayer(e,r,o){this.zone.runOutsideAngular(()=>{Object.keys(e.layerOptions).forEach(c=>{void 0===e.layerOptions[c]&&delete e.layerOptions[c]}),this.mapInstance.addLayer(e.layerOptions,o),r&&((e.layerEvents.layerClick.observers.length||e.layerEvents.click.observers.length)&&this.mapInstance.on("click",e.layerOptions.id,c=>{this.zone.run(()=>{e.layerEvents.layerClick.emit(c),e.layerEvents.click.emit(c)})}),(e.layerEvents.layerDblClick.observers.length||e.layerEvents.dblClick.observers.length)&&this.mapInstance.on("dblclick",e.layerOptions.id,c=>{this.zone.run(()=>{e.layerEvents.layerDblClick.emit(c),e.layerEvents.dblClick.emit(c)})}),(e.layerEvents.layerMouseDown.observers.length||e.layerEvents.mouseDown.observers.length)&&this.mapInstance.on("mousedown",e.layerOptions.id,c=>{this.zone.run(()=>{e.layerEvents.layerMouseDown.emit(c),e.layerEvents.mouseDown.emit(c)})}),(e.layerEvents.layerMouseUp.observers.length||e.layerEvents.mouseUp.observers.length)&&this.mapInstance.on("mouseup",e.layerOptions.id,c=>{this.zone.run(()=>{e.layerEvents.layerMouseUp.emit(c),e.layerEvents.mouseUp.emit(c)})}),(e.layerEvents.layerMouseEnter.observers.length||e.layerEvents.mouseEnter.observers.length)&&this.mapInstance.on("mouseenter",e.layerOptions.id,c=>{this.zone.run(()=>{e.layerEvents.layerMouseEnter.emit(c),e.layerEvents.mouseEnter.emit(c)})}),(e.layerEvents.layerMouseLeave.observers.length||e.layerEvents.mouseLeave.observers.length)&&this.mapInstance.on("mouseleave",e.layerOptions.id,c=>{this.zone.run(()=>{e.layerEvents.layerMouseLeave.emit(c),e.layerEvents.mouseLeave.emit(c)})}),(e.layerEvents.layerMouseMove.observers.length||e.layerEvents.mouseMove.observers.length)&&this.mapInstance.on("mousemove",e.layerOptions.id,c=>{this.zone.run(()=>{e.layerEvents.layerMouseMove.emit(c),e.layerEvents.mouseMove.emit(c)})}),(e.layerEvents.layerMouseOver.observers.length||e.layerEvents.mouseOver.observers.length)&&this.mapInstance.on("mouseover",e.layerOptions.id,c=>{this.zone.run(()=>{e.layerEvents.layerMouseOver.emit(c),e.layerEvents.mouseOver.emit(c)})}),(e.layerEvents.layerMouseOut.observers.length||e.layerEvents.mouseOut.observers.length)&&this.mapInstance.on("mouseout",e.layerOptions.id,c=>{this.zone.run(()=>{e.layerEvents.layerMouseOut.emit(c),e.layerEvents.mouseOut.emit(c)})}),(e.layerEvents.layerContextMenu.observers.length||e.layerEvents.contextMenu.observers.length)&&this.mapInstance.on("contextmenu",e.layerOptions.id,c=>{this.zone.run(()=>{e.layerEvents.layerContextMenu.emit(c),e.layerEvents.contextMenu.emit(c)})}),(e.layerEvents.layerTouchStart.observers.length||e.layerEvents.touchStart.observers.length)&&this.mapInstance.on("touchstart",e.layerOptions.id,c=>{this.zone.run(()=>{e.layerEvents.layerTouchStart.emit(c),e.layerEvents.touchStart.emit(c)})}),(e.layerEvents.layerTouchEnd.observers.length||e.layerEvents.touchEnd.observers.length)&&this.mapInstance.on("touchend",e.layerOptions.id,c=>{this.zone.run(()=>{e.layerEvents.layerTouchEnd.emit(c),e.layerEvents.touchEnd.emit(c)})}),(e.layerEvents.layerTouchCancel.observers.length||e.layerEvents.touchCancel.observers.length)&&this.mapInstance.on("touchcancel",e.layerOptions.id,c=>{this.zone.run(()=>{e.layerEvents.layerTouchCancel.emit(c),e.layerEvents.touchCancel.emit(c)})}))})}removeLayer(e){this.zone.runOutsideAngular(()=>{null!=this.mapInstance.getLayer(e)&&this.mapInstance.removeLayer(e)})}addMarker(e){const r={offset:e.markersOptions.offset,anchor:e.markersOptions.anchor,draggable:!!e.markersOptions.draggable,rotationAlignment:e.markersOptions.rotationAlignment,pitchAlignment:e.markersOptions.pitchAlignment,clickTolerance:e.markersOptions.clickTolerance};e.markersOptions.element.childNodes.length>0&&(r.element=e.markersOptions.element);const o=new Qp.Marker(r);return(e.markersEvents.markerDragStart.observers.length||e.markersEvents.dragStart.observers.length)&&o.on("dragstart",p=>{if(p){const{target:w}=p;this.zone.run(()=>{e.markersEvents.markerDragStart.emit(w),e.markersEvents.dragStart.emit(w)})}}),(e.markersEvents.markerDrag.observers.length||e.markersEvents.drag.observers.length)&&o.on("drag",p=>{if(p){const{target:w}=p;this.zone.run(()=>{e.markersEvents.markerDrag.emit(w),e.markersEvents.drag.emit(w)})}}),(e.markersEvents.markerDragEnd.observers.length||e.markersEvents.dragEnd.observers.length)&&o.on("dragend",p=>{if(p){const{target:w}=p;this.zone.run(()=>{e.markersEvents.markerDragEnd.emit(w),e.markersEvents.dragEnd.emit(w)})}}),o.setLngLat(e.markersOptions.feature?e.markersOptions.feature.geometry.coordinates:e.markersOptions.lngLat),this.zone.runOutsideAngular(()=>(o.addTo(this.mapInstance),o))}removeMarker(e){this.markersToRemove.push(e)}createPopup(e,r){return this.zone.runOutsideAngular(()=>{Object.keys(e.popupOptions).forEach(c=>void 0===e.popupOptions[c]&&delete e.popupOptions[c]);const o=new Qp.Popup(e.popupOptions);return o.setDOMContent(r),(e.popupEvents.popupClose.observers.length||e.popupEvents.close.observers.length)&&o.on("close",()=>{this.zone.run(()=>{e.popupEvents.popupClose.emit(),e.popupEvents.close.emit()})}),(e.popupEvents.popupOpen.observers.length||e.popupEvents.open.observers.length)&&o.on("open",()=>{this.zone.run(()=>{e.popupEvents.popupOpen.emit(),e.popupEvents.open.emit()})}),o})}addPopupToMap(e,r,o=!1){return this.zone.runOutsideAngular(()=>{o&&e._listeners&&delete e._listeners.open,e.setLngLat(r),e.addTo(this.mapInstance)})}addPopupToMarker(e,r){return this.zone.runOutsideAngular(()=>{e.setPopup(r)})}removePopupFromMap(e,r=!1){r&&e._listeners&&delete e._listeners.close,this.popupsToRemove.push(e)}removePopupFromMarker(e){return this.zone.runOutsideAngular(()=>{e.setPopup(void 0)})}addControl(e,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.addControl(e,r)})}removeControl(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.removeControl(e)})}loadAndAddImage(e,r,o){return ld(this,void 0,void 0,function*(){return this.zone.runOutsideAngular(()=>new Promise((c,p)=>{this.mapInstance.loadImage(r,(w,T)=>{w?p(w):(this.addImage(e,T,o),c())})}))})}addImage(e,r,o){return this.zone.runOutsideAngular(()=>{this.mapInstance.addImage(e,r,o)})}removeImage(e){this.imageIdsToRemove.push(e)}addSource(e,r){return this.zone.runOutsideAngular(()=>{Object.keys(r).forEach(o=>void 0===r[o]&&delete r[o]),this.mapInstance.addSource(e,r)})}getSource(e){return this.mapInstance.getSource(e)}removeSource(e){this.zone.runOutsideAngular(()=>{this.findLayersBySourceId(e).forEach(r=>this.mapInstance.removeLayer(r.id)),this.mapInstance.removeSource(e)})}setAllLayerPaintProperty(e,r){return this.zone.runOutsideAngular(()=>{Object.keys(r).forEach(o=>{this.mapInstance.setPaintProperty(e,o,r[o])})})}setAllLayerLayoutProperty(e,r){return this.zone.runOutsideAngular(()=>{Object.keys(r).forEach(o=>{this.mapInstance.setLayoutProperty(e,o,r[o])})})}setLayerFilter(e,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.setFilter(e,r)})}setLayerBefore(e,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.moveLayer(e,r)})}setLayerZoomRange(e,r,o){return this.zone.runOutsideAngular(()=>{this.mapInstance.setLayerZoomRange(e,r||0,o||20)})}fitBounds(e,r){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitBounds(e,r)})}fitScreenCoordinates(e,r,o){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitScreenCoordinates(e[0],e[1],r,o)})}applyChanges(){this.zone.runOutsideAngular(()=>{this.removeMarkers(),this.removePopups(),this.removeImages()})}createMap(e){_i.assertNotInAngularZone(),Object.keys(e).forEach(o=>{void 0===e[o]&&delete e[o]}),this.mapInstance=new Qp.Map(e),window&&/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)&&this.mapInstance.setStyle(e.style),this.subscription.add(this.zone.onMicrotaskEmpty.subscribe(()=>this.applyChanges()))}removeMarkers(){for(const e of this.markersToRemove)e.remove();this.markersToRemove=[]}removePopups(){for(const e of this.popupsToRemove)e.remove();this.popupsToRemove=[]}removeImages(){for(const e of this.imageIdsToRemove)this.mapInstance.removeImage(e);this.imageIdsToRemove=[]}findLayersBySourceId(e){const r=this.mapInstance.getStyle().layers;return null==r?[]:r.filter(o=>"source"in o&&o.source===e)}hookEvents(e){this.mapInstance.on("load",r=>{this.mapLoaded.next(void 0),this.mapLoaded.complete(),this.zone.run(()=>{e.mapLoad.emit(r.target),e.load.emit(r.target)})}),(e.mapResize.observers.length||e.resize.observers.length)&&this.mapInstance.on("resize",r=>this.zone.run(()=>{e.mapResize.emit(r),e.resize.emit(r)})),(e.mapRemove.observers.length||e.remove.observers.length)&&this.mapInstance.on("remove",r=>this.zone.run(()=>{e.mapRemove.emit(r),e.remove.emit(r)})),(e.mapMouseDown.observers.length||e.mouseDown.observers.length)&&this.mapInstance.on("mousedown",r=>this.zone.run(()=>{e.mapMouseDown.emit(r),e.mouseDown.emit(r)})),(e.mapMouseUp.observers.length||e.mouseUp.observers.length)&&this.mapInstance.on("mouseup",r=>this.zone.run(()=>{e.mapMouseUp.emit(r),e.mouseUp.emit(r)})),(e.mapMouseMove.observers.length||e.mouseMove.observers.length)&&this.mapInstance.on("mousemove",r=>this.zone.run(()=>{e.mapMouseMove.emit(r),e.mouseMove.emit(r)})),(e.mapClick.observers.length||e.click.observers.length)&&this.mapInstance.on("click",r=>this.zone.run(()=>{e.mapClick.emit(r),e.click.emit(r)})),(e.mapDblClick.observers.length||e.dblClick.observers.length)&&this.mapInstance.on("dblclick",r=>this.zone.run(()=>{e.mapDblClick.emit(r),e.dblClick.emit(r)})),(e.mapMouseOver.observers.length||e.mouseOver.observers.length)&&this.mapInstance.on("mouseover",r=>this.zone.run(()=>{e.mapMouseOver.emit(r),e.mouseOver.emit(r)})),(e.mapMouseOut.observers.length||e.mouseOut.observers.length)&&this.mapInstance.on("mouseout",r=>this.zone.run(()=>{e.mapMouseOut.emit(r),e.mouseOut.emit(r)})),(e.mapContextMenu.observers.length||e.contextMenu.observers.length)&&this.mapInstance.on("contextmenu",r=>this.zone.run(()=>{e.mapContextMenu.emit(r),e.contextMenu.emit(r)})),(e.mapTouchStart.observers.length||e.touchStart.observers.length)&&this.mapInstance.on("touchstart",r=>this.zone.run(()=>{e.mapTouchStart.emit(r),e.touchStart.emit(r)})),(e.mapTouchEnd.observers.length||e.touchEnd.observers.length)&&this.mapInstance.on("touchend",r=>this.zone.run(()=>{e.mapTouchEnd.emit(r),e.touchEnd.emit(r)})),(e.mapTouchMove.observers.length||e.touchMove.observers.length)&&this.mapInstance.on("touchmove",r=>this.zone.run(()=>{e.mapTouchMove.emit(r),e.touchMove.emit(r)})),(e.mapTouchCancel.observers.length||e.touchCancel.observers.length)&&this.mapInstance.on("touchcancel",r=>this.zone.run(()=>{e.mapTouchCancel.emit(r),e.touchCancel.emit(r)})),(e.mapWheel.observers.length||e.wheel.observers.length)&&this.mapInstance.on("wheel",r=>this.zone.run(()=>{e.mapWheel.emit(r),e.wheel.emit(r)})),e.moveStart.observers.length&&this.mapInstance.on("movestart",r=>this.zone.run(()=>e.moveStart.emit(r))),e.move.observers.length&&this.mapInstance.on("move",r=>this.zone.run(()=>e.move.emit(r))),e.moveEnd.observers.length&&this.mapInstance.on("moveend",r=>this.zone.run(()=>e.moveEnd.emit(r))),(e.mapDragStart.observers.length||e.dragStart.observers.length)&&this.mapInstance.on("dragstart",r=>this.zone.run(()=>{e.mapDragStart.emit(r),e.dragStart.emit(r)})),(e.mapDrag.observers.length||e.drag.observers.length)&&this.mapInstance.on("drag",r=>this.zone.run(()=>{e.mapDrag.emit(r),e.drag.emit(r)})),(e.mapDragEnd.observers.length||e.dragEnd.observers.length)&&this.mapInstance.on("dragend",r=>this.zone.run(()=>{e.mapDragEnd.emit(r),e.dragEnd.emit(r)})),e.zoomStart.observers.length&&this.mapInstance.on("zoomstart",r=>this.zone.run(()=>e.zoomStart.emit(r))),e.zoomEvt.observers.length&&this.mapInstance.on("zoom",r=>this.zone.run(()=>e.zoomEvt.emit(r))),e.zoomEnd.observers.length&&this.mapInstance.on("zoomend",r=>this.zone.run(()=>e.zoomEnd.emit(r))),e.rotateStart.observers.length&&this.mapInstance.on("rotatestart",r=>this.zone.run(()=>e.rotateStart.emit(r))),e.rotate.observers.length&&this.mapInstance.on("rotate",r=>this.zone.run(()=>e.rotate.emit(r))),e.rotateEnd.observers.length&&this.mapInstance.on("rotateend",r=>this.zone.run(()=>e.rotateEnd.emit(r))),e.pitchStart.observers.length&&this.mapInstance.on("pitchstart",r=>this.zone.run(()=>e.pitchStart.emit(r))),e.pitchEvt.observers.length&&this.mapInstance.on("pitch",r=>this.zone.run(()=>e.pitchEvt.emit(r))),e.pitchEnd.observers.length&&this.mapInstance.on("pitchend",r=>this.zone.run(()=>e.pitchEnd.emit(r))),e.boxZoomStart.observers.length&&this.mapInstance.on("boxzoomstart",r=>this.zone.run(()=>e.boxZoomStart.emit(r))),e.boxZoomEnd.observers.length&&this.mapInstance.on("boxzoomend",r=>this.zone.run(()=>e.boxZoomEnd.emit(r))),e.boxZoomCancel.observers.length&&this.mapInstance.on("boxzoomcancel",r=>this.zone.run(()=>e.boxZoomCancel.emit(r))),e.webGlContextLost.observers.length&&this.mapInstance.on("webglcontextlost",r=>this.zone.run(()=>e.webGlContextLost.emit(r))),e.webGlContextRestored.observers.length&&this.mapInstance.on("webglcontextrestored",r=>this.zone.run(()=>e.webGlContextRestored.emit(r))),e.render.observers.length&&this.mapInstance.on("render",r=>this.zone.run(()=>e.render.emit(r))),(e.mapError.observers.length||e.error.observers.length)&&this.mapInstance.on("error",r=>this.zone.run(()=>{e.mapError.emit(r),e.error.emit(r)})),e.data.observers.length&&this.mapInstance.on("data",r=>this.zone.run(()=>e.data.emit(r))),e.styleData.observers.length&&this.mapInstance.on("styledata",r=>this.zone.run(()=>e.styleData.emit(r))),e.sourceData.observers.length&&this.mapInstance.on("sourcedata",r=>this.zone.run(()=>e.sourceData.emit(r))),e.dataLoading.observers.length&&this.mapInstance.on("dataloading",r=>this.zone.run(()=>e.dataLoading.emit(r))),e.styleDataLoading.observers.length&&this.mapInstance.on("styledataloading",r=>this.zone.run(()=>e.styleDataLoading.emit(r))),e.sourceDataLoading.observers.length&&this.mapInstance.on("sourcedataloading",r=>this.zone.run(()=>e.sourceDataLoading.emit(r))),e.styleImageMissing.observers.length&&this.mapInstance.on("styleimagemissing",r=>this.zone.run(()=>e.styleImageMissing.emit(r))),e.idle.observers.length&&this.mapInstance.on("idle",r=>this.zone.run(()=>e.idle.emit(r)))}assign(e,r,o){if("string"==typeof r&&(r=r.split(".")),r.length>1){const c=r.shift();this.assign(e[c]="[object Object]"===Object.prototype.toString.call(e[c])?e[c]:{},r,o)}else e[r[0]]=o}}return n.\u0275fac=function(e){return new(e||n)(vt(_i),vt(ST,8))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();function TT(n,t,e){console.warn(`[ngx-mapbox-gl]: ${n}: ${t} is deprecated, please use ${e} instead.`)}let G8=(()=>{class n{constructor(e,r){this.MapService=e,this.zone=r,this.updateFeatureData=new vi,this.sub=new Et,this.sourceAdded=!1,this.featureIdCounter=0}ngOnInit(){this.data||(this.data={type:"FeatureCollection",features:[]});const e=this.MapService.mapLoaded$.subscribe(()=>{this.init();const r=Ky(this.MapService.mapInstance,"styledata").pipe(ru(()=>!this.MapService.mapInstance.getSource(this.id))).subscribe(()=>{this.init()});this.sub.add(r)});this.sub.add(e)}ngOnChanges(e){if(this.sourceAdded&&((e.maxzoom&&!e.maxzoom.isFirstChange()||e.attribution&&!e.attribution.isFirstChange()||e.buffer&&!e.buffer.isFirstChange()||e.tolerance&&!e.tolerance.isFirstChange()||e.cluster&&!e.cluster.isFirstChange()||e.clusterRadius&&!e.clusterRadius.isFirstChange()||e.clusterMaxZoom&&!e.clusterMaxZoom.isFirstChange()||e.clusterMinPoints&&!e.clusterMinPoints.isFirstChange()||e.clusterProperties&&!e.clusterProperties.isFirstChange()||e.lineMetrics&&!e.lineMetrics.isFirstChange()||e.generateId&&!e.generateId.isFirstChange()||e.promoteId&&!e.promoteId.isFirstChange()||e.filter&&!e.filter.isFirstChange())&&(this.ngOnDestroy(),this.ngOnInit()),e.data&&!e.data.isFirstChange())){const r=this.MapService.getSource(this.id);if(void 0===r)return;r.setData(this.data)}}ngOnDestroy(){this.sub.unsubscribe(),this.sourceAdded&&(this.MapService.removeSource(this.id),this.sourceAdded=!1)}getClusterExpansionZoom(e){return ld(this,void 0,void 0,function*(){const r=this.MapService.getSource(this.id);return this.zone.run(()=>ld(this,void 0,void 0,function*(){return new Promise((o,c)=>{r.getClusterExpansionZoom(e,(p,w)=>{p?c(p):o(w)})})}))})}getClusterChildren(e){return ld(this,void 0,void 0,function*(){const r=this.MapService.getSource(this.id);return this.zone.run(()=>ld(this,void 0,void 0,function*(){return new Promise((o,c)=>{r.getClusterChildren(e,(p,w)=>{p?c(p):o(w)})})}))})}getClusterLeaves(e,r,o){return ld(this,void 0,void 0,function*(){const c=this.MapService.getSource(this.id);return this.zone.run(()=>ld(this,void 0,void 0,function*(){return new Promise((p,w)=>{c.getClusterLeaves(e,r,o,(T,O)=>{T?w(T):p(O)})})}))})}_addFeature(e){this.data.features.push(e),this.updateFeatureData.next()}_removeFeature(e){const r=this.data,o=r.features.indexOf(e);o>-1&&r.features.splice(o,1),this.updateFeatureData.next()}_getNewFeatureId(){return++this.featureIdCounter}init(){this.MapService.addSource(this.id,{type:"geojson",data:this.data,maxzoom:this.maxzoom,attribution:this.attribution,buffer:this.buffer,tolerance:this.tolerance,cluster:this.cluster,clusterRadius:this.clusterRadius,clusterMaxZoom:this.clusterMaxZoom,clusterMinPoints:this.clusterMinPoints,clusterProperties:this.clusterProperties,lineMetrics:this.lineMetrics,generateId:this.generateId,promoteId:this.promoteId,filter:this.filter});const r=this.updateFeatureData.pipe(gT(0)).subscribe(()=>{const o=this.MapService.getSource(this.id);void 0!==o&&o.setData(this.data)});this.sub.add(r),this.sourceAdded=!0}}return n.\u0275fac=function(e){return new(e||n)(lt(ev),lt(_i))},n.\u0275cmp=zo({type:n,selectors:[["mgl-geojson-source"]],inputs:{id:"id",data:"data",maxzoom:"maxzoom",attribution:"attribution",buffer:"buffer",tolerance:"tolerance",cluster:"cluster",clusterRadius:"clusterRadius",clusterMaxZoom:"clusterMaxZoom",clusterMinPoints:"clusterMinPoints",clusterProperties:"clusterProperties",lineMetrics:"lineMetrics",generateId:"generateId",promoteId:"promoteId",filter:"filter"},features:[Sr],decls:0,vars:0,template:function(e,r){},encapsulation:2,changeDetection:0}),n})(),$8=(()=>{class n{constructor(e){this.MapService=e,this.layerClick=new rt,this.layerDblClick=new rt,this.layerMouseDown=new rt,this.layerMouseUp=new rt,this.layerMouseEnter=new rt,this.layerMouseLeave=new rt,this.layerMouseMove=new rt,this.layerMouseOver=new rt,this.layerMouseOut=new rt,this.layerContextMenu=new rt,this.layerTouchStart=new rt,this.layerTouchEnd=new rt,this.layerTouchCancel=new rt,this.click=new rt,this.dblClick=new rt,this.mouseDown=new rt,this.mouseUp=new rt,this.mouseEnter=new rt,this.mouseLeave=new rt,this.mouseMove=new rt,this.mouseOver=new rt,this.mouseOut=new rt,this.contextMenu=new rt,this.touchStart=new rt,this.touchEnd=new rt,this.touchCancel=new rt,this.layerAdded=!1}ngOnInit(){this.warnDeprecatedOutputs(),this.sub=this.MapService.mapLoaded$.pipe(nu(()=>Ky(this.MapService.mapInstance,"styledata").pipe(t=>t.lift(new L8(!1)),ru(()=>!this.MapService.mapInstance.getLayer(this.id)),lS(!0)))).subscribe(e=>this.init(e))}ngOnChanges(e){!this.layerAdded||(e.paint&&!e.paint.isFirstChange()&&this.MapService.setAllLayerPaintProperty(this.id,e.paint.currentValue),e.layout&&!e.layout.isFirstChange()&&this.MapService.setAllLayerLayoutProperty(this.id,e.layout.currentValue),e.filter&&!e.filter.isFirstChange()&&this.MapService.setLayerFilter(this.id,e.filter.currentValue),e.before&&!e.before.isFirstChange()&&this.MapService.setLayerBefore(this.id,e.before.currentValue),(e.minzoom&&!e.minzoom.isFirstChange()||e.maxzoom&&!e.maxzoom.isFirstChange())&&this.MapService.setLayerZoomRange(this.id,this.minzoom,this.maxzoom))}ngOnDestroy(){this.layerAdded&&this.MapService.removeLayer(this.id),this.sub&&this.sub.unsubscribe()}init(e){this.MapService.addLayer({layerOptions:{id:this.id,type:this.type,source:this.source,metadata:this.metadata,"source-layer":this.sourceLayer,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this.layout,paint:this.paint},layerEvents:{layerClick:this.layerClick,layerDblClick:this.layerDblClick,layerMouseDown:this.layerMouseDown,layerMouseUp:this.layerMouseUp,layerMouseEnter:this.layerMouseEnter,layerMouseLeave:this.layerMouseLeave,layerMouseMove:this.layerMouseMove,layerMouseOver:this.layerMouseOver,layerMouseOut:this.layerMouseOut,layerContextMenu:this.layerContextMenu,layerTouchStart:this.layerTouchStart,layerTouchEnd:this.layerTouchEnd,layerTouchCancel:this.layerTouchCancel,click:this.click,dblClick:this.dblClick,mouseDown:this.mouseDown,mouseUp:this.mouseUp,mouseEnter:this.mouseEnter,mouseLeave:this.mouseLeave,mouseMove:this.mouseMove,mouseOver:this.mouseOver,mouseOut:this.mouseOut,contextMenu:this.contextMenu,touchStart:this.touchStart,touchEnd:this.touchEnd,touchCancel:this.touchCancel}},e,this.before),this.layerAdded=!0}warnDeprecatedOutputs(){const e=TT.bind(void 0,n.name);this.click.observers.length&&e("click","layerClick"),this.dblClick.observers.length&&e("dblClick","layerDblClick"),this.mouseDown.observers.length&&e("mouseDown","layerMouseDown"),this.mouseUp.observers.length&&e("mouseUp","layerMouseUp"),this.mouseEnter.observers.length&&e("mouseEnter","layerMouseEnter"),this.mouseLeave.observers.length&&e("mouseLeave","layerMouseLeave"),this.mouseMove.observers.length&&e("mouseMove","layerMouseMove"),this.mouseOver.observers.length&&e("mouseOver","layerMouseOver"),this.mouseOut.observers.length&&e("mouseOut","layerMouseOut"),this.contextMenu.observers.length&&e("contextMenu","layerContextMenu"),this.touchStart.observers.length&&e("touchStart","layerTouchStart"),this.touchEnd.observers.length&&e("touchEnd","layerTouchEnd"),this.touchCancel.observers.length&&e("touchCancel","layerTouchCancel")}}return n.\u0275fac=function(e){return new(e||n)(lt(ev))},n.\u0275cmp=zo({type:n,selectors:[["mgl-layer"]],inputs:{id:"id",source:"source",type:"type",metadata:"metadata",sourceLayer:"sourceLayer",filter:"filter",layout:"layout",paint:"paint",before:"before",minzoom:"minzoom",maxzoom:"maxzoom"},outputs:{layerClick:"layerClick",layerDblClick:"layerDblClick",layerMouseDown:"layerMouseDown",layerMouseUp:"layerMouseUp",layerMouseEnter:"layerMouseEnter",layerMouseLeave:"layerMouseLeave",layerMouseMove:"layerMouseMove",layerMouseOver:"layerMouseOver",layerMouseOut:"layerMouseOut",layerContextMenu:"layerContextMenu",layerTouchStart:"layerTouchStart",layerTouchEnd:"layerTouchEnd",layerTouchCancel:"layerTouchCancel",click:"click",dblClick:"dblClick",mouseDown:"mouseDown",mouseUp:"mouseUp",mouseEnter:"mouseEnter",mouseLeave:"mouseLeave",mouseMove:"mouseMove",mouseOver:"mouseOver",mouseOut:"mouseOut",contextMenu:"contextMenu",touchStart:"touchStart",touchEnd:"touchEnd",touchCancel:"touchCancel"},features:[Sr],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),IT=(()=>{class n{constructor(e){this.MapService=e,this.movingMethod="flyTo",this.mapResize=new rt,this.mapRemove=new rt,this.mapMouseDown=new rt,this.mapMouseUp=new rt,this.mapMouseMove=new rt,this.mapClick=new rt,this.mapDblClick=new rt,this.mapMouseOver=new rt,this.mapMouseOut=new rt,this.mapContextMenu=new rt,this.mapTouchStart=new rt,this.mapTouchEnd=new rt,this.mapTouchMove=new rt,this.mapTouchCancel=new rt,this.mapWheel=new rt,this.moveStart=new rt,this.move=new rt,this.moveEnd=new rt,this.mapDragStart=new rt,this.mapDrag=new rt,this.mapDragEnd=new rt,this.zoomStart=new rt,this.zoomEvt=new rt,this.zoomEnd=new rt,this.rotateStart=new rt,this.rotate=new rt,this.rotateEnd=new rt,this.pitchStart=new rt,this.pitchEvt=new rt,this.pitchEnd=new rt,this.boxZoomStart=new rt,this.boxZoomEnd=new rt,this.boxZoomCancel=new rt,this.webGlContextLost=new rt,this.webGlContextRestored=new rt,this.mapLoad=new rt,this.idle=new rt,this.render=new rt,this.mapError=new rt,this.data=new rt,this.styleData=new rt,this.sourceData=new rt,this.dataLoading=new rt,this.styleDataLoading=new rt,this.sourceDataLoading=new rt,this.styleImageMissing=new rt,this.resize=new rt,this.remove=new rt,this.mouseDown=new rt,this.mouseUp=new rt,this.mouseMove=new rt,this.click=new rt,this.dblClick=new rt,this.mouseOver=new rt,this.mouseOut=new rt,this.contextMenu=new rt,this.touchStart=new rt,this.touchEnd=new rt,this.touchMove=new rt,this.touchCancel=new rt,this.wheel=new rt,this.dragStart=new rt,this.drag=new rt,this.dragEnd=new rt,this.load=new rt,this.error=new rt}get mapInstance(){return this.MapService.mapInstance}ngAfterViewInit(){this.warnDeprecatedOutputs(),this.MapService.setup({accessToken:this.accessToken,customMapboxApiUrl:this.customMapboxApiUrl,mapOptions:{collectResourceTiming:this.collectResourceTiming,container:this.mapContainer.nativeElement,crossSourceCollisions:this.crossSourceCollisions,fadeDuration:this.fadeDuration,minZoom:this.minZoom,maxZoom:this.maxZoom,minPitch:this.minPitch,maxPitch:this.maxPitch,style:this.style,hash:this.hash,interactive:this.interactive,bearingSnap:this.bearingSnap,pitchWithRotate:this.pitchWithRotate,clickTolerance:this.clickTolerance,attributionControl:this.attributionControl,logoPosition:this.logoPosition,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,refreshExpiredTiles:this.refreshExpiredTiles,maxBounds:this.maxBounds,scrollZoom:this.scrollZoom,boxZoom:this.boxZoom,dragRotate:this.dragRotate,dragPan:this.dragPan,keyboard:this.keyboard,doubleClickZoom:this.doubleClickZoom,touchPitch:this.touchPitch,touchZoomRotate:this.touchZoomRotate,trackResize:this.trackResize,center:this.center,zoom:this.zoom,bearing:this.bearing,pitch:this.pitch,renderWorldCopies:this.renderWorldCopies,maxTileCacheSize:this.maxTileCacheSize,localIdeographFontFamily:this.localIdeographFontFamily,transformRequest:this.transformRequest,bounds:this.bounds?this.bounds:this.fitBounds,fitBoundsOptions:this.fitBoundsOptions,antialias:this.antialias,locale:this.locale},mapEvents:this}),this.cursorStyle&&this.MapService.changeCanvasCursor(this.cursorStyle)}ngOnDestroy(){this.MapService.destroyMap()}ngOnChanges(e){return ld(this,void 0,void 0,function*(){yield this.MapService.mapCreated$.toPromise(),e.cursorStyle&&!e.cursorStyle.isFirstChange()&&this.MapService.changeCanvasCursor(e.cursorStyle.currentValue),e.minZoom&&!e.minZoom.isFirstChange()&&this.MapService.updateMinZoom(e.minZoom.currentValue),e.maxZoom&&!e.maxZoom.isFirstChange()&&this.MapService.updateMaxZoom(e.maxZoom.currentValue),e.minPitch&&!e.minPitch.isFirstChange()&&this.MapService.updateMinPitch(e.minPitch.currentValue),e.maxPitch&&!e.maxPitch.isFirstChange()&&this.MapService.updateMaxPitch(e.maxPitch.currentValue),e.renderWorldCopies&&!e.renderWorldCopies.isFirstChange()&&this.MapService.updateRenderWorldCopies(e.renderWorldCopies.currentValue),e.scrollZoom&&!e.scrollZoom.isFirstChange()&&this.MapService.updateScrollZoom(e.scrollZoom.currentValue),e.dragRotate&&!e.dragRotate.isFirstChange()&&this.MapService.updateDragRotate(e.dragRotate.currentValue),e.touchPitch&&!e.touchPitch.isFirstChange()&&this.MapService.updateTouchPitch(e.touchPitch.currentValue),e.touchZoomRotate&&!e.touchZoomRotate.isFirstChange()&&this.MapService.updateTouchZoomRotate(e.touchZoomRotate.currentValue),e.doubleClickZoom&&!e.doubleClickZoom.isFirstChange()&&this.MapService.updateDoubleClickZoom(e.doubleClickZoom.currentValue),e.keyboard&&!e.keyboard.isFirstChange()&&this.MapService.updateKeyboard(e.keyboard.currentValue),e.dragPan&&!e.dragPan.isFirstChange()&&this.MapService.updateDragPan(e.dragPan.currentValue),e.boxZoom&&!e.boxZoom.isFirstChange()&&this.MapService.updateBoxZoom(e.boxZoom.currentValue),e.style&&!e.style.isFirstChange()&&this.MapService.updateStyle(e.style.currentValue),e.maxBounds&&!e.maxBounds.isFirstChange()&&this.MapService.updateMaxBounds(e.maxBounds.currentValue),e.fitBounds&&e.fitBounds.currentValue&&!e.fitBounds.isFirstChange()&&this.MapService.fitBounds(e.fitBounds.currentValue,this.fitBoundsOptions),e.fitScreenCoordinates&&e.fitScreenCoordinates.currentValue&&((this.center||this.zoom||this.pitch||this.fitBounds)&&e.fitScreenCoordinates.isFirstChange()&&console.warn("[ngx-mapbox-gl] center / zoom / pitch / fitBounds inputs are being overridden by fitScreenCoordinates input"),this.MapService.fitScreenCoordinates(e.fitScreenCoordinates.currentValue,this.bearing?this.bearing[0]:0,this.movingOptions)),!this.centerWithPanTo||!e.center||e.center.isFirstChange()||e.zoom||e.bearing||e.pitch?(e.center&&!e.center.isFirstChange()||e.zoom&&!e.zoom.isFirstChange()||e.bearing&&!e.bearing.isFirstChange()&&!e.fitScreenCoordinates||e.pitch&&!e.pitch.isFirstChange())&&this.MapService.move(this.movingMethod,this.movingOptions,e.zoom&&this.zoom?this.zoom[0]:void 0,e.center?this.center:void 0,e.bearing&&this.bearing?this.bearing[0]:void 0,e.pitch&&this.pitch?this.pitch[0]:void 0):this.MapService.panTo(this.center,this.panToOptions)})}warnDeprecatedOutputs(){const e=TT.bind(void 0,n.name);this.resize.observers.length&&e("resize","mapResize"),this.remove.observers.length&&e("remove","mapRemove"),this.mouseDown.observers.length&&e("mouseDown","mapMouseDown"),this.mouseUp.observers.length&&e("mouseUp","mapMouseUp"),this.mouseMove.observers.length&&e("mouseMove","mapMouseMove"),this.click.observers.length&&e("click","mapClick"),this.dblClick.observers.length&&e("dblClick","mapDblClick"),this.mouseOver.observers.length&&e("mouseOver","mapMouseOver"),this.mouseOut.observers.length&&e("mouseOut","mapMouseOut"),this.contextMenu.observers.length&&e("contextMenu","mapContextMenu"),this.touchStart.observers.length&&e("touchStart","mapTouchStart"),this.touchEnd.observers.length&&e("touchEnd","mapTouchEnd"),this.touchMove.observers.length&&e("touchMove","mapTouchMove"),this.touchCancel.observers.length&&e("touchCancel","mapTouchCancel"),this.wheel.observers.length&&e("wheel","mapWheel"),this.dragStart.observers.length&&e("dragStart","mapDragStart"),this.drag.observers.length&&e("drag","mapDrag"),this.dragEnd.observers.length&&e("dragEnd","mapDragEnd"),this.load.observers.length&&e("load","mapLoad"),this.error.observers.length&&e("error","mapError")}}return n.\u0275fac=function(e){return new(e||n)(lt(ev))},n.\u0275cmp=zo({type:n,selectors:[["mgl-map"]],viewQuery:function(e,r){if(1&e&&Mx(N8,7),2&e){let o;Fp(o=Op())&&(r.mapContainer=o.first)}},inputs:{accessToken:"accessToken",collectResourceTiming:"collectResourceTiming",crossSourceCollisions:"crossSourceCollisions",customMapboxApiUrl:"customMapboxApiUrl",fadeDuration:"fadeDuration",hash:"hash",refreshExpiredTiles:"refreshExpiredTiles",failIfMajorPerformanceCaveat:"failIfMajorPerformanceCaveat",bearingSnap:"bearingSnap",interactive:"interactive",pitchWithRotate:"pitchWithRotate",clickTolerance:"clickTolerance",attributionControl:"attributionControl",logoPosition:"logoPosition",maxTileCacheSize:"maxTileCacheSize",localIdeographFontFamily:"localIdeographFontFamily",preserveDrawingBuffer:"preserveDrawingBuffer",trackResize:"trackResize",transformRequest:"transformRequest",bounds:"bounds",antialias:"antialias",locale:"locale",minZoom:"minZoom",maxZoom:"maxZoom",minPitch:"minPitch",maxPitch:"maxPitch",scrollZoom:"scrollZoom",dragRotate:"dragRotate",touchPitch:"touchPitch",touchZoomRotate:"touchZoomRotate",doubleClickZoom:"doubleClickZoom",keyboard:"keyboard",dragPan:"dragPan",boxZoom:"boxZoom",style:"style",center:"center",maxBounds:"maxBounds",zoom:"zoom",bearing:"bearing",pitch:"pitch",fitBoundsOptions:"fitBoundsOptions",renderWorldCopies:"renderWorldCopies",movingMethod:"movingMethod",movingOptions:"movingOptions",fitBounds:"fitBounds",fitScreenCoordinates:"fitScreenCoordinates",centerWithPanTo:"centerWithPanTo",panToOptions:"panToOptions",cursorStyle:"cursorStyle"},outputs:{mapResize:"mapResize",mapRemove:"mapRemove",mapMouseDown:"mapMouseDown",mapMouseUp:"mapMouseUp",mapMouseMove:"mapMouseMove",mapClick:"mapClick",mapDblClick:"mapDblClick",mapMouseOver:"mapMouseOver",mapMouseOut:"mapMouseOut",mapContextMenu:"mapContextMenu",mapTouchStart:"mapTouchStart",mapTouchEnd:"mapTouchEnd",mapTouchMove:"mapTouchMove",mapTouchCancel:"mapTouchCancel",mapWheel:"mapWheel",moveStart:"moveStart",move:"move",moveEnd:"moveEnd",mapDragStart:"mapDragStart",mapDrag:"mapDrag",mapDragEnd:"mapDragEnd",zoomStart:"zoomStart",zoomEvt:"zoomEvt",zoomEnd:"zoomEnd",rotateStart:"rotateStart",rotate:"rotate",rotateEnd:"rotateEnd",pitchStart:"pitchStart",pitchEvt:"pitchEvt",pitchEnd:"pitchEnd",boxZoomStart:"boxZoomStart",boxZoomEnd:"boxZoomEnd",boxZoomCancel:"boxZoomCancel",webGlContextLost:"webGlContextLost",webGlContextRestored:"webGlContextRestored",mapLoad:"mapLoad",idle:"idle",render:"render",mapError:"mapError",data:"data",styleData:"styleData",sourceData:"sourceData",dataLoading:"dataLoading",styleDataLoading:"styleDataLoading",sourceDataLoading:"sourceDataLoading",styleImageMissing:"styleImageMissing",resize:"resize",remove:"remove",mouseDown:"mouseDown",mouseUp:"mouseUp",mouseMove:"mouseMove",click:"click",dblClick:"dblClick",mouseOver:"mouseOver",mouseOut:"mouseOut",contextMenu:"contextMenu",touchStart:"touchStart",touchEnd:"touchEnd",touchMove:"touchMove",touchCancel:"touchCancel",wheel:"wheel",dragStart:"dragStart",drag:"drag",dragEnd:"dragEnd",load:"load",error:"error"},features:[hi([ev]),Sr],decls:2,vars:0,consts:[["container",""]],template:function(e,r){1&e&&Bs(0,"div",null,0)},styles:["[_nghost-%COMP%] {\n        display: block;\n      }\n      div[_ngcontent-%COMP%] {\n        height: 100%;\n        width: 100%;\n      }"],changeDetection:0}),n})();const H8=new on("MapboxApiKey");let q8=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:ST,useValue:e.accessToken},{provide:H8,useValue:e.geocoderAccessToken||e.accessToken}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Gi({type:n}),n.\u0275inj=gr({imports:[[UM]]}),n})();function kT(...n){if(1===n.length){const t=n[0];if(qo(t))return tv(t,null);if(mo(t)&&Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);return tv(e.map(r=>t[r]),e)}}if("function"==typeof n[n.length-1]){const t=n.pop();return tv(n=1===n.length&&qo(n[0])?n[0]:n,null).pipe(pn(e=>t(...e)))}return tv(n,null)}function tv(n,t){return new Hn(e=>{const r=n.length;if(0===r)return void e.complete();const o=new Array(r);let c=0,p=0;for(let w=0;w<r;w++){const T=Nr(n[w]);let O=!1;e.add(T.subscribe({next:V=>{O||(O=!0,p++),o[w]=V},error:V=>e.error(V),complete:()=>{c++,(c===r||!O)&&(p===r&&e.next(t?t.reduce((V,W,K)=>(V[W]=o[K],V),{}):o),e.complete())}}))}})}class PT{}class RT{}class mh{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const o=e.slice(0,r),c=o.toLowerCase(),p=e.slice(r+1).trim();this.maybeSetNormalizedName(o,c),this.headers.has(c)?this.headers.get(c).push(p):this.headers.set(c,[p])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let r=t[e];const o=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(o,r),this.maybeSetNormalizedName(e,o))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof mh?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new mh;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof mh?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,e);const o=("a"===t.op?this.headers.get(e):void 0)||[];o.push(...r),this.headers.set(e,o);break;case"d":const c=t.value;if(c){let p=this.headers.get(e);if(!p)return;p=p.filter(w=>-1===c.indexOf(w)),0===p.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,p)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class Z8{encodeKey(t){return FT(t)}encodeValue(t){return FT(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const Q8=/%(\d[a-f0-9])/gi,X8={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function FT(n){return encodeURIComponent(n).replace(Q8,(t,e)=>{var r;return null!==(r=X8[e])&&void 0!==r?r:t})}function OT(n){return`${n}`}class cd{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new Z8,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(o=>{const c=o.indexOf("="),[p,w]=-1==c?[t.decodeKey(o),""]:[t.decodeKey(o.slice(0,c)),t.decodeValue(o.slice(c+1))],T=e.get(p)||[];T.push(w),e.set(p,T)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const r=t.fromObject[e];this.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(r=>{const o=t[r];Array.isArray(o)?o.forEach(c=>{e.push({param:r,value:c,op:"a"})}):e.push({param:r,value:o,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new cd({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(OT(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const o=r.indexOf(OT(t.value));-1!==o&&r.splice(o,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class Y8{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}keys(){return this.map.keys()}}function LT(n){return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer}function BT(n){return"undefined"!=typeof Blob&&n instanceof Blob}function NT(n){return"undefined"!=typeof FormData&&n instanceof FormData}class h0{constructor(t,e,r,o){let c;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||o?(this.body=void 0!==r?r:null,c=o):c=r,c&&(this.reportProgress=!!c.reportProgress,this.withCredentials=!!c.withCredentials,c.responseType&&(this.responseType=c.responseType),c.headers&&(this.headers=c.headers),c.context&&(this.context=c.context),c.params&&(this.params=c.params)),this.headers||(this.headers=new mh),this.context||(this.context=new Y8),this.params){const p=this.params.toString();if(0===p.length)this.urlWithParams=e;else{const w=e.indexOf("?");this.urlWithParams=e+(-1===w?"?":w<e.length-1?"&":"")+p}}else this.params=new cd,this.urlWithParams=e}serializeBody(){return null===this.body?null:LT(this.body)||BT(this.body)||NT(this.body)||function(n){return"undefined"!=typeof URLSearchParams&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof cd?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||NT(this.body)?null:BT(this.body)?this.body.type||null:LT(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof cd?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){var e;const r=t.method||this.method,o=t.url||this.url,c=t.responseType||this.responseType,p=void 0!==t.body?t.body:this.body,w=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,T=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let O=t.headers||this.headers,V=t.params||this.params;const W=null!==(e=t.context)&&void 0!==e?e:this.context;return void 0!==t.setHeaders&&(O=Object.keys(t.setHeaders).reduce((K,ie)=>K.set(ie,t.setHeaders[ie]),O)),t.setParams&&(V=Object.keys(t.setParams).reduce((K,ie)=>K.set(ie,t.setParams[ie]),V)),new h0(r,o,p,{params:V,headers:O,context:W,reportProgress:T,responseType:c,withCredentials:w})}}var Pi=(()=>((Pi=Pi||{})[Pi.Sent=0]="Sent",Pi[Pi.UploadProgress=1]="UploadProgress",Pi[Pi.ResponseHeader=2]="ResponseHeader",Pi[Pi.DownloadProgress=3]="DownloadProgress",Pi[Pi.Response=4]="Response",Pi[Pi.User=5]="User",Pi))();class Jb{constructor(t,e=200,r="OK"){this.headers=t.headers||new mh,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class ew extends Jb{constructor(t={}){super(t),this.type=Pi.ResponseHeader}clone(t={}){return new ew({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class nv extends Jb{constructor(t={}){super(t),this.type=Pi.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new nv({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class zT extends Jb{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function tw(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let d0=(()=>{class n{constructor(e){this.handler=e}request(e,r,o={}){let c;if(e instanceof h0)c=e;else{let T,O;T=o.headers instanceof mh?o.headers:new mh(o.headers),o.params&&(O=o.params instanceof cd?o.params:new cd({fromObject:o.params})),c=new h0(e,r,void 0!==o.body?o.body:null,{headers:T,context:o.context,params:O,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials})}const p=gn(c).pipe(Gp(T=>this.handler.handle(T)));if(e instanceof h0||"events"===o.observe)return p;const w=p.pipe(ru(T=>T instanceof nv));switch(o.observe||"body"){case"body":switch(c.responseType){case"arraybuffer":return w.pipe(pn(T=>{if(null!==T.body&&!(T.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return T.body}));case"blob":return w.pipe(pn(T=>{if(null!==T.body&&!(T.body instanceof Blob))throw new Error("Response is not a Blob.");return T.body}));case"text":return w.pipe(pn(T=>{if(null!==T.body&&"string"!=typeof T.body)throw new Error("Response is not a string.");return T.body}));case"json":default:return w.pipe(pn(T=>T.body))}case"response":return w;default:throw new Error(`Unreachable: unhandled observe type ${o.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new cd).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,o={}){return this.request("PATCH",e,tw(o,r))}post(e,r,o={}){return this.request("POST",e,tw(o,r))}put(e,r,o={}){return this.request("PUT",e,tw(o,r))}}return n.\u0275fac=function(e){return new(e||n)(vt(PT))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();class VT{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const UT=new on("HTTP_INTERCEPTORS");let e6=(()=>{class n{intercept(e,r){return r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();const t6=/^\)\]\}',?\n/;let jT=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Hn(r=>{const o=this.xhrFactory.build();if(o.open(e.method,e.urlWithParams),e.withCredentials&&(o.withCredentials=!0),e.headers.forEach((ie,fe)=>o.setRequestHeader(ie,fe.join(","))),e.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const ie=e.detectContentTypeHeader();null!==ie&&o.setRequestHeader("Content-Type",ie)}if(e.responseType){const ie=e.responseType.toLowerCase();o.responseType="json"!==ie?ie:"text"}const c=e.serializeBody();let p=null;const w=()=>{if(null!==p)return p;const ie=1223===o.status?204:o.status,fe=o.statusText||"OK",Ve=new mh(o.getAllResponseHeaders()),Re=function(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||e.url;return p=new ew({headers:Ve,status:ie,statusText:fe,url:Re}),p},T=()=>{let{headers:ie,status:fe,statusText:Ve,url:Re}=w(),tt=null;204!==fe&&(tt=void 0===o.response?o.responseText:o.response),0===fe&&(fe=tt?200:0);let He=fe>=200&&fe<300;if("json"===e.responseType&&"string"==typeof tt){const Ot=tt;tt=tt.replace(t6,"");try{tt=""!==tt?JSON.parse(tt):null}catch(Qt){tt=Ot,He&&(He=!1,tt={error:Qt,text:tt})}}He?(r.next(new nv({body:tt,headers:ie,status:fe,statusText:Ve,url:Re||void 0})),r.complete()):r.error(new zT({error:tt,headers:ie,status:fe,statusText:Ve,url:Re||void 0}))},O=ie=>{const{url:fe}=w(),Ve=new zT({error:ie,status:o.status||0,statusText:o.statusText||"Unknown Error",url:fe||void 0});r.error(Ve)};let V=!1;const W=ie=>{V||(r.next(w()),V=!0);let fe={type:Pi.DownloadProgress,loaded:ie.loaded};ie.lengthComputable&&(fe.total=ie.total),"text"===e.responseType&&!!o.responseText&&(fe.partialText=o.responseText),r.next(fe)},K=ie=>{let fe={type:Pi.UploadProgress,loaded:ie.loaded};ie.lengthComputable&&(fe.total=ie.total),r.next(fe)};return o.addEventListener("load",T),o.addEventListener("error",O),o.addEventListener("timeout",O),o.addEventListener("abort",O),e.reportProgress&&(o.addEventListener("progress",W),null!==c&&o.upload&&o.upload.addEventListener("progress",K)),o.send(c),r.next({type:Pi.Sent}),()=>{o.removeEventListener("error",O),o.removeEventListener("abort",O),o.removeEventListener("load",T),o.removeEventListener("timeout",O),e.reportProgress&&(o.removeEventListener("progress",W),null!==c&&o.upload&&o.upload.removeEventListener("progress",K)),o.readyState!==o.DONE&&o.abort()}})}}return n.\u0275fac=function(e){return new(e||n)(vt(HM))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})();const nw=new on("XSRF_COOKIE_NAME"),rw=new on("XSRF_HEADER_NAME");class GT{}let r6=(()=>{class n{constructor(e,r,o){this.doc=e,this.platform=r,this.cookieName=o,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=PM(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return n.\u0275fac=function(e){return new(e||n)(vt(uo),vt(ry),vt(nw))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})(),iw=(()=>{class n{constructor(e,r){this.tokenService=e,this.headerName=r}intercept(e,r){const o=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||o.startsWith("http://")||o.startsWith("https://"))return r.handle(e);const c=this.tokenService.getToken();return null!==c&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,c)})),r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(vt(GT),vt(rw))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})(),i6=(()=>{class n{constructor(e,r){this.backend=e,this.injector=r,this.chain=null}handle(e){if(null===this.chain){const r=this.injector.get(UT,[]);this.chain=r.reduceRight((o,c)=>new VT(o,c),this.backend)}return this.chain.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(vt(RT),vt(Pr))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac}),n})(),o6=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:iw,useClass:e6}]}}static withOptions(e={}){return{ngModule:n,providers:[e.cookieName?{provide:nw,useValue:e.cookieName}:[],e.headerName?{provide:rw,useValue:e.headerName}:[]]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Gi({type:n}),n.\u0275inj=gr({providers:[iw,{provide:UT,useExisting:iw,multi:!0},{provide:GT,useClass:r6},{provide:nw,useValue:"XSRF-TOKEN"},{provide:rw,useValue:"X-XSRF-TOKEN"}]}),n})(),s6=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Gi({type:n}),n.\u0275inj=gr({providers:[d0,{provide:PT,useClass:i6},jT,{provide:RT,useExisting:jT}],imports:[[o6.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),n})();const ow=new on("Google Sheets API key");let a6=(()=>{class n{constructor(e,r){this.http=e,this.apiKey=r,this.defaultActiveValues=["true","1","yes"]}get(e,r,o){return this.getRows(e,r).pipe(pn(c=>this.rowsToEntries(c).map(p=>this.getObjectFromEntry(p,o))))}getActive(e,r,o,c="is_active",p=null){return null===p?p=this.defaultActiveValues:Array.isArray(p)||(p=[p]),this.getRows(e,r).pipe(pn(w=>this.rowsToEntries(w).filter(T=>p.includes(T[c].toLowerCase())).map(T=>this.getObjectFromEntry(T,o))))}getSpreadsheetUrl(e,r){return"https://sheets.googleapis.com/v4/spreadsheets/"+e+"/values/"+encodeURI(r)+"?key="+this.apiKey}getRows(e,r){const o=this.getSpreadsheetUrl(e,r);return this.http.get(o).pipe(pn(c=>c.values),od(this.handleError))}rowsToEntries(e){const r=e[0].map(this.cleanColumnName);return e.slice(1).map(o=>r.reduce((c,p,w)=>(c[p]=o.length>w?o[w]:"",c),{}))}cleanColumnName(e){return e.trim()}arrayToObject(e){return e.reduce((r,o)=>(r[o]=o,r),{})}getObjectFromEntry(e,r){return Array.isArray(r)&&(r=this.arrayToObject(r)),this.getObjectFromEntryObject(e,r)}getObjectFromEntryObject(e,r,o=""){const c={};for(const p in Object(r))if(r.hasOwnProperty(p)&&!["_prefix","_listField"].includes(p))if("string"==typeof r[p])c[p]=this.getValueFromEntry(e,o+r[p]);else if("object"==typeof r[p]){let w="";r[p].hasOwnProperty("_prefix")&&(w=r[p]._prefix),c[p]=r[p]._listField?this.getListFromEntry(e,o+w):this.getObjectFromEntryObject(e,r[p],o+w)}else console.log(`Unknown type for ${p}`);return c}getValueFromEntry(e,r){return r=this.cleanColumnName(r),e.hasOwnProperty(r)?e[r]:null}getListFromEntry(e,r){const o=[];let c=1,p=this.getValueFromEntry(e,`${r}${c}`);for(;p;)o.push(p),c++,p=this.getValueFromEntry(e,`${r}${c}`);return o}handleError(e){return e.error instanceof ErrorEvent?console.error("An error occurred:",e.error.message):console.error(`Backend returned code ${e.status}, body was: ${e.error}`),pT("Something bad happened; please try again later.")}}return n.\u0275fac=function(e){return new(e||n)(vt(d0),vt(ow))},n.\u0275prov=Wt({factory:function(){return new n(vt(d0),vt(ow))},token:n,providedIn:"root"}),n})();const l6={id:"id",name:"name",group:"group",lon:"lon",lat:"lat"},c6={id:"id",name:"name"},u6={id:"id",name:"name",size:"size"};let sw=(()=>{class n{constructor(e){this.googleSheetsDbService=e}getCities(){return this.googleSheetsDbService.get("15HnwixyXuMjkYlryytSMKOqqDjzFwsaN1vuPpMDFc6Y","Cities",l6).pipe(Co(e=>e.forEach(r=>{r.id=Number(r.id),r.lat=Number(r.lat),r.lon=Number(r.lon)})))}getClassifiers(){return this.googleSheetsDbService.get("15HnwixyXuMjkYlryytSMKOqqDjzFwsaN1vuPpMDFc6Y","Classifiers",c6).pipe(Co(e=>e.forEach(r=>{r.id=Number(r.id)})))}getCsvFiles(){return this.googleSheetsDbService.getActive("10MV6ScSQZe1KbpVYCcSi_ZW79bwmfyS_q1voeoyDNOQ","Files",u6,"active").pipe(Co(e=>e.forEach(r=>{r.size=Number(r.size);var o=r.name.split("_");r.areaId=Number(o[0]),r.clfId=Number(o[1])})))}}return n.\u0275fac=function(e){return new(e||n)(vt(a6))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),$T=(()=>{class n{constructor(e,r){this.googleSheetsDownloaderService=e,this.httpClient=r,this.files=[],this.cache=new Map,this.progressSubject=new pl(0)}setupFiles(){return this.googleSheetsDownloaderService.getCsvFiles().pipe(Co(e=>this.files=e))}_getFileId(e){var r=this.files.find(o=>o.name===e);if(!r)throw Error(`No result ${e}`);return r.id}getFileId(e){return 0==this.files.length?this.googleSheetsDownloaderService.getCsvFiles().pipe(Co(r=>this.files=r),pn(()=>this._getFileId(e))):gn(1).pipe(pn(()=>this._getFileId(e)))}parseCsv(e){const o=[];return e.split("\n").forEach(p=>{const w=p.split(",");o.push(w)}),o}getHexData(e,r){var o=`${e.id}_${r}`;return this.cache.has(o)?gn(this.cache.get(o)):this.getFileId(o).pipe(mr(p=>this.httpClient.get("https://www.googleapis.com/drive/v3/files/"+p+"?alt=media&key=AIzaSyDVc71t2FNSlJ5sko_IZBGZVre45bYA94U",{responseType:"text",reportProgress:!0,observe:"events"})),Co(p=>{var w=0;p.type===Pi.DownloadProgress?w=Math.round(100*p.loaded/e.sizeBytes):p.type===Pi.Response&&(w=100),this.progressSubject.next(w)}),ru(p=>p.type===Pi.Response),pn(p=>{var w=this.parseCsv(p.body);w.shift();var T=w.map(O=>({hex:O[0],value:Number(O[1])})).filter(O=>!Number.isNaN(O.value));return this.cache.set(o,T),T}))}}return n.\u0275fac=function(e){return new(e||n)(vt(sw),vt(d0))},n.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var _t=function(n){var r,t=void 0!==(n=n||{})?n:{},e={};for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);var w,o=[],c="";document.currentScript&&(c=document.currentScript.src),c=0!==c.indexOf("blob:")?c.substr(0,c.lastIndexOf("/")+1):"",w=function(ut,Pt,sn){var m=new XMLHttpRequest;m.open("GET",ut,!0),m.responseType="arraybuffer",m.onload=function(){if(200==m.status||0==m.status&&m.response)Pt(m.response);else{var Dr=Nw(ut);Dr?Pt(Dr.buffer):sn()}},m.onerror=sn,m.send(null)};var T=t.print||console.log.bind(console),O=t.printErr||console.warn.bind(console);for(r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);e=null,t.arguments&&(o=t.arguments);var V=0,K=function(){return V},Re=!1;function He(je){var ut=t["_"+je];return function(je,ut){je||ef("Assertion failed: "+ut)}(ut,"Cannot call unknown function "+je+", make sure it is exported"),ut}function Ot(je,ut,Pt,sn,m){var Zr={string:function(Yn){var lr=0;if(null!=Yn&&0!==Yn){var _d=1+(Yn.length<<2);!function(je,ut,Pt){!function(je,ut,Pt,sn){if(!(sn>0))return 0;for(var Zr=Pt+sn-1,Dr=0;Dr<je.length;++Dr){var pe=je.charCodeAt(Dr);if(pe>=55296&&pe<=57343&&(pe=65536+((1023&pe)<<10)|1023&je.charCodeAt(++Dr)),pe<=127){if(Pt>=Zr)break;ut[Pt++]=pe}else if(pe<=2047){if(Pt+1>=Zr)break;ut[Pt++]=192|pe>>6,ut[Pt++]=128|63&pe}else if(pe<=65535){if(Pt+2>=Zr)break;ut[Pt++]=224|pe>>12,ut[Pt++]=128|pe>>6&63,ut[Pt++]=128|63&pe}else{if(Pt+3>=Zr)break;ut[Pt++]=240|pe>>18,ut[Pt++]=128|pe>>12&63,ut[Pt++]=128|pe>>6&63,ut[Pt++]=128|63&pe}}ut[Pt]=0}(je,lu,ut,Pt)}(Yn,lr=pk(_d),_d)}return lr},array:function(Yn){var lr=pk(Yn.length);return function(je,ut){_l.set(je,ut)}(Yn,lr),lr}},pe=He(je),fs=[],fa=0;if(sn)for(var ir=0;ir<sn.length;ir++){var Ri=Zr[Pt[ir]];Ri?(0===fa&&(fa=gj()),fs[ir]=Ri(sn[ir])):fs[ir]=sn[ir]}var Yn,_h=pe.apply(null,fs);return Yn=_h,_h="string"===ut?Ho(Yn):"boolean"===ut?Boolean(Yn):Yn,0!==fa&&mj(fa),_h}var au,_l,lu,KA,gd,Rw,Fw,Fn="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function Ho(je,ut){return je?function(je,ut,Pt){for(var sn=ut+Pt,m=ut;je[m]&&!(m>=sn);)++m;if(m-ut>16&&je.subarray&&Fn)return Fn.decode(je.subarray(ut,m));for(var Zr="";ut<m;){var Dr=je[ut++];if(128&Dr){var pe=63&je[ut++];if(192!=(224&Dr)){var fs=63&je[ut++];if((Dr=224==(240&Dr)?(15&Dr)<<12|pe<<6|fs:(7&Dr)<<18|pe<<12|fs<<6|63&je[ut++])<65536)Zr+=String.fromCharCode(Dr);else{var fa=Dr-65536;Zr+=String.fromCharCode(55296|fa>>10,56320|1023&fa)}}else Zr+=String.fromCharCode((31&Dr)<<6|pe)}else Zr+=String.fromCharCode(Dr)}return Zr}(lu,je,ut):""}function em(je,ut){return je%ut>0&&(je+=ut-je%ut),je}function ik(je){au=je,t.HEAP8=_l=new Int8Array(je),t.HEAP16=KA=new Int16Array(je),t.HEAP32=gd=new Int32Array(je),t.HEAPU8=lu=new Uint8Array(je),t.HEAPU16=new Uint16Array(je),t.HEAPU32=new Uint32Array(je),t.HEAPF32=Rw=new Float32Array(je),t.HEAPF64=Fw=new Float64Array(je)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var sk=t.TOTAL_MEMORY||33554432;function mv(je){for(;je.length>0;){var ut=je.shift();if("function"!=typeof ut){var Pt=ut.func;"number"==typeof Pt?void 0===ut.arg?t.dynCall_v(Pt):t.dynCall_vi(Pt,ut.arg):Pt(void 0===ut.arg?null:ut.arg)}else ut()}}sk=(au=t.buffer?t.buffer:new ArrayBuffer(sk)).byteLength,ik(au),gd[6004]=5266928;var ak=[],$U=[],HU=[],lk=[],KU=Math.abs,JU=Math.ceil,ej=Math.floor,tj=Math.min,JA=0,Ow=null,y0=null;t.preloadedImages={},t.preloadedAudios={};var tm,Bw,gh=null,Lw="data:application/octet-stream;base64,";function ck(je){return String.prototype.startsWith?je.startsWith(Lw):0===je.indexOf(Lw)}function hk(je){return je.replace(/\b__Z[\w\d_]+/g,function(Pt){return Pt==Pt?Pt:Pt+" ["+Pt+"]"})}function dk(){var je=new Error;if(!je.stack){try{throw new Error(0)}catch(ut){je=ut}if(!je.stack)return"(no stack trace available)"}return je.stack.toString()}function Ak(){return _l.length}function fk(je){try{var ut=new ArrayBuffer(je);return ut.byteLength!=je?void 0:(new Int8Array(ut).set(_l),pj(ut),ik(ut),1)}catch(Pt){}}gh="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var hj="function"==typeof atob?atob:function(je){var m,Zr,Dr,pe,fs,fa,ut="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Pt="",ir=0;je=je.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{Dr=ut.indexOf(je.charAt(ir++)),m=(15&(pe=ut.indexOf(je.charAt(ir++))))<<4|(fs=ut.indexOf(je.charAt(ir++)))>>2,Zr=(3&fs)<<6|(fa=ut.indexOf(je.charAt(ir++))),Pt+=String.fromCharCode(Dr<<2|pe>>4),64!==fs&&(Pt+=String.fromCharCode(m)),64!==fa&&(Pt+=String.fromCharCode(Zr))}while(ir<je.length);return Pt};function Nw(je){if(ck(je))return function(je){try{for(var ut=hj(je),Pt=new Uint8Array(ut.length),sn=0;sn<ut.length;++sn)Pt[sn]=ut.charCodeAt(sn);return Pt}catch(m){throw new Error("Converting base64 string to bytes failed.")}}(je.slice(Lw.length))}var je,gv,kt=function(je,ut,Pt){var sn=new je.Int8Array(Pt),m=new je.Int32Array(Pt),pe=(new je.Uint8Array(Pt),new je.Float32Array(Pt),new je.Float64Array(Pt)),fs=0|ut.p,fa=je.Math.floor,ir=je.Math.abs,Ri=je.Math.sqrt,_h=je.Math.pow,Yn=je.Math.cos,lr=je.Math.sin,_d=je.Math.tan,_j=je.Math.acos,yj=je.Math.asin,Uw=je.Math.atan,yl=je.Math.atan2,_v=je.Math.ceil,yh=je.Math.imul,vj=je.Math.min,tf=je.Math.clz32,kn=ut.b,De=ut.c,Or=ut.d,yk=ut.e,xj=ut.f,bj=ut.g,wj=ut.h,Cj=ut.i,me=24048;function vk(d,A,y,C){var M=0,k=0;!(0|jw(d|=0,A|=0,y|=0,C|=0,0))||(ac(0|C,0,(k=1+(0|yh(3*y|0,y+1|0))|0)<<3|0),(M=0|sc(k,4))&&(cu(d,A,y,C,M,k,0),Nn(M)))}function jw(d,A,y,C,M){A|=0,y|=0,M|=0;var ze,k=0,I=0,L=0,G=0,X=0,ee=0,ye=0,Te=0;if(ze=me,me=me+16|0,Te=ze,m[(k=C|=0)>>2]=d|=0,m[k+4>>2]=A,(k=0!=(0|M))&&(m[M>>2]=0),0|Eo(d,A))return me=ze,1;m[Te>>2]=0;e:do{if((0|y)>=1)if(k)for(X=0,ee=1,ye=1,I=0,k=d;;){if(!(I|X)){if(0==(0|(k=0|fo(k,A,4,Te)))&0==(0|(A=0|De()))){k=2;break e}if(0|Eo(k,A)){k=1;break e}}if(0==(0|(k=0|fo(k,A,0|m[16+(X<<2)>>2],Te)))&0==(0|(A=0|De()))){k=2;break e}if(m[(d=C+(ye<<3)|0)>>2]=k,m[d+4>>2]=A,m[M+(ye<<2)>>2]=ee,d=(0|(I=I+1|0))==(0|ee),G=6==(0|(L=X+1|0)),0|Eo(k,A)){k=1;break e}if((0|(ee=ee+(G&d&1)|0))>(0|y)){k=0;break}X=d?G?0:L:X,ye=ye+1|0,I=d?0:I}else for(X=0,ee=1,ye=1,I=0,k=d;;){if(!(I|X)){if(0==(0|(k=0|fo(k,A,4,Te)))&0==(0|(A=0|De()))){k=2;break e}if(0|Eo(k,A)){k=1;break e}}if(0==(0|(k=0|fo(k,A,0|m[16+(X<<2)>>2],Te)))&0==(0|(A=0|De()))){k=2;break e}if(m[(d=C+(ye<<3)|0)>>2]=k,m[d+4>>2]=A,d=(0|(I=I+1|0))==(0|ee),G=6==(0|(L=X+1|0)),0|Eo(k,A)){k=1;break e}if((0|(ee=ee+(G&d&1)|0))>(0|y)){k=0;break}X=d?G?0:L:X,ye=ye+1|0,I=d?0:I}else k=0}while(0);return me=ze,0|k}function cu(d,A,y,C,M,k,I){y|=0,C|=0,M|=0,k|=0,I|=0;var ee,ye,L=0,G=0,X=0,Te=0,ze=0;if(ye=me,me=me+16|0,ee=ye,0==(0|(d|=0))&0==(0|(A|=0)))me=ye;else{if(L=0|xd(0|d,0|A,0|k,((0|k)<0)<<31>>31|0),De(),!(0==(0|(ze=0|m[(Te=G=C+(L<<3)|0)>>2]))&0==(0|(Te=0|m[Te+4>>2]))|(X=(0|ze)==(0|d)&(0|Te)==(0|A))))do{X=(0|(Te=0|m[(ze=G=C+((L=(L+1|0)%(0|k)|0)<<3)|0)>>2]))==(0|d)&(0|(ze=0|m[ze+4>>2]))==(0|A)}while(!(0==(0|Te)&0==(0|ze)|X));L=M+(L<<2)|0,X&&(0|m[L>>2])<=(0|I)||(m[(ze=G)>>2]=d,m[ze+4>>2]=A,m[L>>2]=I,(0|I)>=(0|y)||(ze=I+1|0,m[ee>>2]=0,cu(Te=0|fo(d,A,2,ee),0|De(),y,C,M,k,ze),m[ee>>2]=0,cu(Te=0|fo(d,A,3,ee),0|De(),y,C,M,k,ze),m[ee>>2]=0,cu(Te=0|fo(d,A,1,ee),0|De(),y,C,M,k,ze),m[ee>>2]=0,cu(Te=0|fo(d,A,5,ee),0|De(),y,C,M,k,ze),m[ee>>2]=0,cu(Te=0|fo(d,A,4,ee),0|De(),y,C,M,k,ze),m[ee>>2]=0,cu(Te=0|fo(d,A,6,ee),0|De(),y,C,M,k,ze))),me=ye}}function fo(d,A,y,C){d|=0,A|=0,y|=0;var L,G,M=0,k=0,I=0,ee=0,ye=0,Te=0,ze=0;if((0|m[(C|=0)>>2])>0){M=0;do{y=0|of(y),M=M+1|0}while((0|M)<(0|m[C>>2]))}L=0|Ct(0|d,0|A,45),De(),G=127&L,k=0|ma(d,A),M=0|Ct(0|d,0|A,52),De(),M&=15;e:do{if(M)for(;;){if(Te=0|Ct(0|d,0|A,0|(ye=3*(15-M|0)|0)),De(),Te&=7,ze=0==(0|vl(M)),M=M+-1|0,ee=0|Bt(7,0,0|ye),A&=~(0|De()),d=(ye=0|Bt(0|m[(ze?464:48)+(28*Te|0)+(y<<2)>>2],0,0|ye))|d&~ee,A|=0|De(),!(y=0|m[(ze?672:256)+(28*Te|0)+(y<<2)>>2])){y=0;break e}if(!M){I=6;break}}else I=6}while(0);6==(0|I)&&(d|=Te=0|Bt(0|(ze=0|m[880+(28*G|0)+(y<<2)>>2]),0,45),A=0|De()|-1040385&A,y=0|m[4304+(28*G|0)+(y<<2)>>2],127==(127&ze|0)&&(ze=0|Bt(0|m[880+(28*G|0)+20>>2],0,45),A=0|De()|-1040385&A,y=0|m[4304+(28*G|0)+20>>2],d=0|vd(ze|d,A),A=0|De(),m[C>>2]=1+(0|m[C>>2]))),I=0|Ct(0|d,0|A,45),De(),I&=127;e:do{if(0|yi(I)){t:do{if(1==(0|ma(d,A))){if((0|G)!=(0|I)){if(0|wk(I,0|m[7728+(28*G|0)>>2])){d=0|Kw(d,A),k=1,A=0|De();break}d=0|vd(d,A),k=1,A=0|De();break}switch(0|k){case 5:d=0|Kw(d,A),A=0|De(),m[C>>2]=5+(0|m[C>>2]),k=0;break t;case 3:d=0|vd(d,A),A=0|De(),m[C>>2]=1+(0|m[C>>2]),k=0;break t;default:return ze=0,kn(0|(Te=0)),0|ze}}else k=0}while(0);if((0|y)>0){M=0;do{d=0|Yw(d,A),A=0|De(),M=M+1|0}while((0|M)!=(0|y))}if((0|G)!=(0|I)){if(!(0|Gw(I))){if(0!=(0|k)|5!=(0|ma(d,A)))break;m[C>>2]=1+(0|m[C>>2]);break}switch(127&L){case 8:case 118:break e}3!=(0|ma(d,A))&&(m[C>>2]=1+(0|m[C>>2]))}}else if((0|y)>0){M=0;do{d=0|vd(d,A),A=0|De(),M=M+1|0}while((0|M)!=(0|y))}}while(0);return m[C>>2]=((0|m[C>>2])+y|0)%6|0,ze=d,kn(0|(Te=A)),0|ze}function xk(d,A,y,C,M,k){y|=0,C|=0,M|=0,k|=0;var Nt,qe,yt,Ie,Vt,Ut,Rt,Lt,Lr,I=0,L=0,G=0,X=0,ee=0,ye=0,Te=0,ze=0,Ye=0,et=0,Dt=0,Rn=0,wr=0,Wr=0;if(Lr=me,me=me+48|0,(0|(I=0|m[(d|=0)>>2]))<=0)return me=Lr,0;Nt=d+4|0,qe=8+(Ut=Lr+32|0)|0,yt=8+(Rt=Lr+16|0)|0,Ie=(Lt=Lr)+8|0,Vt=((0|(A|=0))<0)<<31>>31,Dt=0;e:for(;;){m[Ut>>2]=m[(Ye=(L=0|m[Nt>>2])+(Dt<<4)|0)>>2],m[Ut+4>>2]=m[Ye+4>>2],m[Ut+8>>2]=m[Ye+8>>2],m[Ut+12>>2]=m[Ye+12>>2],(0|Dt)==(I+-1|0)?(m[Rt>>2]=m[L>>2],m[Rt+4>>2]=m[L+4>>2],m[Rt+8>>2]=m[L+8>>2],m[Rt+12>>2]=m[L+12>>2]):(m[Rt>>2]=m[(Ye=L+(Dt+1<<4)|0)>>2],m[Rt+4>>2]=m[Ye+4>>2],m[Rt+8>>2]=m[Ye+8>>2],m[Rt+12>>2]=m[Ye+12>>2]),Ye=0|Gj(Ut,Rt,y);t:do{if((0|Ye)>0){et=+(0|Ye),ze=0;n:for(;;){pe[Lt>>3]=+pe[Ut>>3]*(Wr=+(Ye-ze|0))/et+ +pe[Rt>>3]*(wr=+(0|ze))/et,pe[Ie>>3]=+pe[qe>>3]*Wr/et+ +pe[yt>>3]*wr/et,L=0|xd(0|(ye=0|zk(Lt,y)),0|(Te=0|De()),0|A,0|Vt),De(),X=0|m[(G=I=k+(L<<3)|0)>>2],G=0|m[G+4>>2];r:do{if(0==(0|X)&0==(0|G))Rn=14;else for(ee=0;;){if((0|ee)>(0|A)){I=1;break r}if((0|X)==(0|ye)&(0|G)==(0|Te)){I=7;break r}if(0==(0|(X=0|m[(G=I=k+((L=(L+1|0)%(0|A)|0)<<3)|0)>>2]))&0==(0|(G=0|m[G+4>>2]))){Rn=14;break}ee=ee+1|0}}while(0);switch(14==(0|Rn)&&(Rn=0,0==(0|ye)&0==(0|Te)?I=7:(m[I>>2]=ye,m[I+4>>2]=Te,m[(ee=M+((I=0|m[C>>2])<<3)|0)>>2]=ye,m[ee+4>>2]=Te,m[C>>2]=I+1,I=0)),7&I){case 7:case 0:break;default:break n}if((0|Ye)<=(0|(ze=ze+1|0))){Rn=8;break t}}if(0|I){I=-1,Rn=20;break e}}else Rn=8}while(0);if(8==(0|Rn)&&(Rn=0),(0|(Dt=Dt+1|0))>=(0|(I=0|m[d>>2]))){I=0,Rn=20;break}}return 20==(0|Rn)?(me=Lr,0|I):0}function yi(d){return 0|m[7728+(28*(d|=0)|0)+16>>2]}function Gw(d){return 4==(0|(d|=0))|117==(0|d)|0}function bk(d){return 0|m[11152+(216*(0|m[(d|=0)>>2])|0)+(72*(0|m[d+4>>2])|0)+(24*(0|m[d+8>>2])|0)+(m[d+12>>2]<<3)>>2]}function Nj(d){return 0|m[11152+(216*(0|m[(d|=0)>>2])|0)+(72*(0|m[d+4>>2])|0)+(24*(0|m[d+8>>2])|0)+(m[d+12>>2]<<3)+4>>2]}function wk(d,A){return(0|m[7728+(28*(d|=0)|0)+20>>2])==(0|(A|=0))?0|(A=1):0|(A=(0|m[7728+(28*d|0)+24>>2])==(0|A))}function $w(d,A){return 0|m[880+(28*(d|=0)|0)+((A|=0)<<2)>>2]}function Hw(d,A){return(0|m[880+(28*(d|=0)|0)>>2])==(0|(A|=0))?0|(A=0):(0|m[880+(28*d|0)+4>>2])==(0|A)?0|(A=1):(0|m[880+(28*d|0)+8>>2])==(0|A)?0|(A=2):(0|m[880+(28*d|0)+12>>2])==(0|A)?0|(A=3):(0|m[880+(28*d|0)+16>>2])==(0|A)?0|(A=4):(0|m[880+(28*d|0)+20>>2])==(0|A)?0|(A=5):0|((0|m[880+(28*d|0)+24>>2])==(0|A)?6:7)}function Ck(d){return+pe[16+(d|=0)>>3]<+pe[d+24>>3]|0}function Ek(d,A){var y=0,C=0,M=0;return(y=+pe[(A|=0)>>3])>=+pe[8+(d|=0)>>3]&&y<=+pe[d>>3]?(A=(M=+pe[A+8>>3])>=(y=+pe[d+24>>3]),d=M<=(C=+pe[d+16>>3])&1,C<y?A&&(d=1):A||(d=0),0|(A=0!=(0|d))):0|(A=0)}function qw(d,A){d|=0,A|=0;var y,C,M,I,G,X,k=0,L=0;I=me,me=me+288|0,y=I+264|0,C=I+96|0,L=(k=M=I)+96|0;do{m[k>>2]=0,k=k+4|0}while((0|k)<(0|L));return e2(A,M),sf(L=0|m[(k=M)>>2],k=0|m[k+4>>2],y),af(L,k,C),G=+b0(y,C+8|0),pe[y>>3]=+pe[d>>3],pe[(k=y+8|0)>>3]=+pe[d+16>>3],pe[C>>3]=+pe[d+8>>3],pe[(L=C+8|0)>>3]=+pe[d+24>>3],X=+b0(y,C),L=~~+_v(+X*X/+Jk(+ +ir(+(+pe[k>>3]-+pe[L>>3])/(+pe[y>>3]-+pe[C>>3])),3)/(G*(2.59807621135*G)*.8)),me=I,0|(0==(0|L)?1:L)}function Gj(d,A,y){d|=0,A|=0,y|=0;var C,M,k,L,X,I=0,G=0;L=me,me=me+288|0,C=L+264|0,M=L+96|0,G=(I=k=L)+96|0;do{m[I>>2]=0,I=I+4|0}while((0|I)<(0|G));return e2(y,k),sf(I=0|m[(G=k)>>2],G=0|m[G+4>>2],C),af(I,G,M),X=+b0(C,M+8|0),G=~~+_v(+ +b0(d,A)/(2*X)),me=L,0|(0==(0|G)?1:G)}function $j(d,A,y,C){y|=0,C|=0,m[(d|=0)>>2]=A|=0,m[d+4>>2]=y,m[d+8>>2]=C}function ps(d){var I,A=0,y=0,C=0,M=0,k=0;y=0|m[(I=4+(d|=0)|0)>>2],(0|(A=0|m[d>>2]))<0&&(m[I>>2]=y=y-A|0,m[(k=d+8|0)>>2]=(0|m[k>>2])-A,m[d>>2]=0,A=0),(0|y)<0?(m[d>>2]=A=A-y|0,m[(k=d+8|0)>>2]=M=(0|m[k>>2])-y|0,m[I>>2]=0,y=0):(k=M=d+8|0,M=0|m[M>>2]),(0|M)<0&&(m[d>>2]=A=A-M|0,m[I>>2]=y=y-M|0,m[k>>2]=0,M=0),!((0|(C=(0|M)<(0|(C=(0|y)<(0|A)?y:A))?M:C))<=0)&&(m[d>>2]=A-C,m[I>>2]=y-C,m[k>>2]=M-C)}function nf(d,A){var y,C;pe[(A|=0)>>3]=+((0|m[(d|=0)>>2])-(C=0|m[d+8>>2])|0)-.5*(y=+((0|m[d+4>>2])-C|0)),pe[A+8>>3]=.8660254037844386*y}function Gs(d,A,y){m[(y|=0)>>2]=(0|m[(A|=0)>>2])+(0|m[(d|=0)>>2]),m[y+4>>2]=(0|m[A+4>>2])+(0|m[d+4>>2]),m[y+8>>2]=(0|m[A+8>>2])+(0|m[d+8>>2])}function Zw(d,A,y){m[(y|=0)>>2]=(0|m[(d|=0)>>2])-(0|m[(A|=0)>>2]),m[y+4>>2]=(0|m[d+4>>2])-(0|m[A+4>>2]),m[y+8>>2]=(0|m[d+8>>2])-(0|m[A+8>>2])}function Dk(d,A){var C,y=0;y=0|yh(0|m[(d|=0)>>2],A|=0),m[d>>2]=y,C=0|yh(0|m[(y=d+4|0)>>2],A),m[y>>2]=C,A=0|yh(0|m[(d=d+8|0)>>2],A),m[d>>2]=A}function yv(d){var k,I,A=0,y=0,C=0,M=0,L=0;d=(d=(y=(0|(M=(0|m[8+(d|=0)>>2])-((L=(0|(I=0|m[d>>2]))<0)?I:0)+((k=(0|(C=(0|m[d+4>>2])-(L?I:0)|0))<0)?0-C|0:0)|0))<0)?0:M)-((C=(0|(y=(0|d)<(0|(y=(0|(A=(k?0:C)-(y?M:0)|0))<(0|(M=(L?0:I)-(k?C:0)-(y?M:0)|0))?A:M))?d:y))>0)?y:0)|0,A=A-(C?y:0)|0;e:do{switch(M-(C?y:0)|0){case 0:switch(0|A){case 0:return 0|(0==(0|d)?0:1==(0|d)?1:7);case 1:return 0|(0==(0|d)?2:1==(0|d)?3:7);default:break e}case 1:switch(0|A){case 0:return 0|(0==(0|d)?4:1==(0|d)?5:7);case 1:if(d)break e;return 6;default:break e}}}while(0);return 7}function Mk(d){var I,L,A=0,y=0,C=0,M=0,k=0;C=0|Cv(+((3*(A=(0|m[(d|=0)>>2])-(y=0|m[(I=d+8|0)>>2])|0)|0)-(y=(0|m[(L=d+4|0)>>2])-y|0)|0)/7),m[d>>2]=C,A=0|Cv(+((y<<1)+A|0)/7),m[L>>2]=A,m[I>>2]=0,y=A-C|0,(0|C)<0?(k=0-C|0,m[L>>2]=y,m[I>>2]=k,m[d>>2]=0,A=y,C=0,y=k):y=0,(0|A)<0&&(m[d>>2]=C=C-A|0,m[I>>2]=y=y-A|0,m[L>>2]=0,A=0),k=C-y|0,M=A-y|0,(0|y)<0?(m[d>>2]=k,m[L>>2]=M,m[I>>2]=0,A=M,M=k,y=0):M=C,!((0|(C=(0|y)<(0|(C=(0|A)<(0|M)?A:M))?y:C))<=0)&&(m[d>>2]=M-C,m[L>>2]=A-C,m[I>>2]=y-C)}function Ww(d){var I,L,A=0,y=0,C=0,M=0,k=0;C=0|Cv(+(((A=(0|m[(d|=0)>>2])-(y=0|m[(I=d+8|0)>>2])|0)<<1)+(y=(0|m[(L=d+4|0)>>2])-y|0)|0)/7),m[d>>2]=C,A=0|Cv(+((3*y|0)-A|0)/7),m[L>>2]=A,m[I>>2]=0,y=A-C|0,(0|C)<0?(k=0-C|0,m[L>>2]=y,m[I>>2]=k,m[d>>2]=0,A=y,C=0,y=k):y=0,(0|A)<0&&(m[d>>2]=C=C-A|0,m[I>>2]=y=y-A|0,m[L>>2]=0,A=0),k=C-y|0,M=A-y|0,(0|y)<0?(m[d>>2]=k,m[L>>2]=M,m[I>>2]=0,A=M,M=k,y=0):M=C,!((0|(C=(0|y)<(0|(C=(0|A)<(0|M)?A:M))?y:C))<=0)&&(m[d>>2]=M-C,m[L>>2]=A-C,m[I>>2]=y-C)}function vv(d){var k,I,L,A=0,y=0,C=0,M=0;C=0|m[(L=8+(d|=0)|0)>>2],m[d>>2]=M=(y=0|m[(I=d+4|0)>>2])+(3*(A=0|m[d>>2])|0)|0,m[I>>2]=y=C+(3*y|0)|0,m[L>>2]=A=(3*C|0)+A|0,C=y-M|0,(0|M)<0?(A=A-M|0,m[I>>2]=C,m[L>>2]=A,m[d>>2]=0,y=C,C=0):C=M,(0|y)<0&&(m[d>>2]=C=C-y|0,m[L>>2]=A=A-y|0,m[I>>2]=0,y=0),k=C-A|0,M=y-A|0,(0|A)<0?(m[d>>2]=k,m[I>>2]=M,m[L>>2]=0,C=k,A=0):M=y,!((0|(y=(0|A)<(0|(y=(0|M)<(0|C)?M:C))?A:y))<=0)&&(m[d>>2]=C-y,m[I>>2]=M-y,m[L>>2]=A-y)}function rf(d){var k,I,L,A=0,y=0,C=0,M=0;C=(3*(A=0|m[(I=4+(d|=0)|0)>>2])|0)+(M=0|m[d>>2])|0,m[d>>2]=M=(y=0|m[(L=d+8|0)>>2])+(3*M|0)|0,m[I>>2]=C,m[L>>2]=A=(3*y|0)+A|0,y=C-M|0,(0|M)<0?(A=A-M|0,m[I>>2]=y,m[L>>2]=A,m[d>>2]=0,M=0):y=C,(0|y)<0&&(m[d>>2]=M=M-y|0,m[L>>2]=A=A-y|0,m[I>>2]=0,y=0),k=M-A|0,C=y-A|0,(0|A)<0?(m[d>>2]=k,m[I>>2]=C,m[L>>2]=0,M=k,A=0):C=y,!((0|(y=(0|A)<(0|(y=(0|C)<(0|M)?C:M))?A:y))<=0)&&(m[d>>2]=M-y,m[I>>2]=C-y,m[L>>2]=A-y)}function Sk(d,A){d|=0;var y=0,C=0,M=0,k=0,I=0,L=0;((A|=0)-1|0)>>>0>=6||(m[d>>2]=M=(0|m[15472+(12*A|0)>>2])+(0|m[d>>2])|0,m[(L=d+4|0)>>2]=C=(0|m[15472+(12*A|0)+4>>2])+(0|m[L>>2])|0,m[(I=d+8|0)>>2]=A=(0|m[15472+(12*A|0)+8>>2])+(0|m[I>>2])|0,y=C-M|0,(0|M)<0?(A=A-M|0,m[L>>2]=y,m[I>>2]=A,m[d>>2]=0,C=0):(y=C,C=M),(0|y)<0&&(m[d>>2]=C=C-y|0,m[I>>2]=A=A-y|0,m[L>>2]=0,y=0),k=C-A|0,M=y-A|0,(0|A)<0?(m[d>>2]=k,m[L>>2]=M,m[I>>2]=0,C=k,A=0):M=y,!((0|(y=(0|A)<(0|(y=(0|M)<(0|C)?M:C))?A:y))<=0)&&(m[d>>2]=C-y,m[L>>2]=M-y,m[I>>2]=A-y))}function Tk(d){var k,I,L,A=0,y=0,C=0,M=0;C=(A=0|m[(I=4+(d|=0)|0)>>2])+(M=0|m[d>>2])|0,m[d>>2]=M=(y=0|m[(L=d+8|0)>>2])+M|0,m[I>>2]=C,m[L>>2]=A=y+A|0,y=C-M|0,(0|M)<0?(A=A-M|0,m[I>>2]=y,m[L>>2]=A,m[d>>2]=0,C=0):(y=C,C=M),(0|y)<0&&(m[d>>2]=C=C-y|0,m[L>>2]=A=A-y|0,m[I>>2]=0,y=0),k=C-A|0,M=y-A|0,(0|A)<0?(m[d>>2]=k,m[I>>2]=M,m[L>>2]=0,C=k,A=0):M=y,!((0|(y=(0|A)<(0|(y=(0|M)<(0|C)?M:C))?A:y))<=0)&&(m[d>>2]=C-y,m[I>>2]=M-y,m[L>>2]=A-y)}function xv(d){var k,I,L,A=0,y=0,C=0,M=0;y=0|m[(L=8+(d|=0)|0)>>2],m[d>>2]=M=(C=0|m[(I=d+4|0)>>2])+(A=0|m[d>>2])|0,m[I>>2]=C=y+C|0,m[L>>2]=A=y+A|0,y=C-M|0,(0|M)<0?(A=A-M|0,m[I>>2]=y,m[L>>2]=A,m[d>>2]=0,C=0):(y=C,C=M),(0|y)<0&&(m[d>>2]=C=C-y|0,m[L>>2]=A=A-y|0,m[I>>2]=0,y=0),k=C-A|0,M=y-A|0,(0|A)<0?(m[d>>2]=k,m[I>>2]=M,m[L>>2]=0,C=k,A=0):M=y,!((0|(y=(0|A)<(0|(y=(0|M)<(0|C)?M:C))?A:y))<=0)&&(m[d>>2]=C-y,m[I>>2]=M-y,m[L>>2]=A-y)}function of(d){switch(0|(d|=0)){case 1:d=5;break;case 5:d=4;break;case 4:d=6;break;case 6:d=2;break;case 2:d=3;break;case 3:d=1}return 0|d}function yd(d){switch(0|(d|=0)){case 1:d=3;break;case 3:d=2;break;case 2:d=6;break;case 6:d=4;break;case 4:d=5;break;case 5:d=1}return 0|d}function Ik(d){var k,I,L,A=0,y=0,C=0,M=0;C=0|m[(L=8+(d|=0)|0)>>2],m[d>>2]=M=(y=0|m[(I=d+4|0)>>2])+((A=0|m[d>>2])<<1)|0,m[I>>2]=y=C+(y<<1)|0,m[L>>2]=A=(C<<1)+A|0,C=y-M|0,(0|M)<0?(A=A-M|0,m[I>>2]=C,m[L>>2]=A,m[d>>2]=0,y=C,C=0):C=M,(0|y)<0&&(m[d>>2]=C=C-y|0,m[L>>2]=A=A-y|0,m[I>>2]=0,y=0),k=C-A|0,M=y-A|0,(0|A)<0?(m[d>>2]=k,m[I>>2]=M,m[L>>2]=0,C=k,A=0):M=y,!((0|(y=(0|A)<(0|(y=(0|M)<(0|C)?M:C))?A:y))<=0)&&(m[d>>2]=C-y,m[I>>2]=M-y,m[L>>2]=A-y)}function kk(d){var k,I,L,A=0,y=0,C=0,M=0;C=((A=0|m[(I=4+(d|=0)|0)>>2])<<1)+(M=0|m[d>>2])|0,m[d>>2]=M=(y=0|m[(L=d+8|0)>>2])+(M<<1)|0,m[I>>2]=C,m[L>>2]=A=(y<<1)+A|0,y=C-M|0,(0|M)<0?(A=A-M|0,m[I>>2]=y,m[L>>2]=A,m[d>>2]=0,M=0):y=C,(0|y)<0&&(m[d>>2]=M=M-y|0,m[L>>2]=A=A-y|0,m[I>>2]=0,y=0),k=M-A|0,C=y-A|0,(0|A)<0?(m[d>>2]=k,m[I>>2]=C,m[L>>2]=0,M=k,A=0):C=y,!((0|(y=(0|A)<(0|(y=(0|C)<(0|M)?C:M))?A:y))<=0)&&(m[d>>2]=M-y,m[I>>2]=C-y,m[L>>2]=A-y)}function Qw(d,A){var k,I,L,y=0,C=0,M=0;return A=(A=(d=(0|(M=((L=(0|(I=(0|m[(d|=0)>>2])-(0|m[(A|=0)>>2])|0))<0)?0-I|0:0)+(0|m[d+8>>2])-(0|m[A+8>>2])+((k=(0|(C=(0|m[d+4>>2])-(0|m[A+4>>2])-(L?I:0)|0))<0)?0-C|0:0)|0))<0)?0:M)-((C=(0|(d=(0|A)<(0|(d=(0|(y=(k?0:C)-(d?M:0)|0))<(0|(M=(L?0:I)-(k?C:0)-(d?M:0)|0))?y:M))?A:d))>0)?d:0)|0,y=y-(C?d:0)|0,0|((0|(d=(0|(d=M-(C?d:0)|0))>-1?d:0-d|0))>(0|(A=(0|(y=(0|y)>-1?y:0-y|0))>(0|(A=(0|A)>-1?A:0-A|0))?y:A))?d:A)}function Pk(d){var A,y,C,M;m[(d|=0)>>2]=y=(M=0|m[(A=d+8|0)>>2])-(0|m[d>>2])|0,m[(C=d+4|0)>>2]=d=(0|m[C>>2])-M|0,m[A>>2]=0-(d+y)}function Wj(d){var I,L,A=0,y=0,C=0,M=0,k=0;m[(d|=0)>>2]=A=0-(y=0|m[d>>2])|0,m[(I=d+8|0)>>2]=0,M=(C=0|m[(L=d+4|0)>>2])+y|0,(0|y)>0?(m[L>>2]=M,m[I>>2]=y,m[d>>2]=0,A=0,C=M):y=0,(0|C)<0?(m[d>>2]=k=A-C|0,m[I>>2]=y=y-C|0,m[L>>2]=0,M=k-y|0,A=0-y|0,(0|y)<0?(m[d>>2]=M,m[L>>2]=A,m[I>>2]=0,C=A,y=0):(C=0,M=k)):M=A,!((0|(A=(0|y)<(0|(A=(0|C)<(0|M)?C:M))?y:A))<=0)&&(m[d>>2]=M-A,m[L>>2]=C-A,m[I>>2]=y-A)}function v0(d,A,y,C,M){A|=0,y|=0,C|=0,M|=0;var k=0,I=0;if((k=+function(d){var A,y;return+ +Ri(+((y=+pe[(d|=0)>>3])*y+(A=+pe[d+8>>3])*A))}(d|=0))<1e-16)return m[M>>2]=m[(A=15568+(A<<4)|0)>>2],m[M+4>>2]=m[A+4>>2],m[M+8>>2]=m[A+8>>2],void(m[M+12>>2]=m[A+12>>2]);if(I=+yl(+ +pe[d+8>>3],+ +pe[d>>3]),(0|y)>0){d=0;do{k/=2.6457513110645907,d=d+1|0}while((0|d)!=(0|y))}C?(k/=3,y=0==(0|vl(y)),k=+Uw(.381966011250105*(y?k:k/2.6457513110645907))):(k=+Uw(.381966011250105*k),0|vl(y)&&(I=+x0(I+.3334731722518321))),function(d,A,y,C){d|=0,A=+A,C|=0;var M=0,k=0,I=0,L=0;if((y=+y)<1e-16)return m[C>>2]=m[d>>2],m[C+4>>2]=m[d+4>>2],m[C+8>>2]=m[d+8>>2],void(m[C+12>>2]=m[d+12>>2]);k=A<0?A+6.283185307179586:A,k=A>=6.283185307179586?k+-6.283185307179586:k;do{if(!(k<1e-16)){if(M=+ir(+(k+-3.141592653589793))<1e-16,A=+pe[d>>3],M){pe[C>>3]=A-=y,M=C;break}if(I=+Yn(+y),y=+lr(+y),A=I*+lr(+A)+ +Yn(+k)*(y*+Yn(+A)),A=+yj(+((A=A>1?1:A)<-1?-1:A)),pe[C>>3]=A,+ir(+(A+-1.5707963267948966))<1e-16)return pe[C>>3]=1.5707963267948966,void(pe[C+8>>3]=0);if(+ir(+(A+1.5707963267948966))<1e-16)return pe[C>>3]=-1.5707963267948966,void(pe[C+8>>3]=0);if(L=+Yn(+A),k=y*+lr(+k)/L,y=+pe[d>>3],A=(I-+lr(+A)*+lr(+y))/+Yn(+y)/L,(A=+pe[d+8>>3]+ +yl(+((I=k>1?1:k)<-1?-1:I),+((A=A>1?1:A)<-1?-1:A)))>3.141592653589793)do{A+=-6.283185307179586}while(A>3.141592653589793);if(A<-3.141592653589793)do{A+=6.283185307179586}while(A<-3.141592653589793);return void(pe[C+8>>3]=A)}pe[C>>3]=A=+pe[d>>3]+y,M=C}while(0);if(+ir(+(A+-1.5707963267948966))<1e-16)return pe[M>>3]=1.5707963267948966,void(pe[C+8>>3]=0);if(+ir(+(A+1.5707963267948966))<1e-16)return pe[M>>3]=-1.5707963267948966,void(pe[C+8>>3]=0);if((A=+pe[d+8>>3])>3.141592653589793)do{A+=-6.283185307179586}while(A>3.141592653589793);if(A<-3.141592653589793)do{A+=6.283185307179586}while(A<-3.141592653589793);pe[C+8>>3]=A}(15568+(A<<4)|0,+x0(+pe[16368+(24*A|0)>>3]-I),k,M)}function Rk(d,A,y,C,M){d|=0,y|=0,C|=0,M|=0;var G,X,ee,ye,Te,ze,Ye,et,Dt,Nt,yt,Ie,Vt,Ut,Rt,Lt,Rn,Lr,wr,Wr,vr,oi,k=0,I=0,L=0,qe=0,si=0,bn=0;if(oi=me,me=me+272|0,qe=oi+240|0,wr=oi,Wr=oi+224|0,vr=oi+208|0,yt=oi+176|0,Ie=oi+160|0,Vt=oi+192|0,Ut=oi+144|0,Rt=oi+128|0,Lt=oi+112|0,Rn=oi+96|0,Lr=oi+80|0,m[(k=oi+256|0)>>2]=A|=0,m[qe>>2]=m[d>>2],m[qe+4>>2]=m[d+4>>2],m[qe+8>>2]=m[d+8>>2],m[qe+12>>2]=m[d+12>>2],Fk(qe,k,wr),m[M>>2]=0,(0|(qe=C+y+(5==(0|C)&1)|0))<=(0|y))me=oi;else{X=Wr+4|0,ee=yt+4|0,ye=y+5|0,Te=16848+((G=0|m[k>>2])<<2)|0,ze=16928+(G<<2)|0,Ye=Rt+8|0,et=Lt+8|0,Dt=Rn+8|0,Nt=vr+4|0,L=y;e:for(;;){m[vr>>2]=m[(I=wr+(((0|L)%5|0)<<4)|0)>>2],m[vr+4>>2]=m[I+4>>2],m[vr+8>>2]=m[I+8>>2],m[vr+12>>2]=m[I+12>>2];do{}while(2==(0|nm(vr,G,0,1)));if((0|L)>(0|y)&0!=(0|vl(A))){if(m[yt>>2]=m[vr>>2],m[yt+4>>2]=m[vr+4>>2],m[yt+8>>2]=m[vr+8>>2],m[yt+12>>2]=m[vr+12>>2],nf(X,Ie),m[yt>>2]=m[18608+(80*(C=0|m[yt>>2])|0)+(20*(k=0|m[17008+(80*C|0)+(m[Wr>>2]<<2)>>2])|0)>>2],(0|(I=0|m[18608+(80*C|0)+(20*k|0)+16>>2]))>0){d=0;do{Tk(ee),d=d+1|0}while((0|d)<(0|I))}switch(m[Vt>>2]=m[(I=18608+(80*C|0)+(20*k|0)+4|0)>>2],m[Vt+4>>2]=m[I+4>>2],m[Vt+8>>2]=m[I+8>>2],Dk(Vt,3*(0|m[Te>>2])|0),Gs(ee,Vt,ee),ps(ee),nf(ee,Ut),pe[Rt>>3]=3*(si=+(0|m[ze>>2])),pe[Ye>>3]=0,pe[Lt>>3]=bn=-1.5*si,pe[et>>3]=2.598076211353316*si,pe[Rn>>3]=bn,pe[Dt>>3]=-2.598076211353316*si,0|m[17008+(80*(0|m[yt>>2])|0)+(m[vr>>2]<<2)>>2]){case 1:d=Lt,C=Rt;break;case 3:d=Rn,C=Lt;break;case 2:d=Rt,C=Rn;break;default:d=12;break e}qk(Ie,Ut,C,d,Lr),v0(Lr,0|m[yt>>2],G,1,M+8+(m[M>>2]<<4)|0),m[M>>2]=1+(0|m[M>>2])}if((0|L)<(0|ye)&&(nf(Nt,yt),v0(yt,0|m[vr>>2],G,1,M+8+(m[M>>2]<<4)|0),m[M>>2]=1+(0|m[M>>2])),m[Wr>>2]=m[vr>>2],m[Wr+4>>2]=m[vr+4>>2],m[Wr+8>>2]=m[vr+8>>2],m[Wr+12>>2]=m[vr+12>>2],(0|(L=L+1|0))>=(0|qe)){d=3;break}}3!=(0|d)?12==(0|d)&&Or(22474,22521,581,22531):me=oi}}function Fk(d,A,y){d|=0,A|=0,y|=0;var G,C=0,M=0,k=0,I=0,L=0;G=me,me=me+128|0,M=G,I=20208,L=60+(k=C=G+64|0)|0;do{m[k>>2]=m[I>>2],k=k+4|0,I=I+4|0}while((0|k)<(0|L));I=20272,L=(k=M)+60|0;do{m[k>>2]=m[I>>2],k=k+4|0,I=I+4|0}while((0|k)<(0|L));C=(L=0==(0|vl(0|m[A>>2])))?C:M,Ik(M=d+4|0),kk(M),0|vl(0|m[A>>2])&&(rf(M),m[A>>2]=1+(0|m[A>>2])),m[y>>2]=m[d>>2],Gs(M,C,A=y+4|0),ps(A),m[y+16>>2]=m[d>>2],Gs(M,C+12|0,A=y+20|0),ps(A),m[y+32>>2]=m[d>>2],Gs(M,C+24|0,A=y+36|0),ps(A),m[y+48>>2]=m[d>>2],Gs(M,C+36|0,A=y+52|0),ps(A),m[y+64>>2]=m[d>>2],Gs(M,C+48|0,y=y+68|0),ps(y),me=G}function nm(d,A,y,C){y|=0;var I,L,X,ee,Te,Ye,M=0,k=0,G=0,ye=0,ze=0;if(Ye=me,me=me+32|0,Te=Ye+12|0,L=Ye,ye=0|m[16928+((A|=0)<<2)>>2],ye=(ee=0!=(0|(C|=0)))?3*ye|0:ye,M=0|m[(ze=4+(d|=0)|0)>>2],I=0|m[(X=d+8|0)>>2],ee){if((0|(M=I+M+(C=0|m[(k=d+12|0)>>2])|0))==(0|ye))return me=Ye,1;G=k}else M=I+M+(C=0|m[(G=d+12|0)>>2])|0;if((0|M)<=(0|ye))return me=Ye,0;do{if((0|C)>0){if(C=0|m[d>>2],(0|I)>0){k=18608+(80*C|0)+60|0,C=d;break}C=18608+(80*C|0)+40|0,y?($j(Te,ye,0,0),Zw(ze,Te,L),xv(L),Gs(L,Te,ze),k=C,C=d):(k=C,C=d)}else k=18608+(80*(0|m[d>>2])|0)+20|0,C=d}while(0);if(m[C>>2]=m[k>>2],(0|m[(M=k+16|0)>>2])>0){C=0;do{Tk(ze),C=C+1|0}while((0|C)<(0|m[M>>2]))}return m[Te>>2]=m[(d=k+4|0)>>2],m[Te+4>>2]=m[d+4>>2],m[Te+8>>2]=m[d+8>>2],A=0|m[16848+(A<<2)>>2],Dk(Te,ee?3*A|0:A),Gs(ze,Te,ze),ps(ze),me=Ye,0|(ee&&((0|m[X>>2])+(0|m[ze>>2])+(0|m[G>>2])|0)==(0|ye)?1:2)}function Kj(d,A){d|=0,A|=0;var y=0;do{y=0|nm(d,A,0,1)}while(2==(0|y));return 0|y}function Ok(d,A,y,C,M){d|=0,y|=0,C|=0,M|=0;var G,X,ee,ye,Te,ze,Ye,et,Dt,Nt,qe,yt,Ie,Vt,Ut,Rt,Lt,Rn,k=0,I=0,L=0,Lr=0,wr=0;if(Rn=me,me=me+240|0,Vt=Rn+208|0,Ut=Rn,Rt=Rn+192|0,Lt=Rn+176|0,Dt=Rn+160|0,Nt=Rn+144|0,qe=Rn+128|0,yt=Rn+112|0,Ie=Rn+96|0,m[(k=Rn+224|0)>>2]=A|=0,m[Vt>>2]=m[d>>2],m[Vt+4>>2]=m[d+4>>2],m[Vt+8>>2]=m[d+8>>2],m[Vt+12>>2]=m[d+12>>2],Lk(Vt,k,Ut),m[M>>2]=0,(0|(et=C+y+(6==(0|C)&1)|0))<=(0|y))me=Rn;else{X=y+6|0,ee=16928+((G=0|m[k>>2])<<2)|0,ye=Nt+8|0,Te=qe+8|0,ze=yt+8|0,Ye=Rt+4|0,I=0,L=y,C=-1;e:for(;;){if(m[Rt>>2]=m[(d=Ut+((k=(0|L)%6|0)<<4)|0)>>2],m[Rt+4>>2]=m[d+4>>2],m[Rt+8>>2]=m[d+8>>2],m[Rt+12>>2]=m[d+12>>2],d=I,I=0|nm(Rt,G,0,1),(0|L)>(0|y)&0!=(0|vl(A))&&1!=(0|d)&&(0|m[Rt>>2])!=(0|C)){switch(nf(Ut+(((k+5|0)%6|0)<<4)+4|0,Lt),nf(Ut+(k<<4)+4|0,Dt),pe[Nt>>3]=3*(Lr=+(0|m[ee>>2])),pe[ye>>3]=0,pe[qe>>3]=wr=-1.5*Lr,pe[Te>>3]=2.598076211353316*Lr,pe[yt>>3]=wr,pe[ze>>3]=-2.598076211353316*Lr,0|m[17008+(80*(k=0|m[Vt>>2])|0)+(((0|C)==(0|k)?0|m[Rt>>2]:C)<<2)>>2]){case 1:d=qe,C=Nt;break;case 3:d=yt,C=qe;break;case 2:d=Nt,C=yt;break;default:d=8;break e}qk(Lt,Dt,C,d,Ie),!(0|Zk(Lt,Ie))&&!(0|Zk(Dt,Ie))&&(v0(Ie,0|m[Vt>>2],G,1,M+8+(m[M>>2]<<4)|0),m[M>>2]=1+(0|m[M>>2]))}if((0|L)<(0|X)&&(nf(Ye,Lt),v0(Lt,0|m[Rt>>2],G,1,M+8+(m[M>>2]<<4)|0),m[M>>2]=1+(0|m[M>>2])),(0|(L=L+1|0))>=(0|et)){d=3;break}C=0|m[Rt>>2]}3!=(0|d)?8==(0|d)&&Or(22557,22521,746,22602):me=Rn}}function Lk(d,A,y){d|=0,A|=0,y|=0;var G,C=0,M=0,k=0,I=0,L=0;G=me,me=me+160|0,M=G,I=20336,L=72+(k=C=G+80|0)|0;do{m[k>>2]=m[I>>2],k=k+4|0,I=I+4|0}while((0|k)<(0|L));I=20416,L=(k=M)+72|0;do{m[k>>2]=m[I>>2],k=k+4|0,I=I+4|0}while((0|k)<(0|L));C=(L=0==(0|vl(0|m[A>>2])))?C:M,Ik(M=d+4|0),kk(M),0|vl(0|m[A>>2])&&(rf(M),m[A>>2]=1+(0|m[A>>2])),m[y>>2]=m[d>>2],Gs(M,C,A=y+4|0),ps(A),m[y+16>>2]=m[d>>2],Gs(M,C+12|0,A=y+20|0),ps(A),m[y+32>>2]=m[d>>2],Gs(M,C+24|0,A=y+36|0),ps(A),m[y+48>>2]=m[d>>2],Gs(M,C+36|0,A=y+52|0),ps(A),m[y+64>>2]=m[d>>2],Gs(M,C+48|0,A=y+68|0),ps(A),m[y+80>>2]=m[d>>2],Gs(M,C+60|0,y=y+84|0),ps(y),me=G}function x0(d){var A;return A=(d=+d)<0?d+6.283185307179586:d,+(d>=6.283185307179586?A+-6.283185307179586:A)}function rm(d,A){return+ir(+(+pe[(d|=0)>>3]-+pe[(A|=0)>>3]))<17453292519943298e-27?0|(A=+ir(+(+pe[d+8>>3]-+pe[A+8>>3]))<17453292519943298e-27):0|(A=0)}function b0(d,A){var C,M,k,y=0;return y=(k=+lr(.5*((M=+pe[(A|=0)>>3])-(C=+pe[(d|=0)>>3]))))*k+(y=+lr(.5*(+pe[A+8>>3]-+pe[d+8>>3])))*(+Yn(+M)*+Yn(+C)*y),2*+yl(+ +Ri(+y),+ +Ri(+(1-y)))*6371.007180918475}function im(d,A,y){y|=0;var L,X,ee,ye,C=0,M=0,k=0,I=0,G=0,Te=0;return G=+lr(.5*((Te=+pe[(A|=0)>>3])-(ee=+pe[(d|=0)>>3]))),I=+lr(.5*((k=+pe[A+8>>3])-(X=+pe[d+8>>3]))),L=+Yn(+ee),ye=+Yn(+Te),I=2*+yl(+ +Ri(+(I=G*G+I*(ye*L*I))),+ +Ri(+(1-I))),Te=+lr(.5*((G=+pe[y>>3])-Te)),k=+lr(.5*((C=+pe[y+8>>3])-k)),M=+Yn(+G),k=2*+yl(+ +Ri(+(k=Te*Te+k*(ye*M*k))),+ +Ri(+(1-k))),G=+lr(.5*(ee-G)),C=+lr(.5*(X-C)),C=2*+yl(+ +Ri(+(C=G*G+C*(L*M*C))),+ +Ri(+(1-C))),4*+Uw(+ +Ri(+ +_d(.5*(M=.5*(I+k+C)))*+_d(.5*(M-I))*+_d(.5*(M-k))*+_d(.5*(M-C))))}function Bk(d,A){return A=0|Ct(0|(d|=0),0|(A|=0),45),De(),127&A|0}function Nk(d,A){d|=0;var y=0,C=0,M=0,k=0,I=0,L=0;if(!(!0&134217728==(-16777216&(A|=0)|0))||(I=0|Ct(0|d,0|A,45),De(),(I&=127)>>>0>121))return 0;y=0|Ct(0|d,0|A,52),De(),y&=15;do{if(0|y){for(M=1,C=0;;){if(k=0|Ct(0|d,0|A,3*(15-M|0)|0),De(),0!=(0|(k&=7))&(1^C)){if(1==(0|k)&0!=(0|yi(I))){L=0,C=13;break}C=1}if(7==(0|k)){L=0,C=13;break}if(!(M>>>0<y>>>0)){C=9;break}M=M+1|0}if(9==(0|C)){if(15!=(0|y))break;return 1}if(13==(0|C))return 0|L}}while(0);for(;;){if(L=0|Ct(0|d,0|A,3*(14-y|0)|0),De(),!(7==(7&L|0)&!0)){L=0,C=13;break}if(!(y>>>0<14)){L=1,C=13;break}y=y+1|0}return 13==(0|C)?0|L:0}function Xw(d,A,y){y|=0;var C=0,M=0;if(C=0|Ct(0|(d|=0),0|(A|=0),52),De(),(0|(C&=15))>=(0|y)){if((0|C)!=(0|y))if(y>>>0<=15){if(d|=M=0|Bt(0|y,0,52),A=0|De()|-15728641&A,(0|C)>(0|y))do{M=0|Bt(7,0,3*(14-y|0)|0),y=y+1|0,d|=M,A=0|De()|A}while((0|y)<(0|C))}else A=0,d=0}else A=0,d=0;return kn(0|A),0|d}function pa(d,A,y,C){y|=0,C|=0;var M=0,k=0,I=0,L=0,G=0,X=0,ee=0;if(I=0|Ct(0|(d|=0),0|(A|=0),52),De(),(0|y)<16&(0|(I&=15))<=(0|y)){if((0|I)==(0|y))return m[(y=C)>>2]=d,void(m[y+4>>2]=A);if(X=(0|(G=0|wv(7,y-I|0)))/7|0,L=0|Ct(0|d,0|A,45),De(),0|yi(127&L)){e:do{if(I)for(k=1;;){if(M=0|Ct(0|d,0|A,3*(15-k|0)|0),De(),0|(M&=7))break e;if(!(k>>>0<I>>>0)){M=0;break}k=k+1|0}else M=0}while(0);k=0==(0|M)}else k=0;if(ee=0|Bt(I+1|0,0,52),M=0|De()|-15728641&A,pa(A=(ee|d)&~(A=0|Bt(7,0,0|(L=3*(14-I|0)|0))),I=M&~(0|De()),y,C),M=C+(X<<3)|0,!k)return pa((ee=0|Bt(1,0,0|L))|A,0|De()|I,y,M),ee=M+(X<<3)|0,pa((G=0|Bt(2,0,0|L))|A,0|De()|I,y,ee),ee=ee+(X<<3)|0,pa((G=0|Bt(3,0,0|L))|A,0|De()|I,y,ee),ee=ee+(X<<3)|0,pa((G=0|Bt(4,0,0|L))|A,0|De()|I,y,ee),ee=ee+(X<<3)|0,pa((G=0|Bt(5,0,0|L))|A,0|De()|I,y,ee),void pa((G=0|Bt(6,0,0|L))|A,0|De()|I,y,ee+(X<<3)|0);k=M+(X<<3)|0,(0|G)>6&&(ac(0|M,0,8+(ee=(k>>>0>(G=M+8|0)>>>0?k:G)+-1+(0-M)|0)&-8|0),M=G+(ee>>>3<<3)|0),pa((ee=0|Bt(2,0,0|L))|A,0|De()|I,y,M),ee=M+(X<<3)|0,pa((G=0|Bt(3,0,0|L))|A,0|De()|I,y,ee),ee=ee+(X<<3)|0,pa((G=0|Bt(4,0,0|L))|A,0|De()|I,y,ee),ee=ee+(X<<3)|0,pa((G=0|Bt(5,0,0|L))|A,0|De()|I,y,ee),pa((G=0|Bt(6,0,0|L))|A,0|De()|I,y,ee+(X<<3)|0)}}function Eo(d,A){var y=0,C=0,M=0;if(M=0|Ct(0|(d|=0),0|(A|=0),45),De(),!(0|yi(127&M)))return 0;M=0|Ct(0|d,0|A,52),De(),M&=15;e:do{if(M)for(C=1;;){if(y=0|Ct(0|d,0|A,3*(15-C|0)|0),De(),0|(y&=7))break e;if(!(C>>>0<M>>>0)){y=0;break}C=C+1|0}else y=0}while(0);return 0|0==(0|y)&1}function ma(d,A){var y=0,C=0,M=0;if(M=0|Ct(0|(d|=0),0|(A|=0),52),De(),!(M&=15))return 0;for(C=1;;){if(y=0|Ct(0|d,0|A,3*(15-C|0)|0),De(),0|(y&=7)){C=5;break}if(!(C>>>0<M>>>0)){y=0,C=5;break}C=C+1|0}return 5==(0|C)?0|y:0}function Yw(d,A){var y=0,C=0,M=0,k=0,I=0,L=0,G=0;if(G=0|Ct(0|(d|=0),0|(A|=0),52),De(),!(G&=15))return G=d,kn(0|(L=A)),0|G;for(L=1,y=0;;){C=0|Bt(7,0,0|(k=3*(15-L|0)|0)),M=0|De(),I=0|Ct(0|d,0|A,0|k),De(),d=(k=0|Bt(0|of(7&I),0,0|k))|d&~C,A=(I=0|De())|A&~M;e:do{if(!y)if(0==(k&C|0)&0==(I&M|0))y=0;else if(C=0|Ct(0|d,0|A,52),De(),C&=15,C){y=1;t:for(;;){switch(I=0|Ct(0|d,0|A,3*(15-y|0)|0),De(),7&I){case 1:break t;case 0:break;default:y=1;break e}if(!(y>>>0<C>>>0)){y=1;break e}y=y+1|0}for(y=1;;){if(M=0|Ct(0|d,0|A,0|(I=3*(15-y|0)|0)),De(),k=0|Bt(7,0,0|I),A&=~(0|De()),d=d&~k|(I=0|Bt(0|of(7&M),0,0|I)),A=0|A|De(),!(y>>>0<C>>>0)){y=1;break}y=y+1|0}}else y=1}while(0);if(!(L>>>0<G>>>0))break;L=L+1|0}return kn(0|A),0|d}function vd(d,A){var y=0,C=0,M=0,k=0,I=0;if(C=0|Ct(0|(d|=0),0|(A|=0),52),De(),!(C&=15))return C=d,kn(0|(y=A)),0|C;for(y=1;I=0|Ct(0|d,0|A,0|(k=3*(15-y|0)|0)),De(),M=0|Bt(7,0,0|k),A&=~(0|De()),d=(k=0|Bt(0|of(7&I),0,0|k))|d&~M,A=0|De()|A,y>>>0<C>>>0;)y=y+1|0;return kn(0|A),0|d}function x7(d,A){var y=0,C=0,M=0,k=0,I=0,L=0,G=0;if(G=0|Ct(0|(d|=0),0|(A|=0),52),De(),!(G&=15))return G=d,kn(0|(L=A)),0|G;for(L=1,y=0;;){C=0|Bt(7,0,0|(k=3*(15-L|0)|0)),M=0|De(),I=0|Ct(0|d,0|A,0|k),De(),d=(k=0|Bt(0|yd(7&I),0,0|k))|d&~C,A=(I=0|De())|A&~M;e:do{if(!y)if(0==(k&C|0)&0==(I&M|0))y=0;else if(C=0|Ct(0|d,0|A,52),De(),C&=15,C){y=1;t:for(;;){switch(I=0|Ct(0|d,0|A,3*(15-y|0)|0),De(),7&I){case 1:break t;case 0:break;default:y=1;break e}if(!(y>>>0<C>>>0)){y=1;break e}y=y+1|0}for(y=1;;){if(k=0|Bt(7,0,0|(M=3*(15-y|0)|0)),I=A&~(0|De()),A=0|Ct(0|d,0|A,0|M),De(),d=d&~k|(A=0|Bt(0|yd(7&A),0,0|M)),A=0|I|De(),!(y>>>0<C>>>0)){y=1;break}y=y+1|0}}else y=1}while(0);if(!(L>>>0<G>>>0))break;L=L+1|0}return kn(0|A),0|d}function Kw(d,A){var y=0,C=0,M=0,k=0,I=0;if(C=0|Ct(0|(d|=0),0|(A|=0),52),De(),!(C&=15))return C=d,kn(0|(y=A)),0|C;for(y=1;k=0|Bt(7,0,0|(I=3*(15-y|0)|0)),M=A&~(0|De()),A=0|Ct(0|d,0|A,0|I),De(),d=(A=0|Bt(0|yd(7&A),0,0|I))|d&~k,A=0|De()|M,y>>>0<C>>>0;)y=y+1|0;return kn(0|A),0|d}function vl(d){return 0|(0|(d|=0))%2}function zk(d,A){var y,C;return d|=0,C=me,me=me+16|0,y=C,(A|=0)>>>0<=15&&2146435072!=(2146435072&m[d+4>>2]|0)&&2146435072!=(2146435072&m[d+8+4>>2]|0)?(function(d,A,y){var C,M;C=me,me=me+16|0,function(d,A,y,C){A|=0,y|=0,C|=0;var G,M=0,k=0,I=0,L=0;if(G=me,me=me+32|0,function(d,A){A|=0;var C,M,y=0;C=+Yn(+(y=+pe[(d|=0)>>3])),y=+lr(+y),pe[A+16>>3]=y,M=C*+Yn(+(y=+pe[d+8>>3])),pe[A>>3]=M,y=C*+lr(+y),pe[A+8>>3]=y}(d|=0,k=G),m[y>>2]=0,M=+po(15888,k),(I=+po(15912,k))<M&&(m[y>>2]=1,M=I),(I=+po(15936,k))<M&&(m[y>>2]=2,M=I),(I=+po(15960,k))<M&&(m[y>>2]=3,M=I),(I=+po(15984,k))<M&&(m[y>>2]=4,M=I),(I=+po(16008,k))<M&&(m[y>>2]=5,M=I),(I=+po(16032,k))<M&&(m[y>>2]=6,M=I),(I=+po(16056,k))<M&&(m[y>>2]=7,M=I),(I=+po(16080,k))<M&&(m[y>>2]=8,M=I),(I=+po(16104,k))<M&&(m[y>>2]=9,M=I),(I=+po(16128,k))<M&&(m[y>>2]=10,M=I),(I=+po(16152,k))<M&&(m[y>>2]=11,M=I),(I=+po(16176,k))<M&&(m[y>>2]=12,M=I),(I=+po(16200,k))<M&&(m[y>>2]=13,M=I),(I=+po(16224,k))<M&&(m[y>>2]=14,M=I),(I=+po(16248,k))<M&&(m[y>>2]=15,M=I),(I=+po(16272,k))<M&&(m[y>>2]=16,M=I),(I=+po(16296,k))<M&&(m[y>>2]=17,M=I),(I=+po(16320,k))<M&&(m[y>>2]=18,M=I),(I=+po(16344,k))<M&&(m[y>>2]=19,M=I),(I=+_j(+(1-.5*M)))<1e-16)return m[C>>2]=0,m[C+4>>2]=0,m[C+8>>2]=0,m[C+12>>2]=0,void(me=G);if(M=+x0((M=+pe[16368+(24*(y=0|m[y>>2])|0)>>3])-+x0(+function(d,A){var y,C,M,k,I;return d|=0,I=(C=+Yn(+(k=+pe[(A|=0)>>3])))*+lr(+(M=+pe[A+8>>3]-+pe[d+8>>3])),y=+pe[d>>3],+ +yl(+I,+(+lr(+k)*+Yn(+y)-+Yn(+M)*(C*+lr(+y))))}(15568+(y<<4)|0,d))),L=0|vl(A)?+x0(M+-.3334731722518321):M,M=+_d(+I)/.381966011250105,(0|A)>0){k=0;do{M*=2.6457513110645907,k=k+1|0}while((0|k)!=(0|A))}I=+Yn(+L)*M,pe[C>>3]=I,L=+lr(+L)*M,pe[C+8>>3]=L,me=G}(d|=0,A|=0,y|=0,M=C),function(d,A){d|=0;var k,G,X,ye,y=0,C=0,M=0,I=0,L=0,ee=0,Te=0;m[(ye=8+(A|=0)|0)>>2]=0,I=+ir(+(G=+pe[d>>3])),I+=.5*(L=+ir(+(X=+pe[d+8>>3]))/.8660254037844386),I-=+(0|(y=~~I)),L-=+(0|(d=~~L));do{if(I<.5){if(I<.3333333333333333){if(m[A>>2]=y,L<.5*(I+1)){m[A+4>>2]=d;break}m[A+4>>2]=d=d+1|0;break}if(m[A+4>>2]=d=(1&!(L<(Te=1-I)))+d|0,Te<=L&L<2*I){m[A>>2]=y=y+1|0;break}m[A>>2]=y;break}if(!(I<.6666666666666666)){if(m[A>>2]=y=y+1|0,L<.5*I){m[A+4>>2]=d;break}m[A+4>>2]=d=d+1|0;break}if(L<1-I){if(m[A+4>>2]=d,2*I-1<L){m[A>>2]=y;break}}else m[A+4>>2]=d=d+1|0;m[A>>2]=y=y+1|0}while(0);do{if(G<0){if(1&d){y=~~(+(0|y)-(2*(+((ee=0|C0(0|y,((0|y)<0)<<31>>31|0,0|(ee=(d+1|0)/2|0),((0|ee)<0)<<31>>31|0))>>>0)+4294967296*+(0|De()))+1)),m[A>>2]=y;break}y=~~(+(0|y)-2*(+((ee=0|C0(0|y,((0|y)<0)<<31>>31|0,0|(ee=(0|d)/2|0),((0|ee)<0)<<31>>31|0))>>>0)+4294967296*+(0|De()))),m[A>>2]=y;break}}while(0);ee=A+4|0,X<0&&(m[A>>2]=y=y-((1|d<<1)/2|0)|0,m[ee>>2]=d=0-d|0),C=d-y|0,(0|y)<0?(M=0-y|0,m[ee>>2]=C,m[ye>>2]=M,m[A>>2]=0,d=C,y=0):M=0,(0|d)<0&&(m[A>>2]=y=y-d|0,m[ye>>2]=M=M-d|0,m[ee>>2]=0,d=0),k=y-M|0,C=d-M|0,(0|M)<0&&(m[A>>2]=k,m[ee>>2]=C,m[ye>>2]=0,d=C,y=k,M=0),!((0|(C=(0|M)<(0|(C=(0|d)<(0|y)?d:y))?M:C))<=0)&&(m[A>>2]=y-C,m[ee>>2]=d-C,m[ye>>2]=M-C)}(M,y+4|0),me=C}(d,A,y),A=0|function(d,A){d|=0;var G,y=0,C=0,M=0,k=0,I=0,L=0,X=0,ee=0;if(G=me,me=me+64|0,L=G+40|0,C=G+24|0,M=G+12|0,k=G,Bt(0|(A|=0),0,52),y=134225919|De(),!A)return(0|m[d+4>>2])>2||(0|m[d+8>>2])>2||(0|m[d+12>>2])>2?(L=0,kn(0|(I=0)),me=G,0|L):(Bt(0|bk(d),0,45),I=0|De()|y,L=-1,kn(0|I),me=G,0|L);if(m[L>>2]=m[d>>2],m[L+4>>2]=m[d+4>>2],m[L+8>>2]=m[d+8>>2],m[L+12>>2]=m[d+12>>2],I=L+4|0,(0|A)>0)for(d=-1;m[C>>2]=m[I>>2],m[C+4>>2]=m[I+4>>2],m[C+8>>2]=m[I+8>>2],1&A?(Mk(I),m[M>>2]=m[I>>2],m[M+4>>2]=m[I+4>>2],m[M+8>>2]=m[I+8>>2],vv(M)):(Ww(I),m[M>>2]=m[I>>2],m[M+4>>2]=m[I+4>>2],m[M+8>>2]=m[I+8>>2],rf(M)),Zw(C,M,k),ps(k),X=0|Bt(7,0,0|(ee=3*(15-A|0)|0)),y&=~(0|De()),d=(ee=0|Bt(0|yv(k),0,0|ee))|d&~X,y=0|De()|y,(0|A)>1;)A=A+-1|0;else d=-1;e:do{if((0|m[I>>2])<=2&&(0|m[L+8>>2])<=2&&(0|m[L+12>>2])<=2){if(A=0|Bt(0|(C=0|bk(L)),0,45),A|=d,d=0|De()|-1040385&y,k=0|Nj(L),!(0|yi(C))){if((0|k)<=0)break;for(M=0;;){if(C=0|Ct(0|A,0|d,52),De(),C&=15)for(y=1;L=0|Ct(0|A,0|d,0|(ee=3*(15-y|0)|0)),De(),X=0|Bt(7,0,0|ee),d&=~(0|De()),A=A&~X|(ee=0|Bt(0|of(7&L),0,0|ee)),d=0|d|De(),y>>>0<C>>>0;)y=y+1|0;if((0|(M=M+1|0))==(0|k))break e}}M=0|Ct(0|A,0|d,52),De(),M&=15;t:do{if(M){y=1;n:for(;;){switch(ee=0|Ct(0|A,0|d,3*(15-y|0)|0),De(),7&ee){case 1:break n;case 0:break;default:break t}if(!(y>>>0<M>>>0))break t;y=y+1|0}if(0|wk(C,0|m[L>>2]))for(y=1;X=0|Bt(7,0,0|(L=3*(15-y|0)|0)),ee=d&~(0|De()),d=0|Ct(0|A,0|d,0|L),De(),A=A&~X|(d=0|Bt(0|yd(7&d),0,0|L)),d=0|ee|De(),y>>>0<M>>>0;)y=y+1|0;else for(y=1;L=0|Ct(0|A,0|d,0|(ee=3*(15-y|0)|0)),De(),X=0|Bt(7,0,0|ee),d&=~(0|De()),A=A&~X|(ee=0|Bt(0|of(7&L),0,0|ee)),d=0|d|De(),y>>>0<M>>>0;)y=y+1|0}}while(0);if((0|k)>0){y=0;do{A=0|Yw(A,d),d=0|De(),y=y+1|0}while((0|y)!=(0|k))}}else A=0,d=0}while(0);return ee=A,kn(0|(X=d)),me=G,0|ee}(y,A),d=0|De()):(d=0,A=0),kn(0|d),me=C,0|A}function Jw(d,A,y){var M,C=0,k=0,I=0;if(M=4+(y|=0)|0,k=0|Ct(0|(d|=0),0|(A|=0),52),De(),k&=15,I=0|Ct(0|d,0|A,45),De(),C=0==(0|k),0|yi(127&I)){if(C)return 1;C=1}else{if(C)return 0;C=0==(0|m[M>>2])&&0==(0|m[y+8>>2])?0!=(0|m[y+12>>2])&1:1}for(y=1;1&y?vv(M):rf(M),I=0|Ct(0|d,0|A,3*(15-y|0)|0),De(),Sk(M,7&I),y>>>0<k>>>0;)y=y+1|0;return 0|C}function w0(d,A,y){y|=0;var G,ee,C=0,M=0,k=0,I=0,L=0,X=0;ee=me,me=me+16|0,G=ee,X=0|Ct(0|(d|=0),0|(A|=0),45),De(),X&=127;e:do{if(0!=(0|yi(X))&&(k=0|Ct(0|d,0|A,52),De(),k&=15,0!=(0|k))){C=1;t:for(;;){switch(L=0|Ct(0|d,0|A,3*(15-C|0)|0),De(),7&L){case 5:break t;case 0:break;default:C=A;break e}if(!(C>>>0<k>>>0)){C=A;break e}C=C+1|0}for(M=1,C=A;I=0|Bt(7,0,0|(A=3*(15-M|0)|0)),L=C&~(0|De()),C=0|Ct(0|d,0|C,0|A),De(),d=d&~I|(C=0|Bt(0|yd(7&C),0,0|A)),C=0|L|De(),M>>>0<k>>>0;)M=M+1|0}else C=A}while(0);if(m[y>>2]=m[(L=7728+(28*X|0)|0)>>2],m[y+4>>2]=m[L+4>>2],m[y+8>>2]=m[L+8>>2],m[y+12>>2]=m[L+12>>2],0|Jw(d,C,y)){if(m[G>>2]=m[(I=y+4|0)>>2],m[G+4>>2]=m[I+4>>2],m[G+8>>2]=m[I+8>>2],k=0|Ct(0|d,0|C,52),De(),L=15&k,1&k?(rf(I),k=L+1|0):k=L,0|yi(X)){e:do{if(L)for(A=1;;){if(M=0|Ct(0|d,0|C,3*(15-A|0)|0),De(),0|(M&=7)){C=M;break e}if(!(A>>>0<L>>>0)){C=0;break}A=A+1|0}else C=0}while(0);C=4==(0|C)&1}else C=0;if(0|nm(y,k,C,0)){if(0|yi(X))do{}while(0!=(0|nm(y,k,0,0)));(0|k)!=(0|L)&&Ww(I)}else(0|k)!=(0|L)&&(m[I>>2]=m[G>>2],m[I+4>>2]=m[G+4>>2],m[I+8>>2]=m[G+8>>2]);me=ee}else me=ee}function sf(d,A,y){var C,M;y|=0,C=me,me=me+16|0,w0(d|=0,A|=0,M=C),A=0|Ct(0|d,0|A,52),De(),function(d,A,y){var C,M;A|=0,y|=0,C=me,me=me+16|0,nf(4+(d|=0)|0,M=C),v0(M,0|m[d>>2],A,0,y),me=C}(M,15&A,y),me=C}function af(d,A,y){y|=0;var k,I,C=0,M=0;I=me,me=me+16|0,w0(d|=0,A|=0,k=I),C=0|Ct(0|d,0|A,45),De(),C=0==(0|yi(127&C)),M=0|Ct(0|d,0|A,52),De(),M&=15;e:do{if(!C){if(0|M)for(C=1;;){if(!(0==((0|Bt(7,0,3*(15-C|0)|0))&d|0)&0==((0|De())&A|0)))break e;if(!(C>>>0<M>>>0))break;C=C+1|0}return Rk(k,M,0,5,y),void(me=I)}}while(0);Ok(k,M,0,6,y),me=I}function e2(d,A){A|=0;var L,y=0,C=0,M=0,k=0,I=0,G=0;if(Bt(0|(d|=0),0,52),L=134225919|De(),(0|d)<1){C=0,y=0;do{0|yi(C)&&(Bt(0|C,0,45),I=0|L|De(),m[(d=A+(y<<3)|0)>>2]=-1,m[d+4>>2]=I,y=y+1|0),C=C+1|0}while(122!=(0|C))}else{I=0,y=0;do{if(0|yi(I)){for(Bt(0|I,0,45),C=1,M=-1,k=0|L|De();M&=~(G=0|Bt(7,0,3*(15-C|0)|0)),k&=~(0|De()),(0|C)!=(0|d);)C=C+1|0;m[(G=A+(y<<3)|0)>>2]=M,m[G+4>>2]=k,y=y+1|0}I=I+1|0}while(122!=(0|I))}}function Uk(d,A,y,C){var L,M=0,k=0,I=0,G=0,X=0;if(L=me,me=me+64|0,I=L,(0|(d|=0))==(0|(y|=0))&(0|(A|=0))==(0|(C|=0))|!1|134217728!=(2013265920&A|0)|!1|134217728!=(2013265920&C|0)||(M=0|Ct(0|d,0|A,52),De(),M&=15,k=0|Ct(0|y,0|C,52),De(),(0|M)!=(15&k|0)))return me=L,0;if(k=M+-1|0,M>>>0>1&&(X=0|Xw(d,A,k),G=0|De(),(0|X)==(0|(k=0|Xw(y,C,k)))&(0|G)==(0|De()))&&(M=0|Ct(0|d,0|A,0|(k=3*(15^M)|0)),De(),M&=7,k=0|Ct(0|y,0|C,0|k),De(),0==(0|M)|0==(0|(k&=7))||(0|m[21136+(M<<2)>>2])==(0|k)||(0|m[21168+(M<<2)>>2])==(0|k)))return me=L,1;k=(M=I)+56|0;do{m[M>>2]=0,M=M+4|0}while((0|M)<(0|k));return vk(d,A,1,I),M=(0|m[(X=I)>>2])==(0|y)&&(0|m[X+4>>2])==(0|C)||(0|m[(X=I+8|0)>>2])==(0|y)&&(0|m[X+4>>2])==(0|C)||(0|m[(X=I+16|0)>>2])==(0|y)&&(0|m[X+4>>2])==(0|C)||(0|m[(X=I+24|0)>>2])==(0|y)&&(0|m[X+4>>2])==(0|C)||(0|m[(X=I+32|0)>>2])==(0|y)&&(0|m[X+4>>2])==(0|C)||(0|m[(X=I+40|0)>>2])==(0|y)&&(0|m[X+4>>2])==(0|C)?1:1&((0|m[(M=I+48|0)>>2])==(0|y)?(0|m[M+4>>2])==(0|C):0),me=L,0|M}function bv(d,A,y){y|=0;var M,k,I,L,C=0;if(I=me,me=me+16|0,k=I,C=0|Ct(0|(d|=0),0|(A|=0),56),De(),-1==(0|(A=0|function(d,A,y){y|=0;var C=0,M=0;return C=0|Eo(d|=0,A|=0),(y+-1|0)>>>0>5||1==(0|y)&(M=0!=(0|C))?0|(y=-1):(C=0|function(d,A){var M,k,X,y=0,C=0,I=0,L=0,G=0;if(X=me,me=me+32|0,k=X,w0(d|=0,A|=0,M=X+16|0),I=0|Bk(d,A),G=0|ma(d,A),function(d,A){m[(A|=0)>>2]=m[(d=7728+(28*(d|=0)|0)|0)>>2],m[A+4>>2]=m[d+4>>2],m[A+8>>2]=m[d+8>>2],m[A+12>>2]=m[d+12>>2]}(I,k),A=0|function(d,A){d|=0;var y=0,C=0;if((A|=0)>>>0>20)return-1;do{if((0|m[11152+(216*A|0)>>2])!=(0|d))if((0|m[11152+(216*A|0)+8>>2])!=(0|d))if((0|m[11152+(216*A|0)+16>>2])!=(0|d))if((0|m[11152+(216*A|0)+24>>2])!=(0|d))if((0|m[11152+(216*A|0)+32>>2])!=(0|d))if((0|m[11152+(216*A|0)+40>>2])!=(0|d))if((0|m[11152+(216*A|0)+48>>2])!=(0|d))if((0|m[11152+(216*A|0)+56>>2])!=(0|d))if((0|m[11152+(216*A|0)+64>>2])!=(0|d))if((0|m[11152+(216*A|0)+72>>2])!=(0|d))if((0|m[11152+(216*A|0)+80>>2])!=(0|d))if((0|m[11152+(216*A|0)+88>>2])!=(0|d))if((0|m[11152+(216*A|0)+96>>2])!=(0|d))if((0|m[11152+(216*A|0)+104>>2])!=(0|d))if((0|m[11152+(216*A|0)+112>>2])!=(0|d))if((0|m[11152+(216*A|0)+120>>2])!=(0|d))if((0|m[11152+(216*A|0)+128>>2])!=(0|d)){if((0|m[11152+(216*A|0)+136>>2])!=(0|d)){if((0|m[11152+(216*A|0)+144>>2])==(0|d)){d=0,y=2,C=0;break}if((0|m[11152+(216*A|0)+152>>2])==(0|d)){d=0,y=2,C=1;break}if((0|m[11152+(216*A|0)+160>>2])==(0|d)){d=0,y=2,C=2;break}if((0|m[11152+(216*A|0)+168>>2])==(0|d)){d=1,y=2,C=0;break}if((0|m[11152+(216*A|0)+176>>2])==(0|d)){d=1,y=2,C=1;break}if((0|m[11152+(216*A|0)+184>>2])==(0|d)){d=1,y=2,C=2;break}if((0|m[11152+(216*A|0)+192>>2])==(0|d)){d=2,y=2,C=0;break}if((0|m[11152+(216*A|0)+200>>2])==(0|d)){d=2,y=2,C=1;break}if((0|m[11152+(216*A|0)+208>>2])==(0|d)){d=2,y=2,C=2;break}return-1}d=2,y=1,C=2}else d=2,y=1,C=1;else d=2,y=1,C=0;else d=1,y=1,C=2;else d=1,y=1,C=1;else d=1,y=1,C=0;else d=0,y=1,C=2;else d=0,y=1,C=1;else d=0,y=1,C=0;else d=2,y=0,C=2;else d=2,y=0,C=1;else d=2,y=0,C=0;else d=1,y=0,C=2;else d=1,y=0,C=1;else d=1,y=0,C=0;else d=0,y=0,C=2;else d=0,y=0,C=1;else d=0,y=0,C=0}while(0);return 0|m[11152+(216*A|0)+(72*y|0)+(24*d|0)+(C<<3)+4>>2]}(I,0|m[M>>2]),!(0|yi(I)))return me=X,0|A;switch(0|I){case 4:d=0,y=14;break;case 14:d=1,y=14;break;case 24:d=2,y=14;break;case 38:d=3,y=14;break;case 49:d=4,y=14;break;case 58:d=5,y=14;break;case 63:d=6,y=14;break;case 72:d=7,y=14;break;case 83:d=8,y=14;break;case 97:d=9,y=14;break;case 107:d=10,y=14;break;case 117:d=11,y=14;break;default:L=0,C=0}return 14==(0|y)&&(L=0|m[22096+(24*d|0)+8>>2],C=0|m[22096+(24*d|0)+16>>2]),(0|(d=0|m[M>>2]))!=(0|m[k>>2])&&(I=0|Gw(I))|(0|(d=0|m[M>>2]))==(0|C)&&(A=(A+1|0)%6|0),3==(0|G)&(0|d)==(0|C)?(me=X,0|(G=(A+5|0)%6|0)):5==(0|G)&(0|d)==(0|L)?(me=X,0|(G=(A+1|0)%6|0)):(me=X,0|(G=A))}(d,A),M?0|(y=(5-C+(0|m[22384+(y<<2)>>2])|0)%5|0):0|(y=(6-C+(0|m[22416+(y<<2)>>2])|0)%6|0))}(M=(L=!0&268435456==(2013265920&A|0))?d:0,d=L?-2130706433&A|134217728:0,7&C))))return m[y>>2]=0,void(me=I);w0(M,d,k),C=0|Ct(0|M,0|d,52),De(),C&=15,0|Eo(M,d)?Rk(k,C,A,2,y):Ok(k,C,A,2,y),me=I}function k7(d){d|=0;var A,y,C=0;return(A=0|sc(1,12))||Or(22691,22646,49,22704),0|(C=0|m[(y=d+4|0)>>2])?(m[(C=C+8|0)>>2]=A,m[y>>2]=A,0|A):(0|m[d>>2]&&Or(22721,22646,61,22744),m[(C=d)>>2]=A,m[y>>2]=A,0|A)}function P7(d,A){var y,C;return d|=0,A|=0,(C=0|uu(24))||Or(22758,22646,78,22772),m[C>>2]=m[A>>2],m[C+4>>2]=m[A+4>>2],m[C+8>>2]=m[A+8>>2],m[C+12>>2]=m[A+12>>2],m[C+16>>2]=0,0|(y=0|m[(A=d+4|0)>>2])?(m[y+16>>2]=C,m[A>>2]=C,0|C):(0|m[d>>2]&&Or(22787,22646,82,22772),m[d>>2]=C,m[A>>2]=C,0|C)}function jk(d){var vr,oi,A=0,y=0,C=0,M=0,k=0,I=0,L=0,G=0,X=0,ee=0,ye=0,Te=0,ze=0,Ye=0,et=0,Dt=0,Nt=0,qe=0,yt=0,Ie=0,Vt=0,Ut=0,Rt=0,Lt=0,Rn=0,Lr=0,wr=0,Wr=0,si=0,bn=0;if(0|m[(M=8+(d|=0)|0)>>2])return 1;if(!(C=0|m[d>>2]))return 0;A=C,y=0;do{y=y+1|0,A=0|m[A+8>>2]}while(0!=(0|A));if(y>>>0<2)return 0;(oi=0|uu(y<<2))||Or(22807,22646,317,22826),(vr=0|uu(y<<5))||Or(22848,22646,321,22826),m[d>>2]=0,m[(Ut=d+4|0)>>2]=0,m[M>>2]=0,y=0,Wr=0,Vt=0,ye=0;e:for(;;){if(ee=0|m[C>>2]){k=0,I=ee;do{if(A=I,+ir(+((G=+pe[I+8>>3])-(L=+pe[(M=(X=0==(0|(I=0|m[I+16>>2])))?ee:I)+8>>3])))>3.141592653589793){bn=14;break}k+=(L-G)*(+pe[A>>3]+ +pe[M>>3])}while(!X);if(14==(0|bn)){bn=0,k=0,A=ee;do{k+=(+pe[A>>3]+ +pe[(Lr=0==(0|(Lr=0|m[(wr=A+16|0)>>2]))?ee:Lr)>>3])*(((yt=+pe[Lr+8>>3])<0?yt+6.283185307179586:yt)-((Ie=+pe[A+8>>3])<0?Ie+6.283185307179586:Ie)),A=0|m[(0==(0|A)?C:wr)>>2]}while(0!=(0|A))}k>0?(m[oi+(Wr<<2)>>2]=C,Wr=Wr+1|0,M=Vt,A=ye):bn=19}else bn=19;if(19==(0|bn)){bn=0;do{if(!y){if(ye){M=Ut,I=ye+8|0,A=C,y=d;break}if(0|m[d>>2]){bn=27;break e}M=Ut,I=d,A=C,y=d;break}if(0|m[(A=y+8|0)>>2]){bn=21;break e}if(!(y=0|sc(1,12))){bn=23;break e}m[A>>2]=y,M=y+4|0,I=y,A=ye}while(0);if(m[I>>2]=C,m[M>>2]=C,I=vr+(Vt<<5)|0,X=0|m[C>>2]){for(pe[(ee=vr+(Vt<<5)+8|0)>>3]=17976931348623157e292,pe[(ye=vr+(Vt<<5)+24|0)>>3]=17976931348623157e292,pe[I>>3]=-17976931348623157e292,pe[(Te=vr+(Vt<<5)+16|0)>>3]=-17976931348623157e292,Nt=17976931348623157e292,qe=-17976931348623157e292,M=0,ze=X,G=17976931348623157e292,et=17976931348623157e292,Dt=-17976931348623157e292,L=-17976931348623157e292;k=+pe[ze>>3],Ie=+pe[ze+8>>3],yt=+pe[((Ye=0==(0|(ze=0|m[ze+16>>2])))?X:ze)+8>>3],k<G&&(pe[ee>>3]=k,G=k),Ie<et&&(pe[ye>>3]=Ie,et=Ie),k>Dt?pe[I>>3]=k:k=Dt,Ie>L&&(pe[Te>>3]=Ie,L=Ie),Nt=Ie>0&Ie<Nt?Ie:Nt,qe=Ie<0&Ie>qe?Ie:qe,M|=+ir(+(Ie-yt))>3.141592653589793,!Ye;)Dt=k;M&&(pe[Te>>3]=qe,pe[ye>>3]=Nt)}else m[I>>2]=0,m[I+4>>2]=0,m[I+8>>2]=0,m[I+12>>2]=0,m[I+16>>2]=0,m[I+20>>2]=0,m[I+24>>2]=0,m[I+28>>2]=0;M=Vt+1|0}if(C=0|m[(wr=C+8|0)>>2],m[wr>>2]=0,!C){bn=45;break}Vt=M,ye=A}if(21==(0|bn))Or(22624,22646,35,22658);else if(23==(0|bn))Or(22678,22646,37,22658);else if(27==(0|bn))Or(22721,22646,61,22744);else if(45==(0|bn)){e:do{if((0|Wr)>0){for(wr=0==(0|M),Rn=M<<2,Lr=0==(0|d),Lt=0,A=0;;){if(Rt=0|m[oi+(Lt<<2)>>2],wr)bn=73;else{if(!(Vt=0|uu(Rn))){bn=50;break}if(!(Ut=0|uu(Rn))){bn=52;break}t:do{if(Lr)y=0;else{for(M=0,y=0,I=d;0|Gk(0|m[I>>2],C=vr+(M<<5)|0,0|m[Rt>>2])?(m[Vt+(y<<2)>>2]=I,m[Ut+(y<<2)>>2]=C,Ye=y+1|0):Ye=y,I=0|m[I+8>>2];)M=M+1|0,y=Ye;if((0|Ye)>0)if(C=0|m[Vt>>2],1==(0|Ye))y=C;else for(Te=0,ze=-1,y=C,ye=C;;){for(X=0|m[ye>>2],C=0,I=0;ee=(0|(M=0|m[m[Vt+(I<<2)>>2]>>2]))==(0|X)?C:C+(1&(0|Gk(M,0|m[Ut+(I<<2)>>2],0|m[X>>2])))|0,(0|(I=I+1|0))!=(0|Ye);)C=ee;if(y=(M=(0|ee)>(0|ze))?ye:y,(0|(C=Te+1|0))==(0|Ye))break t;Te=C,ze=M?ee:ze,ye=0|m[Vt+(C<<2)>>2]}else y=0}}while(0);if(Nn(Vt),Nn(Ut),y){if(C=0|m[(M=y+4|0)>>2])y=C+8|0;else if(0|m[y>>2]){bn=70;break}m[y>>2]=Rt,m[M>>2]=Rt}else bn=73}if(73==(0|bn)){if(bn=0,0|(A=0|m[Rt>>2]))do{Ut=A,A=0|m[A+16>>2],Nn(Ut)}while(0!=(0|A));Nn(Rt),A=2}if((0|(Lt=Lt+1|0))>=(0|Wr)){si=A;break e}}50==(0|bn)?Or(22863,22646,249,22882):52==(0|bn)?Or(22901,22646,252,22882):70==(0|bn)&&Or(22721,22646,61,22744)}else si=0}while(0);return Nn(oi),Nn(vr),0|si}return 0}function Gk(d,A,y){d|=0;var C=0,M=0,k=0,I=0,L=0,G=0,X=0,ee=0;if(!(0|Ek(A|=0,y|=0)&&(A=0|Ck(A),X=+pe[y>>3],C=+pe[y+8>>3],C=A&C<0?C+6.283185307179586:C,d=0|m[d>>2],d)))return 0;if(A){A=0,y=d;e:for(;;){for(;I=+pe[y>>3],G=+pe[y+8>>3],M=+pe[(ee=0==(0|(ee=0|m[(y=y+16|0)>>2]))?d:ee)+8>>3],I>(k=+pe[ee>>3])?(L=I,I=G):(L=k,k=I,I=M,M=G),X<k|X>L;)if(!(y=0|m[y>>2])){y=22;break e}if(C=(I=I<0?I+6.283185307179586:I)==C|(G=M<0?M+6.283185307179586:M)==C?C+-2220446049250313e-31:C,((G+=(X-k)/(L-k)*(I-G))<0?G+6.283185307179586:G)>C&&(A^=1),!(y=0|m[y>>2])){y=22;break}}if(22==(0|y))return 0|A}else{A=0,y=d;e:for(;;){for(;I=+pe[y>>3],G=+pe[y+8>>3],M=+pe[(ee=0==(0|(ee=0|m[(y=y+16|0)>>2]))?d:ee)+8>>3],I>(k=+pe[ee>>3])?(L=I,I=G):(L=k,k=I,I=M,M=G),X<k|X>L;)if(!(y=0|m[y>>2])){y=22;break e}if(M+(X-k)/(L-k)*(I-M)>(C=I==C|M==C?C+-2220446049250313e-31:C)&&(A^=1),!(y=0|m[y>>2])){y=22;break}}if(22==(0|y))return 0|A}return 0}function vh(d,A,y,C,M){y|=0,C|=0,M|=0;var ye,Te,Dt,qe,k=0,I=0,L=0,G=0,X=0,ee=0,ze=0,Ye=0,et=0,Nt=0;if(qe=me,me=me+32|0,Nt=qe+16|0,Dt=qe,k=0|Ct(0|(d|=0),0|(A|=0),52),De(),k&=15,ze=0|Ct(0|y,0|C,52),De(),(0|k)!=(15&ze|0))return me=qe,1;if(X=0|Ct(0|d,0|A,45),De(),X&=127,ee=0|Ct(0|y,0|C,45),De(),ze=(0|X)!=(0|(ee&=127))){if(7==(0|(L=0|Hw(X,ee))))return me=qe,2;7==(0|(G=0|Hw(ee,X)))?Or(22925,22949,151,22959):(Ye=L,I=G)}else Ye=0,I=0;ye=0|yi(X),Te=0|yi(ee),m[Nt>>2]=0,m[Nt+4>>2]=0,m[Nt+8>>2]=0,m[Nt+12>>2]=0;do{if(Ye){if(L=(0|(ee=0|m[4304+(28*X|0)+(Ye<<2)>>2]))>0,Te)if(L){X=0,G=y,L=C;do{G=0|x7(G,L),L=0|De(),1==(0|(I=0|yd(I)))&&(I=0|yd(1)),X=X+1|0}while((0|X)!=(0|ee));ee=I,X=G,G=L}else ee=I,X=y,G=C;else if(L){X=0,G=y,L=C;do{G=0|Kw(G,L),L=0|De(),I=0|yd(I),X=X+1|0}while((0|X)!=(0|ee));ee=I,X=G,G=L}else ee=I,X=y,G=C;if(Jw(X,G,Nt),ze||Or(22972,22949,181,22959),(L=0!=(0|ye))&(I=0!=(0|Te))&&Or(22999,22949,182,22959),L){if(I=0|ma(d,A),0|sn[22032+(7*I|0)+Ye>>0]){k=3;break}X=G=0|m[21200+(28*I|0)+(Ye<<2)>>2],et=26}else if(I){if(I=0|ma(X,G),0|sn[22032+(7*I|0)+ee>>0]){k=4;break}X=0,G=0|m[21200+(28*ee|0)+(I<<2)>>2],et=26}else I=0;if(26==(0|et))if((0|G)<=-1&&Or(23030,22949,212,22959),(0|X)<=-1&&Or(23053,22949,213,22959),(0|G)>0){L=Nt+4|0,I=0;do{xv(L),I=I+1|0}while((0|I)!=(0|G));I=X}else I=X;if(m[Dt>>2]=0,m[Dt+4>>2]=0,m[Dt+8>>2]=0,Sk(Dt,Ye),0|k)for(;0|vl(k)?vv(Dt):rf(Dt),(0|k)>1;)k=k+-1|0;if((0|I)>0){k=0;do{xv(Dt),k=k+1|0}while((0|k)!=(0|I))}Gs(et=Nt+4|0,Dt,et),ps(et),et=50}else if(Jw(y,C,Nt),0!=(0|ye)&0!=(0|Te))if((0|ee)!=(0|X)&&Or(23077,22949,243,22959),I=0|ma(d,A),k=0|ma(y,C),0|sn[22032+(7*I|0)+k>>0])k=5;else if((0|(I=0|m[21200+(28*I|0)+(k<<2)>>2]))>0){L=Nt+4|0,k=0;do{xv(L),k=k+1|0}while((0|k)!=(0|I));et=50}else et=50;else et=50}while(0);return 50==(0|et)&&(m[M>>2]=m[(k=Nt+4|0)>>2],m[M+4>>2]=m[k+4>>2],m[M+8>>2]=m[k+8>>2],k=0),me=qe,0|k}function $k(d,A,y,C){y|=0,C|=0;var ee,Ye,M=0,k=0,I=0,L=0,G=0,X=0,ye=0,Te=0,ze=0,et=0,Dt=0,Nt=0,qe=0;if(Ye=me,me=me+48|0,I=Ye+36|0,L=Ye+24|0,G=Ye+12|0,X=Ye,k=0|Ct(0|(d|=0),0|(A|=0),52),De(),k&=15,Te=0|Ct(0|d,0|A,45),De(),ee=0|yi(Te&=127),Bt(0|k,0,52),Dt=134225919|De(),m[(et=C)>>2]=-1,m[et+4>>2]=Dt,!k)return(0|m[y>>2])>1||(0|m[y+4>>2])>1||(0|m[y+8>>2])>1||127==(0|(M=0|$w(Te,0|yv(y))))?(me=Ye,0|(Dt=1)):(ze=0|Bt(0|M,0,45),et=0|De(),et|=-1040385&m[(Te=C)+4>>2],m[(Dt=C)>>2]=m[Te>>2]|ze,m[Dt+4>>2]=et,me=Ye,0|(Dt=0));for(m[I>>2]=m[y>>2],m[I+4>>2]=m[y+4>>2],m[I+8>>2]=m[y+8>>2];m[L>>2]=m[I>>2],m[L+4>>2]=m[I+4>>2],m[L+8>>2]=m[I+8>>2],0|vl(k)?(Mk(I),m[G>>2]=m[I>>2],m[G+4>>2]=m[I+4>>2],m[G+8>>2]=m[I+8>>2],vv(G)):(Ww(I),m[G>>2]=m[I>>2],m[G+4>>2]=m[I+4>>2],m[G+8>>2]=m[I+8>>2],rf(G)),Zw(L,G,X),ps(X),Nt=0|m[(et=C)>>2],et=0|m[et+4>>2],y=0|Bt(7,0,0|(qe=3*(15-k|0)|0)),et&=~(0|De()),qe=0|Bt(0|yv(X),0,0|qe),et=0|De()|et,m[(Dt=C)>>2]=qe|Nt&~y,m[Dt+4>>2]=et,(0|k)>1;)k=k+-1|0;e:do{if((0|m[I>>2])<=1&&(0|m[I+4>>2])<=1&&(0|m[I+8>>2])<=1){X=127==(0|(L=0|$w(Te,k=0|yv(I))))?0:0|yi(L);t:do{if(k){if(ee){if(I=21408+(28*(0|ma(d,A))|0)+(k<<2)|0,(0|(I=0|m[I>>2]))>0){y=0;do{k=0|of(k),y=y+1|0}while((0|y)!=(0|I))}if(1==(0|k)){M=3;break e}127==(0|(y=0|$w(Te,k)))&&Or(23104,22949,376,23134),0|yi(y)?Or(23147,22949,377,23134):(ze=I,ye=k,M=y)}else ze=0,ye=k,M=L;if((0|(G=0|m[4304+(28*Te|0)+(ye<<2)>>2]))<=-1&&Or(23178,22949,384,23134),!X){if((0|ze)<=-1&&Or(23030,22949,417,23134),0|ze){k=0,y=0|m[(I=C)>>2],I=0|m[I+4>>2];do{y=0|vd(y,I),I=0|De(),m[(qe=C)>>2]=y,m[qe+4>>2]=I,k=k+1|0}while((0|k)<(0|ze))}if((0|G)<=0){k=54;break}for(k=0,y=0|m[(I=C)>>2],I=0|m[I+4>>2];;)if(y=0|vd(y,I),I=0|De(),m[(qe=C)>>2]=y,m[qe+4>>2]=I,(0|(k=k+1|0))==(0|G)){k=54;break t}}if(7==(0|(L=0|Hw(M,Te)))&&Or(22925,22949,393,23134),y=0|m[(k=C)>>2],k=0|m[k+4>>2],(0|G)>0){I=0;do{y=0|vd(y,k),k=0|De(),m[(qe=C)>>2]=y,m[qe+4>>2]=k,I=I+1|0}while((0|I)!=(0|G))}if(y=0|ma(y,k),qe=0|Gw(M),(0|(y=0|m[(qe?21824:21616)+(28*L|0)+(y<<2)>>2]))<=-1&&Or(23030,22949,412,23134),y){k=0,I=0|m[(L=C)>>2],L=0|m[L+4>>2];do{I=0|Yw(I,L),L=0|De(),m[(qe=C)>>2]=I,m[qe+4>>2]=L,k=k+1|0}while((0|k)<(0|y));k=54}else k=54}else if(0!=(0|ee)&0!=(0|X))if(qe=0|ma(d,A),k=C,k=21408+(28*qe|0)+((0|ma(0|m[k>>2],0|m[k+4>>2]))<<2)|0,k=0|m[k>>2],(0|k)<=-1&&Or(23201,22949,433,23134),k){M=0,y=0|m[(I=C)>>2],I=0|m[I+4>>2];do{y=0|vd(y,I),I=0|De(),m[(qe=C)>>2]=y,m[qe+4>>2]=I,M=M+1|0}while((0|M)<(0|k));M=L,k=54}else M=L,k=55;else M=L,k=54}while(0);if(54==(0|k)&&X&&(k=55),55==(0|k)&&1==(0|ma(0|m[(qe=C)>>2],0|m[qe+4>>2]))){M=4;break}Dt=0|m[(qe=C)>>2],qe=-1040385&m[qe+4>>2],Nt=0|Bt(0|M,0,45),qe=0|qe|De(),m[(M=C)>>2]=Dt|Nt,m[M+4>>2]=qe,M=0}else M=2}while(0);return me=Ye,0|M}function wv(d,A){var y=0;if(!(A|=0))return 1;y=d|=0,d=1;do{d=0|yh(0==(1&A|0)?1:y,d),A>>=1,y=0|yh(y,y)}while(0!=(0|A));return 0|d}function Hk(d,A,y){d|=0;var ee,C=0,M=0,k=0,I=0,L=0,G=0,X=0,ye=0,Te=0;if(!(0|Ek(A|=0,y|=0))||(A=0|Ck(A),Te=+pe[y>>3],C=A&(C=+pe[y+8>>3])<0?C+6.283185307179586:C,(0|(ye=0|m[d>>2]))<=0))return 0;if(ee=0|m[d+4>>2],A){A=0,y=-1,d=0;e:for(;;){for(X=d;G=+pe[ee+(X<<4)+8>>3],M=+pe[ee+((d=(y+2|0)%(0|ye)|0)<<4)+8>>3],(I=+pe[ee+(X<<4)>>3])>(k=+pe[ee+(d<<4)>>3])?(L=I,I=G):(L=k,k=I,I=M,M=G),Te<k|Te>L;){if(!((0|(y=X+1|0))<(0|ye))){y=22;break e}d=X,X=y,y=d}if(C=(I=I<0?I+6.283185307179586:I)==C|(G=M<0?M+6.283185307179586:M)==C?C+-2220446049250313e-31:C,((G+=(Te-k)/(L-k)*(I-G))<0?G+6.283185307179586:G)>C&&(A^=1),(0|(d=X+1|0))>=(0|ye)){y=22;break}y=X}if(22==(0|y))return 0|A}else{A=0,y=-1,d=0;e:for(;;){for(X=d;G=+pe[ee+(X<<4)+8>>3],M=+pe[ee+((d=(y+2|0)%(0|ye)|0)<<4)+8>>3],(I=+pe[ee+(X<<4)>>3])>(k=+pe[ee+(d<<4)>>3])?(L=I,I=G):(L=k,k=I,I=M,M=G),Te<k|Te>L;){if(!((0|(y=X+1|0))<(0|ye))){y=22;break e}d=X,X=y,y=d}if(M+(Te-k)/(L-k)*(I-M)>(C=I==C|M==C?C+-2220446049250313e-31:C)&&(A^=1),(0|(d=X+1|0))>=(0|ye)){y=22;break}y=X}if(22==(0|y))return 0|A}return 0}function t2(d,A){A|=0;var Ye,et,Dt,Nt,y=0,C=0,M=0,k=0,I=0,L=0,G=0,X=0,ee=0,ye=0,Te=0,ze=0,qe=0;if(!(Ye=0|m[(d|=0)>>2]))return m[A>>2]=0,m[A+4>>2]=0,m[A+8>>2]=0,m[A+12>>2]=0,m[A+16>>2]=0,m[A+20>>2]=0,m[A+24>>2]=0,void(m[A+28>>2]=0);if(pe[(et=A+8|0)>>3]=17976931348623157e292,pe[(Dt=A+24|0)>>3]=17976931348623157e292,pe[A>>3]=-17976931348623157e292,pe[(Nt=A+16|0)>>3]=-17976931348623157e292,!((0|Ye)<=0)){for(Te=0|m[d+4>>2],X=17976931348623157e292,ee=-17976931348623157e292,ye=0,d=-1,k=17976931348623157e292,I=17976931348623157e292,G=-17976931348623157e292,C=-17976931348623157e292,ze=0;L=+pe[Te+(ze<<4)+8>>3],M=+pe[Te+(((0|(d=d+2|0))==(0|Ye)?0:d)<<4)+8>>3],(y=+pe[Te+(ze<<4)>>3])<k&&(pe[et>>3]=y,k=y),L<I&&(pe[Dt>>3]=L,I=L),y>G?pe[A>>3]=y:y=G,L>C&&(pe[Nt>>3]=L,C=L),X=L>0&L<X?L:X,ee=L<0&L>ee?L:ee,ye|=+ir(+(L-M))>3.141592653589793,(0|(d=ze+1|0))!=(0|Ye);)qe=ze,G=y,ze=d,d=qe;!ye||(pe[Nt>>3]=ee,pe[Dt>>3]=X)}}function V7(d,A,y){var C=0,M=0;if(!(0|Hk(d|=0,A|=0,y|=0)))return 0;if((0|m[(M=d+8|0)>>2])<=0)return 1;for(C=d+12|0,d=0;;){if(0|Hk((0|m[C>>2])+(d<<3)|0,A+((d=d+1|0)<<5)|0,y)){d=0,C=6;break}if((0|d)>=(0|m[M>>2])){d=1,C=6;break}}return 6==(0|C)?0|d:0}function qk(d,A,y,C,M){var I,L,G,X,ee,ye,Te,k=0;pe[(M|=0)>>3]=(X=+pe[(d|=0)>>3])+(G=+pe[(A|=0)>>3]-X)*(k=((k=+pe[(C|=0)>>3]-(ye=+pe[(y|=0)>>3]))*((L=+pe[d+8>>3])-(Te=+pe[y+8>>3]))-(X-ye)*(ee=+pe[C+8>>3]-Te))/(G*ee-(I=+pe[A+8>>3]-L)*k)),pe[M+8>>3]=L+I*k}function Zk(d,A){return+pe[(d|=0)>>3]!=+pe[(A|=0)>>3]?0|(A=0):0|(A=+pe[d+8>>3]==+pe[A+8>>3])}function po(d,A){var y,C,M;return+((M=+pe[(d|=0)>>3]-+pe[(A|=0)>>3])*M+(C=+pe[d+8>>3]-+pe[A+8>>3])*C+(y=+pe[d+16>>3]-+pe[A+16>>3])*y)}function Wk(d,A,y){d|=0,y|=0;var C=0;(0|(A|=0))>0?(C=0|sc(A,4),m[d>>2]=C,C||Or(23230,23253,40,23267)):m[d>>2]=0,m[d+4>>2]=A,m[d+8>>2]=0,m[d+12>>2]=y}function Qk(d){var M,k,I,A=0,y=0,C=0,L=0;M=4+(d|=0)|0,k=d+12|0,I=d+8|0;e:for(;;){for(y=0|m[M>>2],A=0;;){if((0|A)>=(0|y))break e;if(L=0|m[(C=0|m[d>>2])+(A<<2)>>2])break;A=A+1|0}A=C+(~~(+ir(+ +_h(10,+ +(15-(0|m[k>>2])|0))*(+pe[L>>3]+ +pe[L+8>>3]))%+(0|y))>>>0<<2)|0,y=0|m[A>>2];t:do{if(0|y){if(C=L+32|0,(0|y)==(0|L))m[A>>2]=m[C>>2];else{if(!(A=0|m[(y=y+32|0)>>2]))break;for(;(0|A)!=(0|L);)if(!(A=0|m[(y=A+32|0)>>2]))break t;m[y>>2]=m[C>>2]}Nn(L),m[I>>2]=(0|m[I>>2])-1}}while(0)}Nn(0|m[d>>2])}function Xk(d){var C,A=0,y=0;for(C=0|m[4+(d|=0)>>2],y=0;;){if((0|y)>=(0|C)){A=0,y=4;break}if(A=0|m[(0|m[d>>2])+(y<<2)>>2]){y=4;break}y=y+1|0}return 4==(0|y)?0|A:0}function Yk(d,A){A|=0;var y=0,C=0,M=0,k=0;if(y=~~(+ir(+ +_h(10,+ +(15-(0|m[12+(d|=0)>>2])|0))*(+pe[A>>3]+ +pe[A+8>>3]))%+(0|m[d+4>>2]))>>>0,!(C=0|m[(y=(0|m[d>>2])+(y<<2)|0)>>2]))return 1;k=A+32|0;do{if((0|C)!=(0|A)){if(!(y=0|m[C+32>>2]))return 1;for(M=y;;){if((0|M)==(0|A)){M=8;break}if(!(y=0|m[M+32>>2])){y=1,M=10;break}C=M,M=y}if(8==(0|M)){m[C+32>>2]=m[k>>2];break}if(10==(0|M))return 0|y}else m[y>>2]=m[k>>2]}while(0);return Nn(A),m[(k=d+8|0)>>2]=(0|m[k>>2])-1,0}function K7(d,A,y){d|=0,A|=0,y|=0;var k,C=0,M=0,I=0;(k=0|uu(40))||Or(23283,23253,98,23296),m[k>>2]=m[A>>2],m[k+4>>2]=m[A+4>>2],m[k+8>>2]=m[A+8>>2],m[k+12>>2]=m[A+12>>2],m[(M=k+16|0)>>2]=m[y>>2],m[M+4>>2]=m[y+4>>2],m[M+8>>2]=m[y+8>>2],m[M+12>>2]=m[y+12>>2],m[k+32>>2]=0,M=~~(+ir(+ +_h(10,+ +(15-(0|m[d+12>>2])|0))*(+pe[A>>3]+ +pe[A+8>>3]))%+(0|m[d+4>>2]))>>>0,C=0|m[(M=(0|m[d>>2])+(M<<2)|0)>>2];do{if(C){for(;!(0|rm(C,A)&&0|rm(C+16|0,y));)if(!(0|m[(C=0==(0|(M=0|m[C+32>>2]))?C:M)+32>>2])){I=10;break}if(10==(0|I)){m[C+32>>2]=k;break}return Nn(k),0|C}m[M>>2]=k}while(0);return m[(I=d+8|0)>>2]=1+(0|m[I>>2]),0|k}function J7(d,A,y){A|=0,y|=0;var C=0,M=0;if(M=~~(+ir(+ +_h(10,+ +(15-(0|m[12+(d|=0)>>2])|0))*(+pe[A>>3]+ +pe[A+8>>3]))%+(0|m[d+4>>2]))>>>0,!(M=0|m[(0|m[d>>2])+(M<<2)>>2]))return 0;if(!y){for(d=M;;){if(0|rm(d,A)){C=10;break}if(!(d=0|m[d+32>>2])){d=0,C=10;break}}if(10==(0|C))return 0|d}for(d=M;;){if(0|rm(d,A)&&0|rm(d+16|0,y)){C=10;break}if(!(d=0|m[d+32>>2])){d=0,C=10;break}}return 10==(0|C)?0|d:0}function eG(d,A){A|=0;var y=0;if(y=~~(+ir(+ +_h(10,+ +(15-(0|m[12+(d|=0)>>2])|0))*(+pe[A>>3]+ +pe[A+8>>3]))%+(0|m[d+4>>2]))>>>0,!(d=0|m[(0|m[d>>2])+(y<<2)>>2]))return 0;for(;;){if(0|rm(d,A)){A=5;break}if(!(d=0|m[d+32>>2])){d=0,A=5;break}}return 5==(0|A)?0|d:0}function Cv(d){return 0|~~+function(d){return+ +eP(+(d=+d))}(d=+d)}function uu(d){d|=0;var Vt,A=0,y=0,C=0,M=0,k=0,I=0,L=0,G=0,X=0,ee=0,ye=0,Te=0,ze=0,Ye=0,et=0,Dt=0,Nt=0,qe=0,yt=0,Ie=0;Vt=me,me=me+16|0,Te=Vt;do{if(d>>>0<245){if(3&(y=(ye=0|m[5829])>>>(d=(X=d>>>0<11?16:d+11&-8)>>>3))|0)return(0|(k=0|m[(M=8+(C=0|m[(y=8+(d=23356+((A=(1&y^1)+d|0)<<1<<2)|0)|0)>>2])|0)>>2]))==(0|d)?m[5829]=ye&~(1<<A):(m[k+12>>2]=d,m[y>>2]=k),m[C+4>>2]=3|(Ie=A<<3),m[(Ie=C+Ie+4|0)>>2]=1|m[Ie>>2],me=Vt,0|M;if(X>>>0>(ee=0|m[5831])>>>0){if(0|y)return A=((A=y<<d&((A=2<<d)|0-A))&0-A)-1|0,(0|(y=0|m[(L=8+(k=0|m[(d=8+(A=23356+((C=((y=(A>>>=L=A>>>12&16)>>>5&8)|L|(k=(A>>>=y)>>>2&4)|(d=(A>>>=k)>>>1&2)|(C=(A>>>=d)>>>1&1))+(A>>>C)|0)<<1<<2)|0)|0)>>2])|0)>>2]))==(0|A)?m[5829]=d=ye&~(1<<C):(m[y+12>>2]=A,m[d>>2]=y,d=ye),I=(Ie=C<<3)-X|0,m[k+4>>2]=3|X,m[4+(M=k+X|0)>>2]=1|I,m[k+Ie>>2]=I,0|ee&&(C=0|m[5834],y=23356+((A=ee>>>3)<<1<<2)|0,d&(A=1<<A)?A=0|m[(d=y+8|0)>>2]:(m[5829]=d|A,A=y,d=y+8|0),m[d>>2]=C,m[A+12>>2]=C,m[C+8>>2]=A,m[C+12>>2]=y),m[5831]=I,m[5834]=M,me=Vt,0|L;if(k=0|m[5830]){for(y=(k&0-k)-1|0,y=G=0|m[23620+(((C=(y>>>=M=y>>>12&16)>>>5&8)|M|(I=(y>>>=C)>>>2&4)|(L=(y>>>=I)>>>1&2)|(G=(y>>>=L)>>>1&1))+(y>>>G)<<2)>>2],L=G,G=(-8&m[G+4>>2])-X|0;(d=0|m[y+16>>2])||(d=0|m[y+20>>2]);)y=d,L=(M=(I=(-8&m[d+4>>2])-X|0)>>>0<G>>>0)?d:L,G=M?I:G;if((I=L+X|0)>>>0>L>>>0){M=0|m[L+24>>2],A=0|m[L+12>>2];do{if((0|A)==(0|L)){if(!(A=0|m[(d=L+20|0)>>2])&&!(A=0|m[(d=L+16|0)>>2])){y=0;break}for(;;)if(y=0|m[(C=A+20|0)>>2])A=y,d=C;else{if(!(y=0|m[(C=A+16|0)>>2]))break;A=y,d=C}m[d>>2]=0,y=A}else m[12+(y=0|m[L+8>>2])>>2]=A,m[A+8>>2]=y,y=A}while(0);do{if(0|M){if((0|L)==(0|m[(d=23620+((A=0|m[L+28>>2])<<2)|0)>>2])){if(m[d>>2]=y,!y){m[5830]=k&~(1<<A);break}}else if(m[((0|m[(Ie=M+16|0)>>2])==(0|L)?Ie:M+20|0)>>2]=y,!y)break;m[y+24>>2]=M,0|(A=0|m[L+16>>2])&&(m[y+16>>2]=A,m[A+24>>2]=y),0|(A=0|m[L+20>>2])&&(m[y+20>>2]=A,m[A+24>>2]=y)}}while(0);return G>>>0<16?(m[L+4>>2]=3|(Ie=G+X|0),m[(Ie=L+Ie+4|0)>>2]=1|m[Ie>>2]):(m[L+4>>2]=3|X,m[I+4>>2]=1|G,m[I+G>>2]=G,0|ee&&(C=0|m[5834],y=23356+((A=ee>>>3)<<1<<2)|0,(A=1<<A)&ye?A=0|m[(d=y+8|0)>>2]:(m[5829]=A|ye,A=y,d=y+8|0),m[d>>2]=C,m[A+12>>2]=C,m[C+8>>2]=A,m[C+12>>2]=y),m[5831]=G,m[5834]=I),me=Vt,0|L+8}ye=X}else ye=X}else ye=X}else if(d>>>0<=4294967231)if(X=-8&(d=d+11|0),C=0|m[5830]){M=0-X|0,G=(d>>>=8)?X>>>0>16777215?31:X>>>(7+(G=14-((L=(520192+(et=d<<(ye=(d+1048320|0)>>>16&8))|0)>>>16&4)|ye|(G=(245760+(et<<=L)|0)>>>16&2))+(et<<G>>>15)|0)|0)&1|G<<1:0,y=0|m[23620+(G<<2)>>2];e:do{if(y)for(d=0,L=X<<(31==(0|G)?0:25-(G>>>1)|0),k=0;;){if((I=(-8&m[y+4>>2])-X|0)>>>0<M>>>0){if(!I){d=y,M=0,et=65;break e}d=y,M=I}if(k=0==(0|(et=0|m[y+20>>2]))|(0|et)==(0|(y=0|m[y+16+(L>>>31<<2)>>2]))?k:et,!y){y=k,et=61;break}L<<=1}else y=0,d=0,et=61}while(0);if(61==(0|et)){if(0==(0|y)&0==(0|d)){if(!(d=((d=2<<G)|0-d)&C)){ye=X;break}ye=(d&0-d)-1|0,d=0,y=0|m[23620+(((k=(ye>>>=I=ye>>>12&16)>>>5&8)|I|(L=(ye>>>=k)>>>2&4)|(G=(ye>>>=L)>>>1&2)|(y=(ye>>>=G)>>>1&1))+(ye>>>y)<<2)>>2]}y?et=65:(L=d,I=M)}if(65==(0|et))for(k=y;;){if(M=(y=(ye=(-8&m[k+4>>2])-X|0)>>>0<M>>>0)?ye:M,d=y?k:d,(y=0|m[k+16>>2])||(y=0|m[k+20>>2]),!y){L=d,I=M;break}k=y}if(0!=(0|L)&&I>>>0<((0|m[5831])-X|0)>>>0&&(ee=L+X|0)>>>0>L>>>0){k=0|m[L+24>>2],A=0|m[L+12>>2];do{if((0|A)==(0|L)){if(!(A=0|m[(d=L+20|0)>>2])&&!(A=0|m[(d=L+16|0)>>2])){A=0;break}for(;;)if(y=0|m[(M=A+20|0)>>2])A=y,d=M;else{if(!(y=0|m[(M=A+16|0)>>2]))break;A=y,d=M}m[d>>2]=0}else m[12+(Ie=0|m[L+8>>2])>>2]=A,m[A+8>>2]=Ie}while(0);do{if(k){if((0|L)==(0|m[(y=23620+((d=0|m[L+28>>2])<<2)|0)>>2])){if(m[y>>2]=A,!A){m[5830]=C&=~(1<<d);break}}else if(m[((0|m[(Ie=k+16|0)>>2])==(0|L)?Ie:k+20|0)>>2]=A,!A)break;m[A+24>>2]=k,0|(d=0|m[L+16>>2])&&(m[A+16>>2]=d,m[d+24>>2]=A),(d=0|m[L+20>>2])&&(m[A+20>>2]=d,m[d+24>>2]=A)}}while(0);e:do{if(I>>>0<16)Ie=I+X|0,m[L+4>>2]=3|Ie,Ie=L+Ie+4|0,m[Ie>>2]=1|m[Ie>>2];else{if(m[L+4>>2]=3|X,m[ee+4>>2]=1|I,m[ee+I>>2]=I,A=I>>>3,I>>>0<256){y=23356+(A<<1<<2)|0,(d=0|m[5829])&(A=1<<A)?A=0|m[(d=y+8|0)>>2]:(m[5829]=d|A,A=y,d=y+8|0),m[d>>2]=ee,m[A+12>>2]=ee,m[ee+8>>2]=A,m[ee+12>>2]=y;break}if(y=(A=I>>>8)?I>>>0>16777215?31:I>>>(7+(y=14-((qe=(520192+(Ie=A<<(yt=(A+1048320|0)>>>16&8))|0)>>>16&4)|yt|(y=(245760+(Ie<<=qe)|0)>>>16&2))+(Ie<<y>>>15)|0)|0)&1|y<<1:0,A=23620+(y<<2)|0,m[ee+28>>2]=y,m[4+(d=ee+16|0)>>2]=0,m[d>>2]=0,!(C&(d=1<<y))){m[5830]=C|d,m[A>>2]=ee,m[ee+24>>2]=A,m[ee+12>>2]=ee,m[ee+8>>2]=ee;break}A=0|m[A>>2];t:do{if((-8&m[A+4>>2]|0)!=(0|I)){for(C=I<<(31==(0|y)?0:25-(y>>>1)|0);d=0|m[(y=A+16+(C>>>31<<2)|0)>>2];){if((-8&m[d+4>>2]|0)==(0|I)){A=d;break t}C<<=1,A=d}m[y>>2]=ee,m[ee+24>>2]=A,m[ee+12>>2]=ee,m[ee+8>>2]=ee;break e}}while(0);m[12+(Ie=0|m[(yt=A+8|0)>>2])>>2]=ee,m[yt>>2]=ee,m[ee+8>>2]=Ie,m[ee+12>>2]=A,m[ee+24>>2]=0}}while(0);return me=Vt,0|L+8}ye=X}else ye=X;else ye=-1}while(0);if((y=0|m[5831])>>>0>=ye>>>0)return d=0|m[5834],(A=y-ye|0)>>>0>15?(m[5834]=Ie=d+ye|0,m[5831]=A,m[Ie+4>>2]=1|A,m[d+y>>2]=A,m[d+4>>2]=3|ye):(m[5831]=0,m[5834]=0,m[d+4>>2]=3|y,m[(Ie=d+y+4|0)>>2]=1|m[Ie>>2]),me=Vt,0|d+8;if((I=0|m[5832])>>>0>ye>>>0)return m[5832]=qe=I-ye|0,m[5835]=yt=(Ie=0|m[5835])+ye|0,m[yt+4>>2]=1|qe,m[Ie+4>>2]=3|ye,me=Vt,0|Ie+8;if(0|m[5947]?d=0|m[5949]:(m[5949]=4096,m[5948]=4096,m[5950]=-1,m[5951]=-1,m[5952]=0,m[5940]=0,m[5947]=-16&Te^1431655768,d=4096),L=ye+48|0,(X=(k=d+(G=ye+47|0)|0)&(M=0-d|0))>>>0<=ye>>>0||0|(d=0|m[5939])&&(Te=(ee=0|m[5937])+X|0)>>>0<=ee>>>0|Te>>>0>d>>>0)return me=Vt,0;e:do{if(4&m[5940])A=0,et=143;else{y=0|m[5835];t:do{if(y){for(C=23764;!((Te=0|m[C>>2])>>>0<=y>>>0&&(Te+(0|m[C+4>>2])|0)>>>0>y>>>0);){if(!(d=0|m[C+8>>2])){et=128;break t}C=d}if((A=k-I&M)>>>0<2147483647)if((0|(d=0|bd(0|A)))==((0|m[C>>2])+(0|m[C+4>>2])|0)){if(-1!=(0|d)){I=A,k=d,et=145;break e}}else C=d,et=136;else A=0}else et=128}while(0);do{if(128==(0|et))if(-1!=(0|(y=0|bd(0)))&&(Ye=(A=(0==((Ye=(ze=0|m[5948])-1|0)&(A=y)|0)?0:(Ye+A&0-ze)-A|0)+X|0)+(ze=0|m[5937])|0,A>>>0>ye>>>0&A>>>0<2147483647)){if(0|(Te=0|m[5939])&&Ye>>>0<=ze>>>0|Ye>>>0>Te>>>0){A=0;break}if((0|(d=0|bd(0|A)))==(0|y)){I=A,k=y,et=145;break e}C=d,et=136}else A=0}while(0);do{if(136==(0|et)){if(y=0-A|0,!(L>>>0>A>>>0&A>>>0<2147483647&-1!=(0|C))){if(-1==(0|C)){A=0;break}I=A,k=C,et=145;break e}if((d=G-A+(d=0|m[5949])&0-d)>>>0>=2147483647){I=A,k=C,et=145;break e}if(-1==(0|bd(0|d))){bd(0|y),A=0;break}I=d+A|0,k=C,et=145;break e}}while(0);m[5940]=4|m[5940],et=143}}while(0);if((143==(0|et)&&X>>>0<2147483647?!(-1==(0|(qe=0|bd(0|X)))|1^(Nt=(Dt=(Ye=0|bd(0))-qe|0)>>>0>(ye+40|0)>>>0)|qe>>>0<Ye>>>0&-1!=(0|qe)&-1!=(0|Ye)^1):0)&&(I=Nt?Dt:A,k=qe,et=145),145==(0|et)){m[5937]=A=(0|m[5937])+I|0,A>>>0>(0|m[5938])>>>0&&(m[5938]=A),G=0|m[5835];e:do{if(G){for(A=23764;;){if((0|k)==((d=0|m[A>>2])+(y=0|m[A+4>>2])|0)){et=154;break}if(!(C=0|m[A+8>>2]))break;A=C}if(154==(0|et)&&(yt=A+4|0,0==(8&m[A+12>>2]|0))&&k>>>0>G>>>0&d>>>0<=G>>>0){m[yt>>2]=y+I,yt=G+(qe=0==(7&(qe=G+8|0)|0)?0:0-qe&7)|0,qe=(Ie=(0|m[5832])+I|0)-qe|0,m[5835]=yt,m[5832]=qe,m[yt+4>>2]=1|qe,m[G+Ie+4>>2]=40,m[5836]=m[5951];break}for(k>>>0<(0|m[5833])>>>0&&(m[5833]=k),y=k+I|0,A=23764;;){if((0|m[A>>2])==(0|y)){et=162;break}if(!(d=0|m[A+8>>2]))break;A=d}if(162==(0|et)&&0==(8&m[A+12>>2]|0)){m[A>>2]=k,m[(ee=A+4|0)>>2]=(0|m[ee>>2])+I,X=(ee=k+(0==(7&(ee=k+8|0)|0)?0:0-ee&7)|0)+ye|0,L=(A=y+(0==(7&(A=y+8|0)|0)?0:0-A&7)|0)-ee-ye|0,m[ee+4>>2]=3|ye;t:do{if((0|G)==(0|A))Ie=(0|m[5832])+L|0,m[5832]=Ie,m[5835]=X,m[X+4>>2]=1|Ie;else{if((0|m[5834])==(0|A)){m[5831]=Ie=(0|m[5831])+L|0,m[5834]=X,m[X+4>>2]=1|Ie,m[X+Ie>>2]=Ie;break}if(1==(3&(d=0|m[A+4>>2])|0)){I=-8&d,C=d>>>3;n:do{if(d>>>0<256){if((0|(y=0|m[A+12>>2]))==(0|(d=0|m[A+8>>2]))){m[5829]=m[5829]&~(1<<C);break}m[d+12>>2]=y,m[y+8>>2]=d;break}k=0|m[A+24>>2],d=0|m[A+12>>2];do{if((0|d)==(0|A)){if(d=0|m[(C=4+(y=A+16|0)|0)>>2])y=C;else if(!(d=0|m[y>>2])){d=0;break}for(;;)if(C=0|m[(M=d+20|0)>>2])d=C,y=M;else{if(!(C=0|m[(M=d+16|0)>>2]))break;d=C,y=M}m[y>>2]=0}else m[12+(Ie=0|m[A+8>>2])>>2]=d,m[d+8>>2]=Ie}while(0);if(!k)break;C=23620+((y=0|m[A+28>>2])<<2)|0;do{if((0|m[C>>2])==(0|A)){if(m[C>>2]=d,0|d)break;m[5830]=m[5830]&~(1<<y);break n}if(m[((0|m[(Ie=k+16|0)>>2])==(0|A)?Ie:k+20|0)>>2]=d,!d)break n}while(0);if(m[d+24>>2]=k,0|(C=0|m[(y=A+16|0)>>2])&&(m[d+16>>2]=C,m[C+24>>2]=d),!(y=0|m[y+4>>2]))break;m[d+20>>2]=y,m[y+24>>2]=d}while(0);A=A+I|0,M=I+L|0}else M=L;if(m[(A=A+4|0)>>2]=-2&m[A>>2],m[X+4>>2]=1|M,m[X+M>>2]=M,A=M>>>3,M>>>0<256){y=23356+(A<<1<<2)|0,(d=0|m[5829])&(A=1<<A)?A=0|m[(d=y+8|0)>>2]:(m[5829]=d|A,A=y,d=y+8|0),m[d>>2]=X,m[A+12>>2]=X,m[X+8>>2]=A,m[X+12>>2]=y;break}A=M>>>8;do{if(A){if(M>>>0>16777215){C=31;break}C=M>>>(7+(C=14-((qe=(520192+(Ie=A<<(yt=(A+1048320|0)>>>16&8))|0)>>>16&4)|yt|(C=(245760+(Ie<<=qe)|0)>>>16&2))+(Ie<<C>>>15)|0)|0)&1|C<<1}else C=0}while(0);if(A=23620+(C<<2)|0,m[X+28>>2]=C,m[4+(d=X+16|0)>>2]=0,m[d>>2]=0,!((d=0|m[5830])&(y=1<<C))){m[5830]=d|y,m[A>>2]=X,m[X+24>>2]=A,m[X+12>>2]=X,m[X+8>>2]=X;break}A=0|m[A>>2];n:do{if((-8&m[A+4>>2]|0)!=(0|M)){for(C=M<<(31==(0|C)?0:25-(C>>>1)|0);d=0|m[(y=A+16+(C>>>31<<2)|0)>>2];){if((-8&m[d+4>>2]|0)==(0|M)){A=d;break n}C<<=1,A=d}m[y>>2]=X,m[X+24>>2]=A,m[X+12>>2]=X,m[X+8>>2]=X;break t}}while(0);m[12+(Ie=0|m[(yt=A+8|0)>>2])>>2]=X,m[yt>>2]=X,m[X+8>>2]=Ie,m[X+12>>2]=A,m[X+24>>2]=0}}while(0);return me=Vt,0|ee+8}for(A=23764;!((d=0|m[A>>2])>>>0<=G>>>0&&(Ie=d+(0|m[A+4>>2])|0,Ie>>>0>G>>>0));)A=0|m[A+8>>2];A=(d=(d=(M=Ie+-47|0)+(0==(7&(d=M+8|0)|0)?0:0-d&7)|0)>>>0<(M=G+16|0)>>>0?G:d)+8|0,yt=k+(qe=0==(7&(qe=k+8|0)|0)?0:0-qe&7)|0,qe=(y=I+-40|0)-qe|0,m[5835]=yt,m[5832]=qe,m[yt+4>>2]=1|qe,m[k+y+4>>2]=40,m[5836]=m[5951],m[(y=d+4|0)>>2]=27,m[A>>2]=m[5941],m[A+4>>2]=m[5942],m[A+8>>2]=m[5943],m[A+12>>2]=m[5944],m[5941]=k,m[5942]=I,m[5944]=0,m[5943]=A,A=d+24|0;do{yt=A,m[(A=A+4|0)>>2]=7}while((yt+8|0)>>>0<Ie>>>0);if((0|d)!=(0|G)){if(k=d-G|0,m[y>>2]=-2&m[y>>2],m[G+4>>2]=1|k,m[d>>2]=k,A=k>>>3,k>>>0<256){y=23356+(A<<1<<2)|0,(d=0|m[5829])&(A=1<<A)?A=0|m[(d=y+8|0)>>2]:(m[5829]=d|A,A=y,d=y+8|0),m[d>>2]=G,m[A+12>>2]=G,m[G+8>>2]=A,m[G+12>>2]=y;break}if(y=23620+((C=(A=k>>>8)?k>>>0>16777215?31:k>>>(7+(C=14-((qe=(520192+(Ie=A<<(yt=(A+1048320|0)>>>16&8))|0)>>>16&4)|yt|(C=(245760+(Ie<<=qe)|0)>>>16&2))+(Ie<<C>>>15)|0)|0)&1|C<<1:0)<<2)|0,m[G+28>>2]=C,m[G+20>>2]=0,m[M>>2]=0,!((A=0|m[5830])&(d=1<<C))){m[5830]=A|d,m[y>>2]=G,m[G+24>>2]=y,m[G+12>>2]=G,m[G+8>>2]=G;break}A=0|m[y>>2];t:do{if((-8&m[A+4>>2]|0)!=(0|k)){for(C=k<<(31==(0|C)?0:25-(C>>>1)|0);d=0|m[(y=A+16+(C>>>31<<2)|0)>>2];){if((-8&m[d+4>>2]|0)==(0|k)){A=d;break t}C<<=1,A=d}m[y>>2]=G,m[G+24>>2]=A,m[G+12>>2]=G,m[G+8>>2]=G;break e}}while(0);m[12+(Ie=0|m[(yt=A+8|0)>>2])>>2]=G,m[yt>>2]=G,m[G+8>>2]=Ie,m[G+12>>2]=A,m[G+24>>2]=0}}else Ie=0|m[5833],0==(0|Ie)|k>>>0<Ie>>>0&&(m[5833]=k),m[5941]=k,m[5942]=I,m[5944]=0,m[5838]=m[5947],m[5837]=-1,m[5842]=23356,m[5841]=23356,m[5844]=23364,m[5843]=23364,m[5846]=23372,m[5845]=23372,m[5848]=23380,m[5847]=23380,m[5850]=23388,m[5849]=23388,m[5852]=23396,m[5851]=23396,m[5854]=23404,m[5853]=23404,m[5856]=23412,m[5855]=23412,m[5858]=23420,m[5857]=23420,m[5860]=23428,m[5859]=23428,m[5862]=23436,m[5861]=23436,m[5864]=23444,m[5863]=23444,m[5866]=23452,m[5865]=23452,m[5868]=23460,m[5867]=23460,m[5870]=23468,m[5869]=23468,m[5872]=23476,m[5871]=23476,m[5874]=23484,m[5873]=23484,m[5876]=23492,m[5875]=23492,m[5878]=23500,m[5877]=23500,m[5880]=23508,m[5879]=23508,m[5882]=23516,m[5881]=23516,m[5884]=23524,m[5883]=23524,m[5886]=23532,m[5885]=23532,m[5888]=23540,m[5887]=23540,m[5890]=23548,m[5889]=23548,m[5892]=23556,m[5891]=23556,m[5894]=23564,m[5893]=23564,m[5896]=23572,m[5895]=23572,m[5898]=23580,m[5897]=23580,m[5900]=23588,m[5899]=23588,m[5902]=23596,m[5901]=23596,m[5904]=23604,m[5903]=23604,Ie=I+-40|0,qe=k+8|0,qe=0==(7&qe|0)?0:0-qe&7,yt=k+qe|0,qe=Ie-qe|0,m[5835]=yt,m[5832]=qe,m[yt+4>>2]=1|qe,m[k+Ie+4>>2]=40,m[5836]=m[5951]}while(0);if((A=0|m[5832])>>>0>ye>>>0)return m[5832]=qe=A-ye|0,m[5835]=yt=(Ie=0|m[5835])+ye|0,m[yt+4>>2]=1|qe,m[Ie+4>>2]=3|ye,me=Vt,0|Ie+8}return m[(Ie=23312)>>2]=12,me=Vt,0}function Nn(d){var A=0,y=0,C=0,M=0,k=0,I=0,L=0,G=0;if(d|=0){M=0|m[5833],G=(y=d+-8|0)+(A=-8&(d=0|m[d+-4>>2]))|0;do{if(1&d)L=y,I=y;else{if(C=0|m[y>>2],!(3&d)||(k=C+A|0,(I=y+(0-C)|0)>>>0<M>>>0))return;if((0|m[5834])==(0|I)){if(3!=(3&(A=0|m[(d=G+4|0)>>2])|0)){L=I,A=k;break}return m[5831]=k,m[d>>2]=-2&A,m[I+4>>2]=1|k,void(m[I+k>>2]=k)}if(y=C>>>3,C>>>0<256){if((0|(A=0|m[I+12>>2]))==(0|(d=0|m[I+8>>2]))){m[5829]=m[5829]&~(1<<y),L=I,A=k;break}m[d+12>>2]=A,m[A+8>>2]=d,L=I,A=k;break}M=0|m[I+24>>2],d=0|m[I+12>>2];do{if((0|d)==(0|I)){if(d=0|m[(y=4+(A=I+16|0)|0)>>2])A=y;else if(!(d=0|m[A>>2])){d=0;break}for(;;)if(y=0|m[(C=d+20|0)>>2])d=y,A=C;else{if(!(y=0|m[(C=d+16|0)>>2]))break;d=y,A=C}m[A>>2]=0}else m[12+(L=0|m[I+8>>2])>>2]=d,m[d+8>>2]=L}while(0);if(M){if((0|m[(y=23620+((A=0|m[I+28>>2])<<2)|0)>>2])==(0|I)){if(m[y>>2]=d,!d){m[5830]=m[5830]&~(1<<A),L=I,A=k;break}}else if(m[((0|m[(L=M+16|0)>>2])==(0|I)?L:M+20|0)>>2]=d,!d){L=I,A=k;break}m[d+24>>2]=M,0|(y=0|m[(A=I+16|0)>>2])&&(m[d+16>>2]=y,m[y+24>>2]=d),(A=0|m[A+4>>2])?(m[d+20>>2]=A,m[A+24>>2]=d,L=I,A=k):(L=I,A=k)}else L=I,A=k}}while(0);if(!(I>>>0>=G>>>0)&&1&(C=0|m[(d=G+4|0)>>2])){if(2&C)m[d>>2]=-2&C,m[L+4>>2]=1|A,m[I+A>>2]=A,M=A;else{if((0|m[5835])==(0|G)){if(m[5832]=G=(0|m[5832])+A|0,m[5835]=L,m[L+4>>2]=1|G,(0|L)!=(0|m[5834]))return;return m[5834]=0,void(m[5831]=0)}if((0|m[5834])==(0|G))return m[5831]=G=(0|m[5831])+A|0,m[5834]=I,m[L+4>>2]=1|G,void(m[I+G>>2]=G);M=(-8&C)+A|0,y=C>>>3;do{if(C>>>0<256){if((0|(d=0|m[G+12>>2]))==(0|(A=0|m[G+8>>2]))){m[5829]=m[5829]&~(1<<y);break}m[A+12>>2]=d,m[d+8>>2]=A;break}k=0|m[G+24>>2],d=0|m[G+12>>2];do{if((0|d)==(0|G)){if(d=0|m[(y=4+(A=G+16|0)|0)>>2])A=y;else if(!(d=0|m[A>>2])){y=0;break}for(;;)if(y=0|m[(C=d+20|0)>>2])d=y,A=C;else{if(!(y=0|m[(C=d+16|0)>>2]))break;d=y,A=C}m[A>>2]=0,y=d}else m[12+(y=0|m[G+8>>2])>>2]=d,m[d+8>>2]=y,y=d}while(0);if(0|k){if((0|m[(A=23620+((d=0|m[G+28>>2])<<2)|0)>>2])==(0|G)){if(m[A>>2]=y,!y){m[5830]=m[5830]&~(1<<d);break}}else if(m[((0|m[(C=k+16|0)>>2])==(0|G)?C:k+20|0)>>2]=y,!y)break;m[y+24>>2]=k,0|(A=0|m[(d=G+16|0)>>2])&&(m[y+16>>2]=A,m[A+24>>2]=y),0|(d=0|m[d+4>>2])&&(m[y+20>>2]=d,m[d+24>>2]=y)}}while(0);if(m[L+4>>2]=1|M,m[I+M>>2]=M,(0|L)==(0|m[5834]))return void(m[5831]=M)}if(d=M>>>3,M>>>0<256)return y=23356+(d<<1<<2)|0,(A=0|m[5829])&(d=1<<d)?d=0|m[(A=y+8|0)>>2]:(m[5829]=A|d,d=y,A=y+8|0),m[A>>2]=L,m[d+12>>2]=L,m[L+8>>2]=d,void(m[L+12>>2]=y);C=(d=M>>>8)?M>>>0>16777215?31:M>>>(7+(C=14-((k=(520192+(G=d<<(I=(d+1048320|0)>>>16&8))|0)>>>16&4)|I|(C=(245760+(G<<=k)|0)>>>16&2))+(G<<C>>>15)|0)|0)&1|C<<1:0,d=23620+(C<<2)|0,m[L+28>>2]=C,m[L+20>>2]=0,m[L+16>>2]=0,A=0|m[5830],y=1<<C;e:do{if(A&y){d=0|m[d>>2];t:do{if((-8&m[d+4>>2]|0)!=(0|M)){for(C=M<<(31==(0|C)?0:25-(C>>>1)|0);A=0|m[(y=d+16+(C>>>31<<2)|0)>>2];){if((-8&m[A+4>>2]|0)==(0|M)){d=A;break t}C<<=1,d=A}m[y>>2]=L,m[L+24>>2]=d,m[L+12>>2]=L,m[L+8>>2]=L;break e}}while(0);m[12+(G=0|m[(I=d+8|0)>>2])>>2]=L,m[I>>2]=L,m[L+8>>2]=G,m[L+12>>2]=d,m[L+24>>2]=0}else m[5830]=A|y,m[d>>2]=L,m[L+24>>2]=d,m[L+12>>2]=L,m[L+8>>2]=L}while(0);if(m[5837]=G=(0|m[5837])-1|0,!(0|G)){for(d=23772;d=0|m[d>>2];)d=d+8|0;m[5837]=-1}}}}function sc(d,A){A|=0;var y=0;return(d|=0)?(y=0|yh(A,d),(A|d)>>>0>65535&&(y=(0|(y>>>0)/(d>>>0))==(0|A)?y:-1)):y=0,!(d=0|uu(y))||!(3&m[d+-4>>2])||ac(0|d,0,0|y),0|d}function C0(d,A,y,C){return kn(0|(C=(A|=0)-(C|=0)-((y|=0)>>>0>(d|=0)>>>0|0)>>>0)),0|d-y>>>0}function Kk(d){return 0|((d|=0)?31-(0|tf(d^d-1))|0:32)}function xd(d,A,y,C){var M,k;return k=me,me=me+16|0,function(d,A,y,C,M){M|=0;var k=0,I=0,L=0,G=0,X=0,ee=0,ye=0,Te=0,ze=0,Ye=0;if(ee=d|=0,I=y|=0,L=Te=C|=0,!(X=G=A|=0))return k=0!=(0|M),L?k?(m[M>>2]=0|d,m[M+4>>2]=0&A,M=0,kn(0|(Te=0)),0|M):(M=0,kn(0|(Te=0)),0|M):(k&&(m[M>>2]=(ee>>>0)%(I>>>0),m[M+4>>2]=0),M=(ee>>>0)/(I>>>0)>>>0,kn(0|(Te=0)),0|M);k=0==(0|L);do{if(I){if(!k){if((k=(0|tf(0|L))-(0|tf(0|X))|0)>>>0<=31){I=ye=k+1|0,d=ee>>>(ye>>>0)&(A=k-31>>31)|X<<(L=31-k|0),A&=X>>>(ye>>>0),k=0,L=ee<<L;break}return M?(m[M>>2]=0|d,m[M+4>>2]=G|0&A,M=0,kn(0|(Te=0)),0|M):(M=0,kn(0|(Te=0)),0|M)}if((k=I-1|0)&I|0){I=L=33+(0|tf(0|I))-(0|tf(0|X))|0,d=(ye=32-L|0)-1>>31&X>>>((ze=L-32|0)>>>0)|(X<<ye|ee>>>(L>>>0))&(A=ze>>31),A&=X>>>(L>>>0),k=ee<<(Ye=64-L|0)&(G=ye>>31),L=(X<<Ye|ee>>>(ze>>>0))&G|ee<<ye&L-33>>31;break}return 0|M&&(m[M>>2]=k&ee,m[M+4>>2]=0),1==(0|I)?(Ye=0|d,kn(0|(ze=G|0&A)),0|Ye):(ze=X>>>((Ye=0|Kk(0|I))>>>0)|0,Ye=X<<32-Ye|ee>>>(Ye>>>0)|0,kn(0|ze),0|Ye)}if(k)return 0|M&&(m[M>>2]=(X>>>0)%(I>>>0),m[M+4>>2]=0),Ye=(X>>>0)/(I>>>0)>>>0,kn(0|(ze=0)),0|Ye;if(!ee)return 0|M&&(m[M>>2]=0,m[M+4>>2]=(X>>>0)%(L>>>0)),Ye=(X>>>0)/(L>>>0)>>>0,kn(0|(ze=0)),0|Ye;if(!((k=L-1|0)&L))return 0|M&&(m[M>>2]=0|d,m[M+4>>2]=k&X|0&A),ze=0,Ye=X>>>((0|Kk(0|L))>>>0),kn(0|ze),0|Ye;if((k=(0|tf(0|L))-(0|tf(0|X))|0)>>>0<=30){I=A=k+1|0,d=X<<(L=31-k|0)|ee>>>(A>>>0),A=X>>>(A>>>0),k=0,L=ee<<L;break}return M?(m[M>>2]=0|d,m[M+4>>2]=G|0&A,Ye=0,kn(0|(ze=0)),0|Ye):(Ye=0,kn(0|(ze=0)),0|Ye)}while(0);if(I){X=0|function(d,A,y,C){return kn((A|=0)+(C|=0)+((y=(d|=0)+(y|=0)>>>0)>>>0<d>>>0|0)>>>0|0),0|y}(0|(ye=0|y),0|(ee=Te|0&C),-1,-1),y=0|De(),G=L,L=0;do{C=G,G=k>>>31|G<<1,k=L|k<<1,C0(0|X,0|y,0|(C=d<<1|C>>>31|0),0|(Te=d>>>31|A<<1|0)),L=1&(ze=(Ye=0|De())>>31|((0|Ye)<0?-1:0)<<1),d=0|C0(0|C,0|Te,ze&ye|0,(((0|Ye)<0?-1:0)>>31|((0|Ye)<0?-1:0)<<1)&ee|0),A=0|De(),I=I-1|0}while(0!=(0|I));X=G,G=0}else X=L,G=0,L=0;I=0,0|M&&(m[M>>2]=d,m[M+4>>2]=A),Ye=-2&(k<<1|0)|L,kn(0|(ze=(0|k)>>>31|(X|I)<<1|0&(I<<1|k>>>31)|G))}(d|=0,A|=0,y|=0,C|=0,M=0|k),me=k,kn(0|m[M+4>>2]),0|m[M>>2]}function Ct(d,A,y){return d|=0,A|=0,(0|(y|=0))<32?(kn(A>>>y|0),d>>>y|(A&(1<<y)-1)<<32-y):(kn(0),A>>>y-32|0)}function Bt(d,A,y){return d|=0,(0|(y|=0))<32?(kn((A|=0)<<y|(d&(1<<y)-1<<32-y)>>>32-y|0),d<<y):(kn(d<<y-32|0),0)}function Jk(d,A){return A=+A,(d=+d)!=d?+A:A!=A?+d:+vj(+d,+A)}function Ev(d){return(d=+d)>=0?+fa(d+.5):+_v(d-.5)}function Dv(d,A,y){d|=0,A|=0;var M,k,C=0;if((0|(y|=0))>=8192)return bj(0|d,0|A,0|y),0|d;if(k=0|d,M=d+y|0,(3&d)==(3&A)){for(;3&d;){if(!y)return 0|k;sn[d>>0]=0|sn[A>>0],d=d+1|0,A=A+1|0,y=y-1|0}for(C=(y=-4&M|0)-64|0;(0|d)<=(0|C);)m[d>>2]=m[A>>2],m[d+4>>2]=m[A+4>>2],m[d+8>>2]=m[A+8>>2],m[d+12>>2]=m[A+12>>2],m[d+16>>2]=m[A+16>>2],m[d+20>>2]=m[A+20>>2],m[d+24>>2]=m[A+24>>2],m[d+28>>2]=m[A+28>>2],m[d+32>>2]=m[A+32>>2],m[d+36>>2]=m[A+36>>2],m[d+40>>2]=m[A+40>>2],m[d+44>>2]=m[A+44>>2],m[d+48>>2]=m[A+48>>2],m[d+52>>2]=m[A+52>>2],m[d+56>>2]=m[A+56>>2],m[d+60>>2]=m[A+60>>2],d=d+64|0,A=A+64|0;for(;(0|d)<(0|y);)m[d>>2]=m[A>>2],d=d+4|0,A=A+4|0}else for(y=M-4|0;(0|d)<(0|y);)sn[d>>0]=0|sn[A>>0],sn[d+1>>0]=0|sn[A+1>>0],sn[d+2>>0]=0|sn[A+2>>0],sn[d+3>>0]=0|sn[A+3>>0],d=d+4|0,A=A+4|0;for(;(0|d)<(0|M);)sn[d>>0]=0|sn[A>>0],d=d+1|0,A=A+1|0;return 0|k}function ac(d,A,y){A|=0;var k,C=0,M=0,I=0;if(k=(d|=0)+(y|=0)|0,A&=255,(0|y)>=67){for(;3&d;)sn[d>>0]=A,d=d+1|0;for(I=A|A<<8|A<<16|A<<24,M=(C=-4&k|0)-64|0;(0|d)<=(0|M);)m[d>>2]=I,m[d+4>>2]=I,m[d+8>>2]=I,m[d+12>>2]=I,m[d+16>>2]=I,m[d+20>>2]=I,m[d+24>>2]=I,m[d+28>>2]=I,m[d+32>>2]=I,m[d+36>>2]=I,m[d+40>>2]=I,m[d+44>>2]=I,m[d+48>>2]=I,m[d+52>>2]=I,m[d+56>>2]=I,m[d+60>>2]=I,d=d+64|0;for(;(0|d)<(0|C);)m[d>>2]=I,d=d+4|0}for(;(0|d)<(0|k);)sn[d>>0]=A,d=d+1|0;return k-y|0}function eP(d){return(d=+d)>=0?+fa(d+.5):+_v(d-.5)}function bd(d){var A,y,C;return d|=0,C=0|xj(),(0|d)>0&(0|(A=(y=0|m[fs>>2])+d|0))<(0|y)|(0|A)<0?(Cj(0|A),yk(12),-1):(0|A)>(0|C)&&!(0|wj(0|A))?(yk(12),-1):(m[fs>>2]=A,0|y)}return{___uremdi3:xd,_bitshift64Lshr:Ct,_bitshift64Shl:Bt,_calloc:sc,_cellAreaKm2:function(d,A){var C,M,k,y=0;if(k=me,me=me+192|0,M=k,sf(d|=0,A|=0,C=k+168|0),af(d,A,M),(0|(A=0|m[M>>2]))>0){if(y=+im(M+8|0,M+8+((1!=(0|A)&1)<<4)|0,C)+0,1!=(0|A)){d=1;do{y+=+im(M+8+(d<<4)|0,M+8+(((0|(d=d+1|0))%(0|A)|0)<<4)|0,C)}while((0|d)<(0|A))}}else y=0;return me=k,6371.007180918475*y*6371.007180918475},_cellAreaM2:function(d,A){var C,M,k,y=0;if(k=me,me=me+192|0,M=k,sf(d|=0,A|=0,C=k+168|0),af(d,A,M),(0|(A=0|m[M>>2]))>0){if(y=+im(M+8|0,M+8+((1!=(0|A)&1)<<4)|0,C)+0,1!=(0|A)){d=1;do{y+=+im(M+8+(d<<4)|0,M+8+(((0|(d=d+1|0))%(0|A)|0)<<4)|0,C)}while((0|d)<(0|A))}}else y=0;return me=k,6371.007180918475*y*6371.007180918475*1e3*1e3},_cellAreaRads2:function(d,A){var C,M,k,y=0;if(k=me,me=me+192|0,M=k,sf(d|=0,A|=0,C=k+168|0),af(d,A,M),(0|(A=0|m[M>>2]))<=0)return me=k,+(y=0);if(y=+im(M+8|0,M+8+((1!=(0|A)&1)<<4)|0,C)+0,1==(0|A))return me=k,+y;d=1;do{y+=+im(M+8+(d<<4)|0,M+8+(((0|(d=d+1|0))%(0|A)|0)<<4)|0,C)}while((0|d)<(0|A));return me=k,+y},_compact:function(d,A,y){A|=0;var Ie,C=0,M=0,k=0,I=0,L=0,G=0,X=0,ee=0,ye=0,Te=0,ze=0,Ye=0,et=0,Dt=0,Nt=0,qe=0,yt=0,Vt=0,Ut=0,Rt=0,Lt=0;if(!(y|=0))return 0;if(C=0|m[(M=d|=0)>>2],!0&0==(15728640&(M=0|m[M+4>>2])|0)){if((0|y)<=0||(m[(Rt=A)>>2]=C,m[Rt+4>>2]=M,1==(0|y)))return 0;C=1;do{Ut=0|m[4+(Vt=d+(C<<3)|0)>>2],m[(Rt=A+(C<<3)|0)>>2]=m[Vt>>2],m[Rt+4>>2]=Ut,C=C+1|0}while((0|C)!=(0|y));return 0}if(!(Ut=0|uu(Vt=y<<3)))return-3;if(Dv(0|Ut,0|d,0|Vt),!(Ie=0|sc(y,8)))return Nn(Ut),-3;C=y;e:for(;;){qe=0|Ct(0|(ee=0|m[(I=Ut)>>2]),0|(I=0|m[I+4>>2]),52),De(),yt=(qe&=15)-1|0,Nt=(0|C)>0;t:do{if(Nt){if(Dt=((0|C)<0)<<31>>31,Ye=0|Bt(0|yt,0,52),et=0|De(),yt>>>0>15)for(M=0,d=ee,y=I;;){if(!(0==(0|d)&0==(0|y))){if(k=0|Ct(0|d,0|y,52),De(),L=(0|(k&=15))<(0|yt),k=(0|k)==(0|yt),y=0|xd(0|(X=L?0:k?d:0),0|(d=L?0:k?y:0),0|C,0|Dt),De(),0==(0|(G=0|m[(L=k=Ie+(y<<3)|0)>>2]))&0==(0|(L=0|m[L+4>>2])))y=X;else for(Ye=0,ze=y,Te=L,y=X;;){if((0|Ye)>(0|C)){Rt=41;break e}if((0|G)==(0|y)&(-117440513&Te|0)==(0|d)){X=0|Ct(0|G,0|Te,56),De(),ye=1+(X&=7)|0,et=0|Ct(0|G,0|Te,45),De();n:do{if(0|yi(127&et)){if(G=0|Ct(0|G,0|Te,52),De(),!(G&=15)){L=6;break}for(L=1;;){if(!(0==((et=0|Bt(7,0,3*(15-L|0)|0))&y|0)&0==((0|De())&d|0))){L=7;break n}if(!(L>>>0<G>>>0)){L=6;break}L=L+1|0}}else L=7}while(0);if((X+2|0)>>>0>L>>>0){Rt=51;break e}et=0|Bt(0|ye,0,56),d=0|De()|-117440513&d,m[(L=k)>>2]=0,m[L+4>>2]=0,L=ze,y|=et}else L=(ze+1|0)%(0|C)|0;if(0==(0|(G=0|m[(Te=k=Ie+(L<<3)|0)>>2]))&0==(0|(Te=0|m[Te+4>>2])))break;Ye=Ye+1|0,ze=L}m[(et=k)>>2]=y,m[et+4>>2]=d}if((0|(M=M+1|0))>=(0|C))break t;d=0|m[(y=Ut+(M<<3)|0)>>2],y=0|m[y+4>>2]}for(M=0,d=ee,y=I;;){if(!(0==(0|d)&0==(0|y))){if(L=0|Ct(0|d,0|y,52),De(),(0|(L&=15))>=(0|yt)){if((0|L)!=(0|yt)&&(d|=Ye,y=-15728641&y|et,L>>>0>=qe>>>0)){k=yt;do{ze=0|Bt(7,0,3*(14-k|0)|0),k=k+1|0,d|=ze,y=0|De()|y}while(k>>>0<L>>>0)}}else d=0,y=0;if(L=0|xd(0|d,0|y,0|C,0|Dt),De(),!(0==(0|(X=0|m[(G=k=Ie+(L<<3)|0)>>2]))&0==(0|(G=0|m[G+4>>2]))))for(ze=0;;){if((0|ze)>(0|C)){Rt=41;break e}if((0|X)==(0|d)&(-117440513&G|0)==(0|y)){ye=0|Ct(0|X,0|G,56),De(),Te=1+(ye&=7)|0,Lt=0|Ct(0|X,0|G,45),De();n:do{if(0|yi(127&Lt)){if(X=0|Ct(0|X,0|G,52),De(),!(X&=15)){G=6;break}for(G=1;;){if(!(0==((Lt=0|Bt(7,0,3*(15-G|0)|0))&d|0)&0==((0|De())&y|0))){G=7;break n}if(!(G>>>0<X>>>0)){G=6;break}G=G+1|0}}else G=7}while(0);if((ye+2|0)>>>0>G>>>0){Rt=51;break e}Lt=0|Bt(0|Te,0,56),y=0|De()|-117440513&y,m[(Te=k)>>2]=0,m[Te+4>>2]=0,d|=Lt}else L=(L+1|0)%(0|C)|0;if(0==(0|(X=0|m[(G=k=Ie+(L<<3)|0)>>2]))&0==(0|(G=0|m[G+4>>2])))break;ze=ze+1|0}m[(Lt=k)>>2]=d,m[Lt+4>>2]=y}if((0|(M=M+1|0))>=(0|C))break t;d=0|m[(y=Ut+(M<<3)|0)>>2],y=0|m[y+4>>2]}}}while(0);if((C+5|0)>>>0<11){Rt=99;break}if(!(et=0|sc((0|C)/6|0,8))){Rt=58;break}t:do{if(Nt){ze=0,Te=0;do{if(!(0==(0|(M=0|m[(d=L=Ie+(ze<<3)|0)>>2]))&0==(0|(d=0|m[d+4>>2])))){G=0|Ct(0|M,0|d,56),De(),y=1+(G&=7)|0,X=-117440513&d,Lt=0|Ct(0|M,0|d,45),De();n:do{if(0|yi(127&Lt)){if(ye=0|Ct(0|M,0|d,52),De(),0|(ye&=15))for(k=1;;){if(!(0==(M&(Lt=0|Bt(7,0,3*(15-k|0)|0))|0)&0==(X&(0|De())|0)))break n;if(!(k>>>0<ye>>>0))break;k=k+1|0}M|=d=0|Bt(0|y,0,56),d=0|De()|X,m[(y=L)>>2]=M,m[y+4>>2]=d,y=G+2|0}}while(0);7==(0|y)&&(m[(Lt=et+(Te<<3)|0)>>2]=M,m[Lt+4>>2]=-117440513&d,Te=Te+1|0)}ze=ze+1|0}while((0|ze)!=(0|C));if(Nt){if(Ye=((0|C)<0)<<31>>31,ye=0|Bt(0|yt,0,52),ze=0|De(),yt>>>0>15)for(d=0,M=0;;){do{if(!(0==(0|ee)&0==(0|I))){for(G=0|Ct(0|ee,0|I,52),De(),k=(0|(G&=15))<(0|yt),G=(0|G)==(0|yt),k=0|xd(0|(L=k?0:G?ee:0),0|(G=k?0:G?I:0),0|C,0|Ye),De(),y=0;;){if((0|y)>(0|C)){Rt=98;break e}if((-117440513&(X=0|m[4+(Lt=Ie+(k<<3)|0)>>2])|0)==(0|G)&&(0|m[Lt>>2])==(0|L)){Rt=70;break}if((0|m[(Lt=Ie+((k=(k+1|0)%(0|C)|0)<<3)|0)>>2])==(0|L)&&(0|m[Lt+4>>2])==(0|G))break;y=y+1|0}if(70==(0|Rt)&&(Rt=0,!0&100663296==(117440512&X|0)))break;m[(Lt=A+(M<<3)|0)>>2]=ee,m[Lt+4>>2]=I,M=M+1|0}}while(0);if((0|(d=d+1|0))>=(0|C)){C=Te;break t}ee=0|m[(I=Ut+(d<<3)|0)>>2],I=0|m[I+4>>2]}for(d=0,M=0;;){do{if(!(0==(0|ee)&0==(0|I))){if(G=0|Ct(0|ee,0|I,52),De(),(0|(G&=15))>=(0|yt))if((0|G)!=(0|yt))if(y=ee|ye,k=-15728641&I|ze,G>>>0<qe>>>0)G=k;else{L=yt;do{Lt=0|Bt(7,0,3*(14-L|0)|0),L=L+1|0,y|=Lt,k=0|De()|k}while(L>>>0<G>>>0);G=k}else y=ee,G=I;else y=0,G=0;for(L=0|xd(0|y,0|G,0|C,0|Ye),De(),k=0;;){if((0|k)>(0|C)){Rt=98;break e}if((-117440513&(X=0|m[4+(Lt=Ie+(L<<3)|0)>>2])|0)==(0|G)&&(0|m[Lt>>2])==(0|y)){Rt=93;break}if((0|m[(Lt=Ie+((L=(L+1|0)%(0|C)|0)<<3)|0)>>2])==(0|y)&&(0|m[Lt+4>>2])==(0|G))break;k=k+1|0}if(93==(0|Rt)&&(Rt=0,!0&100663296==(117440512&X|0)))break;m[(Lt=A+(M<<3)|0)>>2]=ee,m[Lt+4>>2]=I,M=M+1|0}}while(0);if((0|(d=d+1|0))>=(0|C)){C=Te;break t}ee=0|m[(I=Ut+(d<<3)|0)>>2],I=0|m[I+4>>2]}}else M=0,C=Te}else M=0,C=0}while(0);if(ac(0|Ie,0,0|Vt),Dv(0|Ut,0|et,C<<3|0),Nn(et),!C)break;A=A+(M<<3)|0}return 41==(0|Rt)?(Nn(Ut),Nn(Ie),0|(Lt=-1)):51==(0|Rt)?(Nn(Ut),Nn(Ie),0|(Lt=-2)):58==(0|Rt)?(Nn(Ut),Nn(Ie),0|(Lt=-3)):98==(0|Rt)?(Nn(et),Nn(Ut),Nn(Ie),0|(Lt=-1)):(99==(0|Rt)&&Dv(0|A,0|Ut,C<<3|0),Nn(Ut),Nn(Ie),0|(Lt=0))},_destroyLinkedPolygon:function(d){var A=0,y=0,C=0,M=0;if(d|=0)for(C=1;;){if(0|(A=0|m[d>>2]))do{if(0|(y=0|m[A>>2]))do{M=y,y=0|m[y+16>>2],Nn(M)}while(0!=(0|y));M=A,A=0|m[A+8>>2],Nn(M)}while(0!=(0|A));if(A=d,d=0|m[d+8>>2],C||Nn(A),!d)break;C=0}},_edgeLengthKm:function(d){return+ +pe[20752+((d|=0)<<3)>>3]},_edgeLengthM:function(d){return+ +pe[20880+((d|=0)<<3)>>3]},_emscripten_replace_memory:function(d){return sn=new Int8Array(d),new Uint8Array(d),m=new Int32Array(d),new Float32Array(d),pe=new Float64Array(d),Pt=d,!0},_exactEdgeLengthKm:function(d,A){var k,I,y=0,C=0,M=0,L=0,G=0,X=0;if(I=me,me=me+176|0,bv(d|=0,A|=0,k=I),(0|(d=0|m[k>>2]))<=1)return me=I,+(M=0);A=d+-1|0,d=0,y=0,C=+pe[k+8>>3],M=+pe[k+16>>3];do{G=C,L=M,L=(X=+lr(.5*((C=+pe[k+8+((d=d+1|0)<<4)>>3])-G)))*X+(L=+lr(.5*((M=+pe[k+8+(d<<4)+8>>3])-L)))*(+Yn(+G)*+Yn(+C)*L),y+=2*+yl(+ +Ri(+L),+ +Ri(+(1-L)))}while((0|d)!=(0|A));return me=I,+(X=6371.007180918475*y)},_exactEdgeLengthM:function(d,A){var k,I,y=0,C=0,M=0,L=0,G=0,X=0;if(I=me,me=me+176|0,bv(d|=0,A|=0,k=I),(0|(d=0|m[k>>2]))<=1)return me=I,+(M=0);A=d+-1|0,d=0,y=0,C=+pe[k+8>>3],M=+pe[k+16>>3];do{G=C,L=M,L=(X=+lr(.5*((C=+pe[k+8+((d=d+1|0)<<4)>>3])-G)))*X+(L=+lr(.5*((M=+pe[k+8+(d<<4)+8>>3])-L)))*(+Yn(+G)*+Yn(+C)*L),y+=2*+yl(+ +Ri(+L),+ +Ri(+(1-L)))}while((0|d)!=(0|A));return me=I,+(X=6371.007180918475*y*1e3)},_exactEdgeLengthRads:function(d,A){var k,I,y=0,C=0,M=0,L=0,G=0,X=0;if(I=me,me=me+176|0,bv(d|=0,A|=0,k=I),(0|(d=0|m[k>>2]))<=1)return me=I,+(M=0);A=d+-1|0,d=0,y=0,C=+pe[k+8>>3],M=+pe[k+16>>3];do{G=C,L=M,L=(X=+lr(.5*((C=+pe[k+8+((d=d+1|0)<<4)>>3])-G)))*X+(L=+lr(.5*((M=+pe[k+8+(d<<4)+8>>3])-L)))*(+Yn(+C)*+Yn(+G)*L),y+=2*+yl(+ +Ri(+L),+ +Ri(+(1-L)))}while((0|d)<(0|A));return me=I,+y},_experimentalH3ToLocalIj:function(d,A,y,C,M){var k,I;return M|=0,I=me,me=me+16|0,(d=0|vh(d|=0,A|=0,y|=0,C|=0,k=I))||(function(d,A){var y;m[(A|=0)>>2]=(0|m[(d|=0)>>2])-(y=0|m[d+8>>2]),m[A+4>>2]=(0|m[d+4>>2])-y}(k,M),d=0),me=I,0|d},_experimentalLocalIjToH3:function(d,A,y,C){var M,k;return d|=0,A|=0,C|=0,M=me,me=me+16|0,function(d,A){var k,I,L,y=0,C=0,M=0;m[(A|=0)>>2]=C=0|m[(d|=0)>>2],m[(I=A+4|0)>>2]=d=0|m[d+4>>2],m[(L=A+8|0)>>2]=0,y=d-C|0,(0|C)<0?(d=0-C|0,m[I>>2]=y,m[L>>2]=d,m[A>>2]=0,C=0):(y=d,d=0),(0|y)<0&&(m[A>>2]=C=C-y|0,m[L>>2]=d=d-y|0,m[I>>2]=0,y=0),k=C-d|0,M=y-d|0,(0|d)<0?(m[A>>2]=k,m[I>>2]=M,m[L>>2]=0,y=M,M=k,d=0):M=C,!((0|(C=(0|d)<(0|(C=(0|y)<(0|M)?y:M))?d:C))<=0)&&(m[A>>2]=M-C,m[I>>2]=y-C,m[L>>2]=d-C)}(y|=0,k=M),C=0|$k(d,A,k,C),me=M,0|C},_free:Nn,_geoToH3:zk,_getDestinationH3IndexFromUnidirectionalEdge:function(d,A){d|=0;var C,y=0,M=0;return C=me,me=me+16|0,y=C,!0&268435456==(2013265920&(A|=0)|0)?(M=0|Ct(0|d,0|A,56),De(),m[y>>2]=0,y=0|fo(d,-2130706433&A|134217728,7&M,y),A=0|De(),kn(0|A),me=C,0|y):(y=0,kn(0|(A=0)),me=C,0|y)},_getH3IndexesFromUnidirectionalEdge:function(d,A,y){d|=0;var C,M,k,I,L=0;k=me,me=me+16|0,C=k,M=-2130706433&(A|=0)|134217728,m[(L=y|=0)>>2]=(I=!0&268435456==(2013265920&A|0))?d:0,m[L+4>>2]=I?M:0,I?(A=0|Ct(0|d,0|A,56),De(),m[C>>2]=0,d=0|fo(d,M,7&A,C),A=0|De()):(d=0,A=0),m[(L=y+8|0)>>2]=d,m[L+4>>2]=A,me=k},_getH3UnidirectionalEdge:function(d,A,y,C){var I,X,M=0,k=0,L=0,G=0,ee=0;if(X=me,me=me+16|0,I=X,!(0|Uk(d|=0,A|=0,y|=0,C|=0)))return G=0,kn(0|(L=0)),me=X,0|G;for(L=-2130706433&A,M=(M=0==(0|Eo(d,A)))?1:2;m[I>>2]=0,k=M+1|0,!((0|(ee=0|fo(d,A,M,I)))==(0|y)&(0|De())==(0|C));){if(!(k>>>0<7)){M=0,d=0,G=6;break}M=k}return 6==(0|G)?(kn(0|M),me=X,0|d):(ee=0|Bt(0|M,0,56),G=0|L|De()|268435456,ee|=d,kn(0|G),me=X,0|ee)},_getH3UnidirectionalEdgeBoundary:bv,_getH3UnidirectionalEdgesFromHexagon:function(d,A,y){y|=0;var M,C=0;M=0==(0|Eo(d|=0,A|=0)),A&=-2130706433,m[(C=y)>>2]=M?d:0,m[C+4>>2]=M?285212672|A:0,m[(C=y+8|0)>>2]=d,m[C+4>>2]=301989888|A,m[(C=y+16|0)>>2]=d,m[C+4>>2]=318767104|A,m[(C=y+24|0)>>2]=d,m[C+4>>2]=335544320|A,m[(C=y+32|0)>>2]=d,m[C+4>>2]=352321536|A,m[(y=y+40|0)>>2]=d,m[y+4>>2]=369098752|A},_getOriginH3IndexFromUnidirectionalEdge:function(d,A){var y;return d|=0,kn(0|((y=!0&268435456==(2013265920&(A|=0)|0))?-2130706433&A|134217728:0)),0|(y?d:0)},_getPentagonIndexes:e2,_getRes0Indexes:function(d){d|=0;var A=0,y=0,C=0;A=0;do{Bt(0|A,0,45),C=134225919|De(),m[(y=d+(A<<3)|0)>>2]=-1,m[y+4>>2]=C,A=A+1|0}while(122!=(0|A))},_h3Distance:function(d,A,y,C){var M,k,I;return y|=0,C|=0,I=me,me=me+32|0,k=I,d=0==(0|vh(d|=0,A|=0,d,A,M=I+12|0))&&0==(0|vh(d,A,y,C,k))?0|Qw(M,k):-1,me=I,0|d},_h3GetBaseCell:Bk,_h3GetFaces:function Vk(d,A,y){y|=0;var ye,C=0,M=0,k=0,I=0,L=0,G=0,X=0,ee=0;ye=me,me=me+128|0,X=ye+112|0,k=ye+96|0,ee=ye,M=0|Ct(0|(d|=0),0|(A|=0),52),De(),m[X>>2]=L=15&M,I=0|Ct(0|d,0|A,45),De(),I&=127;e:do{if(0|yi(I)){if(0|L)for(C=1;;){if(!(0==((G=0|Bt(7,0,3*(15-C|0)|0))&d|0)&0==((0|De())&A|0))){M=0;break e}if(!(C>>>0<L>>>0))break;C=C+1|0}if(!(1&M))return G=0|Bt(L+1|0,0,52),ee=0|De()|-15728641&A,Vk((G|d)&~(X=0|Bt(7,0,3*(14-L|0)|0)),ee&~(0|De()),y),void(me=ye);M=1}else M=0}while(0);w0(d,A,k),M?(Fk(k,X,ee),G=5):(Lk(k,X,ee),G=6);e:do{if(0|yi(I))if(L)for(C=1;;){if(!(0==((I=0|Bt(7,0,3*(15-C|0)|0))&d|0)&0==((0|De())&A|0))){C=8;break e}if(!(C>>>0<L>>>0)){C=20;break}C=C+1|0}else C=20;else C=8}while(0);if(ac(0|y,-1,0|C),M){M=0;do{for(Kj(k=ee+(M<<4)|0,0|m[X>>2]),k=0|m[k>>2],C=0;!(-1==(0|(L=0|m[(I=y+(C<<2)|0)>>2]))|(0|L)==(0|k));)C=C+1|0;m[I>>2]=k,M=M+1|0}while((0|M)!=(0|G))}else{M=0;do{for(nm(k=ee+(M<<4)|0,0|m[X>>2],0,1),k=0|m[k>>2],C=0;!(-1==(0|(L=0|m[(I=y+(C<<2)|0)>>2]))|(0|L)==(0|k));)C=C+1|0;m[I>>2]=k,M=M+1|0}while((0|M)!=(0|G))}me=ye},_h3GetResolution:function(d,A){return A=0|Ct(0|(d|=0),0|(A|=0),52),De(),15&A|0},_h3IndexesAreNeighbors:Uk,_h3IsPentagon:Eo,_h3IsResClassIII:function(d,A){return A=0|Ct(0|(d|=0),0|(A|=0),52),De(),1&A|0},_h3IsValid:Nk,_h3Line:function(d,A,y,C,M){y|=0,C|=0,M|=0;var Vt,k=0,I=0,L=0,G=0,X=0,ee=0,ye=0,Te=0,ze=0,Ye=0,et=0,Dt=0,Nt=0,qe=0,yt=0,Ie=0,Ut=0;if(Vt=me,me=me+48|0,I=Vt+12|0,Ie=Vt,0==(0|vh(d|=0,A|=0,d,A,k=Vt+24|0))&&0==(0|vh(d,A,y,C,I))){if((0|(yt=0|Qw(k,I)))<0)return me=Vt,0|yt;for(m[k>>2]=0,m[k+4>>2]=0,m[k+8>>2]=0,m[I>>2]=0,m[I+4>>2]=0,m[I+8>>2]=0,vh(d,A,d,A,k),vh(d,A,y,C,I),Pk(k),Pk(I),yt?(qe=k,y=ee=0|m[k>>2],C=ye=0|m[(Dt=k+4|0)>>2],k=Te=0|m[(Nt=k+8|0)>>2],Ye=+((0|m[I>>2])-ee|0)/(ze=+(0|yt)),et=+((0|m[I+4>>2])-ye|0)/ze,ze=+((0|m[I+8>>2])-Te|0)/ze):(Dt=C=k+4|0,Nt=Te=k+8|0,qe=k,y=0|m[k>>2],C=0|m[C>>2],k=0|m[Te>>2],Ye=0,et=0,ze=0),m[Ie>>2]=y,m[(Te=Ie+4|0)>>2]=C,m[(ye=Ie+8|0)>>2]=k,ee=0;;){Ut=Ye*(G=+(0|ee))+ +(0|y),L=et*G+ +(0|m[Dt>>2]),G=ze*G+ +(0|m[Nt>>2]),C=~~+Ev(+Ut),I=~~+Ev(+L),y=~~+Ev(+G),Ut=+ir(+(+(0|C)-Ut)),L=+ir(+(+(0|I)-L)),G=+ir(+(+(0|y)-G));do{if(!(Ut>L&Ut>G)){if(X=0-C|0,L>G){k=X-y|0;break}k=I,y=X-I|0;break}C=0-(I+y)|0,k=I}while(0);if(m[Ie>>2]=C,m[Te>>2]=k,m[ye>>2]=y,Wj(Ie),$k(d,A,Ie,M+(ee<<3)|0),(0|ee)==(0|yt))break;ee=ee+1|0,y=0|m[qe>>2]}return me=Vt,0}return me=Vt,-1},_h3LineSize:function(d,A,y,C){var M,k,I;return y|=0,C|=0,I=me,me=me+32|0,k=I,d=0==(0|vh(d|=0,A|=0,d,A,M=I+12|0))&&0==(0|vh(d,A,y,C,k))?0|Qw(M,k):-1,me=I,(d>>>31^1)+d|0},_h3SetToLinkedGeo:function(d,A,y){y|=0;var C,M,k,I=0;if(k=me,me=me+32|0,C=k,function(d,A,y){d|=0,y|=0;var G,X,C=0,M=0,k=0,I=0,L=0;if(X=me,me=me+176|0,G=X,(0|(A|=0))<1)return Wk(y,0,0),void(me=X);I=0|Ct(0|m[(I=d)>>2],0|m[I+4>>2],52),De(),Wk(y,(0|A)>6?A:6,15&I),I=0;do{if(af(0|m[(C=d+(I<<3)|0)>>2],0|m[C+4>>2],G),(0|(C=0|m[G>>2]))>0){L=0;do{k=G+8+(L<<4)|0,(M=0|J7(y,C=G+8+(((0|(L=L+1|0))%(0|C)|0)<<4)|0,k))?Yk(y,M):K7(y,k,C),C=0|m[G>>2]}while((0|L)<(0|C))}I=I+1|0}while((0|I)!=(0|A));me=X}(d|=0,A|=0,M=k+16|0),m[y>>2]=0,m[y+4>>2]=0,m[y+8>>2]=0,!(d=0|Xk(M)))return jk(y),Qk(M),void(me=k);do{A=0|k7(y);do{P7(A,d),m[C>>2]=m[(I=d+16|0)>>2],m[C+4>>2]=m[I+4>>2],m[C+8>>2]=m[I+8>>2],m[C+12>>2]=m[I+12>>2],Yk(M,d),d=0|eG(M,C)}while(0!=(0|d));d=0|Xk(M)}while(0!=(0|d));jk(y),Qk(M),me=k},_h3ToCenterChild:function(d,A,y){y|=0;var C=0,M=0;if(C=0|Ct(0|(d|=0),0|(A|=0),52),De(),(0|y)<16&(0|(C&=15))<=(0|y)){if((0|C)!=(0|y)&&(d|=M=0|Bt(0|y,0,52),A=0|De()|-15728641&A,(0|C)<(0|y)))do{M=0|Bt(7,0,3*(14-C|0)|0),C=C+1|0,d&=~M,A&=~(0|De())}while((0|C)<(0|y))}else A=0,d=0;return kn(0|A),0|d},_h3ToChildren:pa,_h3ToGeo:sf,_h3ToGeoBoundary:af,_h3ToParent:Xw,_h3UnidirectionalEdgeIsValid:function(d,A){var y=0;if(!(!0&268435456==(2013265920&(A|=0)|0)))return 0;switch(y=0|Ct(0|(d|=0),0|A,56),De(),7&y){case 0:case 7:return 0}return!0&16777216==(117440512&A|0)&0!=(0|Eo(d,y=-2130706433&A|134217728))?0|(y=0):0|(y=0|Nk(d,y))},_hexAreaKm2:function(d){return+ +pe[20496+((d|=0)<<3)>>3]},_hexAreaM2:function(d){return+ +pe[20624+((d|=0)<<3)>>3]},_hexRing:function(d,A,y,C){d|=0,A|=0,C|=0;var ye,M=0,k=0,I=0,L=0,G=0,X=0,ee=0;if(ye=me,me=me+16|0,ee=ye,!(y|=0))return m[(ee=C)>>2]=d,m[ee+4>>2]=A,me=ye,0;m[ee>>2]=0;e:do{if(0|Eo(d,A))d=1;else{if(k=(0|y)>0){M=0,X=d;do{if(0==(0|(X=0|fo(X,A,4,ee)))&0==(0|(A=0|De()))){d=2;break e}if(M=M+1|0,0|Eo(X,A)){d=1;break e}}while((0|M)<(0|y));if(m[(G=C)>>2]=X,m[G+4>>2]=A,G=y+-1|0,k){k=0,I=1,M=X,d=A;do{if(0==(0|(M=0|fo(M,d,2,ee)))&0==(0|(d=0|De()))){d=2;break e}if(m[(L=C+(I<<3)|0)>>2]=M,m[L+4>>2]=d,I=I+1|0,0|Eo(M,d)){d=1;break e}k=k+1|0}while((0|k)<(0|y));L=0,k=I;do{if(0==(0|(M=0|fo(M,d,3,ee)))&0==(0|(d=0|De()))){d=2;break e}if(m[(I=C+(k<<3)|0)>>2]=M,m[I+4>>2]=d,k=k+1|0,0|Eo(M,d)){d=1;break e}L=L+1|0}while((0|L)<(0|y));I=0;do{if(0==(0|(M=0|fo(M,d,1,ee)))&0==(0|(d=0|De()))){d=2;break e}if(m[(L=C+(k<<3)|0)>>2]=M,m[L+4>>2]=d,k=k+1|0,0|Eo(M,d)){d=1;break e}I=I+1|0}while((0|I)<(0|y));I=0;do{if(0==(0|(M=0|fo(M,d,5,ee)))&0==(0|(d=0|De()))){d=2;break e}if(m[(L=C+(k<<3)|0)>>2]=M,m[L+4>>2]=d,k=k+1|0,0|Eo(M,d)){d=1;break e}I=I+1|0}while((0|I)<(0|y));I=0;do{if(0==(0|(M=0|fo(M,d,4,ee)))&0==(0|(d=0|De()))){d=2;break e}if(m[(L=C+(k<<3)|0)>>2]=M,m[L+4>>2]=d,k=k+1|0,0|Eo(M,d)){d=1;break e}I=I+1|0}while((0|I)<(0|y));for(I=0;;){if(0==(0|(M=0|fo(M,d,6,ee)))&0==(0|(d=0|De()))){d=2;break e}if((0|I)!=(0|G)){if(m[(L=C+(k<<3)|0)>>2]=M,m[L+4>>2]=d,0|Eo(M,d)){d=1;break e}k=k+1|0}if((0|(I=I+1|0))>=(0|y)){I=X,k=A;break}}}else I=X,M=X,k=A,d=A}else m[(I=C)>>2]=d,m[I+4>>2]=A,I=d,M=d,k=A,d=A;d=1&((0|I)!=(0|M)|(0|k)!=(0|d))}}while(0);return me=ye,0|d},_i64Subtract:C0,_kRing:vk,_kRingDistances:function(d,A,y,C,M){var k=0;if(0|jw(d|=0,A|=0,y|=0,C|=0,M|=0)){if(ac(0|C,0,(k=1+(0|yh(3*y|0,y+1|0))|0)<<3|0),0|M)return ac(0|M,0,k<<2|0),void cu(d,A,y,C,M,k,0);(M=0|sc(k,4))&&(cu(d,A,y,C,M,k,0),Nn(M))}},_llvm_minnum_f64:Jk,_llvm_round_f64:Ev,_malloc:uu,_maxFaceCount:function(d,A){var y=0,C=0;if(C=0|Ct(0|(d|=0),0|(A|=0),45),De(),!(0|yi(127&C)))return 2;if(C=0|Ct(0|d,0|A,52),De(),!(C&=15))return 5;for(y=1;;){if(!(0==((0|Bt(7,0,3*(15-y|0)|0))&d|0)&0==((0|De())&A|0))){y=2,d=6;break}if(!(y>>>0<C>>>0)){y=5,d=6;break}y=y+1|0}return 6==(0|d)?0|y:0},_maxH3ToChildrenSize:function(d,A,y){return y|=0,d=0|Ct(0|(d|=0),0|(A|=0),52),De(),(0|y)<16&(0|(d&=15))<=(0|y)?0|(y=0|wv(7,y-d|0)):0|(y=0)},_maxKringSize:function(d){return 1+(0|yh(3*(d|=0)|0,d+1|0))|0},_maxPolyfillSize:function(d,A){A|=0;var k,y=0,C=0,M=0,I=0,L=0;if(k=me,me=me+48|0,M=k+8|0,I=0|m[4+(L=d|=0)>>2],m[(y=C=k)>>2]=m[L>>2],m[y+4>>2]=I,t2(C,M),M=0|qw(M,A),A=0|m[C>>2],(0|(C=0|m[d+8>>2]))<=0)return me=k,0|(L=(I=(0|M)<(0|(L=A)))?L:M)+12;y=0|m[d+12>>2],d=0;do{A=(0|m[y+(d<<3)>>2])+A|0,d=d+1|0}while((0|d)<(0|C));return me=k,0|(L=(L=(0|M)<(0|A))?A:M)+12},_maxUncompactSize:function(d,A,y){d|=0;var C=0,M=0,k=0,I=0;if((0|(A|=0))<=0)return 0;if((0|(y|=0))>=16){for(C=0;;){if(!(0==(0|m[(I=d+(C<<3)|0)>>2])&0==(0|m[I+4>>2]))){C=-1,M=13;break}if((0|(C=C+1|0))>=(0|A)){C=0,M=13;break}}if(13==(0|M))return 0|C}C=0,I=0;e:for(;;){k=0|m[(M=d+(I<<3)|0)>>2],M=0|m[M+4>>2];do{if(!(0==(0|k)&0==(0|M))){if(M=0|Ct(0|k,0|M,52),De(),(0|(M&=15))>(0|y)){C=-1,M=13;break e}if((0|M)==(0|y)){C=C+1|0;break}C=(0|wv(7,y-M|0))+C|0;break}}while(0);if((0|(I=I+1|0))>=(0|A)){M=13;break}}return 13==(0|M)?0|C:0},_memcpy:Dv,_memset:ac,_numHexagons:function(d){var A;return d=0|m[(A=21008+((d|=0)<<3)|0)>>2],kn(0|m[A+4>>2]),0|d},_pentagonIndexCount:function(){return 12},_pointDistKm:b0,_pointDistM:function(d,A){var C,M,k,y=0;return y=(k=+lr(.5*((M=+pe[(A|=0)>>3])-(C=+pe[(d|=0)>>3]))))*k+(y=+lr(.5*(+pe[A+8>>3]-+pe[d+8>>3])))*(+Yn(+M)*+Yn(+C)*y),2*+yl(+ +Ri(+y),+ +Ri(+(1-y)))*6371.007180918475*1e3},_pointDistRads:function(d,A){var C,M,k,y=0;return y=(k=+lr(.5*((M=+pe[(A|=0)>>3])-(C=+pe[(d|=0)>>3]))))*k+(y=+lr(.5*(+pe[A+8>>3]-+pe[d+8>>3])))*(+Yn(+M)*+Yn(+C)*y),2*+yl(+ +Ri(+y),+ +Ri(+(1-y)))},_polyfill:function(d,A,y){var L,C=0,M=0,k=0,I=0,G=0;if(L=me,me=me+48|0,C=L+8|0,M=L,0|function(d,A,y){A|=0,y|=0;var wr,Wr,vr,oi,bn,C=0,M=0,k=0,I=0,L=0,G=0,X=0,ee=0,ye=0,Te=0,ze=0,Ye=0,et=0,Dt=0,Nt=0,qe=0,yt=0,Ie=0,Vt=0,Ut=0,Rt=0,Lt=0,Rn=0,Lr=0,si=0;if(bn=me,me=me+112|0,Wr=bn+80|0,G=bn+72|0,vr=bn,oi=bn+56|0,(si=0|uu(32+(m[(X=8+(d|=0)|0)>>2]<<5)|0))||Or(22848,22448,800,22456),function(d,A){A|=0;var y=0,C=0,M=0,k=0,I=0,L=0,G=0,X=0,ee=0,ye=0,Te=0,ze=0,Ye=0,et=0,Dt=0,Nt=0,qe=0,yt=0,Ie=0,Vt=0,Ut=0,Rt=0;if(Ye=0|m[(d|=0)>>2]){if(pe[(et=A+8|0)>>3]=17976931348623157e292,pe[(Dt=A+24|0)>>3]=17976931348623157e292,pe[A>>3]=-17976931348623157e292,pe[(Nt=A+16|0)>>3]=-17976931348623157e292,(0|Ye)>0){for(M=0|m[d+4>>2],Te=17976931348623157e292,ze=-17976931348623157e292,C=0,y=-1,G=17976931348623157e292,X=17976931348623157e292,ye=-17976931348623157e292,I=-17976931348623157e292,qe=0;ee=+pe[M+(qe<<4)+8>>3],L=+pe[M+(((0|(Ut=y+2|0))==(0|Ye)?0:Ut)<<4)+8>>3],(k=+pe[M+(qe<<4)>>3])<G&&(pe[et>>3]=k,G=k),ee<X&&(pe[Dt>>3]=ee,X=ee),k>ye?pe[A>>3]=k:k=ye,ee>I&&(pe[Nt>>3]=ee,I=ee),Te=ee>0&ee<Te?ee:Te,ze=ee<0&ee>ze?ee:ze,C|=+ir(+(ee-L))>3.141592653589793,(0|(y=qe+1|0))!=(0|Ye);)Ut=qe,ye=k,qe=y,y=Ut;C&&(pe[Nt>>3]=ze,pe[Dt>>3]=Te)}}else m[A>>2]=0,m[A+4>>2]=0,m[A+8>>2]=0,m[A+12>>2]=0,m[A+16>>2]=0,m[A+20>>2]=0,m[A+24>>2]=0,m[A+28>>2]=0;if(!((0|(y=0|m[(Ut=d+8|0)>>2]))<=0)){Vt=d+12|0,Ie=0;do{if(C=Ie,Dt=A+((Ie=Ie+1|0)<<5)|0,Nt=0|m[(M=0|m[Vt>>2])+(C<<3)>>2]){if(pe[(qe=A+(Ie<<5)+8|0)>>3]=17976931348623157e292,pe[(d=A+(Ie<<5)+24|0)>>3]=17976931348623157e292,pe[Dt>>3]=-17976931348623157e292,pe[(yt=A+(Ie<<5)+16|0)>>3]=-17976931348623157e292,(0|Nt)>0){for(Ye=0|m[M+(C<<3)+4>>2],Te=17976931348623157e292,ze=-17976931348623157e292,M=0,C=-1,et=0,G=17976931348623157e292,X=17976931348623157e292,ee=-17976931348623157e292,I=-17976931348623157e292;ye=+pe[Ye+(et<<4)+8>>3],L=+pe[Ye+(((0|(C=C+2|0))==(0|Nt)?0:C)<<4)+8>>3],(k=+pe[Ye+(et<<4)>>3])<G&&(pe[qe>>3]=k,G=k),ye<X&&(pe[d>>3]=ye,X=ye),k>ee?pe[Dt>>3]=k:k=ee,ye>I&&(pe[yt>>3]=ye,I=ye),Te=ye>0&ye<Te?ye:Te,ze=ye<0&ye>ze?ye:ze,M|=+ir(+(ye-L))>3.141592653589793,(0|(C=et+1|0))!=(0|Nt);)Rt=et,et=C,ee=k,C=Rt;M&&(pe[yt>>3]=ze,pe[d>>3]=Te)}}else m[Dt>>2]=0,m[Dt+4>>2]=0,m[Dt+8>>2]=0,m[Dt+12>>2]=0,m[Dt+16>>2]=0,m[Dt+20>>2]=0,m[Dt+24>>2]=0,m[Dt+28>>2]=0,y=0|m[Ut>>2]}while((0|Ie)<(0|y))}}(d,si),C=0|m[(k=d)+4>>2],m[(L=G)>>2]=m[k>>2],m[L+4>>2]=C,t2(G,Wr),L=0|qw(Wr,A),C=0|m[G>>2],(0|(k=0|m[X>>2]))>0){I=0|m[d+12>>2],M=0;do{C=(0|m[I+(M<<3)>>2])+C|0,M=M+1|0}while((0|M)!=(0|k))}if(M=0|sc(wr=(L=(0|L)<(0|C)?C:L)+12|0,8),ee=0|sc(wr,8),m[Wr>>2]=0,Lr=0|m[(Rn=d)+4>>2],m[(C=G)>>2]=m[Rn>>2],m[C+4>>2]=Lr,0|(C=0|xk(G,wr,A,Wr,M,ee)))return Nn(M),Nn(ee),Nn(si),me=bn,0|C;e:do{if((0|m[X>>2])>0){for(k=d+12|0,C=0;I=0|xk((0|m[k>>2])+(C<<3)|0,wr,A,Wr,M,ee),C=C+1|0,!(0|I);)if((0|C)>=(0|m[X>>2]))break e;return Nn(M),Nn(ee),Nn(si),me=bn,0|I}}while(0);(0|L)>-12&&ac(0|ee,0,((0|wr)>1?wr:1)<<3|0);e:do{if((0|m[Wr>>2])>0){Lr=((0|wr)<0)<<31>>31,Ie=M,Vt=ee,Ut=M,Rt=M,Lt=ee,Rn=M,C=M,Dt=M,Nt=ee,qe=ee,yt=ee,M=ee;t:for(;;){for(et=0|m[Wr>>2],ze=0,Ye=0,k=0;;){L=(I=vr)+56|0;do{m[I>>2]=0,I=I+4|0}while((0|I)<(0|L));if(0|jw(G=0|m[(A=Ie+(ze<<3)|0)>>2],A=0|m[A+4>>2],1,vr,0)){L=(I=vr)+56|0;do{m[I>>2]=0,I=I+4|0}while((0|I)<(0|L));0|(I=0|sc(7,4))&&(cu(G,A,1,vr,I,7,0),Nn(I))}Te=0;do{ee=0|m[(ye=vr+(Te<<3)|0)>>2],ye=0|m[ye+4>>2];n:do{if(!(0==(0|ee)&0==(0|ye))){if(G=0|xd(0|ee,0|ye,0|wr,0|Lr),De(),!(0==(0|(A=0|m[(L=I=y+(G<<3)|0)>>2]))&0==(0|(L=0|m[L+4>>2]))))for(X=0;;){if((0|X)>(0|wr))break t;if((0|A)==(0|ee)&(0|L)==(0|ye))break n;if(0==(0|(A=0|m[(L=I=y+((G=(G+1|0)%(0|wr)|0)<<3)|0)>>2]))&0==(0|(L=0|m[L+4>>2])))break;X=X+1|0}0==(0|ee)&0==(0|ye)||(sf(ee,ye,oi),0|V7(d,si,oi)&&(m[(X=I)>>2]=ee,m[X+4>>2]=ye,m[(X=Vt+(k<<3)|0)>>2]=ee,m[X+4>>2]=ye,k=k+1|0))}}while(0);Te=Te+1|0}while(Te>>>0<7);if((0|(Ye=Ye+1|0))>=(0|et))break;ze=ze+1|0}if((0|et)>0&&ac(0|Ut,0,et<<3|0),m[Wr>>2]=k,!((0|k)>0))break e;ee=M,ye=yt,Te=Rn,ze=qe,Ye=Nt,et=Vt,M=Dt,yt=C,qe=Rt,Nt=Ut,Dt=ee,C=ye,Rn=Lt,Lt=Te,Rt=ze,Ut=Ye,Vt=Ie,Ie=et}return Nn(Rt),Nn(Lt),Nn(si),me=bn,-1}C=ee}while(0);return Nn(si),Nn(M),Nn(C),me=bn,0}(d|=0,A|=0,y|=0)){if(k=0|m[(G=d)+4>>2],m[(I=M)>>2]=m[G>>2],m[I+4>>2]=k,t2(M,C),I=0|qw(C,A),A=0|m[M>>2],(0|(k=0|m[d+8>>2]))>0){M=0|m[d+12>>2],C=0;do{A=(0|m[M+(C<<3)>>2])+A|0,C=C+1|0}while((0|C)!=(0|k))}(0|(A=(0|I)<(0|A)?A:I))<=-12||ac(0|y,0,8+(((0|(G=A+11|0))>0?G:0)<<3)|0),me=L}else me=L},_res0IndexCount:function(){return 122},_round:eP,_sbrk:bd,_sizeOfCoordIJ:function(){return 8},_sizeOfGeoBoundary:function(){return 168},_sizeOfGeoCoord:function(){return 16},_sizeOfGeoPolygon:function(){return 16},_sizeOfGeofence:function(){return 8},_sizeOfH3Index:function(){return 8},_sizeOfLinkedGeoPolygon:function(){return 12},_uncompact:function(d,A,y,C,M){d|=0,y|=0,C|=0;var k=0,I=0,L=0,G=0,X=0,ee=0;if((0|(A|=0))<=0)return 0;if((0|(M|=0))>=16){for(k=0;;){if(!(0==(0|m[(ee=d+(k<<3)|0)>>2])&0==(0|m[ee+4>>2]))){k=14;break}if((0|(k=k+1|0))>=(0|A)){I=0,k=16;break}}if(14==(0|k))return 0|((0|C)>0?-2:-1);if(16==(0|k))return 0|I}k=0,ee=0;e:for(;;){I=0|m[(L=X=d+(ee<<3)|0)>>2],L=0|m[L+4>>2];do{if(!(0==(0|I)&0==(0|L))){if((0|k)>=(0|C)){I=-1,k=16;break e}if(G=0|Ct(0|I,0|L,52),De(),(0|(G&=15))>(0|M)){I=-2,k=16;break e}if((0|G)==(0|M)){m[(X=y+(k<<3)|0)>>2]=I,m[X+4>>2]=L,k=k+1|0;break}if((0|(I=(0|wv(7,M-G|0))+k|0))>(0|C)){I=-1,k=16;break e}pa(0|m[X>>2],0|m[X+4>>2],M,y+(k<<3)|0),k=I}}while(0);if((0|(ee=ee+1|0))>=(0|A)){I=0,k=16;break}}return 16==(0|k)?0|I:0},establishStackSpace:function(d,A){me=d|=0},stackAlloc:function(d){var A;return A=me,me=15+(me=me+(d|=0)|0)&-16,0|A},stackRestore:function(d){me=d|=0},stackSave:function(){return 0|me}}}({Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},{a:ef,b:function(je){V=je},c:K,d:function(je,ut,Pt,sn){ef("Assertion failed: "+Ho(je)+", at: "+[ut?Ho(ut):"unknown filename",Pt,sn?Ho(sn):"unknown function"])},e:function(je){return t.___errno_location&&(gd[t.___errno_location()>>2]=je),je},f:Ak,g:function(je,ut,Pt){lu.set(lu.subarray(ut,ut+Pt),je)},h:function(je){var ut=Ak(),sn=2130706432;if(je>sn)return!1;for(var Zr=Math.max(ut,16777216);Zr<je;)Zr=Zr<=536870912?em(2*Zr,16777216):Math.min(em((3*Zr+2147483648)/4,16777216),sn);return!!fk(Zr)},i:function(je){ef("OOM")},j:function(je){return je},k:hk,l:fk,m:dk,n:function(){var je=dk();return t.extraStackTrace&&(je+="\n"+t.extraStackTrace()),hk(je)},o:24032,p:24016},au),pj=(t.___uremdi3=kt.___uremdi3,t._bitshift64Lshr=kt._bitshift64Lshr,t._bitshift64Shl=kt._bitshift64Shl,t._calloc=kt._calloc,t._cellAreaKm2=kt._cellAreaKm2,t._cellAreaM2=kt._cellAreaM2,t._cellAreaRads2=kt._cellAreaRads2,t._compact=kt._compact,t._destroyLinkedPolygon=kt._destroyLinkedPolygon,t._edgeLengthKm=kt._edgeLengthKm,t._edgeLengthM=kt._edgeLengthM,t._emscripten_replace_memory=kt._emscripten_replace_memory),pk=(t._exactEdgeLengthKm=kt._exactEdgeLengthKm,t._exactEdgeLengthM=kt._exactEdgeLengthM,t._exactEdgeLengthRads=kt._exactEdgeLengthRads,t._experimentalH3ToLocalIj=kt._experimentalH3ToLocalIj,t._experimentalLocalIjToH3=kt._experimentalLocalIjToH3,t._free=kt._free,t._geoToH3=kt._geoToH3,t._getDestinationH3IndexFromUnidirectionalEdge=kt._getDestinationH3IndexFromUnidirectionalEdge,t._getH3IndexesFromUnidirectionalEdge=kt._getH3IndexesFromUnidirectionalEdge,t._getH3UnidirectionalEdge=kt._getH3UnidirectionalEdge,t._getH3UnidirectionalEdgeBoundary=kt._getH3UnidirectionalEdgeBoundary,t._getH3UnidirectionalEdgesFromHexagon=kt._getH3UnidirectionalEdgesFromHexagon,t._getOriginH3IndexFromUnidirectionalEdge=kt._getOriginH3IndexFromUnidirectionalEdge,t._getPentagonIndexes=kt._getPentagonIndexes,t._getRes0Indexes=kt._getRes0Indexes,t._h3Distance=kt._h3Distance,t._h3GetBaseCell=kt._h3GetBaseCell,t._h3GetFaces=kt._h3GetFaces,t._h3GetResolution=kt._h3GetResolution,t._h3IndexesAreNeighbors=kt._h3IndexesAreNeighbors,t._h3IsPentagon=kt._h3IsPentagon,t._h3IsResClassIII=kt._h3IsResClassIII,t._h3IsValid=kt._h3IsValid,t._h3Line=kt._h3Line,t._h3LineSize=kt._h3LineSize,t._h3SetToLinkedGeo=kt._h3SetToLinkedGeo,t._h3ToCenterChild=kt._h3ToCenterChild,t._h3ToChildren=kt._h3ToChildren,t._h3ToGeo=kt._h3ToGeo,t._h3ToGeoBoundary=kt._h3ToGeoBoundary,t._h3ToParent=kt._h3ToParent,t._h3UnidirectionalEdgeIsValid=kt._h3UnidirectionalEdgeIsValid,t._hexAreaKm2=kt._hexAreaKm2,t._hexAreaM2=kt._hexAreaM2,t._hexRing=kt._hexRing,t._i64Subtract=kt._i64Subtract,t._kRing=kt._kRing,t._kRingDistances=kt._kRingDistances,t._llvm_minnum_f64=kt._llvm_minnum_f64,t._llvm_round_f64=kt._llvm_round_f64,t._malloc=kt._malloc,t._maxFaceCount=kt._maxFaceCount,t._maxH3ToChildrenSize=kt._maxH3ToChildrenSize,t._maxKringSize=kt._maxKringSize,t._maxPolyfillSize=kt._maxPolyfillSize,t._maxUncompactSize=kt._maxUncompactSize,t._memcpy=kt._memcpy,t._memset=kt._memset,t._numHexagons=kt._numHexagons,t._pentagonIndexCount=kt._pentagonIndexCount,t._pointDistKm=kt._pointDistKm,t._pointDistM=kt._pointDistM,t._pointDistRads=kt._pointDistRads,t._polyfill=kt._polyfill,t._res0IndexCount=kt._res0IndexCount,t._round=kt._round,t._sbrk=kt._sbrk,t._sizeOfCoordIJ=kt._sizeOfCoordIJ,t._sizeOfGeoBoundary=kt._sizeOfGeoBoundary,t._sizeOfGeoCoord=kt._sizeOfGeoCoord,t._sizeOfGeoPolygon=kt._sizeOfGeoPolygon,t._sizeOfGeofence=kt._sizeOfGeofence,t._sizeOfH3Index=kt._sizeOfH3Index,t._sizeOfLinkedGeoPolygon=kt._sizeOfLinkedGeoPolygon,t._uncompact=kt._uncompact,t.establishStackSpace=kt.establishStackSpace,t.stackAlloc=kt.stackAlloc),mj=t.stackRestore=kt.stackRestore,gj=t.stackSave=kt.stackSave;if(t.asm=kt,t.cwrap=function(je,ut,Pt,sn){var m=(Pt=Pt||[]).every(function(Dr){return"number"===Dr});return"string"!==ut&&m&&!sn?He(je):function(){return Ot(je,ut,Pt,arguments)}},t.setValue=function(je,ut,Pt,sn){switch("*"===(Pt=Pt||"i8").charAt(Pt.length-1)&&(Pt="i32"),Pt){case"i1":case"i8":_l[je>>0]=ut;break;case"i16":KA[je>>1]=ut;break;case"i32":gd[je>>2]=ut;break;case"i64":Bw=[ut>>>0,(tm=ut,+KU(tm)>=1?tm>0?(0|tj(+ej(tm/4294967296),4294967295))>>>0:~~+JU((tm-+(~~tm>>>0))/4294967296)>>>0:0)],gd[je>>2]=Bw[0],gd[je+4>>2]=Bw[1];break;case"float":Rw[je>>2]=ut;break;case"double":Fw[je>>3]=ut;break;default:ef("invalid type for setValue: "+Pt)}},t.getValue=function(je,ut,Pt){switch("*"===(ut=ut||"i8").charAt(ut.length-1)&&(ut="i32"),ut){case"i1":case"i8":return _l[je>>0];case"i16":return KA[je>>1];case"i32":case"i64":return gd[je>>2];case"float":return Rw[je>>2];case"double":return Fw[je>>3];default:ef("invalid type for getValue: "+ut)}return null},t.getTempRet0=K,gh){ck(gh)||(je=gh,gh=t.locateFile?t.locateFile(je,c):c+je),JA++,t.monitorRunDependencies&&t.monitorRunDependencies(JA);var zw=function(je){je.byteLength&&(je=new Uint8Array(je)),lu.set(je,8),t.memoryInitializerRequest&&delete t.memoryInitializerRequest.response,function(je){if(JA--,t.monitorRunDependencies&&t.monitorRunDependencies(JA),0==JA&&(null!==Ow&&(clearInterval(Ow),Ow=null),y0)){var ut=y0;y0=null,ut()}}()},mk=function(){w(gh,zw,function(){throw"could not load memory initializer "+gh})},gk=Nw(gh);if(gk)zw(gk.buffer);else if(t.memoryInitializerRequest){var _k=function(){var je=t.memoryInitializerRequest,ut=je.response;if(200!==je.status&&0!==je.status){var Pt=Nw(t.memoryInitializerRequestURL);if(!Pt)return console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+je.status+", retrying "+gh),void mk();ut=Pt.buffer}zw(ut)};t.memoryInitializerRequest.response?setTimeout(_k,0):t.memoryInitializerRequest.addEventListener("load",_k)}else mk()}function Vw(je){function ut(){gv||(gv=!0,!Re&&(mv($U),mv(HU),t.onRuntimeInitialized&&t.onRuntimeInitialized(),function(){if(t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;)je=t.postRun.shift(),lk.unshift(je);var je;mv(lk)}()))}je=je||o,JA>0||(function(){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)je=t.preRun.shift(),ak.unshift(je);var je;mv(ak)}(),JA>0)||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),ut()},1)):ut())}function ef(je){throw t.onAbort&&t.onAbort(je),T(je+=""),O(je),Re=!0,"abort("+je+"). Build with -s ASSERTIONS=1 for more info."}if(y0=function je(){gv||Vw(),gv||(y0=je)},t.run=Vw,t.abort=ef,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Vw(),n}("object"==typeof _t?_t:{}),rn="number",jt={};[["sizeOfH3Index",rn],["sizeOfGeoCoord",rn],["sizeOfGeoBoundary",rn],["sizeOfGeoPolygon",rn],["sizeOfGeofence",rn],["sizeOfLinkedGeoPolygon",rn],["sizeOfCoordIJ",rn],["h3IsValid",rn,[rn,rn]],["geoToH3",rn,[rn,rn,rn]],["h3ToGeo",null,[rn,rn,rn]],["h3ToGeoBoundary",null,[rn,rn,rn]],["maxKringSize",rn,[rn]],["kRing",null,[rn,rn,rn,rn]],["kRingDistances",null,[rn,rn,rn,rn,rn]],["hexRing",null,[rn,rn,rn,rn]],["maxPolyfillSize",rn,[rn,rn]],["polyfill",null,[rn,rn,rn]],["h3SetToLinkedGeo",null,[rn,rn,rn]],["destroyLinkedPolygon",null,[rn]],["compact",rn,[rn,rn,rn]],["uncompact",rn,[rn,rn,rn,rn,rn]],["maxUncompactSize",rn,[rn,rn,rn]],["h3IsPentagon",rn,[rn,rn]],["h3IsResClassIII",rn,[rn,rn]],["h3GetBaseCell",rn,[rn,rn]],["h3GetResolution",rn,[rn,rn]],["maxFaceCount",rn,[rn,rn]],["h3GetFaces",null,[rn,rn,rn]],["h3ToParent",rn,[rn,rn,rn]],["h3ToChildren",null,[rn,rn,rn,rn]],["h3ToCenterChild",rn,[rn,rn,rn]],["maxH3ToChildrenSize",rn,[rn,rn,rn]],["h3IndexesAreNeighbors",rn,[rn,rn,rn,rn]],["getH3UnidirectionalEdge",rn,[rn,rn,rn,rn]],["getOriginH3IndexFromUnidirectionalEdge",rn,[rn,rn]],["getDestinationH3IndexFromUnidirectionalEdge",rn,[rn,rn]],["h3UnidirectionalEdgeIsValid",rn,[rn,rn]],["getH3IndexesFromUnidirectionalEdge",null,[rn,rn,rn]],["getH3UnidirectionalEdgesFromHexagon",null,[rn,rn,rn]],["getH3UnidirectionalEdgeBoundary",null,[rn,rn,rn]],["h3Distance",rn,[rn,rn,rn,rn]],["h3Line",rn,[rn,rn,rn,rn,rn]],["h3LineSize",rn,[rn,rn,rn,rn]],["experimentalH3ToLocalIj",rn,[rn,rn,rn,rn,rn]],["experimentalLocalIjToH3",rn,[rn,rn,rn,rn]],["hexAreaM2",rn,[rn]],["hexAreaKm2",rn,[rn]],["edgeLengthM",rn,[rn]],["edgeLengthKm",rn,[rn]],["pointDistM",rn,[rn,rn]],["pointDistKm",rn,[rn,rn]],["pointDistRads",rn,[rn,rn]],["cellAreaM2",rn,[rn,rn]],["cellAreaKm2",rn,[rn,rn]],["cellAreaRads2",rn,[rn,rn]],["exactEdgeLengthM",rn,[rn,rn]],["exactEdgeLengthKm",rn,[rn,rn]],["exactEdgeLengthRads",rn,[rn,rn]],["numHexagons",rn,[rn]],["getRes0Indexes",null,[rn]],["res0IndexCount",rn],["getPentagonIndexes",null,[rn,rn]],["pentagonIndexCount",rn]].forEach(function(t){jt[t[0]]=_t.cwrap.apply(_t,t)}),jt.sizeOfH3Index(),jt.sizeOfGeoCoord();var qT=jt.sizeOfGeoBoundary();jt.sizeOfGeoPolygon(),jt.sizeOfGeofence(),jt.sizeOfLinkedGeoPolygon(),jt.sizeOfCoordIJ();var f6=/[^0-9a-fA-F]/;function iv(n){return function(n){return 180*n/Math.PI}(_t.getValue(n,"double"))}function cw(n){return[iv(n),iv(n+8)]}function eI(n){return[iv(n+8),iv(n)]}let nI=(()=>{class n{constructor(){}getGeojsonForHex(e){return{type:"Polygon",coordinates:[function(n,t){var e=_t._malloc(qT),r=function(n){if(Array.isArray(n)&&2===n.length&&Number.isInteger(n[0])&&Number.isInteger(n[1]))return n;if("string"!=typeof n||f6.test(n))return[0,0];var t=parseInt(n.substring(0,n.length-8),16);return[parseInt(n.substring(n.length-8),16),t]}(n);jt.h3ToGeoBoundary(r[0],r[1],e);var p=function(n,t,e){for(var r=_t.getValue(n,"i32"),o=n+8,c=[],p=t?eI:cw,w=0;w<2*r;w+=2)c.push(p(o+8*w));return e&&c.push(c[0]),c}(e,true,true);return _t._free(e),p}(e).map(c=>c)]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),rI=(()=>{class n{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(lt(ah),lt(Xi))},n.\u0275dir=Kt({type:n}),n})(),QA=(()=>{class n extends rI{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Pn(n)))(r||n)}}(),n.\u0275dir=Kt({type:n,features:[ui]}),n})();const su=new on("NgValueAccessor"),D6={provide:su,useExisting:Zn(()=>ov),multi:!0},S6=new on("CompositionEventMode");let ov=(()=>{class n extends rI{constructor(e,r,o){super(e,r),this._compositionMode=o,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const n=tu()?tu().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",null==e?"":e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(lt(ah),lt(Xi),lt(S6,8))},n.\u0275dir=Kt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,r){1&e&&Er("input",function(c){return r._handleInput(c.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(c){return r._compositionEnd(c.target.value)})},features:[hi([D6]),ui]}),n})();const As=new on("NgValidators"),dd=new on("NgAsyncValidators");function fI(n){return null!=n}function pI(n){const t=wg(n)?Nr(n):n;return B_(t),t}function mI(n){let t={};return n.forEach(e=>{t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function gI(n,t){return t.map(e=>e(n))}function _I(n){return n.map(t=>function(n){return!n.validate}(t)?t:e=>t.validate(e))}function hw(n){return null!=n?function(n){if(!n)return null;const t=n.filter(fI);return 0==t.length?null:function(e){return mI(gI(e,t))}}(_I(n)):null}function dw(n){return null!=n?function(n){if(!n)return null;const t=n.filter(fI);return 0==t.length?null:function(e){return kT(gI(e,t).map(pI)).pipe(pn(mI))}}(_I(n)):null}function xI(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function Aw(n){return n?Array.isArray(n)?n:[n]:[]}function sv(n,t){return Array.isArray(n)?n.includes(t):n===t}function CI(n,t){const e=Aw(t);return Aw(n).forEach(o=>{sv(e,o)||e.push(o)}),e}function EI(n,t){return Aw(t).filter(e=>!sv(n,e))}let DI=(()=>{class n{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=hw(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=dw(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,r){return!!this.control&&this.control.hasError(e,r)}getError(e,r){return this.control?this.control.getError(e,r):null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Kt({type:n}),n})(),js=(()=>{class n extends DI{get formDirective(){return null}get path(){return null}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Pn(n)))(r||n)}}(),n.\u0275dir=Kt({type:n,features:[ui]}),n})();class fd extends DI{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let SI=(()=>{class n extends class{constructor(t){this._cd=t}is(t){var e,r,o;return"submitted"===t?!!(null===(e=this._cd)||void 0===e?void 0:e.submitted):!!(null===(o=null===(r=this._cd)||void 0===r?void 0:r.control)||void 0===o?void 0:o[t])}}{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(lt(fd,2))},n.\u0275dir=Kt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,r){2&e&&ua("ng-untouched",r.is("untouched"))("ng-touched",r.is("touched"))("ng-pristine",r.is("pristine"))("ng-dirty",r.is("dirty"))("ng-valid",r.is("valid"))("ng-invalid",r.is("invalid"))("ng-pending",r.is("pending"))},features:[ui]}),n})();function p0(n,t){(function(n,t){const e=function(n){return n._rawValidators}(n);null!==t.validator?n.setValidators(xI(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const r=function(n){return n._rawAsyncValidators}(n);null!==t.asyncValidator?n.setAsyncValidators(xI(r,t.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const o=()=>n.updateValueAndValidity();uv(t._rawValidators,o),uv(t._rawAsyncValidators,o)})(n,t),t.valueAccessor.writeValue(n.value),function(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&TI(n,t)})}(n,t),function(n,t){const e=(r,o)=>{t.valueAccessor.writeValue(r),o&&t.viewToModelUpdate(r)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&TI(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function(n,t){if(t.valueAccessor.setDisabledState){const e=r=>{t.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function uv(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function TI(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function dv(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}const m0="VALID",Av="INVALID",Jp="PENDING",g0="DISABLED";function yw(n){return(xw(n)?n.validators:n)||null}function PI(n){return Array.isArray(n)?hw(n):n||null}function vw(n,t){return(xw(t)?t.asyncValidators:n)||null}function RI(n){return Array.isArray(n)?dw(n):n||null}function xw(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class bw{constructor(t,e){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=PI(this._rawValidators),this._composedAsyncValidatorFn=RI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===m0}get invalid(){return this.status===Av}get pending(){return this.status==Jp}get disabled(){return this.status===g0}get enabled(){return this.status!==g0}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=PI(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=RI(t)}addValidators(t){this.setValidators(CI(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(CI(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(EI(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(EI(t,this._rawAsyncValidators))}hasValidator(t){return sv(this._rawValidators,t)}hasAsyncValidator(t){return sv(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=Jp,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=g0,this.errors=null,this._forEachChild(r=>{r.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=m0,this._forEachChild(r=>{r.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===m0||this.status===Jp)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?g0:m0}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=Jp,this._hasOwnPendingAsyncValidator=!0;const e=pI(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(n,t,e){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;let r=n;return t.forEach(o=>{r=r instanceof ww?r.controls.hasOwnProperty(o)?r.controls[o]:null:r instanceof G6&&r.at(o)||null}),r}(this,t)}getError(t,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new rt,this.statusChanges=new rt}_calculateStatus(){return this._allControlsDisabled()?g0:this.errors?Av:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Jp)?Jp:this._anyControlsHaveStatus(Av)?Av:m0}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){xw(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class fv extends bw{constructor(t=null,e,r){super(yw(e),vw(r,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){dv(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){dv(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class ww extends bw{constructor(t,e,r){super(yw(e),vw(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(r=>{this._throwIfControlMissing(r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(r=>{this.controls[r]&&this.controls[r].patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,o)=>{r.reset(t[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=e instanceof fv?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const r=this.controls[e];if(this.contains(e)&&t(r))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,r)=>((e.enabled||this.disabled)&&(t[r]=e.value),t))}_reduceChildren(t,e){let r=t;return this._forEachChild((o,c)=>{r=e(r,o,c)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,r)=>{if(void 0===t[r])throw new Error(`Must supply a value for form control with name: '${r}'.`)})}}class G6 extends bw{constructor(t,e,r){super(yw(e),vw(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[t]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,r={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((r,o)=>{this._throwIfControlMissing(o),this.at(o).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((r,o)=>{this.at(o)&&this.at(o).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((r,o)=>{r.reset(t[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof fv?t.value:t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_syncPendingControls(){let t=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error(`Cannot find form control at index ${t}`)}_forEachChild(t){this.controls.forEach((e,r)=>{t(e,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,r)=>{if(void 0===t[r])throw new Error(`Must supply a value for form control at index: ${r}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const q6={provide:fd,useExisting:Zn(()=>Ew)},LI=(()=>Promise.resolve(null))();let Ew=(()=>{class n extends fd{constructor(e,r,o,c){super(),this.control=new fv,this._registered=!1,this.update=new rt,this._parent=e,this._setValidators(r),this._setAsyncValidators(o),this.valueAccessor=function(n,t){if(!t)return null;let e,r,o;return Array.isArray(t),t.forEach(c=>{c.constructor===ov?e=c:function(n){return Object.getPrototypeOf(n.constructor)===QA}(c)?r=c:o=c}),o||r||e||null}(0,c)}ngOnChanges(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),function(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function(n,t){return[...t.path,n]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){p0(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){LI.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1})})}_updateDisabled(e){const r=e.isDisabled.currentValue,o=""===r||r&&"false"!==r;LI.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable()})}}return n.\u0275fac=function(e){return new(e||n)(lt(js,9),lt(As,10),lt(dd,10),lt(su,10))},n.\u0275dir=Kt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[hi([q6]),ui,Sr]}),n})();const W6={provide:su,useExisting:Zn(()=>Dw),multi:!0};let Dw=(()=>{class n extends QA{writeValue(e){this.setProperty("value",null==e?"":e)}registerOnChange(e){this.onChange=r=>{e(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Pn(n)))(r||n)}}(),n.\u0275dir=Kt({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,r){1&e&&Er("input",function(c){return r.onChange(c.target.value)})("blur",function(){return r.onTouched()})},features:[hi([W6]),ui]}),n})(),BI=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Gi({type:n}),n.\u0275inj=gr({}),n})();const Mw=new on("NgModelWithFormControlWarning"),rU={provide:su,useExisting:Zn(()=>pv),multi:!0};function GI(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let pv=(()=>{class n extends QA{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=this._getOptionId(e);null==r&&this.setProperty("selectedIndex",-1);const o=GI(r,e);this.setProperty("value",o)}registerOnChange(e){this.onChange=r=>{this.value=this._getOptionValue(r),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),e))return r;return null}_getOptionValue(e){const r=function(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r):e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Pn(n)))(r||n)}}(),n.\u0275dir=Kt({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,r){1&e&&Er("change",function(c){return r.onChange(c.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[hi([rU]),ui]}),n})(),$I=(()=>{class n{constructor(e,r,o){this._element=e,this._renderer=r,this._select=o,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(GI(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(lt(Xi),lt(ah),lt(pv,9))},n.\u0275dir=Kt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const oU={provide:su,useExisting:Zn(()=>kw),multi:!0};function HI(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let kw=(()=>{class n extends QA{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let r;if(this.value=e,Array.isArray(e)){const o=e.map(c=>this._getOptionId(c));r=(c,p)=>{c._setSelected(o.indexOf(p.toString())>-1)}}else r=(o,c)=>{o._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(e){this.onChange=r=>{const o=[];if(void 0!==r.selectedOptions){const c=r.selectedOptions;for(let p=0;p<c.length;p++){const w=c.item(p),T=this._getOptionValue(w.value);o.push(T)}}else{const c=r.options;for(let p=0;p<c.length;p++){const w=c.item(p);if(w.selected){const T=this._getOptionValue(w.value);o.push(T)}}}this.value=o,e(o)}}_registerOption(e){const r=(this._idCounter++).toString();return this._optionMap.set(r,e),r}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,e))return r;return null}_getOptionValue(e){const r=function(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r)._value:e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Pn(n)))(r||n)}}(),n.\u0275dir=Kt({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,r){1&e&&Er("change",function(c){return r.onChange(c.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[hi([oU]),ui]}),n})(),qI=(()=>{class n{constructor(e,r,o){this._element=e,this._renderer=r,this._select=o,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(HI(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(HI(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(lt(Xi),lt(ah),lt(kw,9))},n.\u0275dir=Kt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})(),nk=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Gi({type:n}),n.\u0275inj=gr({imports:[[BI]]}),n})(),pU=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Gi({type:n}),n.\u0275inj=gr({imports:[nk]}),n})(),mU=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:Mw,useValue:e.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Gi({type:n}),n.\u0275inj=gr({imports:[nk]}),n})();function gU(n,t){if(1&n&&(We(0,"li"),Bs(1,"span"),Qe()),2&n){const e=t.$implicit;Ht(1),RA("background",e)}}function _U(n,t){1&n&&(We(0,"p",39),Zt(1," Minimal value have to be >= 0. "),Qe())}function yU(n,t){1&n&&(We(0,"p",39),Zt(1," Maximal value have to be <= 1. "),Qe())}function vU(n,t){if(1&n&&(We(0,"p",39),Zt(1),Qe()),2&n){const e=Ur(2);Ht(1),FA(" Minimal value (",e.tempFilterMinValue,") have to be <= maximal value (",e.tempFilterMaxValue,"). ")}}function xU(n,t){if(1&n&&(F_(0),Zt(1),yx(2,"number"),O_()),2&n){const e=Ur().index,r=Ur(2);Ht(1),za(" ",vx(2,1,r.legendMinValue+e/r.currentGradient.colors.length*(r.legendMaxValue-r.legendMinValue),"1.0-2")," - ")}}function bU(n,t){if(1&n&&(We(0,"li"),Bs(1,"span"),Qi(2,xU,3,4,"ng-container",40),Zt(3),yx(4,"number"),Qe()),2&n){const e=t.$implicit,r=t.index,o=Ur(2);Ht(1),RA("background",e),Ht(1),vn("ngIf",0==r),Ht(1),za(" ",vx(4,4,o.legendMinValue+(r+1)/o.currentGradient.colors.length*(o.legendMaxValue-o.legendMinValue),"1.0-2")," ")}}function wU(n,t){1&n&&(We(0,"p",39),Zt(1," Minimal value have to be >= 0. "),Qe())}function CU(n,t){1&n&&(We(0,"p",39),Zt(1," Maximal value have to be <= 1. "),Qe())}function EU(n,t){if(1&n&&(We(0,"p",39),Zt(1),Qe()),2&n){const e=Ur(2);Ht(1),FA(" Minimal value (",e.tempFilterMinValue,") have to be <= maximal value (",e.tempFilterMaxValue,"). ")}}function DU(n,t){if(1&n){const e=L_();We(0,"div",19),We(1,"div",20),We(2,"div",21),We(3,"div",22),Zt(4),Qe(),We(5,"div",23),We(6,"ul",24),Qi(7,gU,2,2,"li",25),Qe(),Qe(),We(8,"div",26),We(9,"div"),Zt(10),Qe(),Bs(11,"div",27),We(12,"div"),Zt(13),Qe(),Qe(),We(14,"div",28),We(15,"p",29),We(16,"input",30),Er("ngModelChange",function(o){return qi(e),Ur().tempFilterMinValue=o}),Qe(),Qe(),We(17,"p",29),We(18,"a",31),Zt(19," - "),Qe(),Qe(),We(20,"p",29),We(21,"input",32),Er("ngModelChange",function(o){return qi(e),Ur().tempFilterMaxValue=o}),Qe(),Qe(),We(22,"p",29),We(23,"a",33),Er("click",function(){return qi(e),Ur().applyFilter()}),Zt(24,"Filter"),Qe(),Qe(),Qe(),Qi(25,_U,2,0,"p",34),Qi(26,yU,2,0,"p",34),Qi(27,vU,2,2,"p",34),Qe(),Qe(),We(28,"div",35),We(29,"div",21),We(30,"div",22),Zt(31),Qe(),We(32,"div",23),We(33,"ul",24),Qi(34,bU,5,7,"li",25),Qe(),Qe(),Qe(),Qe(),We(35,"div",36),Bs(36,"google-chart",37),We(37,"div",38),We(38,"p",29),We(39,"a",31),Zt(40,"Min:"),Qe(),Qe(),We(41,"p",29),We(42,"input",30),Er("ngModelChange",function(o){return qi(e),Ur().tempFilterMinValue=o}),Qe(),Qe(),We(43,"p",29),We(44,"a",31),Zt(45," - "),Qe(),Qe(),We(46,"p",29),We(47,"a",31),Zt(48,"Max:"),Qe(),Qe(),We(49,"p",29),We(50,"input",32),Er("ngModelChange",function(o){return qi(e),Ur().tempFilterMaxValue=o}),Qe(),Qe(),We(51,"p",29),We(52,"a",33),Er("click",function(){return qi(e),Ur().applyFilter()}),Zt(53,"Filter"),Qe(),Qe(),We(54,"p",29),We(55,"a",33),Er("click",function(){return qi(e),Ur().resetFilter()}),Zt(56,"Reset"),Qe(),Qe(),Qe(),Qi(57,wU,2,0,"p",34),Qi(58,CU,2,0,"p",34),Qi(59,EU,2,2,"p",34),Qe(),Qe()}if(2&n){const e=Ur();Ht(4),FA(" Number of hexes: ",e.currentHexes.length," (Filtered: ",e.currentHexesFiltered.length,") "),Ht(3),vn("ngForOf",e.currentGradient.colors),Ht(3),za(" ",e.legendMinValue," "),Ht(3),za(" ",e.legendMaxValue," "),Ht(3),ua("is-danger",e.tempFilterMinValue<0||e.tempFilterMinValue>e.tempFilterMaxValue),vn("ngModel",e.tempFilterMinValue),Ht(5),ua("is-danger",e.tempFilterMaxValue>1||e.tempFilterMinValue>e.tempFilterMaxValue),vn("ngModel",e.tempFilterMaxValue),Ht(2),ua("is-static",e.tempFilterMinValue==e.filterMinValue&&e.tempFilterMaxValue==e.filterMaxValue||e.tempFilterMinValue<0||e.tempFilterMaxValue>1||e.tempFilterMinValue>e.tempFilterMaxValue)("is-primary",(e.tempFilterMinValue!=e.filterMinValue||e.tempFilterMaxValue!=e.filterMaxValue)&&e.tempFilterMinValue>=0&&e.tempFilterMaxValue<=1&&e.tempFilterMinValue<=e.tempFilterMaxValue),Ht(2),vn("ngIf",e.tempFilterMinValue<0),Ht(1),vn("ngIf",e.tempFilterMaxValue>1),Ht(1),vn("ngIf",e.tempFilterMinValue>e.tempFilterMaxValue),Ht(4),FA(" Number of hexes: ",e.currentHexes.length," (Filtered: ",e.currentHexesFiltered.length,") "),Ht(3),vn("ngForOf",e.currentGradient.colors),Ht(2),vn("type",e.chartType)("data",e.currentHexesValues)("options",e.chartOptions),Ht(6),ua("is-danger",e.tempFilterMinValue<0||e.tempFilterMinValue>e.tempFilterMaxValue),vn("ngModel",e.tempFilterMinValue),Ht(8),ua("is-danger",e.tempFilterMaxValue>1||e.tempFilterMinValue>e.tempFilterMaxValue),vn("ngModel",e.tempFilterMaxValue),Ht(2),ua("is-static",e.tempFilterMinValue==e.filterMinValue&&e.tempFilterMaxValue==e.filterMaxValue||e.tempFilterMinValue<0||e.tempFilterMaxValue>1||e.tempFilterMinValue>e.tempFilterMaxValue)("is-primary",(e.tempFilterMinValue!=e.filterMinValue||e.tempFilterMaxValue!=e.filterMaxValue)&&e.tempFilterMinValue>=0&&e.tempFilterMaxValue<=1&&e.tempFilterMinValue<=e.tempFilterMaxValue),Ht(3),ua("is-static",e.filterMinValue==e.minValue&&e.filterMaxValue==e.maxValue)("is-light",e.filterMinValue!=e.minValue||e.filterMaxValue!=e.maxValue),Ht(2),vn("ngIf",e.tempFilterMinValue<0),Ht(1),vn("ngIf",e.tempFilterMaxValue>1),Ht(1),vn("ngIf",e.tempFilterMinValue>e.tempFilterMaxValue)}}function MU(n,t){if(1&n&&(F_(0),Zt(1),O_()),2&n){const e=Ur(2);Ht(1),za("(",e.progress,"%)")}}function SU(n,t){if(1&n&&(We(0,"div",41),We(1,"span",42),Zt(2,"Loading data "),Qi(3,MU,2,1,"ng-container",40),Qe(),Qe()),2&n){const e=Ur();ua("is-loading",e.loading),Ht(3),vn("ngIf",e.initialized)}}function TU(n,t){if(1&n&&(We(0,"option",56),Zt(1),Qe()),2&n){const e=t.$implicit,r=Ur(3);vn("ngValue",e.id),Ht(1),FA(" ",e.name," (",r.formatBytes(e.sizeBytes),") ")}}function IU(n,t){if(1&n&&(We(0,"optgroup",58),Qi(1,TU,2,3,"option",57),Qe()),2&n){const e=t.$implicit,r=Ur(2);vn("label",e),Ht(1),vn("ngForOf",r.getCitiesForGroup(e))}}function kU(n,t){if(1&n&&(We(0,"option",56),Zt(1),Qe()),2&n){const e=t.$implicit;vn("ngValue",e.id),Ht(1),za(" ",e.name," ")}}function PU(n,t){if(1&n&&(We(0,"option",56),Zt(1),Qe()),2&n){const e=t.$implicit;vn("ngValue",e),Ht(1),za(" ",100*e,"% ")}}function RU(n,t){if(1&n&&(We(0,"option",56),Zt(1),Qe()),2&n){const e=t.$implicit;vn("ngValue",e.name),Ht(1),za(" ",e.name," ")}}function FU(n,t){if(1&n&&(We(0,"option",56),Zt(1),Qe()),2&n){const e=t.$implicit;vn("ngValue",e),Ht(1),za(" ",e.name," ")}}const rk=function(n){return{"is-active":n}};function OU(n,t){if(1&n){const e=L_();We(0,"div",43),We(1,"div",44),Er("click",function(){return qi(e),Ur().toggleSettingsModal()}),Qe(),We(2,"div",45),We(3,"h2",46),Zt(4,"Ustawienia"),Qe(),We(5,"div"),We(6,"div",47),We(7,"div",48),We(8,"label",49),Zt(9,"City"),Qe(),Qe(),We(10,"div",50),We(11,"div",51),We(12,"div",29),We(13,"div",52),We(14,"select",53),Er("ngModelChange",function(o){return qi(e),Ur().currentCityId=o})("ngModelChange",function(){return qi(e),Ur().onCitySelect()}),We(15,"option",54),Zt(16),Qe(),Qi(17,IU,2,2,"optgroup",55),Qe(),Qe(),Qe(),Qe(),Qe(),Qe(),We(18,"div",47),We(19,"div",48),We(20,"label",49),Zt(21,"Classifier"),Qe(),Qe(),We(22,"div",50),We(23,"div",51),We(24,"div",29),We(25,"div",52),We(26,"select",53),Er("ngModelChange",function(o){return qi(e),Ur().currentClassifierId=o})("ngModelChange",function(){return qi(e),Ur().onClassifierSelect()}),We(27,"option",56),Zt(28,"None"),Qe(),Qi(29,kU,2,2,"option",57),Qe(),Qe(),Qe(),Qe(),Qe(),Qe(),We(30,"div",47),We(31,"div",48),We(32,"label",49),Zt(33,"Opacity"),Qe(),Qe(),We(34,"div",50),We(35,"div",51),We(36,"div",29),We(37,"div",52),We(38,"select",53),Er("ngModelChange",function(o){return qi(e),Ur().currentOpacity=o}),Qi(39,PU,2,2,"option",57),Qe(),Qe(),Qe(),Qe(),Qe(),Qe(),We(40,"div",47),We(41,"div",48),We(42,"label",49),Zt(43,"Gradient"),Qe(),Qe(),We(44,"div",50),We(45,"div",51),We(46,"div",29),We(47,"div",52),We(48,"select",53),Er("ngModelChange",function(o){return qi(e),Ur().currentGradientName=o}),Qi(49,RU,2,2,"option",57),Qe(),Qe(),Qe(),Qe(),Qe(),Qe(),We(50,"div",47),We(51,"div",48),We(52,"label",49),Zt(53,"Map style"),Qe(),Qe(),We(54,"div",50),We(55,"div",51),We(56,"div",29),We(57,"div",52),We(58,"select",53),Er("ngModelChange",function(o){return qi(e),Ur().currentMapStyle=o}),Qi(59,FU,2,2,"option",57),Qe(),Qe(),Qe(),Qe(),Qe(),Qe(),Qe(),Qe(),Qe()}if(2&n){const e=Ur();vn("ngClass",_x(16,rk,e.isSettingsModalActive)),Ht(14),vn("ngModel",e.currentCityId),Ht(1),vn("ngValue",e.currentCityId),Ht(1),za(" ",e.currentCity.name," "),Ht(1),vn("ngForOf",e.cityGroups),Ht(9),vn("ngModel",e.currentClassifierId),Ht(1),vn("ngValue",null),Ht(2),vn("ngForOf",e.classifiers),Ht(9),vn("ngModel",e.currentOpacity),Ht(1),vn("ngForOf",e.opacities),Ht(9),ul(e.getGradientCss(e.currentGradient.colors)),vn("ngModel",e.currentGradientName),Ht(1),vn("ngForOf",e.gradients),Ht(9),vn("ngModel",e.currentMapStyle),Ht(1),vn("ngForOf",e.mapStyles)}}function LU(n,t){if(1&n){const e=L_();We(0,"div",43),We(1,"div",44),Er("click",function(){return qi(e),Ur().toggleAboutModal()}),Qe(),We(2,"div",45),We(3,"h2",59),Zt(4),Qe(),We(5,"h4",60),Zt(6," Kamil Raczycki | Piotr Szyma\u0144ski "),Qe(),We(7,"div",61),We(8,"span"),Zt(9,"Project description:"),Qe(),Zt(10," Based on data collected from 34 European cities, a method for automatically generating a heat map has been developed to support planners in developing the layout of bike sharing stations. The model was developed as part of a Master's thesis and published at the ARIC workshop at SIGSPATIAL 2021. The website allows the user to view all generated results for different cities of the world for many of the available heat map models with the possibility to change the colour scheme and style of the map. "),Qe(),We(11,"div",61),We(12,"span"),Zt(13,"Paper abstract:"),Qe(),Zt(14," Bicycle-sharing systems (BSS) have become a daily reality for many citizens of larger, wealthier cities in developed regions. However, planning the layout of bicycle-sharing stations usually requires expensive data gathering, surveying travel behavior and trip modelling followed by station layout optimization. Many smaller cities and towns, especially in developing areas, may have difficulty financing such projects. Planning a BSS also takes a considerable amount of time. Yet as the pandemic has shown us, municipalities will face the need to adapt rapidly to mobility shifts, which include citizens leaving public transport for bicycles. Laying out a bike sharing system quickly will become critical in addressing the increase in bike demand. This paper addresses the problem of cost and time in BSS layout design and proposes a new solution to streamline and facilitate the process of such planning by using spatial embedding methods. Based only on publicly available data from OpenStreetMap, and station layouts from 34 cities in Europe, a method has been developed to divide cities into micro-regions using the Uber H3 discrete global grid system and to indicate regions where it is worth placing a station based on existing systems in different cities using transfer learning. The result of the work is a mechanism to support planners in their decision making when planning a station layout with a choice of reference cities. "),Qe(),We(15,"div",62),We(16,"a",63),Zt(17,"Github"),Qe(),Zt(18," | "),We(19,"a",64),Zt(20,"Arxiv (ACM Preprint)"),Qe(),Zt(21," | "),We(22,"a",65),Zt(23,"Arxiv (Master's thesis)"),Qe(),Qe(),We(24,"div",62),Zt(25," Advances in Intelligent and Resilient Cities - 2021 "),Qe(),We(26,"div",66),We(27,"span"),Zt(28,"Technologies"),Qe(),Bs(29,"br"),We(30,"a",67),Zt(31,"Angular"),Qe(),Zt(32," | "),We(33,"a",68),Zt(34,"Bulma"),Qe(),Zt(35," | "),We(36,"a",69),Zt(37,"CARTO Colors"),Qe(),Zt(38," | "),We(39,"a",70),Zt(40,"Google Drive"),Qe(),Zt(41," | "),We(42,"a",71),Zt(43,"Google Sheets"),Qe(),Zt(44," | "),We(45,"a",72),Zt(46,"H3"),Qe(),Zt(47," | "),We(48,"a",73),Zt(49,"Mapbox GL JS"),Qe(),Qe(),Qe(),Qe()}if(2&n){const e=Ur();vn("ngClass",_x(12,rk,e.isAboutModalActive)),Ht(4),Z1(e.title),Ht(4),RA("font-weight",500)("margin-left",3,"rem"),Ht(4),RA("font-weight",500)("margin-left",3,"rem"),Ht(15),RA("font-weight",500)}}const BU=function(){return{"circle-color":"#ffffff","circle-pitch-scale":"viewport","circle-stroke-color":"#000000","circle-stroke-width":1}};let zU=(()=>{class n{constructor(e,r,o,c,p,w){this.titleService=e,this.googleSheetsDownloaderService=r,this.googleDriveDownloaderService=o,this.h3Service=c,this.sanitizer=p,this.httpClient=w,this.title="Transfer learning approach to bicycle-sharing systems\u2019 station location planning using OpenStreetMap data",this.isBurgerActive=!1,this.isAboutModalActive=!1,this.isSettingsModalActive=!1,this.loading=!1,this.progress=0,this.initialized=!1,this.renderHexes=!1,this.currentCityId=1,this.currentClassifierId=35,this.currentOpacity=.7,this.filterMinValue=0,this.filterMaxValue=1,this.tempFilterMinValue=0,this.tempFilterMaxValue=1,this.currentGradientName="SunsetDark",this.opacities=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1],this.mapStyles=[{name:"Basic",styleUrl:"basic-v9"},{name:"Streets",styleUrl:"streets-v11"},{name:"Light",styleUrl:"light-v10"},{name:"Dark",styleUrl:"dark-v10"},{name:"Satellite",styleUrl:"satellite-v9"},{name:"Satellite streets",styleUrl:"satellite-streets-v11"}],this.gradients=[{name:"PinkYl",colors:["#fef6b5","#ffdd9a","#ffc285","#ffa679","#fa8a76","#f16d7a","#e15383"]},{name:"Sunset",colors:["#f3e79b","#fac484","#f8a07e","#eb7f86","#ce6693","#a059a0","#5c53a5"]},{name:"SunsetDark",colors:["#fcde9c","#faa476","#f0746e","#e34f6f","#dc3977","#b9257a","#7c1d6f"]},{name:"Mint",colors:["#e4f1e1","#b4d9cc","#89c0b6","#63a6a0","#448c8a","#287274","#0d585f"]},{name:"DarkMint",colors:["#d2fbd4","#a5dbc2","#7bbcb0","#559c9e","#3a7c89","#235d72","#123f5a"]},{name:"TealGrn",colors:["#b0f2bc","#89e8ac","#67dba5","#4cc8a3","#38b2a3","#2c98a0","#257d98"]},{name:"PurpOr",colors:["#f9ddda","#f2b9c4","#e597b9","#ce78b3","#ad5fad","#834ba0","#573b88"]},{name:"Magenta",colors:["#f3cbd3","#eaa9bd","#dd88ac","#ca699d","#b14d8e","#91357d","#6c2167"]},{name:"Peach",colors:["#fde0c5","#facba6","#f8b58b","#f59e72","#f2855d","#ef6a4c","#eb4a40"]},{name:"BluYl",colors:["#f7feae","#b7e6a5","#7ccba2","#46aea0","#089099","#00718b","#045275"]},{name:"Emrld",colors:["#d3f2a3","#97e196","#6cc08b","#4c9b82","#217a79","#105965","#074050"]},{name:"Temps",colors:["#009392","#39b185","#9ccb86","#e9e29c","#eeb479","#e88471","#cf597e"]},{name:"Geyser",colors:["#008080","#70a494","#b4c8a8","#f6edbd","#edbb8a","#de8a5a","#ca562c"]},{name:"Earth",colors:["#A16928","#bd925a","#d6bd8d","#edeac2","#b5c8b8","#79a7ac","#2887a1"]},{name:"TealRose",colors:["#009392","#72aaa1","#b1c7b3","#f1eac8","#e5b9ad","#d98994","#d0587e"]},{name:"ArmyRose",colors:["#798234","#a3ad62","#d0d3a2","#fdfbe4","#f0c6c3","#df91a3","#d46780"]}],this.cities=[],this.cityGroups=[],this.classifiers=[],this.currentHexes=[],this.currentHexesFiltered=[],this.currentHexesValues=[],this.minValue=0,this.maxValue=1,this.currentGeojsonData=null,this.currentGeojsonBikeStationsData=null,this.popup=new Qp.Popup({closeButton:!1,closeOnClick:!1}),this.currentPopupId=null,this.chartType=Fr.Histogram,this.chartOptions={width:500,vAxis:{logScale:!0,textPosition:"in"},enableInteractivity:!1,legend:{position:"none"},hAxis:{slantedText:!1,minValue:0,maxValue:1},chartArea:{top:0,width:"95%",height:"80%"},histogram:{minValue:0,maxValue:1},bar:{gap:0},fontName:"Fira Sans"},this.titleService.setTitle(this.title)}toggleBurger(){this.isBurgerActive=!this.isBurgerActive}toggleAboutModal(){this.isAboutModalActive=!this.isAboutModalActive}toggleSettingsModal(){this.isSettingsModalActive=!this.isSettingsModalActive}get legendMinValue(){return Math.max(this.minValue,this.filterMinValue)}get legendMaxValue(){return Math.min(this.maxValue,this.filterMaxValue)}ngOnInit(){this.loading=!0,this.currentMapStyle=this.mapStyles.find(e=>"Basic"===e.name),this.generateGeojsonData(),this.googleDriveDownloaderService.progressSubject.subscribe(e=>this.progress=e),this.httpClient.get("assets/bikeStations.geojson",{responseType:"json"}).subscribe(e=>this.currentGeojsonBikeStationsData=e)}ngAfterViewInit(){kT([this.googleSheetsDownloaderService.getCities(),this.googleSheetsDownloaderService.getClassifiers(),this.googleDriveDownloaderService.setupFiles()]).subscribe(([c,p,w])=>{var T=new Intl.Collator("pl");this.loading=!1,this.cities=c.filter(O=>w.some(V=>V.areaId===O.id)).sort((O,V)=>T.compare(O.name,V.name)),this.cities.forEach(O=>{var V;return O.sizeBytes=null===(V=w.find(W=>W.areaId===O.id))||void 0===V?void 0:V.size}),this.cityGroups=[...new Set(this.cities.map(O=>O.group))].sort((O,V)=>T.compare(O,V)),this.classifiers=p.sort((O,V)=>T.compare(O.name,V.name)),this.currentCityId=this.cities[Math.floor(Math.random()*this.cities.length)].id,this.initialized=!0,this.onCitySelect()})}get currentGradient(){return this.gradients.find(e=>e.name===this.currentGradientName)}get currentCity(){var e=this.cities.find(r=>r.id==this.currentCityId);if(void 0===e)throw new Error("City get error: "+this.currentCityId);return e}get currentClassifier(){return this.classifiers.find(r=>r.id==this.currentClassifierId)}getCitiesForGroup(e){return this.cities.filter(r=>r.group===e)}getMapStyle(){return`mapbox://styles/mapbox/${this.currentMapStyle.styleUrl}`}generateGeojsonData(){var e={type:"FeatureCollection",features:this.currentHexesFiltered.map(r=>({type:"Feature",geometry:this.h3Service.getGeojsonForHex(r.hex),properties:{value:r.value}}))};this.currentGeojsonData=e}onCitySelect(){var e,r;this.map.mapInstance.getLayer("hex")&&this.map.mapInstance.setLayoutProperty("hex","visibility","none"),this.loading=!0,this.progress=0,this.map.mapInstance.jumpTo({bearing:0,pitch:0,zoom:13,center:[null===(e=this.currentCity)||void 0===e?void 0:e.lon,null===(r=this.currentCity)||void 0===r?void 0:r.lat]}),this.loading=!1,this.onClassifierSelect()}formatBytes(e,r=2){if(!e||0===e)return"0 Bytes";const c=r<0?0:r,w=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,w)).toFixed(c))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][w]}interpolateGradient(){var e=this.gradients.find(p=>p.name===this.currentGradientName),r=[],o=e.colors.length,c=this.legendMaxValue-this.legendMinValue;return e.colors.forEach((p,w)=>{r.push(this.legendMinValue+w/(o-1)*c),r.push(p)}),r}getGradientCss(e){var r="",o=e.length;return e.forEach((c,p)=>{r+=`${c} ${100*p/(o-1)}%`,p<o-1&&(r+=", ")}),this.sanitizer.bypassSecurityTrustStyle(`background-image: linear-gradient(90deg, ${r});`)}getPaint(){return{"fill-color":["interpolate",["linear"],["get","value"],...this.interpolateGradient()],"fill-opacity":this.currentOpacity,"fill-antialias":!1}}showPopup(e){var r;if((null===(r=e.features)||void 0===r?void 0:r.length)>0){var o=e.features[0].properties.value;this.currentPopupId!==e.features[0].id&&(this.popup.remove(),this.popup.setLngLat(e.lngLat).setText(o).addTo(this.map.mapInstance))}}hidePopup(e){this.popup.remove()}applyFilter(){this.filterMinValue=this.tempFilterMinValue,this.filterMaxValue=this.tempFilterMaxValue,this.currentHexesFiltered=this.currentHexes.filter(e=>e.value>=this.filterMinValue&&e.value<=this.filterMaxValue),this.generateGeojsonData()}resetFilter(e=!1){this.filterMinValue=e?.5:this.minValue,this.tempFilterMinValue=e?.5:this.minValue,this.filterMaxValue=this.maxValue,this.tempFilterMaxValue=this.maxValue,this.applyFilter()}onClassifierSelect(){this.loading=!0,this.progress=0,this.renderHexes=!1,this.map.mapInstance.getLayer("hex")&&this.map.mapInstance.setLayoutProperty("hex","visibility","none"),this.currentClassifierId?this.googleDriveDownloaderService.getHexData(this.currentCity,this.currentClassifierId).subscribe(e=>{this.currentHexes=e;var r=this.currentHexes.map(o=>o.value).sort();this.currentHexesValues=r.map(o=>[o]),this.minValue=r[0],this.maxValue=r[r.length-1],this.resetFilter(!0),this.loading=!1,this.map.mapInstance.setLayoutProperty("hex","visibility","visible")},e=>{console.log(e.message),console.log(e),this.currentHexes=[],this.generateGeojsonData(),this.loading=!1},()=>{this.loading=!1}):(this.currentHexes=[],this.currentHexesValues=[],this.minValue=0,this.maxValue=1,this.resetFilter(),this.loading=!1)}}return n.\u0275fac=function(e){return new(e||n)(lt(rS),lt(sw),lt($T),lt(nI),lt(Py),lt(d0))},n.\u0275cmp=zo({type:n,selectors:[["app-root"]],viewQuery:function(e,r){if(1&e&&Mx(IT,5),2&e){let o;Fp(o=Op())&&(r.map=o.first)}},decls:28,vars:16,consts:[["role","navigation","aria-label","main navigation",1,"navbar"],[1,"navbar-brand"],[1,"navbar-item","is-size-3","has-text-weight-medium"],["role","button","aria-label","menu","aria-expanded","false",1,"navbar-burger",2,"width","64px","height","64px",3,"click"],["aria-hidden","true"],["id","navbarBasicExample",1,"navbar-menu"],[1,"navbar-end"],[1,"navbar-item"],[1,"button","is-rounded",3,"click"],["src","assets/pwr_logo.svg",2,"max-height","3rem"],[1,"map-container"],["id","scale-box",4,"ngIf"],["id","loading-overlay",3,"is-loading",4,"ngIf"],["movingMethod","jumpTo",3,"interactive"],["id","hex",3,"data"],["id","stations",3,"data"],["id","stations","type","circle","source","stations",3,"paint"],["id","hex","type","fill","source","hex",3,"paint","layerMouseMove","layerMouseOut"],["class","modal",3,"ngClass",4,"ngIf"],["id","scale-box"],[1,"box","is-hidden-tablet"],[1,"my-legend"],[1,"legend-title"],[1,"legend-scale"],[1,"legend-labels"],[4,"ngFor","ngForOf"],[1,"is-flex"],[2,"flex","1"],[1,"field","has-addons","mt-3"],[1,"control"],["type","number","placeholder","0.0",1,"input",3,"ngModel","ngModelChange"],[1,"button","is-static"],["type","number","placeholder","1.0",1,"input",3,"ngModel","ngModelChange"],[1,"button",3,"click"],["class","help is-danger",4,"ngIf"],[1,"box","is-hidden-mobile"],[1,"box","is-hidden-mobile",2,"max-width","540px"],[3,"type","data","options"],[1,"field","has-addons"],[1,"help","is-danger"],[4,"ngIf"],["id","loading-overlay"],[1,"is-size-3",2,"margin","0 auto"],[1,"modal",3,"ngClass"],[1,"modal-background",3,"click"],[1,"modal-content"],[1,"is-size-3","has-text-centered","mb-4"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],[1,"label"],[1,"field-body"],[1,"field","is-expanded"],[1,"select","is-fullwidth","is-rounded"],[3,"ngModel","ngModelChange"],["hidden","","selected","",3,"ngValue"],[3,"label",4,"ngFor","ngForOf"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"label"],[1,"is-size-3","has-text-centered"],[1,"is-size-4","has-text-centered"],[1,"is-size-6","has-text-justified","mt-4","mb-4"],[1,"is-size-6","has-text-centered"],["href","https://github.com/pwr-inf/Transfer-learning-approach-to-bicycle-sharing-systems-station-location-planning-using-OpenStreetMap/tree/main","target","_blank"],["href","https://arxiv.org/abs/2111.00990","target","_blank"],["href","https://arxiv.org/abs/2111.01722","target","_blank"],[1,"is-size-6","has-text-centered","mt-4","mb-4"],["href","https://angular.io","target","_blank"],["href","https://bulma.io","target","_blank"],["href","https://carto.com/carto-colors/","target","_blank"],["href","https://drive.google.com/","target","_blank"],["href","https://docs.google.com/spreadsheets/","target","_blank"],["href","https://h3geo.org","target","_blank"],["href","https://docs.mapbox.com/mapbox-gl-js/","target","_blank"]],template:function(e,r){1&e&&(We(0,"nav",0),We(1,"div",1),We(2,"h3",2),Zt(3,"OSM \u2794 BSS"),Qe(),We(4,"a",3),Er("click",function(){return r.toggleBurger()}),Bs(5,"span",4),Bs(6,"span",4),Bs(7,"span",4),Qe(),Qe(),We(8,"div",5),We(9,"div",6),We(10,"div",7),We(11,"button",8),Er("click",function(){return r.toggleSettingsModal()}),Zt(12," Settings "),Qe(),Qe(),We(13,"div",7),We(14,"button",8),Er("click",function(){return r.toggleAboutModal()}),Zt(15," About "),Qe(),Qe(),We(16,"div",7),Bs(17,"img",9),Qe(),Qe(),Qe(),Qe(),We(18,"div",10),Qi(19,DU,60,41,"div",11),Qi(20,SU,4,3,"div",12),We(21,"mgl-map",13),Bs(22,"mgl-geojson-source",14),Bs(23,"mgl-geojson-source",15),Bs(24,"mgl-layer",16),We(25,"mgl-layer",17),Er("layerMouseMove",function(c){return r.showPopup(c)})("layerMouseOut",function(c){return r.hidePopup(c)}),Qe(),Qe(),Qe(),Qi(26,OU,60,18,"div",18),Qi(27,LU,50,14,"div",18)),2&e&&(Ht(4),ua("is-active",r.isBurgerActive),Ht(4),ua("is-active",r.isBurgerActive),Ht(11),vn("ngIf",r.currentHexes.length>0),Ht(1),vn("ngIf",r.loading),Ht(1),ul(r.getMapStyle()),vn("interactive",!0),Ht(1),vn("data",r.currentGeojsonData),Ht(1),vn("data",r.currentGeojsonBikeStationsData),Ht(1),vn("paint",function(n,t,e){const r=Ci()+n,o=ht();return o[r]===An?Yc(o,r,e?t.call(e):t()):function(n,t){return n[t]}(o,r)}(15,BU)),Ht(1),vn("paint",r.getPaint()),Ht(1),vn("ngIf",r.initialized),Ht(1),vn("ngIf",r.initialized))},directives:[LM,IT,G8,$8,FM,Dw,ov,SI,Ew,R8,RM,pv,$I,qI],pipes:[VM],styles:["[_nghost-%COMP%]{height:100vh;display:flex;flex:1;flex-direction:column}[_nghost-%COMP%]   .navbar[_ngcontent-%COMP%]{height:64px}.modal-background[_ngcontent-%COMP%]{background-color:#ffffff80}#loading-overlay[_ngcontent-%COMP%]{background-color:#ffffffe6}@supports ((-webkit-backdrop-filter: none) or (backdrop-filter: none)){.modal-background[_ngcontent-%COMP%], #loading-overlay[_ngcontent-%COMP%]{background-color:transparent;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);background-color:#ffffff40}}.modal-content[_ngcontent-%COMP%]{background-color:#ffffffbf;padding:3em;border-radius:2rem;width:80vw}.map-container[_ngcontent-%COMP%]{height:calc(100vh - 64px);flex:1;position:relative}.map-container[_ngcontent-%COMP%]   #loading-overlay[_ngcontent-%COMP%], .map-container[_ngcontent-%COMP%]   mgl-map[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;top:0;left:0}.map-container[_ngcontent-%COMP%]   #loading-overlay[_ngcontent-%COMP%]{z-index:20;align-items:center;display:flex;pointer-events:none;opacity:0;transition:opacity .6s linear}.map-container[_ngcontent-%COMP%]   .is-loading[_ngcontent-%COMP%]{opacity:1!important}.map-container[_ngcontent-%COMP%]   #scale-box[_ngcontent-%COMP%]{z-index:10;position:absolute;top:1em;right:1em;--box-width: 70px}.map-container[_ngcontent-%COMP%]   #scale-box[_ngcontent-%COMP%]   .my-legend[_ngcontent-%COMP%]{height:60px;width:500px}.map-container[_ngcontent-%COMP%]   #scale-box[_ngcontent-%COMP%]   .my-legend[_ngcontent-%COMP%]   .legend-title[_ngcontent-%COMP%]{text-align:left;margin-bottom:8px;font-size:90%}.map-container[_ngcontent-%COMP%]   #scale-box[_ngcontent-%COMP%]   .my-legend[_ngcontent-%COMP%]   .legend-scale[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0 0 0 5px;padding:0;float:left;list-style:none}@media screen and (max-width: 768px){.map-container[_ngcontent-%COMP%]   #scale-box[_ngcontent-%COMP%]{top:auto;bottom:1em;right:1em;left:1em;--box-width: calc(((100vw - 2em - 2.5rem) / 7) - 1px)}.map-container[_ngcontent-%COMP%]   #scale-box[_ngcontent-%COMP%]   .my-legend[_ngcontent-%COMP%]{width:calc(100vw - 2em - 2.5rem);height:auto}.map-container[_ngcontent-%COMP%]   #scale-box[_ngcontent-%COMP%]   .my-legend[_ngcontent-%COMP%]   .legend-scale[_ngcontent-%COMP%]{margin-bottom:23px}.map-container[_ngcontent-%COMP%]   #scale-box[_ngcontent-%COMP%]   .my-legend[_ngcontent-%COMP%]   .legend-scale[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-left:0}}.map-container[_ngcontent-%COMP%]   #scale-box[_ngcontent-%COMP%]   .my-legend[_ngcontent-%COMP%]   .legend-scale[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:block;float:left;width:var(--box-width);text-align:center;font-size:80%;list-style:none}.map-container[_ngcontent-%COMP%]   #scale-box[_ngcontent-%COMP%]   .my-legend[_ngcontent-%COMP%]   ul.legend-labels[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;float:left;height:15px;width:var(--box-width)}.map-container[_ngcontent-%COMP%]   #scale-box[_ngcontent-%COMP%]   .my-legend[_ngcontent-%COMP%]   .legend-source[_ngcontent-%COMP%]{font-size:70%;color:#999;clear:both}.map-container[_ngcontent-%COMP%]   #scale-box[_ngcontent-%COMP%]   .my-legend[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#777}"]}),n})(),VU=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Gi({type:n,bootstrap:[zU]}),n.\u0275inj=gr({providers:[{provide:ow,useValue:"AIzaSyDVc71t2FNSlJ5sko_IZBGZVre45bYA94U"},sw,$T,nI],imports:[[_5,a8,s6,q8.withConfig({accessToken:"pk.eyJ1IjoicmFjemVxIiwiYSI6ImNrb2Fmd3E3cjJwYmIyd2xwa2IwZGhxaXkifQ.VrDUIhReRiZxENDHOzCgqw"}),pU,mU,F8]]}),n})();(function(){if(zD)throw new Error("Cannot enable prod mode after platform setup.");ND=!1})(),m5().bootstrapModule(VU).catch(n=>console.error(n))}},wd=>{wd(wd.s=177)}]);